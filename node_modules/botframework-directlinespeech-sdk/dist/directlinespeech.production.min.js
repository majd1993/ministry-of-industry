window.DirectLineSpeech=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=226)}([function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{static throwIfNullOrUndefined(e,t){if(null==e)throw new Error("throwIfNullOrUndefined:"+t)}static throwIfNull(e,t){if(null===e)throw new Error("throwIfNull:"+t)}static throwIfNullOrWhitespace(e,t){if(n.throwIfNullOrUndefined(e,t),(""+e).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+t)}static throwIfDisposed(e){if(e)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(e,t){if(n.throwIfNullOrUndefined(e,t),0===e.length)throw new Error("throwIfArrayEmptyOrWhitespace:"+t);for(const r of e)n.throwIfNullOrWhitespace(r,t)}static throwIfFileDoesNotExist(e,t){n.throwIfNullOrWhitespace(e,t)}static throwIfNotUndefined(e,t){if(void 0!==e)throw new Error("throwIfNotUndefined:"+t)}}},function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return a}));const n="OutputFormat",i="CancellationErrorCode",o="ServiceProperties",s="ForceDication",a="OpenRange"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(148);t.AudioConfig=n.AudioConfig;var i=r(63);t.AudioStreamFormat=i.AudioStreamFormat;var o=r(155);t.AudioInputStream=o.AudioInputStream,t.PullAudioInputStream=o.PullAudioInputStream,t.PushAudioInputStream=o.PushAudioInputStream;var s=r(53);t.AudioOutputStream=s.AudioOutputStream,t.PullAudioOutputStream=s.PullAudioOutputStream,t.PushAudioOutputStream=s.PushAudioOutputStream;var a=r(260);t.CancellationReason=a.CancellationReason;var c=r(261);t.PullAudioInputStreamCallback=c.PullAudioInputStreamCallback;var p=r(262);t.PushAudioOutputStreamCallback=p.PushAudioOutputStreamCallback;var u=r(263);t.KeywordRecognitionModel=u.KeywordRecognitionModel;var h=r(264);t.SessionEventArgs=h.SessionEventArgs;var v=r(265);t.RecognitionEventArgs=v.RecognitionEventArgs;var l=r(266);t.OutputFormat=l.OutputFormat;var d=r(267);t.IntentRecognitionEventArgs=d.IntentRecognitionEventArgs;var f=r(268);t.RecognitionResult=f.RecognitionResult;var g=r(269);t.SpeechRecognitionResult=g.SpeechRecognitionResult;var y=r(270);t.IntentRecognitionResult=y.IntentRecognitionResult;var m=r(271);t.LanguageUnderstandingModel=m.LanguageUnderstandingModel;var S=r(272);t.SpeechRecognitionEventArgs=S.SpeechRecognitionEventArgs;var C=r(273);t.SpeechRecognitionCanceledEventArgs=C.SpeechRecognitionCanceledEventArgs;var b=r(274);t.TranslationRecognitionEventArgs=b.TranslationRecognitionEventArgs;var P=r(275);t.TranslationSynthesisEventArgs=P.TranslationSynthesisEventArgs;var R=r(156);t.TranslationRecognitionResult=R.TranslationRecognitionResult;var w=r(276);t.TranslationSynthesisResult=w.TranslationSynthesisResult;var I=r(277);t.ResultReason=I.ResultReason;var E=r(278);t.SpeechConfig=E.SpeechConfig,t.SpeechConfigImpl=E.SpeechConfigImpl;var O=r(279);t.SpeechTranslationConfig=O.SpeechTranslationConfig;var T=r(157);t.PropertyCollection=T.PropertyCollection;var A=r(105);t.PropertyId=A.PropertyId;var D=r(280);t.Recognizer=D.Recognizer;var _=r(281);t.SpeechRecognizer=_.SpeechRecognizer;var M=r(282);t.IntentRecognizer=M.IntentRecognizer;var x=r(283);t.VoiceProfileType=x.VoiceProfileType;var k=r(284);t.TranslationRecognizer=k.TranslationRecognizer;var j=r(285);t.Translations=j.Translations;var z=r(286);t.NoMatchReason=z.NoMatchReason;var N=r(287);t.NoMatchDetails=N.NoMatchDetails;var L=r(288);t.TranslationRecognitionCanceledEventArgs=L.TranslationRecognitionCanceledEventArgs;var B=r(289);t.IntentRecognitionCanceledEventArgs=B.IntentRecognitionCanceledEventArgs;var F=r(159);t.CancellationDetailsBase=F.CancellationDetailsBase;var U=r(290);t.CancellationDetails=U.CancellationDetails;var q=r(291);t.CancellationErrorCode=q.CancellationErrorCode;var H=r(292);t.ConnectionEventArgs=H.ConnectionEventArgs;var W=r(293);t.ServiceEventArgs=W.ServiceEventArgs;var V=r(294);t.Connection=V.Connection;var K=r(295);t.PhraseListGrammar=K.PhraseListGrammar;var J=r(106);t.DialogServiceConfig=J.DialogServiceConfig;var G=r(296);t.BotFrameworkConfig=G.BotFrameworkConfig;var Q=r(297);t.CustomCommandsConfig=Q.CustomCommandsConfig;var $=r(298);t.DialogServiceConnector=$.DialogServiceConnector;var Y=r(300);t.ActivityReceivedEventArgs=Y.ActivityReceivedEventArgs;var X=r(301);t.ServicePropertyChannel=X.ServicePropertyChannel;var Z=r(302);t.ProfanityOption=Z.ProfanityOption;var ee=r(303);t.BaseAudioPlayer=ee.BaseAudioPlayer;var te=r(304);t.ConnectionMessageEventArgs=te.ConnectionMessageEventArgs;var re=r(160);t.ConnectionMessage=re.ConnectionMessage;var ne=r(305);t.VoiceProfile=ne.VoiceProfile;var ie=r(306);t.VoiceProfileEnrollmentResult=ie.VoiceProfileEnrollmentResult,t.VoiceProfileEnrollmentCancellationDetails=ie.VoiceProfileEnrollmentCancellationDetails;var oe=r(307);t.VoiceProfileResult=oe.VoiceProfileResult,t.VoiceProfileCancellationDetails=oe.VoiceProfileCancellationDetails;var se=r(308);t.VoiceProfileClient=se.VoiceProfileClient;var ae=r(309);t.SpeakerRecognizer=ae.SpeakerRecognizer;var ce=r(310);t.SpeakerIdentificationModel=ce.SpeakerIdentificationModel;var pe=r(311);t.SpeakerVerificationModel=pe.SpeakerVerificationModel;var ue=r(312);t.AutoDetectSourceLanguageConfig=ue.AutoDetectSourceLanguageConfig;var he=r(313);t.AutoDetectSourceLanguageResult=he.AutoDetectSourceLanguageResult;var ve=r(314);t.SourceLanguageConfig=ve.SourceLanguageConfig;var le=r(315);t.SpeakerRecognitionResult=le.SpeakerRecognitionResult,t.SpeakerRecognitionResultType=le.SpeakerRecognitionResultType,t.SpeakerRecognitionCancellationDetails=le.SpeakerRecognitionCancellationDetails;var de=r(161);t.Conversation=de.Conversation,t.ConversationExpirationEventArgs=de.ConversationExpirationEventArgs,t.ConversationParticipantsChangedEventArgs=de.ConversationParticipantsChangedEventArgs,t.ConversationTranslationCanceledEventArgs=de.ConversationTranslationCanceledEventArgs,t.ConversationTranslationEventArgs=de.ConversationTranslationEventArgs,t.ConversationTranslationResult=de.ConversationTranslationResult,t.ConversationTranslator=de.ConversationTranslator,t.Participant=de.Participant,t.ParticipantChangedReason=de.ParticipantChangedReason,t.User=de.User;var fe=r(104);t.SpeechSynthesisOutputFormat=fe.SpeechSynthesisOutputFormat;var ge=r(324);t.SpeechSynthesizer=ge.SpeechSynthesizer;var ye=r(326);t.SpeechSynthesisResult=ye.SpeechSynthesisResult;var me=r(327);t.SpeechSynthesisEventArgs=me.SpeechSynthesisEventArgs;var Se=r(328);t.SpeechSynthesisWordBoundaryEventArgs=Se.SpeechSynthesisWordBoundaryEventArgs;var Ce=r(329);t.SpeakerAudioDestination=Ce.SpeakerAudioDestination},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",e[e.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",e[e.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",e[e.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=25]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",e[e.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",e[e.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.SpeechServiceConnection_EnableAudioLogging=32]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceResponse_ProfanityOption=33]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=34]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=35]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=36]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=37]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=38]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.Conversation_ApplicationId=39]="Conversation_ApplicationId",e[e.Conversation_DialogType=40]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=41]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=42]="Conversation_From_Id",e[e.Conversation_Conversation_Id=43]="Conversation_Conversation_Id",e[e.Conversation_Custom_Voice_Deployment_Ids=44]="Conversation_Custom_Voice_Deployment_Ids",e[e.Conversation_Speech_Activity_Template=45]="Conversation_Speech_Activity_Template",e[e.SpeechServiceConnection_Host=46]="SpeechServiceConnection_Host",e[e.ConversationTranslator_Host=47]="ConversationTranslator_Host",e[e.ConversationTranslator_Name=48]="ConversationTranslator_Name",e[e.ConversationTranslator_CorrelationId=49]="ConversationTranslator_CorrelationId",e[e.ConversationTranslator_Token=50]="ConversationTranslator_Token"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o}));class n extends Error{constructor(e){super(e),this.name="ArgumentNull",this.message=e}}class i extends Error{constructor(e){super(e),this.name="InvalidOperation",this.message=e}}class o extends Error{constructor(e,t){super(t),this.name=e+"ObjectDisposed",this.message=t}}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(254)),n(r(255)),n(r(103)),n(r(256)),n(r(107)),n(r(330)),n(r(331)),n(r(332)),n(r(158)),n(r(333)),n(r(334)),n(r(335)),n(r(336)),n(r(337)),n(r(338)),n(r(339)),n(r(340)),n(r(341)),n(r(342)),n(r(343)),n(r(344)),n(r(345)),n(r(346)),n(r(347)),n(r(348)),n(r(349)),n(r(351)),n(r(352)),n(r(353)),n(r(356)),n(r(357)),n(r(368)),n(r(369)),n(r(168)),n(r(371)),n(r(372)),n(r(373)),n(r(374)),t.OutputFormatPropertyName="OutputFormat",t.CancellationErrorCodePropertyName="CancellationErrorCode",t.ServicePropertiesPropertyName="ServiceProperties",t.ForceDictationPropertyName="ForceDication",t.AutoDetectSourceLanguagesOpenRangeOptionName="OpenRange"},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(244)),n(r(245)),n(r(149)),n(r(246)),n(r(29)),n(r(247)),n(r(150)),n(r(45)),n(r(248)),n(r(151)),n(r(73)),n(r(101)),n(r(152)),n(r(249)),n(r(250)),n(r(251));var i=r(102);t.TranslationStatus=i.TranslationStatus,n(r(252)),n(r(253)),n(r(153))},function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return p})),r.d(t,"e",(function(){return u}));var n,i=r(4);!function(e){e[e.None=0]="None",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(n||(n={}));class o{constructor(e){this.throwIfError=()=>{if(this.isError)throw this.error},e.on(e=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=e)},e=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=e)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}class s{constructor(){this.setResult=e=>{this.privOnSetResult(e)},this.setError=e=>{this.privOnSetError(e)},this.on=(e,t)=>{this.privOnSetResult=e,this.privOnSetError=t}}}class a{}a.whenAll=e=>{if(!e||0===e.length)throw new i.a("promises");const t=new p,r=[];let n=0;const o=()=>{n++,n===e.length&&(0===r.length?t.resolve(!0):t.reject(r.join(", ")))};for(const t of e)t.on(e=>{o()},e=>{r.push(e),o()});return t.promise()},a.fromResult=e=>{const t=new p;return t.resolve(e),t.promise()},a.fromError=e=>{const t=new p;return t.reject(e),t.promise()};class c{constructor(e){this.result=()=>this.privSink.result,this.continueWith=e=>{if(!e)throw new i.a("continuationCallback");const t=new p;return this.privSink.on(r=>{try{const r=e(this.privSink.result);t.resolve(r)}catch(e){t.reject(e)}},r=>{try{const r=e(this.privSink.result);t.resolve(r)}catch(e){t.reject(`'Error handler for error ${r} threw error ${e}'`)}}),t.promise()},this.onSuccessContinueWith=e=>{if(!e)throw new i.a("continuationCallback");const t=new p;return this.privSink.on(r=>{try{const n=e(r);t.resolve(n)}catch(e){t.reject(e)}},e=>{t.reject(e)}),t.promise()},this.continueWithPromise=e=>{if(!e)throw new i.a("continuationCallback");const t=new p;return this.privSink.on(r=>{try{const r=e(this.privSink.result);if(!r)throw new Error("'Continuation callback did not return promise'");r.on(e=>{t.resolve(e)},e=>{t.reject(e)})}catch(e){t.reject(e)}},r=>{try{const r=e(this.privSink.result);if(!r)throw new Error("Continuation callback did not return promise");r.on(e=>{t.resolve(e)},e=>{t.reject(e)})}catch(e){t.reject(`'Error handler for error ${r} threw error ${e}'`)}}),t.promise()},this.onSuccessContinueWithPromise=e=>{if(!e)throw new i.a("continuationCallback");const t=new p;return this.privSink.on(r=>{try{const n=e(r);if(!n)throw new Error("Continuation callback did not return promise");n.on(e=>{t.resolve(e)},e=>{t.reject(e)})}catch(e){t.reject(e)}},e=>{t.reject(e)}),t.promise()},this.on=(e,t)=>{if(!e)throw new i.a("successCallback");if(!t)throw new i.a("errorCallback");return this.privSink.on(e,t),this},this.finally=e=>{if(!e)throw new i.a("callback");const t=t=>{e()};return this.on(t,t)},this.privSink=e}}class p{constructor(){this.state=()=>this.privSink.state,this.promise=()=>this.privPromise,this.resolve=e=>(this.privSink.resolve(e),this),this.reject=e=>(this.privSink.reject(e),this),this.privSink=new u,this.privPromise=new c(this.privSink)}}class u{constructor(){this.privState=n.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.resolve=e=>{if(this.privState!==n.None)throw new Error("'Cannot resolve a completed promise'");this.privState=n.Resolved,this.privPromiseResultEvents.setResult(e);for(let t=0;t<this.privSuccessHandlers.length;t++)this.executeSuccessCallback(e,this.privSuccessHandlers[t],this.privErrorHandlers[t]);this.detachHandlers()},this.reject=e=>{if(this.privState!==n.None)throw new Error("'Cannot reject a completed promise'");this.privState=n.Rejected,this.privPromiseResultEvents.setError(e);for(const t of this.privErrorHandlers)this.executeErrorCallback(e,t);this.detachHandlers()},this.on=(e,t)=>{null==e&&(e=e=>{}),this.privState===n.None?(this.privSuccessHandlers.push(e),this.privErrorHandlers.push(t)):(this.privState===n.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,e,t):this.privState===n.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,t),this.detachHandlers())},this.executeSuccessCallback=(e,t,r)=>{try{t(e)}catch(e){this.executeErrorCallback(`'Unhandled callback error: ${e}'`,r)}},this.executeErrorCallback=(e,t)=>{if(!t)throw new Error(`'Unhandled error: ${e}'`);try{t(e)}catch(t){throw new Error(`'Unhandled callback error: ${t}. InnerError: ${e}'`)}},this.detachHandlers=()=>{this.privErrorHandlers=[],this.privSuccessHandlers=[]},this.privPromiseResultEvents=new s,this.privPromiseResult=new o(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n,i=r(18);!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(n||(n={}));class o{constructor(e,t){this.privName=e,this.privEventId=Object(i.b)(),this.privEventTime=(new Date).toISOString(),this.privEventType=t,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.throwIfNullOrUndefined=function(e,t){if(null==e)throw new Error("throwIfNullOrUndefined:"+t)},e.throwIfNull=function(e,t){if(null===e)throw new Error("throwIfNull:"+t)},e.throwIfNullOrWhitespace=function(t,r){if(e.throwIfNullOrUndefined(t,r),(""+t).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+r)},e.throwIfDisposed=function(e){if(e)throw new Error("the object is already disposed")},e.throwIfArrayEmptyOrWhitespace=function(t,r){if(e.throwIfNullOrUndefined(t,r),0===t.length)throw new Error("throwIfArrayEmptyOrWhitespace:"+r);for(var n=0,i=t;n<i.length;n++){var o=i[n];e.throwIfNullOrWhitespace(o,r)}},e.throwIfFileDoesNotExist=function(t,r){e.throwIfNullOrWhitespace(t,r)},e.throwIfNotUndefined=function(e,t){if(void 0!==e)throw new Error("throwIfNotUndefined:"+t)},e}();t.Contracts=n},function(e,t,r){"use strict";r.d(t,"b",(function(){return E})),r.d(t,"e",(function(){return v.a})),r.d(t,"c",(function(){return y.a})),r.d(t,"Q",(function(){return y.b})),r.d(t,"T",(function(){return y.d})),r.d(t,"d",(function(){return C.a})),r.d(t,"S",(function(){return C.b})),r.d(t,"U",(function(){return C.d})),r.d(t,"m",(function(){return A.a})),r.d(t,"R",(function(){return g})),r.d(t,"V",(function(){return R})),r.d(t,"F",(function(){return D})),r.d(t,"cb",(function(){return _.a})),r.d(t,"W",(function(){return M.a})),r.d(t,"J",(function(){return x.a})),r.d(t,"C",(function(){return k.a})),r.d(t,"X",(function(){return j.a})),r.d(t,"pb",(function(){return z.a})),r.d(t,"D",(function(){return N.a})),r.d(t,"G",(function(){return L})),r.d(t,"ob",(function(){return U.a})),r.d(t,"nb",(function(){return q.a})),r.d(t,"yb",(function(){return H.a})),r.d(t,"Bb",(function(){return W.a})),r.d(t,"zb",(function(){return V.a})),r.d(t,"Cb",(function(){return K.a})),r.d(t,"Z",(function(){return J.a})),r.d(t,"lb",(function(){return X})),r.d(t,"mb",(function(){return Z})),r.d(t,"wb",(function(){return ee})),r.d(t,"O",(function(){return $.a})),r.d(t,"P",(function(){return Q.a})),r.d(t,"Y",(function(){return oe})),r.d(t,"qb",(function(){return ce})),r.d(t,"E",(function(){return ve})),r.d(t,"Lb",(function(){return le.a})),r.d(t,"Ab",(function(){return ge})),r.d(t,"Db",(function(){return me.a})),r.d(t,"I",(function(){return ye})),r.d(t,"H",(function(){return be})),r.d(t,"xb",(function(){return Pe.a})),r.d(t,"B",(function(){return Re.a})),r.d(t,"k",(function(){return we})),r.d(t,"j",(function(){return Oe})),r.d(t,"l",(function(){return Ee.a})),r.d(t,"o",(function(){return Te})),r.d(t,"ab",(function(){return Ae})),r.d(t,"n",(function(){return ke})),r.d(t,"M",(function(){return je})),r.d(t,"z",(function(){return ze})),r.d(t,"i",(function(){return Le})),r.d(t,"y",(function(){return Be})),r.d(t,"A",(function(){return Qe})),r.d(t,"a",(function(){return Ye.a})),r.d(t,"bb",(function(){return $e})),r.d(t,"N",(function(){return F})),r.d(t,"h",(function(){return Ze})),r.d(t,"q",(function(){return xe})),r.d(t,"p",(function(){return _e})),r.d(t,"Fb",(function(){return et})),r.d(t,"Jb",(function(){return tt})),r.d(t,"Ib",(function(){return rt})),r.d(t,"Kb",(function(){return nt})),r.d(t,"Gb",(function(){return it})),r.d(t,"Hb",(function(){return ct})),r.d(t,"jb",(function(){return lt})),r.d(t,"fb",(function(){return pt})),r.d(t,"kb",(function(){return vt})),r.d(t,"f",(function(){return dt})),r.d(t,"g",(function(){return ft})),r.d(t,"db",(function(){return gt})),r.d(t,"hb",(function(){return ut})),r.d(t,"ib",(function(){return ot})),r.d(t,"gb",(function(){return ht})),r.d(t,"r",(function(){return ur})),r.d(t,"s",(function(){return Ht})),r.d(t,"t",(function(){return sr})),r.d(t,"u",(function(){return Vt})),r.d(t,"v",(function(){return ar})),r.d(t,"w",(function(){return Wt})),r.d(t,"x",(function(){return vr})),r.d(t,"K",(function(){return pr})),r.d(t,"L",(function(){return Ft})),r.d(t,"Eb",(function(){return cr})),r.d(t,"sb",(function(){return Y.a})),r.d(t,"vb",(function(){return gr})),r.d(t,"tb",(function(){return mr.a})),r.d(t,"rb",(function(){return Sr.a})),r.d(t,"ub",(function(){return Cr.a})),r.d(t,"eb",(function(){return P}));class n{constructor(e,t){this.encode=e=>{const t=this.downSampleAudioFrame(e,this.privActualSampleRate,this.privDesiredSampleRate);if(!t)return null;const r=2*t.length,n=new ArrayBuffer(r),i=new DataView(n);return this.floatTo16BitPCM(i,0,t),n},this.setString=(e,t,r)=>{for(let n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))},this.floatTo16BitPCM=(e,t,r)=>{for(let n=0;n<r.length;n++,t+=2){const i=Math.max(-1,Math.min(1,r[n]));e.setInt16(t,i<0?32768*i:32767*i,!0)}},this.downSampleAudioFrame=(e,t,r)=>{if(r===t||r>t)return e;const n=t/r,i=Math.round(e.length/n),o=new Float32Array(i);let s=0,a=0;for(;a<i;){const t=Math.round((a+1)*n);let r=0,i=0;for(;s<t&&s<e.length;)r+=e[s++],i++;o[a++]=r/i}return o},this.privActualSampleRate=e,this.privDesiredSampleRate=t}}class i{constructor(){this.record=(e,t,r)=>{const i=(()=>{let t=0;try{return e.createScriptProcessor(t,1,1)}catch(r){t=2048;let n=e.sampleRate;for(;t<16384&&n>=32e3;)t<<=1,n>>=1;return e.createScriptProcessor(t,1,1)}})(),o=new n(e.sampleRate,16e3);let s=!0;i.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);if(r&&!r.isClosed){const e=o.encode(t);e&&(r.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()}),s=!1)}};const a=e.createMediaStreamSource(t);this.privSpeechProcessorScript&&e.audioWorklet?e.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const n=new AudioWorkletNode(e,"speech-processor");n.port.onmessage=e=>{const t=e.data;if(r&&!r.isClosed){const e=o.encode(t);e&&(r.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()}),s=!1)}},a.connect(n),n.connect(e.destination),this.privMediaResources={scriptProcessorNode:n,source:a,stream:t}}).catch(()=>{a.connect(i),i.connect(e.destination),this.privMediaResources={scriptProcessorNode:i,source:a,stream:t}}):(a.connect(i),i.connect(e.destination),this.privMediaResources={scriptProcessorNode:i,source:a,stream:t})},this.releaseMediaResources=e=>{this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(e.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privMediaResources.stream.getTracks().forEach(e=>e.stop()),this.privMediaResources.source=null))}}setWorkletUrl(e){this.privSpeechProcessorScript=e}}var o=r(31),s=r(7),a=r(27),c=r(479),p=r(133),u=r(18),h=r(61),v=r(30);class l{constructor(e,t,r){this.privRecorder=e,this.deviceId=t,this.privStreams={},this.turnOn=()=>{if(this.privInitializeDeferral)return this.privInitializeDeferral.promise();this.privInitializeDeferral=new s.a;try{this.createAudioContext()}catch(e){if(e instanceof Error){const t=e;this.privInitializeDeferral.reject(t.name+": "+t.message)}else this.privInitializeDeferral.reject(e);return this.privInitializeDeferral.promise()}const e=window.navigator;let t=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia;if(e.mediaDevices&&(t=(t,r,n)=>{e.mediaDevices.getUserMedia(t).then(r).catch(n)}),t){const e=()=>{this.onEvent(new a.b(this.privId)),t({audio:!this.deviceId||{deviceId:this.deviceId},video:!1},e=>{this.privMediaStream=e,this.onEvent(new a.d(this.privId)),this.privInitializeDeferral.resolve(!0)},e=>{const t="Error occurred during microphone initialization: "+e,r=this.privInitializeDeferral;this.privInitializeDeferral=null,r.reject(t),this.onEvent(new a.a(this.privId,t))})};"suspended"===this.privContext.state?this.privContext.resume().then(e,e=>{this.privInitializeDeferral.reject("Failed to initialize audio context: "+e)}):e()}else{const e="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(e),this.onEvent(new a.a(e,""))}return this.privInitializeDeferral.promise()},this.id=()=>this.privId,this.attach=e=>(this.onEvent(new a.f(this.privId,e)),this.listen(e).onSuccessContinueWith(t=>(this.onEvent(new a.e(this.privId,e)),{detach:()=>{t.readEnded(),this.turnOff(),delete this.privStreams[e],this.onEvent(new a.g(this.privId,e))},id:()=>e,read:()=>t.read()}))),this.detach=e=>{e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new a.g(this.privId,e)))},this.turnOff=()=>{for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&t.close()}return this.onEvent(new a.c(this.privId)),this.privInitializeDeferral=null,this.destroyAudioContext(),s.c.fromResult(!0)},this.listen=e=>this.turnOn().onSuccessContinueWith(t=>{const r=new c.a(this.privOutputChunkSize,e);this.privStreams[e]=r;try{this.privRecorder.record(this.privContext,this.privMediaStream,r)}catch(t){throw this.onEvent(new a.h(this.privId,e,t)),t}return r}),this.onEvent=e=>{this.privEvents.onEvent(e),p.a.instance.onEvent(e)},this.createAudioContext=()=>{if(!this.privContext){if("undefined"==typeof AudioContext)throw new Error("Browser does not support Web Audio API (AudioContext is not available).");navigator.mediaDevices.getSupportedConstraints().sampleRate?this.privContext=new AudioContext({sampleRate:l.AUDIOFORMAT.samplesPerSec}):this.privContext=new AudioContext}},this.destroyAudioContext=()=>{if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let e=!1;"close"in this.privContext&&(e=!0),e?(this.privContext.close(),this.privContext=null):null!==this.privContext&&"running"===this.privContext.state&&this.privContext.suspend()},this.privOutputChunkSize=l.AUDIOFORMAT.avgBytesPerSec/10,this.privId=r||Object(u.b)(),this.privEvents=new h.a}get format(){return s.c.fromResult(l.AUDIOFORMAT)}get blob(){return s.c.fromError("Not implemented for Mic input")}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().onSuccessContinueWith(e=>({bitspersample:l.AUDIOFORMAT.bitsPerSample,channelcount:l.AUDIOFORMAT.channels,connectivity:o.f.Unknown,manufacturer:"Speech SDK",model:e,samplerate:l.AUDIOFORMAT.samplesPerSec,type:o.g.Microphones}))}setProperty(e,t){if("MICROPHONE-WorkletSourceUrl"!==e)throw new Error("Property '"+e+"' is not supported on Microphone.");this.privRecorder.setWorkletUrl(t)}getMicrophoneLabel(){if(void 0!==this.privMicrophoneLabel)return s.c.fromResult(this.privMicrophoneLabel);if(void 0===this.privMediaStream||!this.privMediaStream.active)return s.c.fromResult("microphone");this.privMicrophoneLabel="microphone";const e=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(void 0===e)return s.c.fromResult(this.privMicrophoneLabel);const t=new s.a;return navigator.mediaDevices.enumerateDevices().then(r=>{for(const t of r)if(t.deviceId===e){this.privMicrophoneLabel=t.label;break}t.resolve(this.privMicrophoneLabel)},()=>t.resolve(this.privMicrophoneLabel)),t.promise()}}l.AUDIOFORMAT=v.a.getDefaultInputFormat();class d{constructor(e,t){this.privStreams={},this.turnOn=()=>{if("undefined"==typeof FileReader){const e="Browser does not support FileReader.";return this.onEvent(new a.a(e,"")),s.c.fromError(e)}if(this.privFile.name.lastIndexOf(".wav")!==this.privFile.name.length-4){const e=this.privFile.name+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new a.a(e,"")),s.c.fromError(e)}return this.onEvent(new a.b(this.privId)),this.onEvent(new a.d(this.privId)),s.c.fromResult(!0)},this.id=()=>this.privId,this.attach=e=>(this.onEvent(new a.f(this.privId,e)),this.upload(e).onSuccessContinueWith(t=>(this.onEvent(new a.e(this.privId,e)),{detach:()=>{t.readEnded(),delete this.privStreams[e],this.onEvent(new a.g(this.privId,e)),this.turnOff()},id:()=>e,read:()=>t.read()}))),this.detach=e=>{e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new a.g(this.privId,e)))},this.turnOff=()=>{for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&!t.isClosed&&t.close()}return this.onEvent(new a.c(this.privId)),s.c.fromResult(!0)},this.readHeader=()=>{const e=this.privFile.slice(0,44),t=new FileReader,r=new s.a;return t.onload=e=>{const t=e.target.result,n=new DataView(t);"RIFF"!==String.fromCharCode(n.getUint8(0),n.getUint8(1),n.getUint8(2),n.getUint8(3))&&r.reject("Invalid WAV header in file, RIFF was not found");"WAVEfmt"!==String.fromCharCode(n.getUint8(8),n.getUint8(9),n.getUint8(10),n.getUint8(11),n.getUint8(12),n.getUint8(13),n.getUint8(14))&&r.reject("Invalid WAV header in file, WAVEfmt was not found");const i=n.getUint16(22,!0),o=n.getUint32(24,!0),s=n.getUint16(34,!0);r.resolve(v.a.getWaveFormatPCM(o,s,i))},t.readAsArrayBuffer(e),r.promise()},this.upload=e=>this.turnOn().onSuccessContinueWithPromise(t=>this.privAudioFormatPromise.onSuccessContinueWith(t=>{new c.a(3200);const r=new FileReader,n=new c.a(t.avgBytesPerSec/10,e);this.privStreams[e]=n;r.onload=e=>{n.isClosed||(n.writeStreamChunk({buffer:r.result,isEnd:!1,timeReceived:Date.now()}),n.close())},r.onerror=t=>{const r=`Error occurred while processing '${this.privFile.name}'. ${t}`;throw this.onEvent(new a.h(this.privId,e,r)),new Error(r)};const i=this.privFile.slice(44);return r.readAsArrayBuffer(i),n})),this.onEvent=e=>{this.privEvents.onEvent(e),p.a.instance.onEvent(e)},this.privId=t||Object(u.b)(),this.privEvents=new h.a,this.privFile=e,this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}get blob(){return s.c.fromResult(this.privFile)}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.onSuccessContinueWithPromise(e=>s.c.fromResult({bitspersample:e.bitsPerSample,channelcount:e.channels,connectivity:o.f.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:e.samplesPerSec,type:o.g.File}))}}var f=r(0);class g{}var y=r(55),m=r(76),S=r(26),C=r(22);const b={[S.a.PCM]:"audio/wav",[S.a.MP3]:"audio/mpeg",[S.a.Opus]:"audio/ogg"};class P{constructor(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||Object(u.b)(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(e){void 0!==this.privAudioBuffer?(this.privAudioBuffer.push(e),this.updateSourceBuffer()):void 0!==this.privAudioOutputStream&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)}close(){if(this.privIsClosed=!0,void 0!==this.privSourceBuffer)this.handleSourceBufferUpdateEnd();else if(void 0!==this.privAudioOutputStream){let e=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(e),this.privFormat.hasHeader&&(e=m.a.addHeader(e,this.privFormat));const t=new Blob([e],{type:b[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(t),this.notifyPlayback()}}set format(e){if("undefined"!=typeof AudioContext||void 0!==window.webkitAudioContext){this.privFormat=e;const t=b[this.privFormat.formatTag];void 0===t?console.warn(`Unknown mimeType for format ${S.a[this.privFormat.formatTag]}.`):"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported(t)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=e=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=1800,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(t),this.privSourceBuffer.onupdate=e=>{this.updateSourceBuffer()},this.privSourceBuffer.onupdateend=e=>{this.handleSourceBufferUpdateEnd()},this.privSourceBuffer.onupdatestart=e=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer()):(console.warn(`Format ${S.a[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new C.c,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get isClosed(){return this.privIsClosed}get currentTime(){return void 0!==this.privAudio?this.privAudio.currentTime:-1}pause(){this.privIsPaused||void 0===this.privAudio||(this.privAudio.pause(),this.privIsPaused=!0)}resume(){this.privIsPaused&&void 0!==this.privAudio&&(this.privAudio.play(),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}updateSourceBuffer(){if(void 0!==this.privAudioBuffer&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const e=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(e)}catch(t){return this.privAudioBuffer.unshift(e),void console.log("buffer filled, pausing addition of binaries until space is made")}this.notifyPlayback()}else this.canEndStream()&&this.handleSourceBufferUpdateEnd()}handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),this.notifyPlayback())}notifyPlayback(){this.privPlaybackStarted||void 0===this.privAudio||(this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||this.privAudio.play(),this.privPlaybackStarted=!0)}canEndStream(){return this.isClosed&&void 0!==this.privSourceBuffer&&0===this.privAudioBuffer.length&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&"open"===this.privMediaSource.readyState}sourceBufferAvailable(){return void 0!==this.privSourceBuffer&&!this.privSourceBuffer.updating}}class R{}var w=r(69);class I{constructor(e){this.id=()=>this.privId,this.privFd=w.openSync(e,"w")}set format(e){f.a.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;let t=0;this.privAudioFormat.hasHeader&&(t=this.privAudioFormat.header.byteLength),void 0!==this.privFd&&(this.privWriteStream=w.createWriteStream("",{fd:this.privFd,start:t,autoClose:!1}))}write(e){f.a.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),void 0!==this.privWriteStream&&this.privWriteStream.write(new Uint8Array(e.slice(0)))}close(){void 0!==this.privFd&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),w.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),w.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}}class E{static fromDefaultMicrophoneInput(){const e=new i;return new O(new l(e))}static fromMicrophoneInput(e){const t=new i;return new O(new l(t,e))}static fromWavFileInput(e){return new O(new d(e))}static fromStreamInput(e){if(e instanceof g)return new O(new y.c(e));if(e instanceof y.a)return new O(e);throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new T(new P)}static fromSpeakerOutput(e){if(void 0===e)return E.fromDefaultSpeakerOutput();if(e instanceof P)return new T(e);throw new Error("Not Supported Type")}static fromAudioFileOutput(e){return new T(new I(e))}static fromStreamOutput(e){if(e instanceof R)return new T(new C.e(e));if(e instanceof C.d)return new T(e);if(e instanceof C.b)return new T(e);throw new Error("Not Supported Type")}}class O extends E{constructor(e){super(),this.privSource=e}get format(){return this.privSource.format}close(){this.privSource.turnOff()}id(){return this.privSource.id()}get blob(){return this.privSource.blob}turnOn(){return this.privSource.turnOn()}attach(e){return this.privSource.attach(e)}detach(e){return this.privSource.detach(e)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(e,t){if(f.a.throwIfNull(t,"value"),void 0===this.privSource.setProperty)throw new Error("This AudioConfig instance does not support setting properties.");this.privSource.setProperty(e,t)}getProperty(e,t){if(void 0!==this.privSource.getProperty)return this.privSource.getProperty(e,t);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}class T extends E{constructor(e){super(),this.privDestination=e}set format(e){this.privDestination.format=e}write(e){this.privDestination.write(e)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(e,t){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(e,t){throw new Error("This AudioConfig instance does not support getting properties.")}}var A=r(36);class D{constructor(){this.privDisposed=!1}static fromFile(e){throw f.a.throwIfFileDoesNotExist(e,"fileName"),new Error("Not yet implemented.")}static fromStream(e){throw f.a.throwIfNull(e,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}}var _=r(78),M=r(58),x=r(59),k=r(48),j=r(123),z=r(42),N=r(49);class L{constructor(){}static fromEndpoint(e){f.a.throwIfNull(e,"uri"),f.a.throwIfNullOrWhitespace(e.hostname,"uri");const t=new B,r=e.host.indexOf(".");if(-1===r)throw new Error("Could not determine region from endpoint");t.region=e.host.substr(0,r);const n=e.pathname.lastIndexOf("/")+1;if(-1===n)throw new Error("Could not determine appId from endpoint");if(t.appId=e.pathname.substr(n),t.subscriptionKey=e.searchParams.get("subscription-key"),void 0===t.subscriptionKey)throw new Error("Could not determine subscription key from endpoint");return t}static fromAppId(e){f.a.throwIfNullOrWhitespace(e,"appId");const t=new B;return t.appId=e,t}static fromSubscription(e,t,r){f.a.throwIfNullOrWhitespace(e,"subscriptionKey"),f.a.throwIfNullOrWhitespace(t,"appId"),f.a.throwIfNullOrWhitespace(r,"region");const n=new B;return n.appId=t,n.region=r,n.subscriptionKey=e,n}}class B extends L{}var F,U=r(79),q=r(124),H=r(80),W=r(81),V=r(47),K=r(82),J=r(12),G=r(1),Q=r(3),$=r(23);!function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"}(F||(F={}));var Y=r(15);class X{constructor(){}static fromSubscription(e,t){f.a.throwIfNullOrWhitespace(e,"subscriptionKey"),f.a.throwIfNullOrWhitespace(t,"region");const r=new Z;return r.setProperty(Q.a.SpeechServiceConnection_Region,t),r.setProperty(Q.a.SpeechServiceConnection_IntentRegion,t),r.setProperty(Q.a.SpeechServiceConnection_Key,e),r}static fromEndpoint(e,t){f.a.throwIfNull(e,"endpoint");const r=new Z;return r.setProperty(Q.a.SpeechServiceConnection_Endpoint,e.href),void 0!==t&&r.setProperty(Q.a.SpeechServiceConnection_Key,t),r}static fromHost(e,t){f.a.throwIfNull(e,"hostName");const r=new Z;return r.setProperty(Q.a.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(""===e.port?"":":"+e.port)),void 0!==t&&r.setProperty(Q.a.SpeechServiceConnection_Key,t),r}static fromAuthorizationToken(e,t){f.a.throwIfNull(e,"authorizationToken"),f.a.throwIfNullOrWhitespace(t,"region");const r=new Z;return r.setProperty(Q.a.SpeechServiceConnection_Region,t),r.setProperty(Q.a.SpeechServiceConnection_IntentRegion,t),r.authorizationToken=e,r}close(){}}class Z extends X{constructor(){super(),this.privProperties=new $.a,this.speechRecognitionLanguage="en-US",this.outputFormat=x.a.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(Q.a.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(Q.a.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(Q.a.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(Q.a.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.privProperties.setProperty(Q.a.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return this.privProperties.getProperty(Q.a.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(e){this.privProperties.setProperty(Q.a.SpeechServiceConnection_RecoLanguage,e)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(Q.a.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(e){this.privProperties.setProperty(Q.a.SpeechServiceConnection_AutoDetectSourceLanguages,e)}get outputFormat(){return x.a[this.privProperties.getProperty(G.d,void 0)]}set outputFormat(e){this.privProperties.setProperty(G.d,x.a[e])}get endpointId(){return this.privProperties.getProperty(Q.a.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privProperties.setProperty(Q.a.SpeechServiceConnection_EndpointId,e)}setProperty(e,t){f.a.throwIfNull(t,"value"),this.privProperties.setProperty(e,t)}getProperty(e,t){return this.privProperties.getProperty(e,t)}setProxy(e,t,r,n){this.setProperty(Q.a[Q.a.SpeechServiceConnection_ProxyHostName],e),this.setProperty(Q.a[Q.a.SpeechServiceConnection_ProxyPort],t),this.setProperty(Q.a[Q.a.SpeechServiceConnection_ProxyUserName],r),this.setProperty(Q.a[Q.a.SpeechServiceConnection_ProxyPassword],n)}setServiceProperty(e,t,r){const n=JSON.parse(this.privProperties.getProperty(G.e,"{}"));n[e]=t,this.privProperties.setProperty(G.e,JSON.stringify(n))}setProfanity(e){this.privProperties.setProperty(Q.a.SpeechServiceResponse_ProfanityOption,F[e])}enableAudioLogging(){this.privProperties.setProperty(Q.a.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(Q.a.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(G.c,"true")}clone(){const e=new Z;return e.privProperties=this.privProperties.clone(),e}get speechSynthesisLanguage(){return this.privProperties.getProperty(Q.a.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privProperties.setProperty(Q.a.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(Q.a.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privProperties.setProperty(Q.a.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return Y.a[this.privProperties.getProperty(Q.a.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privProperties.setProperty(Q.a.SpeechServiceConnection_SynthOutputFormat,Y.a[e])}}class ee extends X{constructor(){super()}static fromSubscription(e,t){f.a.throwIfNullOrWhitespace(e,"subscriptionKey"),f.a.throwIfNullOrWhitespace(t,"region");const r=new te;return r.properties.setProperty(Q.a.SpeechServiceConnection_Key,e),r.properties.setProperty(Q.a.SpeechServiceConnection_Region,t),r}static fromAuthorizationToken(e,t){f.a.throwIfNullOrWhitespace(e,"authorizationToken"),f.a.throwIfNullOrWhitespace(t,"region");const r=new te;return r.properties.setProperty(Q.a.SpeechServiceAuthorization_Token,e),r.properties.setProperty(Q.a.SpeechServiceConnection_Region,t),r}static fromHost(e,t){f.a.throwIfNull(e,"hostName");const r=new te;return r.setProperty(Q.a.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(""===e.port?"":":"+e.port)),void 0!==t&&r.setProperty(Q.a.SpeechServiceConnection_Key,t),r}static fromEndpoint(e,t){f.a.throwIfNull(e,"endpoint"),f.a.throwIfNull(t,"subscriptionKey");const r=new te;return r.properties.setProperty(Q.a.SpeechServiceConnection_Endpoint,e.href),r.properties.setProperty(Q.a.SpeechServiceConnection_Key,t),r}}class te extends ee{constructor(){super(),this.privSpeechProperties=new $.a,this.outputFormat=x.a.Simple}set authorizationToken(e){f.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(Q.a.SpeechServiceAuthorization_Token,e)}set speechRecognitionLanguage(e){f.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(Q.a.SpeechServiceConnection_RecoLanguage,e)}get subscriptionKey(){return this.privSpeechProperties.getProperty(Q.a[Q.a.SpeechServiceConnection_Key])}get outputFormat(){return x.a[this.privSpeechProperties.getProperty(G.d,void 0)]}set outputFormat(e){this.privSpeechProperties.setProperty(G.d,x.a[e])}get endpointId(){return this.privSpeechProperties.getProperty(Q.a.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privSpeechProperties.setProperty(Q.a.SpeechServiceConnection_EndpointId,e)}addTargetLanguage(e){f.a.throwIfNullOrWhitespace(e,"value");const t=this.targetLanguages;t.push(e),this.privSpeechProperties.setProperty(Q.a.SpeechServiceConnection_TranslationToLanguages,t.join(","))}get targetLanguages(){return void 0!==this.privSpeechProperties.getProperty(Q.a.SpeechServiceConnection_TranslationToLanguages,void 0)?this.privSpeechProperties.getProperty(Q.a.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(Q.a[Q.a.SpeechServiceConnection_TranslationVoice])}set voiceName(e){f.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(Q.a.SpeechServiceConnection_TranslationVoice,e)}get region(){return this.privSpeechProperties.getProperty(Q.a.SpeechServiceConnection_Region)}setProxy(e,t,r,n){this.setProperty(Q.a[Q.a.SpeechServiceConnection_ProxyHostName],e),this.setProperty(Q.a[Q.a.SpeechServiceConnection_ProxyPort],t),this.setProperty(Q.a[Q.a.SpeechServiceConnection_ProxyUserName],r),this.setProperty(Q.a[Q.a.SpeechServiceConnection_ProxyPassword],n)}getProperty(e,t){return this.privSpeechProperties.getProperty(e,t)}setProperty(e,t){this.privSpeechProperties.setProperty(e,t)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(e,t,r){const n=JSON.parse(this.privSpeechProperties.getProperty(G.e,"{}"));n[e]=t,this.privSpeechProperties.setProperty(G.e,JSON.stringify(n))}setProfanity(e){this.privSpeechProperties.setProperty(Q.a.SpeechServiceResponse_ProfanityOption,F[e])}enableAudioLogging(){this.privSpeechProperties.setProperty(Q.a.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(Q.a.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(G.c,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(Q.a.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privSpeechProperties.setProperty(Q.a.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(Q.a.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privSpeechProperties.setProperty(Q.a.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return Y.a[this.privSpeechProperties.getProperty(Q.a.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privSpeechProperties.setProperty(Q.a.SpeechServiceConnection_SynthOutputFormat,Y.a[e])}}var re=r(68),ne=r(174),ie=r(175);class oe{constructor(e,t,r){this.audioConfig=void 0!==e?e:E.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=r,this.implCommonRecognizerSetup()}close(){f.a.throwIfDisposed(this.privDisposed),this.dispose(!0)}get internalData(){return this.privReco}dispose(e){this.privDisposed||(e&&this.privReco&&(this.privReco.audioSource.turnOff(),this.privReco.dispose()),this.privDisposed=!0)}static get telemetryEnabled(){return re.a.telemetryDataEnabled}static enableTelemetry(e){re.a.telemetryDataEnabled=e}implCommonRecognizerSetup(){let e="undefined"!=typeof window?"Browser":"Node",t="unknown",r="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);const n=this.createRecognizerConfig(new o.e(new o.a(new o.b(e,t,r)))),i=this.privProperties.getProperty(Q.a.SpeechServiceConnection_Key,void 0),a=i&&""!==i?new ne.a(i):new ie.a(e=>{const t=this.privProperties.getProperty(Q.a.SpeechServiceAuthorization_Token,void 0);return s.c.fromResult(t)},e=>{const t=this.privProperties.getProperty(Q.a.SpeechServiceAuthorization_Token,void 0);return s.c.fromResult(t)});this.privReco=this.createServiceRecognizer(a,this.privConnectionFactory,this.audioConfig,n)}recognizeOnceAsyncImpl(e,t,r){try{f.a.throwIfDisposed(this.privDisposed),this.implRecognizerStop().on(n=>{try{this.privReco.recognize(e,e=>{this.implRecognizerStop().on(r=>{t&&t(e)},e=>{r&&r(e)})},e=>{this.implRecognizerStop(),r&&r(e)}).on(e=>{},e=>{r&&r(e)})}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e);this.dispose(!0)}},e=>{r&&r(e)})}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e);this.dispose(!0)}}startContinuousRecognitionAsyncImpl(e,t,r){try{f.a.throwIfDisposed(this.privDisposed),this.implRecognizerStop().on(n=>{this.privReco.recognize(e,void 0,void 0).on(e=>{if(t){try{t()}catch(e){r&&r(e)}t=void 0}},e=>{r&&r(e),this.dispose(!0)})},e=>{r&&r(e),this.dispose(!0)})}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e);this.dispose(!0)}}stopContinuousRecognitionAsyncImpl(e,t){try{f.a.throwIfDisposed(this.privDisposed),this.implRecognizerStop().on(r=>{if(e)try{e()}catch(e){t&&t(e)}},e=>{t&&t(e)})}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}implRecognizerStop(){return this.privReco?this.privReco.stopRecognizing():s.c.fromResult(!0)}}var se=r(176),ae=r(77);class ce extends oe{constructor(e,t){const r=e;f.a.throwIfNull(r,"speechConfig"),f.a.throwIfNullOrWhitespace(r.properties.getProperty(Q.a.SpeechServiceConnection_RecoLanguage),Q.a[Q.a.SpeechServiceConnection_RecoLanguage]),super(t,r.properties,new ae.a),this.privDisposedSpeechRecognizer=!1}static FromConfig(e,t,r){const n=e;t.properties.mergeTo(n.properties);return new ce(e,r)}get endpointId(){return f.a.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(Q.a.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(Q.a.SpeechServiceAuthorization_Token)}set authorizationToken(e){f.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Q.a.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return f.a.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(Q.a.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return f.a.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(G.d,x.a[x.a.Simple])===x.a[x.a.Simple]?x.a.Simple:x.a.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(e,t){this.recognizeOnceAsyncImpl(o.c.Interactive,e,t)}startContinuousRecognitionAsync(e,t){this.startContinuousRecognitionAsyncImpl(o.c.Conversation,e,t)}stopContinuousRecognitionAsync(e,t){this.stopContinuousRecognitionAsyncImpl(e,t)}startKeywordRecognitionAsync(e,t,r){f.a.throwIfNull(e,"model"),r&&r("Not yet implemented.")}stopKeywordRecognitionAsync(e,t){e&&e()}close(){f.a.throwIfDisposed(this.privDisposedSpeechRecognizer),this.dispose(!0)}dispose(e){this.privDisposedSpeechRecognizer||(e&&(this.implRecognizerStop(),this.privDisposedSpeechRecognizer=!0),super.dispose(e))}createRecognizerConfig(e){return new o.d(e,this.properties)}createServiceRecognizer(e,t,r,n){const i=r;return new se.a(e,t,i,n,this)}}var pe=r(177),ue=r(178),he=r(179);class ve extends oe{constructor(e,t){f.a.throwIfNullOrUndefined(e,"speechConfig");const r=e;f.a.throwIfNullOrUndefined(r,"speechConfig"),super(t,r.properties,new pe.a),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=r.properties,f.a.throwIfNullOrWhitespace(this.properties.getProperty(Q.a.SpeechServiceConnection_RecoLanguage),Q.a[Q.a.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return f.a.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(Q.a.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(Q.a.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(Q.a.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e,t){if(f.a.throwIfDisposed(this.privDisposedIntentRecognizer),0!==Object.keys(this.privAddedLmIntents).length||void 0!==this.privUmbrellaIntent){const e=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",e.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(e.ReferenceGrammars);this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}this.recognizeOnceAsyncImpl(o.c.Interactive,e,t)}startContinuousRecognitionAsync(e,t){if(0!==Object.keys(this.privAddedLmIntents).length){const e=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",e.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(e.ReferenceGrammars);this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}this.startContinuousRecognitionAsyncImpl(o.c.Conversation,e,t)}stopContinuousRecognitionAsync(e,t){this.stopContinuousRecognitionAsyncImpl(e,t)}startKeywordRecognitionAsync(e,t,r){f.a.throwIfNull(e,"model"),r&&r("Not yet implemented.")}stopKeywordRecognitionAsync(e,t){e&&e()}addIntent(e,t){f.a.throwIfDisposed(this.privDisposedIntentRecognizer),f.a.throwIfNullOrWhitespace(t,"intentId"),f.a.throwIfNullOrWhitespace(e,"simplePhrase"),this.privAddedIntents.push([t,e])}addIntentWithLanguageModel(e,t,r){f.a.throwIfDisposed(this.privDisposedIntentRecognizer),f.a.throwIfNullOrWhitespace(e,"intentId"),f.a.throwIfNull(t,"model");const n=t;f.a.throwIfNullOrWhitespace(n.appId,"model.appId"),this.privAddedLmIntents[e]=new ue.a(n,r)}addAllIntents(e,t){f.a.throwIfNull(e,"model");const r=e;f.a.throwIfNullOrWhitespace(r.appId,"model.appId"),this.privUmbrellaIntent=new ue.a(r,t)}close(){f.a.throwIfDisposed(this.privDisposedIntentRecognizer),this.dispose(!0)}createRecognizerConfig(e){return new o.d(e,this.properties)}createServiceRecognizer(e,t,r,n){const i=r;return new he.a(e,t,i,n,this)}dispose(e){this.privDisposedIntentRecognizer||e&&(this.privDisposedIntentRecognizer=!0,super.dispose(e))}buildSpeechContext(){let e,t,r;const n=[];void 0!==this.privUmbrellaIntent&&(e=this.privUmbrellaIntent.modelImpl.appId,t=this.privUmbrellaIntent.modelImpl.region,r=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(const i of Object.keys(this.privAddedLmIntents)){const o=this.privAddedLmIntents[i];if(void 0===e)e=o.modelImpl.appId;else if(e!==o.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(void 0===t)t=o.modelImpl.region;else if(t!==o.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(void 0===r)r=o.modelImpl.subscriptionKey;else if(r!==o.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");const s="luis/"+e+"-PRODUCTION#"+i;n.push(s)}return{Intent:{id:e,key:void 0===r?this.privProperties.getProperty(Q.a[Q.a.SpeechServiceConnection_Key]):r,provider:"LUIS"},ReferenceGrammars:void 0===this.privUmbrellaIntent?n:["luis/"+e+"-PRODUCTION"]}}}var le=r(180),de=r(181),fe=r(182);class ge extends oe{constructor(e,t){const r=e;f.a.throwIfNull(r,"speechConfig"),super(t,r.properties,new de.a),this.privDisposedTranslationRecognizer=!1,this.privProperties=r.properties.clone(),void 0!==this.properties.getProperty(Q.a.SpeechServiceConnection_TranslationVoice,void 0)&&f.a.throwIfNullOrWhitespace(this.properties.getProperty(Q.a.SpeechServiceConnection_TranslationVoice),Q.a[Q.a.SpeechServiceConnection_TranslationVoice]),f.a.throwIfNullOrWhitespace(this.properties.getProperty(Q.a.SpeechServiceConnection_TranslationToLanguages),Q.a[Q.a.SpeechServiceConnection_TranslationToLanguages]),f.a.throwIfNullOrWhitespace(this.properties.getProperty(Q.a.SpeechServiceConnection_RecoLanguage),Q.a[Q.a.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return f.a.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Q.a.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return f.a.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Q.a.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return f.a.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Q.a.SpeechServiceConnection_TranslationVoice,void 0)}get authorizationToken(){return this.properties.getProperty(Q.a.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(Q.a.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e,t){f.a.throwIfDisposed(this.privDisposedTranslationRecognizer),this.recognizeOnceAsyncImpl(o.c.Conversation,e,t)}startContinuousRecognitionAsync(e,t){this.startContinuousRecognitionAsyncImpl(o.c.Conversation,e,t)}stopContinuousRecognitionAsync(e,t){this.stopContinuousRecognitionAsyncImpl(e,t)}close(){f.a.throwIfDisposed(this.privDisposedTranslationRecognizer),this.dispose(!0)}dispose(e){this.privDisposedTranslationRecognizer||e&&(this.implRecognizerStop(),this.privDisposedTranslationRecognizer=!0,super.dispose(e))}createRecognizerConfig(e){return new o.d(e,this.properties)}createServiceRecognizer(e,t,r,n){const i=r;return new fe.a(e,t,i,n,this)}}var ye,me=r(130);!function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(ye||(ye={}));var Se=r(84),Ce=r(13);class be{constructor(e){this.privReason=e}static fromResult(e){const t=Se.a.fromJSON(e.json);let r=ye.NotRecognized;switch(t.RecognitionStatus){case Ce.a.BabbleTimeout:r=ye.InitialBabbleTimeout;break;case Ce.a.InitialSilenceTimeout:r=ye.InitialSilenceTimeout;break;default:r=ye.NotRecognized}return new be(r)}get reason(){return this.privReason}}var Pe=r(86),Re=r(127);class we{constructor(e,t,r){this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}}var Ie=r(38),Ee=r(20);class Oe extends we{constructor(e,t,r){super(e,t,r)}static fromResult(e){let t=A.a.Error,r=Ee.a.NoError;if(e instanceof j.a&&e.json){const r=Se.a.fromJSON(e.json);t=Ie.a.implTranslateCancelResult(r.RecognitionStatus)}return e.properties&&(r=Ee.a[e.properties.getProperty(G.b,Ee.a[Ee.a.NoError])]),new Oe(t,e.errorDetails,r)}}class Te extends _.a{}class Ae extends _.a{constructor(e,t,r){super(r),this.privJsonResult=e,this.privEventName=t}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}}var De=r(17);class _e{}class Me{constructor(e){this.privConnectionMessage=e,this.privProperties=new $.a,this.privConnectionMessage.headers["X-ConnectionId"]&&this.privProperties.setProperty(Q.a.Speech_SessionId,this.privConnectionMessage.headers["X-ConnectionId"]),Object.keys(this.privConnectionMessage.headers).forEach((e,t,r)=>{this.privProperties.setProperty(e,this.privConnectionMessage.headers[e])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(e=>e.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===De.b.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===De.b.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}class xe{constructor(e){this.privConnectionMessage=e}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}}class ke{static fromRecognizer(e){const t=e.internalData,r=new ke;return r.privInternalData=t,r.setupEvents(),r}static fromSynthesizer(e){const t=e.internalData,r=new ke;return r.privInternalData=t,r.setupEvents(),r}openConnection(){this.privInternalData.connect()}closeConnection(){if(this.privInternalData instanceof m.a)throw new Error("Disconnecting a synthesizer's connection is currently not supported");this.privInternalData.disconnect()}setMessageProperty(e,t,r){if(f.a.throwIfNullOrWhitespace(t,"propertyName"),this.privInternalData instanceof re.a){if("speech.context"!==e.toLowerCase())throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(t,r)}else if(this.privInternalData instanceof m.a){if("synthesis.context"!==e.toLowerCase())throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(t,r)}}sendMessageAsync(e,t,r,n){this.privInternalData.sendNetworkMessage(e,t,r,n)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(e=>{"ConnectionEstablishedEvent"===e.name?this.connected&&this.connected(new Te(e.connectionId)):"ConnectionClosedEvent"===e.name?this.disconnected&&this.disconnected(new Te(e.connectionId)):"ConnectionMessageSentEvent"===e.name?this.messageSent&&this.messageSent(new xe(new Me(e.message))):"ConnectionMessageReceivedEvent"===e.name&&this.messageReceived&&this.messageReceived(new xe(new Me(e.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(e=>{this.receivedServiceMessage&&this.receivedServiceMessage(new Ae(e.jsonString,e.name))})}}class je{constructor(e){this.privGrammerBuilder=e.dynamicGrammar}static fromRecognizer(e){const t=e.internalData;return new je(t)}addPhrase(e){this.privGrammerBuilder.addPhrase(e)}addPhrases(e){this.privGrammerBuilder.addPhrase(e)}clear(){this.privGrammerBuilder.clearPhrases()}}class ze{constructor(){}}class Ne extends ze{constructor(){super(),this.privSpeechConfig=new Z}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(e){f.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechConfig.speechRecognitionLanguage=e}setProperty(e,t){this.privSpeechConfig.setProperty(e,t)}getProperty(e,t){return this.privSpeechConfig.getProperty(e)}setProxy(e,t,r,n){this.setProperty(Q.a.SpeechServiceConnection_ProxyHostName,e),this.setProperty(Q.a.SpeechServiceConnection_ProxyPort,""+t),r&&this.setProperty(Q.a.SpeechServiceConnection_ProxyUserName,r),n&&this.setProperty(Q.a.SpeechServiceConnection_ProxyPassword,n)}setServiceProperty(e,t,r){this.privSpeechConfig.setServiceProperty(e,t,r)}close(){}}class Le extends Ne{constructor(){super()}static fromSubscription(e,t,r){f.a.throwIfNullOrWhitespace(e,"subscription"),f.a.throwIfNullOrWhitespace(t,"region");const n=new Ne;return n.setProperty(Q.a.Conversation_DialogType,"bot_framework"),n.setProperty(Q.a.SpeechServiceConnection_Key,e),n.setProperty(Q.a.SpeechServiceConnection_Region,t),r&&n.setProperty(Q.a.Conversation_ApplicationId,r),n}static fromAuthorizationToken(e,t){f.a.throwIfNullOrWhitespace(e,"authorizationToken"),f.a.throwIfNullOrWhitespace(t,"region");const r=new Ne;return r.setProperty(Q.a.Conversation_DialogType,"bot_framework"),r.setProperty(Q.a.SpeechServiceAuthorization_Token,e),r.setProperty(Q.a.SpeechServiceConnection_Region,t),r}}class Be extends Ne{constructor(){super()}static fromSubscription(e,t,r){f.a.throwIfNullOrWhitespace(e,"applicationId"),f.a.throwIfNullOrWhitespace(t,"subscription"),f.a.throwIfNullOrWhitespace(r,"region");const n=new Ne;return n.setProperty(Q.a.Conversation_DialogType,"custom_commands"),n.setProperty(Q.a.Conversation_ApplicationId,e),n.setProperty(Q.a.SpeechServiceConnection_Key,t),n.setProperty(Q.a.SpeechServiceConnection_Region,r),n}static fromAuthorizationToken(e,t,r){f.a.throwIfNullOrWhitespace(e,"applicationId"),f.a.throwIfNullOrWhitespace(t,"authorizationToken"),f.a.throwIfNullOrWhitespace(r,"region");const n=new Ne;return n.setProperty(Q.a.Conversation_DialogType,"custom_commands"),n.setProperty(Q.a.Conversation_ApplicationId,e),n.setProperty(Q.a.SpeechServiceAuthorization_Token,t),n.setProperty(Q.a.SpeechServiceConnection_Region,r),n}set applicationId(e){f.a.throwIfNullOrWhitespace(e,"value"),this.setProperty(Q.a.Conversation_ApplicationId,e)}get applicationId(){return this.getProperty(Q.a.Conversation_ApplicationId)}}var Fe=r(89),Ue=r(88),qe=r(34),He=r(60),We=r(14);const Ve={authHeader:"X-DLS-Secret",resourcePath:"",version:"v3"},Ke={authHeader:"X-CommandsAppId",resourcePath:"commands",version:"v1"};class Je extends qe.a{constructor(){super(...arguments),this.create=(e,t,r)=>{const n=e.parameters.getProperty(Q.a.Conversation_ApplicationId,""),i=e.parameters.getProperty(Q.a.Conversation_DialogType),o=e.parameters.getProperty(Q.a.SpeechServiceConnection_Region),s=e.parameters.getProperty(Q.a.SpeechServiceConnection_RecoLanguage,"en-US"),a={};a[We.a.LanguageParamName]=s,a[We.a.FormatParamName]=e.parameters.getProperty(Q.a.SpeechServiceResponse_OutputFormatOption,x.a[x.a.Simple]).toLowerCase();const{resourcePath:c,version:p,authHeader:u}=function(e){switch(e){case"custom_commands":return Ke;case"bot_framework":return Ve}throw new Error(`Invalid dialog type '${e}'`)}(i),h={};null!=t.token&&""!==t.token&&(h[t.headerName]=t.token),h[We.a.ConnectionIdHeader]=r,""!==n&&(h[u]=n);let v=e.parameters.getProperty(Q.a.SpeechServiceConnection_Endpoint,"");if(""===v){const e=o&&o.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com";v=""===n?`wss://${o}.convai.speech${e}/api/${p}`:`wss://${o}.convai.speech${e}/${c}/api/${p}`}return this.setCommonUrlParams(e,a,v),new Fe.a(v,a,h,new He.a,Ue.a.fromRecognizerConfig(e),r)}}}var Ge=r(213);class Qe extends oe{constructor(e,t){const r=e;f.a.throwIfNull(e,"dialogConfig"),super(t,r.properties,new Je),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=r.properties.clone();const n=this.buildAgentConfig();this.privReco.agentConfig.set(n)}connect(){this.privReco.connect()}disconnect(){this.privReco.disconnect()}get authorizationToken(){return this.properties.getProperty(Q.a.SpeechServiceAuthorization_Token)}set authorizationToken(e){f.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Q.a.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(Q.a.Conversation_Speech_Activity_Template)}set speechActivityTemplate(e){this.properties.setProperty(Q.a.Conversation_Speech_Activity_Template,e)}listenOnceAsync(e,t){if(this.isTurnComplete)try{f.a.throwIfDisposed(this.privIsDisposed),this.connect(),this.implRecognizerStop(),this.isTurnComplete=!1,this.privReco.recognize(o.c.Conversation,t=>{this.implRecognizerStop(),this.isTurnComplete=!0,e&&e(t)},e=>{this.implRecognizerStop(),this.isTurnComplete=!0,t&&t(e)}).on(e=>{},e=>{t&&t(e)})}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}sendActivityAsync(e){this.privReco.sendMessage(e)}close(){f.a.throwIfDisposed(this.privIsDisposed),this.dispose(!0)}dispose(e){this.privIsDisposed||e&&(this.implRecognizerStop(),this.privIsDisposed=!0,super.dispose(e))}createRecognizerConfig(e){return new o.d(e,this.privProperties)}createServiceRecognizer(e,t,r,n){const i=r;return new Ge.a(e,t,i,n,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(Q.a.Conversation_ApplicationId),conversationId:this.properties.getProperty(Q.a.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(Q.a.Conversation_From_Id,void 0),ttsAudioFormat:Y.a[this.properties.getProperty(Q.a.SpeechServiceConnection_SynthOutputFormat,void 0)]},version:.2}}}var $e,Ye=r(183);!function(e){e[e.UriQueryParameter=0]="UriQueryParameter"}($e||($e={}));var Xe=r(4);class Ze{constructor(e){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,this.init(e)}playAudioSample(e){this.ensureInitializedContext();const t=this.formatAudioData(e),r=new Float32Array(this.samples.length+t.length);r.set(this.samples,0),r.set(t,this.samples.length),this.samples=r}stopAudio(){null!==this.audioContext&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close(),this.audioContext=null)}init(e){this.audioFormat=e,this.samples=new Float32Array}ensureInitializedContext(){if(null===this.audioContext){this.createAudioContext();const e=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},e)}}createAudioContext(){this.audioContext=new AudioContext,this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(e){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(e),128);case 16:return this.formatArrayBuffer(new Int16Array(e),32768);case 32:return this.formatArrayBuffer(new Int32Array(e),2147483648);default:throw new Xe.b("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(e,t){const r=new Float32Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]/t;return r}updateAudioBuffer(){if(0===this.samples.length)return;const e=this.audioFormat.channels,t=this.audioContext.createBufferSource(),r=this.samples.length/e,n=this.audioContext.createBuffer(e,r,this.audioFormat.samplesPerSec);for(let t=0;t<e;t++){let r=t;const i=n.getChannelData(t);for(let t=0;t<this.samples.length;t++,r+=e)i[t]=this.samples[r]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),t.buffer=n,t.connect(this.gainNode),t.start(this.startTime),this.startTime+=n.duration,this.samples=new Float32Array}}class et{constructor(e,t){this.privId=e,this.privProfileType=t}get profileId(){return this.privId}get profileType(){return this.privProfileType}}class tt{constructor(e,t,r){this.privReason=e,this.privProperties=new $.a,this.privReason!==J.a.Canceled?(this.privDetails=JSON.parse(t),f.a.throwIfNullOrUndefined(t,"JSON"),"enrolling"===this.privDetails.enrollmentStatus.toLowerCase()&&(this.privReason=J.a.EnrollingVoiceProfile)):(this.privErrorDetails=r,this.privProperties.setProperty(G.b,Ee.a[Ee.a.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}}class rt extends we{constructor(e,t,r){super(e,t,r)}static fromResult(e){const t=A.a.Error;let r=Ee.a.NoError;return e.properties&&(r=Ee.a[e.properties.getProperty(G.b,Ee.a[Ee.a.NoError])]),new rt(t,e.errorDetails,r)}}class nt{constructor(e,t){this.privReason=e,this.privProperties=new $.a,e===J.a.Canceled&&(f.a.throwIfNullOrUndefined(t,"statusText"),this.privErrorDetails=t,this.privProperties.setProperty(G.b,Ee.a[Ee.a.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}}class it extends we{constructor(e,t,r){super(e,t,r)}static fromResult(e){const t=A.a.Error;let r=Ee.a.NoError;return e.properties&&(r=Ee.a[e.properties.getProperty(G.b,Ee.a[Ee.a.NoError])]),new it(t,e.errorDetails,r)}}var ot,st=r(184),at=r(215);class ct{constructor(e){const t=e;f.a.throwIfNull(t,"speechConfig"),this.privProperties=t.properties.clone(),this.implClientSetup()}get authorizationToken(){return this.properties.getProperty(Q.a.SpeechServiceAuthorization_Token)}set authorizationToken(e){f.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Q.a.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}createProfileAsync(e,t,r,n){this.privAdapter.createProfile(e,t).on(t=>{if(r){const n=t.json(),i=new et(n.profileId,e);r(i)}},e=>{n&&n(e)})}enrollProfileAsync(e,t,r,n){const i=t;f.a.throwIfNullOrUndefined(i,"audioConfig"),this.privAdapter.createEnrollment(e,i).on(e=>{r&&r(new tt(e.ok?J.a.EnrolledVoiceProfile:J.a.Canceled,e.data,e.statusText))},e=>{n&&n(e)})}deleteProfileAsync(e,t,r){this.privAdapter.deleteProfile(e).on(e=>{this.handleResultCallbacks(e,J.a.DeletedVoiceProfile,t)},e=>{r&&r(e)})}resetProfileAsync(e,t,r){this.privAdapter.resetProfile(e).on(e=>{this.handleResultCallbacks(e,J.a.ResetVoiceProfile,t)},e=>{r&&r(e)})}close(){}implClientSetup(){let e="undefined"!=typeof window?"Browser":"Node",t="unknown",r="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);const n=new st.a(new o.a(new o.b(e,t,r)),this.privProperties);this.privAdapter=new at.a(n)}handleResultCallbacks(e,t,r){if(r){r(new nt(e.ok?t:J.a.Canceled,e.statusText))}}}class pt{constructor(e){if(this.privVoiceProfiles=[],f.a.throwIfNullOrUndefined(e,"VoiceProfiles"),0===e.length)throw new Error("Empty Voice Profiles array");e.forEach(e=>{if(e.profileType!==le.a.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+e.profileId);this.privVoiceProfiles.push(e)})}static fromProfiles(e){return new pt(e)}get voiceProfileIds(){return this.privVoiceProfiles.map(e=>e.profileId).join(",")}}!function(e){e[e.Verify=0]="Verify",e[e.Identify=1]="Identify"}(ot||(ot={}));class ut{constructor(e,t,r,n=J.a.RecognizedSpeaker){if(this.privProperties=new $.a,this.privReason=n,this.privReason!==J.a.Canceled)if(e===ot.Identify){const e=JSON.parse(t);f.a.throwIfNullOrUndefined(e,"JSON"),this.privProfileId=e.identifiedProfile.profileId,this.privScore=e.identifiedProfile.score}else{const e=JSON.parse(t);f.a.throwIfNullOrUndefined(e,"JSON"),this.privScore=e.score,"accept"!==e.recognitionResult.toLowerCase()&&(this.privReason=J.a.NoMatch),void 0!==r&&""!==r&&(this.privProfileId=r)}else{const e=JSON.parse(t);f.a.throwIfNullOrUndefined(e,"JSON"),this.privErrorDetails=e.statusText,this.privProperties.setProperty(G.b,Ee.a[Ee.a.ServiceError])}this.privProperties.setProperty(Q.a.SpeechServiceResponse_JsonResult,t)}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}}class ht extends we{constructor(e,t,r){super(e,t,r)}static fromResult(e){const t=A.a.Error;let r=Ee.a.NoError;return e.properties&&(r=Ee.a[e.properties.getProperty(G.b,Ee.a[Ee.a.NoError])]),new ht(t,e.errorDetails,r)}}class vt{constructor(e){if(f.a.throwIfNullOrUndefined(e,"VoiceProfile"),e.profileType===le.a.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=e}static fromProfile(e){return new vt(e)}get voiceProfile(){return this.privVoiceProfile}}class lt{constructor(e,t){const r=e;f.a.throwIfNull(r,"speechConfig"),this.privAudioConfigImpl=t,f.a.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privProperties=r.properties.clone(),this.implSRSetup()}get authorizationToken(){return this.properties.getProperty(Q.a.SpeechServiceAuthorization_Token)}set authorizationToken(e){f.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Q.a.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e,t,r){if(e instanceof pt)this.privAdapter.identifySpeaker(e,this.privAudioConfigImpl).continueWith(e=>{this.handleResultCallbacks(e,ot.Identify,void 0,t,r)});else{if(!(e instanceof vt))throw new Error("SpeakerRecognizer.recognizeOnce: Unexpected model type");this.privAdapter.verifySpeaker(e,this.privAudioConfigImpl).continueWith(n=>{this.handleResultCallbacks(n,ot.Verify,e.voiceProfile.profileId,t,r)})}}close(){}implSRSetup(){let e="undefined"!=typeof window?"Browser":"Node",t="unknown",r="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);const n=new st.a(new o.a(new o.b(e,t,r)),this.privProperties);this.privAdapter=new at.a(n)}handleResultCallbacks(e,t,r,n,i){try{e.isError?i&&i(e.error):e.isCompleted&&n&&n(new ut(t,e.result.data,r,e.result.ok?J.a.RecognizedSpeaker:J.a.Canceled))}catch(e){i&&i(e)}}}class dt{constructor(){this.privProperties=new $.a}static fromOpenRange(){const e=new dt;return e.properties.setProperty(Q.a.SpeechServiceConnection_AutoDetectSourceLanguages,G.a),e}static fromLanguages(e){f.a.throwIfArrayEmptyOrWhitespace(e,"languages");const t=new dt;return t.properties.setProperty(Q.a.SpeechServiceConnection_AutoDetectSourceLanguages,e.join()),t}static fromSourceLanguageConfigs(e){if(e.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const t=new dt,r=[];return e.forEach(e=>{if(r.push(e.language),void 0!==e.endpointId&&""!==e.endpointId){const r=e.language+Q.a.SpeechServiceConnection_EndpointId.toString();t.properties.setProperty(r,e.endpointId)}}),t.properties.setProperty(Q.a.SpeechServiceConnection_AutoDetectSourceLanguages,r.join()),t}get properties(){return this.privProperties}}class ft{constructor(e,t){f.a.throwIfNullOrUndefined(e,"language"),f.a.throwIfNullOrUndefined(t,"languageDetectionConfidence"),this.privLanguage=e,this.privLanguageDetectionConfidence=t}static fromResult(e){return new ft(e.language,e.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}}class gt{constructor(e,t){f.a.throwIfNullOrUndefined(e,"language"),this.privLanguage=e,this.privEndpointId=t}static fromLanguage(e,t){return new gt(e,t)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}}var yt=r(87);class mt extends yt.a{static get host(){return mt.privHost}static get apiVersion(){return mt.privApiVersion}static get clientAppId(){return mt.privClientAppId}static get defaultLanguageCode(){return mt.privDefaultLanguageCode}static get restPath(){return mt.privRestPath}static get webSocketPath(){return mt.privWebSocketPath}static get speechHost(){return mt.privSpeechHost}static get speechPath(){return mt.privSpeechPath}}mt.privHost="dev.microsofttranslator.com",mt.privRestPath="/capito/room",mt.privApiVersion="2.0",mt.privDefaultLanguageCode="en-US",mt.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",mt.privWebSocketPath="/capito/translate",mt.privSpeechHost="{region}.s2s.speech.microsoft.com",mt.privSpeechPath="/speech/translation/cognitiveservices/v1";class St{constructor(e=[],t){this.participants=e,this.meId=t}addOrUpdateParticipant(e){if(void 0===e)return;const t=this.getParticipantIndex(e.id);return t>-1?this.participants.splice(t,1,e):this.participants.push(e),this.getParticipant(e.id)}getParticipantIndex(e){return this.participants.findIndex(t=>t.id===e)}getParticipant(e){return this.participants.find(t=>t.id===e)}deleteParticipant(e){this.participants=this.participants.filter(t=>t.id!==e)}get host(){return this.participants.find(e=>!0===e.isHost)}get me(){return this.getParticipant(this.meId)}}const Ct="final",bt="instant_message",Pt="partial",Rt="participant_command",wt="ChangeNickname",It="EjectParticipant",Et="SetLockState",Ot="SetMute",Tt="SetMuteAll",At="SetProfanityFiltering",Dt="SetTranslateToLanguages",_t="SetUseTTS";function Mt(e,t={}){const r=function(e={}){return Object.keys(e).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t])).join("&")}(t);return r?e+(-1===e.indexOf("?")?"?":"&")+r:e}function xt(e,t=null){return{data:t||e.statusText,headers:e.getAllResponseHeaders(),json:()=>JSON.parse(t||'"'+e.statusText+'"'),ok:!1,status:e.status,statusText:e.statusText}}function kt(e,t,r={},n=null,i={},o){const s=yt.a.requestOptions,a=i.ignoreCache||s.ignoreCache,c=i.headers||s.headers,p=i.timeout||s.timeout,u=new XMLHttpRequest;u.open(e,Mt(t,r),!0),c&&Object.keys(c).forEach(e=>u.setRequestHeader(e,c[e])),a&&u.setRequestHeader("Cache-Control","no-cache"),u.timeout=p,u.onload=e=>{o(function(e){return{data:e.responseText,headers:e.getAllResponseHeaders(),json:()=>JSON.parse(e.responseText),ok:e.status>=200&&e.status<300,status:e.status,statusText:e.statusText}}(u))},u.onerror=e=>{o(xt(u,"Failed to make request."))},u.ontimeout=e=>{o(xt(u,"Request took longer than expected."))},"post"===e&&n?(u.setRequestHeader("Content-Type","application/json"),u.send(JSON.stringify(n))):u.send()}class jt{constructor(){this.privRequestParams=mt.configParams,this.privErrors=mt.restErrors,this.privHost=mt.host,this.privApiVersion=mt.apiVersion,this.privRestPath=mt.restPath}createOrJoin(e,t,r,n){try{f.a.throwIfNullOrUndefined(e,"args");const i=e.getProperty(Q.a.SpeechServiceConnection_RecoLanguage,mt.defaultLanguageCode),o=e.getProperty(Q.a.ConversationTranslator_Name),s=e.getProperty(Q.a.ConversationTranslator_Host,this.privHost),a=e.getProperty(Q.a.ConversationTranslator_CorrelationId),c=e.getProperty(Q.a.SpeechServiceConnection_Key),p=e.getProperty(Q.a.SpeechServiceConnection_Region),u=e.getProperty(Q.a.SpeechServiceAuthorization_Token);f.a.throwIfNullOrWhitespace(i,"languageCode"),f.a.throwIfNullOrWhitespace(o,"nickname"),f.a.throwIfNullOrWhitespace(s,"endpointHost");const h={};h[this.privRequestParams.apiVersion]=this.privApiVersion,h[this.privRequestParams.languageCode]=i,h[this.privRequestParams.nickname]=o;const v={};a&&(v[this.privRequestParams.correlationId]=a),v[this.privRequestParams.clientAppId]=mt.clientAppId,void 0!==t?h[this.privRequestParams.roomId]=t:(f.a.throwIfNullOrUndefined(p,this.privErrors.authInvalidSubscriptionRegion),v[this.privRequestParams.subscriptionRegion]=p,c?v[this.privRequestParams.subscriptionKey]=c:u?v[this.privRequestParams.authorization]="Bearer "+u:f.a.throwIfNullOrUndefined(c,this.privErrors.authInvalidSubscriptionKey));const l={};l.headers=v;kt("post",`https://${s}${this.privRestPath}`,h,null,l,e=>{const t=function(e,t){let r="";try{const n=t.trim().split(/[\r\n]+/),i={};n.forEach(e=>{const t=e.split(": "),r=t.shift().toLowerCase(),n=t.join(": ");i[r]=n}),r=i[e.toLowerCase()]}catch(e){}return r}(this.privRequestParams.requestId,e.headers);if(!e.ok){if(n){let r,i=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",e.status.toString());try{r=JSON.parse(e.data),i+=` [${r.error.code}: ${r.error.message}]`}catch(t){i+=` [${e.data}]`}t&&(i+=" "+t),n(i)}return}const i=JSON.parse(e.data);if(i&&(i.requestId=t),r){try{r(i)}catch(e){n&&n(e)}r=void 0}})}catch(e){if(n)if(e instanceof Error){const t=e;n(t.name+": "+t.message)}else n(e)}}leave(e,t,r,n){try{f.a.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","config")),f.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","token"));const i=e.getProperty(Q.a.ConversationTranslator_Host,this.privHost),o=e.getProperty(Q.a.ConversationTranslator_CorrelationId),s={};s[this.privRequestParams.apiVersion]=this.privApiVersion,s[this.privRequestParams.sessionToken]=t;const a={};o&&(a[this.privRequestParams.correlationId]=o);const c={};c.headers=a;kt("delete",`https://${i}${this.privRestPath}`,s,null,c,e=>{if(e.ok,r){try{r()}catch(e){n&&n(e)}r=void 0}})}catch(e){if(n)if(e instanceof Error){const t=e;n(t.name+": "+t.message)}else n(e)}}}var zt=r(225);class Nt extends De.a{constructor(e,t,r,n){super(e,t,r,n);const i=JSON.parse(this.textBody);void 0!==i.type&&(this.privConversationMessageType=i.type)}get conversationMessageType(){return this.privConversationMessageType}}class Lt{constructor(){this.toConnectionMessage=e=>{const t=new s.a;try{if(e.messageType===De.b.Text){const r=new Nt(e.messageType,e.textContent,{},e.id);t.resolve(r)}else e.messageType===De.b.Binary&&t.resolve(new Nt(e.messageType,e.binaryContent,void 0,e.id))}catch(e){t.reject("Error formatting the message. Error: "+e)}return t.promise()},this.fromConnectionMessage=e=>{const t=new s.a;try{if(e.messageType===De.b.Text){const r=""+(e.textBody?e.textBody:"");t.resolve(new zt.a(De.b.Text,r,e.id))}}catch(e){t.reject("Error formatting the message. "+e)}return t.promise()}}}class Bt extends qe.a{create(e,t,r){const n=e.parameters.getProperty(Q.a.ConversationTranslator_Host,mt.host),i=e.parameters.getProperty(Q.a.ConversationTranslator_CorrelationId,Object(u.a)()),o=`wss://${n}${mt.webSocketPath}`,s=e.parameters.getProperty(Q.a.ConversationTranslator_Token,void 0);f.a.throwIfNullOrUndefined(s,"token");const a={};return a[mt.configParams.apiVersion]=mt.apiVersion,a[mt.configParams.token]=s,a[mt.configParams.correlationId]=i,new Fe.a(o,a,{},new Lt,Ue.a.fromRecognizerConfig(e),r)}}var Ft,Ut,qt=r(224);class Ht extends _.a{constructor(e,t){super(t),this.privExpirationTime=e}get expirationTime(){return this.privExpirationTime}}class Wt extends V.a{constructor(e,t,r,n,i,o,s,a,c,p,u){super(t,n,i,o,s,a,c,p,u),this.privId=e,this.privOrigLang=r}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}}class Vt extends M.a{constructor(e,t,r,n,i){super(n,i),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}class Kt{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.onPreConnectionStart=(e,t)=>{this.privSessionId=t},this.onAuthCompleted=(e,t)=>{e&&this.onComplete()},this.onConnectionEstablishCompleted=(e,t)=>{200!==e&&403===e&&this.onComplete()},this.onServiceTurnEndResponse=e=>{e?this.privRequestId=Object(u.b)():this.onComplete()},this.dispose=e=>{if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)e.detach()}},this.onComplete=()=>{},this.privSessionId=e,this.privRequestId=Object(u.b)(),this.privRequestCompletionDeferral=new s.a}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise()}}class Jt extends _.a{constructor(e,t){super(t),this.privIsMuted=e}get isMuted(){return this.privIsMuted}}class Gt extends _.a{constructor(e,t){super(t),this.privIsLocked=e}get isMuted(){return this.privIsLocked}}class Qt extends _.a{constructor(e,t){super(t),this.privParticipant=e}get participant(){return this.privParticipant}}class $t extends _.a{constructor(e,t,r,n){super(n),this.privKey=t,this.privValue=r,this.privParticipantId=e}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}class Yt extends _.a{constructor(e,t,r,n,i,o,s,a,c){super(c),this.privRoomId=e,this.privSessionToken=t,this.privTranslateTo=r,this.privProfanityFilter=n,this.privRoomProfanityFilter=i,this.privIsRoomLocked=o,this.privIsRoomLocked=s,this.privParticipants=a}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}class Xt{constructor(e,t,r){this.privPayload=t,this.privCommand=e,this.privSessionId=r}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}class Zt{constructor(e){this.privCommandResponse=JSON.parse(e)}static fromJSON(e){return new Zt(e)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}}class er{constructor(e){this.privParticipantsPayloadResponse=JSON.parse(e)}static fromJSON(e){return new er(e)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}}class tr{constructor(e){this.privParticipantPayloadResponse=JSON.parse(e)}static fromJSON(e){return new tr(e)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}}class rr{constructor(e){this.privSpeechResponse=JSON.parse(e)}static fromJSON(e){return new rr(e)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return"final"===this.privSpeechResponse.type}}class nr{constructor(e){this.privTextResponse=JSON.parse(e)}static fromJSON(e){return new nr(e)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}}class ir extends re.a{constructor(e,t,r,n,i){super(e,t,r,n,i),this.privLastPartialUtteranceId="",this.sendMessageAsync=e=>{const t=new s.e;return this.fetchConversationConnection().continueWith(r=>{try{r.isError?t.reject(r.error):r.result.send(new Nt(De.b.Text,e)).continueWith(e=>{try{e.isError?t.reject(e.error):t.resolve(e.result)}catch(e){t.reject("Unhandled inner error: "+e)}})}catch(e){t.reject("Unhandled error: "+e)}}),new s.b(t)},this.noOp=()=>{},this.receiveConversationMessageOverride=(e,t)=>{const r=new s.a;return this.fetchConversationConnection().on(e=>e.read().onSuccessContinueWithPromise(e=>{const t=this.isDisposed(),n=!this.isDisposed()&&this.terminateMessageLoop,i=this.privConversationRequestSession.sessionId;let o=!1;if(t||n)return r.resolve(void 0),s.c.fromResult(void 0);if(!e)return this.receiveConversationMessageOverride();try{switch(e.conversationMessageType.toLowerCase()){case"info":case"participant_command":case"command":const t=Zt.fromJSON(e.textBody);switch(t.command.toLowerCase()){case"participantlist":const r=er.fromJSON(e.textBody),n=r.participants.map(e=>({avatar:e.avatar,displayName:e.nickname,id:e.participantId,isHost:e.ishost,isMuted:e.ismuted,isUsingTts:e.usetts,preferredLanguage:e.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new Yt(r.roomid,r.token,r.translateTo,r.profanityFilter,r.roomProfanityFilter,r.roomLocked,r.muteAll,n,i));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new $t(t.participantId,Dt,t.value,i));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new $t(t.participantId,At,t.value,i));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new $t(t.participantId,Ot,t.value,i));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new Jt(t.value,i));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new Ht(t.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new $t(t.participantId,_t,t.value,i));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new Gt(t.value,i));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new $t(t.participantId,wt,t.nickname,i));break;case"joinsession":const o=tr.fromJSON(e.textBody),s={avatar:o.avatar,displayName:o.nickname,id:o.participantId,isHost:o.ishost,isMuted:o.ismuted,isUsingTts:o.usetts,preferredLanguage:o.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new Qt(s,i));break;case"leavesession":const a={id:t.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new Qt(a,i));break;case"disconnectsession":t.participantId}break;case"partial":case"final":const r=rr.fromJSON(e.textBody),n=new Wt(r.participantId,this.getTranslations(r.translations),r.language,void 0,void 0,r.recognition,void 0,void 0,e.textBody,void 0);r.isFinal?((void 0!==n.text&&n.text.length>0||r.id===this.privLastPartialUtteranceId)&&(o=!0),o&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Xt(Ct,n,i))):void 0!==n.text&&(this.privLastPartialUtteranceId=r.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Xt(Pt,n,i)));break;case"translated_message":const s=nr.fromJSON(e.textBody),a=new Wt(s.participantId,this.getTranslations(s.translations),s.language,void 0,void 0,s.originalText,void 0,void 0,void 0,e.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Xt(bt,a,i))}}catch(e){}return this.receiveConversationMessageOverride()}),e=>{this.terminateMessageLoop=!0}),r.promise()},this.fetchConversationConnection=()=>this.configConnection(),this.privConversationServiceConnector=i,this.privConversationAuthentication=e,this.receiveMessageOverride=this.receiveConversationMessageOverride,this.recognizeOverride=this.noOp,this.connectImplOverride=this.conversationConnectImpl,this.configConnectionOverride=this.configConnection,this.fetchConnectionOverride=this.fetchConversationConnection,this.disconnectOverride=this.privDisconnect,this.privConversationRequestSession=new Kt(Object(u.b)()),this.privConversationConnectionFactory=t,this.privConversationIsDisposed=!1}isDisposed(){return this.privConversationIsDisposed}dispose(e){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise&&this.privConnectionConfigPromise.onSuccessContinueWith(t=>{t.dispose(e)})}sendMessage(e){this.fetchConversationConnection().onSuccessContinueWith(t=>{t.send(new Nt(De.b.Text,e))})}privDisconnect(){this.terminateMessageLoop||(this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,A.a.Error,Ee.a.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.privConversationConnectionPromise.result().isCompleted?this.privConversationConnectionPromise.result().isError||(this.privConversationConnectionPromise.result().result.dispose(),this.privConversationConnectionPromise=null):this.privConversationConnectionPromise.onSuccessContinueWith(e=>{e.dispose()}))}processTypeSpecificMessages(e,t,r){return!0}cancelRecognition(e,t,r,n,i){this.terminateMessageLoop=!0;const o=new Vt(r,i,n,void 0,e);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,o)}catch(e){}}conversationConnectImpl(e=!1){if(this.privConversationConnectionPromise)return this.privConversationConnectionPromise.result().isCompleted&&(this.privConversationConnectionPromise.result().isError||this.privConversationConnectionPromise.result().result.state()===qt.a.Disconnected)?(this.privConnectionId=null,this.privConversationConnectionPromise=null,this.terminateMessageLoop=!0,this.conversationConnectImpl()):this.privConversationConnectionPromise;this.privConversationAuthFetchEventId=Object(u.b)(),void 0===this.privConnectionId&&(this.privConnectionId=Object(u.b)()),this.privConversationRequestSession.onPreConnectionStart(this.privConversationAuthFetchEventId,this.privConnectionId);const t=e?this.privConversationAuthentication.fetchOnExpiry(this.privConversationAuthFetchEventId):this.privConversationAuthentication.fetch(this.privConversationAuthFetchEventId);return this.privConversationConnectionPromise=t.continueWithPromise(t=>{if(t.isError)throw this.privConversationRequestSession.onAuthCompleted(!0,t.error),new Error(t.error);this.privConversationRequestSession.onAuthCompleted(!1);const r=this.privConversationConnectionFactory.create(this.privRecognizerConfig,t.result,this.privConnectionId);return r.events.attach(e=>{this.connectionEvents.onEvent(e)}),r.open().onSuccessContinueWithPromise(t=>{if(200===t.statusCode){this.privConversationRequestSession.onPreConnectionStart(this.privConversationAuthFetchEventId,this.privConnectionId),this.privConversationRequestSession.onConnectionEstablishCompleted(t.statusCode);const e=new _.a(this.privConversationRequestSession.sessionId);return this.privConversationServiceConnector.connectionOpened&&this.privConversationServiceConnector.connectionOpened(this.privConversationServiceConnector,e),s.c.fromResult(r)}return 403!==t.statusCode||e?(this.privConversationRequestSession.onConnectionEstablishCompleted(t.statusCode,t.reason),s.c.fromError(`Unable to contact server. StatusCode: ${t.statusCode}, ${this.privRecognizerConfig.parameters.getProperty(Q.a.SpeechServiceConnection_Endpoint)} Reason: ${t.reason}`)):this.conversationConnectImpl(!0)})}),this.privConnectionLoop=this.startMessageLoop(),this.privConversationConnectionPromise}startMessageLoop(){this.terminateMessageLoop=!1;return this.receiveConversationMessageOverride().on(e=>!0,e=>{this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",A.a.Error,Ee.a.RuntimeError,e)})}configConnection(){return this.privConnectionConfigPromise?this.privConnectionConfigPromise.result().isCompleted&&(this.privConnectionConfigPromise.result().isError||this.privConnectionConfigPromise.result().result.state()===qt.a.Disconnected)?(this.privConnectionConfigPromise=null,this.configConnection()):this.privConnectionConfigPromise:this.terminateMessageLoop?s.c.fromResult(void 0):(this.privConnectionConfigPromise=this.conversationConnectImpl().onSuccessContinueWith(e=>e),this.privConnectionConfigPromise)}getTranslations(e){let t;if(void 0!==e){t=new me.a;for(const r of e)t.set(r.lang,r.translation)}return t}}class or extends oe{constructor(e,t){const r=e;f.a.throwIfNull(r,"speechConfig"),super(t,r.properties,new Bt),this.privIsDisposed=!1,this.privProperties=r.properties.clone()}set conversation(e){this.privRoom=e}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(e,t,r){try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfNullOrWhitespace(e,"token"),this.privReco.conversationTranslatorToken=e,this.privReco.connectAsync(t,r)}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e)}}disconnect(e,t){try{f.a.throwIfDisposed(this.privIsDisposed),this.privRoom=void 0,this.privReco.disconnectAsync(e,t)}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}sendMessageRequest(e,t,r){try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),f.a.throwIfNullOrWhitespace(e,"message");const n={participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:bt};this.sendMessage(JSON.stringify(n),t,r)}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e);this.dispose(!0)}}sendLockRequest(e,t,r){try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),f.a.throwIfNullOrUndefined(e,"isLocked");const n={command:Et,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:Rt,value:e};this.sendMessage(JSON.stringify(n),t,r)}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e);this.dispose(!0)}}sendMuteAllRequest(e,t,r){try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),f.a.throwIfNullOrUndefined(e,"isMuted");const n={command:Tt,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:Rt,value:e};this.sendMessage(JSON.stringify(n),t,r)}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e);this.dispose(!0)}}sendMuteRequest(e,t,r,n){try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.a.throwIfNullOrWhitespace(e,"participantId"),f.a.throwIfNullOrUndefined(t,"isMuted");const i={command:Ot,participantId:e,roomid:this.privRoom.roomId,type:Rt,value:t};this.sendMessage(JSON.stringify(i),r,n)}catch(e){if(n)if(e instanceof Error){const t=e;n(t.name+": "+t.message)}else n(e);this.dispose(!0)}}sendEjectRequest(e,t,r){try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.a.throwIfNullOrWhitespace(e,"participantId");const n={command:It,participantId:e,roomid:this.privRoom.roomId,type:Rt};if(this.sendMessage(JSON.stringify(n),t,r),t)try{t()}catch(e){r&&r(e)}}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e);this.dispose(!0)}}sendChangeNicknameRequest(e,t,r){try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.a.throwIfNullOrWhitespace(e,"nickname");const n={command:wt,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:Rt,value:e};this.sendMessage(JSON.stringify(n),t,r)}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e);this.dispose(!0)}}close(){f.a.throwIfDisposed(this.privIsDisposed),this.dispose(!0)}dispose(e){this.privIsDisposed||e&&(this.privIsDisposed=!0,super.dispose(e))}createRecognizerConfig(e){return new o.d(e,this.privProperties)}createServiceRecognizer(e,t,r,n){return new ir(e,t,r,n,this)}sendMessage(e,t,r){!function(e,t,r){e?e.continueWith(e=>{try{e.isError?r&&r(e.error):t&&t()}catch(t){r&&r(`'Unhandled error on promise callback: ${t}. InnerError: ${e.error}'`)}}):r&&r("Null promise")}(this.privReco.sendMessageAsync(e),t,r)}}class sr extends _.a{constructor(e,t,r){super(r),this.privReason=e,this.privParticipant=t}get reason(){return this.privReason}get participants(){return this.privParticipant}}!function(e){e[e.JoinedConversation=0]="JoinedConversation",e[e.LeftConversation=1]="LeftConversation",e[e.Updated=2]="Updated"}(Ft||(Ft={}));class ar extends M.a{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}}class cr{constructor(e){this.privUserId=e}get userId(){return this.privUserId}}class pr{constructor(e,t,r,n,i,o,s){this.privId=e,this.privAvatar=t,this.privDisplayName=r,this.privIsHost=n,this.privIsMuted=i,this.privIsUsingTts=o,this.privPreferredLanguage=s,this.privPoperties=new $.a}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get properties(){return this.privPoperties}}class ur{constructor(){}static createConversationAsync(e,t,r){f.a.throwIfNullOrUndefined(e,mt.restErrors.invalidArgs.replace("{arg}","config")),f.a.throwIfNullOrUndefined(e.region,mt.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),e.subscriptionKey||e.getProperty(Q.a[Q.a.SpeechServiceAuthorization_Token])||f.a.throwIfNullOrUndefined(e.subscriptionKey,mt.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const n=new hr(e);return n.createConversationAsync(()=>{t&&t()},e=>{r&&r(e)}),n}}class hr extends ur{constructor(e){super(),this.privIsDisposed=!1,this.privIsConnected=!1,this.privErrors=mt.restErrors,this.onConnected=e=>{this.privIsConnected=!0;try{this.privConversationTranslator.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,e)}catch(e){}},this.onDisconnected=e=>{this.close(!1);try{this.privConversationTranslator.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,e)}catch(e){}},this.onCanceled=(e,t)=>{this.close(!1);try{this.privConversationTranslator.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,t)}catch(t){}},this.onParticipantUpdateCommandReceived=(e,t)=>{var r,n;try{const e=this.privParticipants.getParticipant(t.id);if(void 0!==e){switch(t.key){case wt:e.displayName=t.value;break;case _t:e.useTts=t.value;break;case At:e.profanity=t.value;break;case Ot:e.isMuted=t.value;break;case Dt:e.translateToLanguages=t.value}this.privParticipants.addOrUpdateParticipant(e),(null===(r=this.privConversationTranslator)||void 0===r?void 0:r.participantsChanged)&&(null===(n=this.privConversationTranslator)||void 0===n||n.participantsChanged(this.privConversationTranslator,new sr(Ft.Updated,[this.toParticipant(e)],t.sessionId)))}}catch(t){}},this.onLockRoomCommandReceived=(e,t)=>{},this.onMuteAllCommandReceived=(e,t)=>{var r,n;try{this.privParticipants.participants.forEach(e=>e.isMuted=!e.isHost&&t.isMuted),(null===(r=this.privConversationTranslator)||void 0===r?void 0:r.participantsChanged)&&(null===(n=this.privConversationTranslator)||void 0===n||n.participantsChanged(this.privConversationTranslator,new sr(Ft.Updated,this.toParticipants(!1),t.sessionId)))}catch(t){}},this.onParticipantJoinCommandReceived=(e,t)=>{var r,n;try{const e=this.privParticipants.addOrUpdateParticipant(t.participant);void 0!==e&&(null===(r=this.privConversationTranslator)||void 0===r?void 0:r.participantsChanged)&&(null===(n=this.privConversationTranslator)||void 0===n||n.participantsChanged(this.privConversationTranslator,new sr(Ft.JoinedConversation,[this.toParticipant(e)],t.sessionId)))}catch(t){}},this.onParticipantLeaveCommandReceived=(e,t)=>{var r,n;try{const e=this.privParticipants.getParticipant(t.participant.id);void 0!==e&&(this.privParticipants.deleteParticipant(t.participant.id),(null===(r=this.privConversationTranslator)||void 0===r?void 0:r.participantsChanged)&&(null===(n=this.privConversationTranslator)||void 0===n||n.participantsChanged(this.privConversationTranslator,new sr(Ft.LeftConversation,[this.toParticipant(e)],t.sessionId))))}catch(t){}},this.onTranslationReceived=(e,t)=>{var r,n,i,o,s,a;try{switch(t.command){case Ct:(null===(r=this.privConversationTranslator)||void 0===r?void 0:r.transcribed)&&(null===(n=this.privConversationTranslator)||void 0===n||n.transcribed(this.privConversationTranslator,new ar(t.payload,void 0,t.sessionId)));break;case Pt:(null===(i=this.privConversationTranslator)||void 0===i?void 0:i.transcribing)&&(null===(o=this.privConversationTranslator)||void 0===o||o.transcribing(this.privConversationTranslator,new ar(t.payload,void 0,t.sessionId)));break;case bt:(null===(s=this.privConversationTranslator)||void 0===s?void 0:s.textMessageReceived)&&(null===(a=this.privConversationTranslator)||void 0===a||a.textMessageReceived(this.privConversationTranslator,new ar(t.payload,void 0,t.sessionId)))}}catch(t){}},this.onParticipantsListReceived=(e,t)=>{var r,n;try{if(void 0!==t.sessionToken&&null!==t.sessionToken&&(this.privRoom.token=t.sessionToken),this.privParticipants.participants=[...t.participants],void 0!==this.privParticipants.me&&(this.privIsReady=!0),(null===(r=this.privConversationTranslator)||void 0===r?void 0:r.participantsChanged)&&(null===(n=this.privConversationTranslator)||void 0===n||n.participantsChanged(this.privConversationTranslator,new sr(Ft.JoinedConversation,this.toParticipants(!0),t.sessionId))),this.me.isHost){const e=this.privConversationTranslator.properties.getProperty(Q.a.ConversationTranslator_Name);void 0!==e&&e.length>0&&e!==this.me.displayName&&this.changeNicknameAsync(e)}}catch(t){}},this.onConversationExpiration=(e,t)=>{var r,n;try{(null===(r=this.privConversationTranslator)||void 0===r?void 0:r.conversationExpiration)&&(null===(n=this.privConversationTranslator)||void 0===n||n.conversationExpiration(this.privConversationTranslator,t))}catch(t){}},this.privProperties=new $.a,this.privManager=new jt;e.getProperty(Q.a[Q.a.SpeechServiceConnection_RecoLanguage])||e.setProperty(Q.a[Q.a.SpeechServiceConnection_RecoLanguage],mt.defaultLanguageCode),this.privLanguage=e.getProperty(Q.a[Q.a.SpeechServiceConnection_RecoLanguage]),0===e.targetLanguages.length&&e.addTargetLanguage(this.privLanguage);e.getProperty(Q.a[Q.a.SpeechServiceResponse_ProfanityOption])||e.setProfanity(F.Masked);let t=e.getProperty(Q.a[Q.a.ConversationTranslator_Name]);(null==t||t.length<=1||t.length>50)&&(t="Host"),e.setProperty(Q.a[Q.a.ConversationTranslator_Name],t),this.privConfig=e;const r=e;f.a.throwIfNull(r,"speechConfig"),this.privProperties=r.properties.clone(),this.privIsConnected=!1,this.privParticipants=new St,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}set conversationTranslator(e){this.privConversationTranslator=e}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get authorizationToken(){return this.privToken}set authorizationToken(e){f.a.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:""}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var e,t;return!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)&&(null===(t=this.privParticipants.me)||void 0===t?void 0:t.isMuted)}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}createConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,r=>{r||this.handleError(new Error(this.privErrors.permissionDeniedConnect),t),this.privRoom=r,this.handleCallback(e,t)},e=>{this.handleError(e,t)})}catch(e){this.handleError(e,t)}}startConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),f.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=new or(this.privConfig),this.privConversationRecognizer.conversation=this.privRoom,this.privConversationRecognizerConnection=ke.fromRecognizer(this.privConversationRecognizer),this.privConversationRecognizerConnection.connected=this.onConnected,this.privConversationRecognizerConnection.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(e,t)},e=>{this.handleError(e,t)})}catch(e){this.handleError(e,t)}}joinConversationAsync(e,t,r,n,i){try{f.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),f.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),f.a.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,e=>{f.a.throwIfNullOrUndefined(e,this.privErrors.permissionDeniedConnect),this.privRoom=e,this.privConfig.authorizationToken=e.cognitiveSpeechAuthToken,n&&n(e.cognitiveSpeechAuthToken)},e=>{this.handleError(e,i)})}catch(e){this.handleError(e,i)}}deleteConversationAsync(e,t){try{f.a.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),f.a.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),this.privManager.leave(this.privProperties,this.privRoom.token,()=>{this.handleCallback(e,t)},e=>{this.handleError(e,t)}),this.dispose()}catch(e){this.handleError(e,t)}}endConversationAsync(e,t){try{this.close(!0),this.handleCallback(e,t)}catch(e){this.handleError(e,t)}}lockConversationAsync(e,t){var r;try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),null===(r=this.privConversationRecognizer)||void 0===r||r.sendLockRequest(!0,()=>{this.handleCallback(e,t)},e=>{this.handleError(e,t)})}catch(e){this.handleError(e,t)}}muteAllParticipantsAsync(e,t){var r;try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.a.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),f.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),null===(r=this.privConversationRecognizer)||void 0===r||r.sendMuteAllRequest(!0,()=>{this.handleCallback(e,t)},e=>{this.handleError(e,t)})}catch(e){this.handleError(e,t)}}muteParticipantAsync(e,t,r){var n;try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),f.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r);-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),null===(n=this.privConversationRecognizer)||void 0===n||n.sendMuteRequest(e,!0,()=>{this.handleCallback(t,r)},e=>{this.handleError(e,r)})}catch(e){this.handleError(e,r)}}removeParticipantAsync(e,t,r){var n;try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),r);let i="";if("string"==typeof e)i=e;else if(e.hasOwnProperty("id")){i=e.id}else if(e.hasOwnProperty("userId")){i=e.userId}f.a.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","userId"));-1===this.participants.findIndex(e=>e.id===i)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),null===(n=this.privConversationRecognizer)||void 0===n||n.sendEjectRequest(i,()=>{this.handleCallback(t,r)},e=>{this.handleError(e,r)})}catch(e){this.handleError(e,r)}}unlockConversationAsync(e,t){var r;try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),null===(r=this.privConversationRecognizer)||void 0===r||r.sendLockRequest(!1,()=>{this.handleCallback(e,t)},e=>{this.handleError(e,t)})}catch(e){this.handleError(e,t)}}unmuteAllParticipantsAsync(e,t){var r;try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),null===(r=this.privConversationRecognizer)||void 0===r||r.sendMuteAllRequest(!1,()=>{this.handleCallback(e,t)},e=>{this.handleError(e,t)})}catch(e){this.handleError(e,t)}}unmuteParticipantAsync(e,t,r){var n;try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),f.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r);-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),null===(n=this.privConversationRecognizer)||void 0===n||n.sendMuteRequest(e,!1,()=>{this.handleCallback(t,r)},e=>{this.handleError(e,r)})}catch(e){this.handleError(e,r)}}sendTextMessageAsync(e,t,r){var n;try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),f.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),r),null===(n=this.privConversationRecognizer)||void 0===n||n.sendMessageRequest(e,()=>{this.handleCallback(t,r)},e=>{this.handleError(e,r)})}catch(e){this.handleError(e,r)}}changeNicknameAsync(e,t,r){var n;try{f.a.throwIfDisposed(this.privIsDisposed),f.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),f.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),null===(n=this.privConversationRecognizer)||void 0===n||n.sendChangeNicknameRequest(e,()=>{this.handleCallback(t,r)},e=>{this.handleError(e,r)})}catch(e){this.handleError(e,r)}}isDisposed(){return this.privIsDisposed}dispose(e){var t;this.isDisposed||(this.privIsDisposed=!0,null===(t=this.config)||void 0===t||t.close(),this.privConversationRecognizerConnection&&(this.privConversationRecognizerConnection.closeConnection(),this.privConversationRecognizerConnection.close(),this.privConversationRecognizerConnection=void 0),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privConversationRecognizer=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0,this.privRoom=void 0)}close(e){var t,r,n;try{this.privIsConnected=!1,null===(t=this.privConversationRecognizerConnection)||void 0===t||t.closeConnection(),null===(r=this.privConversationRecognizerConnection)||void 0===r||r.close(),this.privConversationRecognizer.close(),this.privConversationRecognizerConnection=void 0,this.privConversationRecognizer=void 0,null===(n=this.privConversationTranslator)||void 0===n||n.dispose()}catch(e){}e&&this.dispose()}get canSend(){var e;return this.privIsConnected&&!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isMuted)}get canSendAsHost(){var e;return this.privIsConnected&&(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)}handleCallback(e,t){if(e){try{e()}catch(e){t&&t(e)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e)}toParticipants(e){const t=this.privParticipants.participants.map(e=>this.toParticipant(e));return e?t:t.filter(e=>!1===e.isHost)}toParticipant(e){return new pr(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage)}}!function(e){e[e.Inactive=0]="Inactive",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected"}(Ut||(Ut={}));class vr{constructor(e){this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privSpeechState=Ut.Inactive,this.privErrors=mt.restErrors,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.onSpeechConnected=e=>{this.privSpeechState=Ut.Connected},this.onSpeechDisconnected=e=>{this.privSpeechState=Ut.Inactive,this.cancelSpeech()},this.onSpeechRecognized=(e,t)=>{var r;(null===(r=t.result)||void 0===r?void 0:r.errorDetails)&&(this.cancelSpeech(),this.fireCancelEvent(t.result.errorDetails))},this.onSpeechRecognizing=(e,t)=>{},this.onSpeechCanceled=(e,t)=>{if(this.privSpeechState!==Ut.Inactive)try{this.cancelSpeech()}catch(e){this.privSpeechState=Ut.Inactive}},this.onSpeechSessionStarted=(e,t)=>{this.privSpeechState=Ut.Connected},this.onSpeechSessionStopped=(e,t)=>{this.privSpeechState=Ut.Inactive},this.privProperties=new $.a,this.privAudioConfig=e}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){var e;return null===(e=this.privConversation)||void 0===e?void 0:e.participants}joinConversationAsync(e,t,r,n,i){try{if("string"==typeof e){f.a.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),f.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),i);let o=r;null!=o&&""!==o||(o=mt.defaultLanguageCode),this.privSpeechTranslationConfig=ee.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(F.Masked),this.privSpeechTranslationConfig.addTargetLanguage(o),this.privSpeechTranslationConfig.setProperty(Q.a[Q.a.SpeechServiceConnection_RecoLanguage],o),this.privSpeechTranslationConfig.setProperty(Q.a[Q.a.ConversationTranslator_Name],t);const s=this.privProperties.getProperty(Q.a.ConversationTranslator_Host);s&&this.privSpeechTranslationConfig.setProperty(Q.a[Q.a.ConversationTranslator_Host],s);const a=this.privProperties.getProperty(Q.a.SpeechServiceConnection_Host);a&&this.privSpeechTranslationConfig.setProperty(Q.a[Q.a.SpeechServiceConnection_Host],a),this.privConversation=new hr(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(e,t,o,e=>{e||this.handleError(new Error(this.privErrors.permissionDeniedConnect),i),this.privSpeechTranslationConfig.authorizationToken=e,this.privConversation.startConversationAsync(()=>{this.handleCallback(n,i)},e=>{this.handleError(e,i)})},e=>{this.handleError(e,i)})}else"object"==typeof e?(f.a.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),f.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(Q.a.ConversationTranslator_Name,t),this.privConversation=e,this.privConversation.conversationTranslator=this,f.a.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),f.a.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=e.config,this.handleCallback(r,n)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),n)}catch(e){this.handleError(e,"string"==typeof r?i:n)}}leaveConversationAsync(e,t){try{this.cancelSpeech(),this.privConversation.endConversationAsync(()=>{this.privConversation.deleteConversationAsync(()=>{this.handleCallback(e,t),this.dispose()},e=>{this.handleError(e,t)})},e=>{this.handleError(e,t)})}catch(e){this.handleError(e,t)}}sendTextMessageAsync(e,t,r){var n;try{f.a.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),f.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}",e)),null===(n=this.privConversation)||void 0===n||n.sendTextMessageAsync(e,t,r)}catch(e){this.handleError(e,r)}}startTranscribingAsync(e,t){try{f.a.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),f.a.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),t),void 0===this.privTranslationRecognizer?this.connectTranslatorRecognizer(()=>{this.startContinuousRecognition(()=>{this.privIsSpeaking=!0,this.handleCallback(e,t)},e=>{this.privIsSpeaking=!1,this.cancelSpeech(),this.handleError(e,t)})},e=>{this.handleError(e,t)}):this.startContinuousRecognition(()=>{this.privIsSpeaking=!0,this.handleCallback(e,t)},e=>{this.privIsSpeaking=!1,this.cancelSpeech(),this.handleError(e,t)})}catch(e){this.handleError(e,t),this.cancelSpeech()}}stopTranscribingAsync(e,t){var r;try{if(!this.privIsSpeaking)return this.cancelSpeech(),void this.handleCallback(e,t);this.privIsSpeaking=!1,null===(r=this.privTranslationRecognizer)||void 0===r||r.stopContinuousRecognitionAsync(()=>{this.handleCallback(e,t)},e=>{this.handleError(e,t),this.cancelSpeech()})}catch(e){this.handleError(e,t),this.cancelSpeech()}}isDisposed(){return this.privIsDisposed}dispose(e){var t,r;this.isDisposed&&!this.privIsSpeaking||(this.cancelSpeech(),this.privIsDisposed=!0,null===(t=this.privSpeechTranslationConfig)||void 0===t||t.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,null===(r=this.privConversation)||void 0===r||r.dispose(),this.privConversation=void 0)}connectTranslatorRecognizer(e,t){try{void 0===this.privAudioConfig&&(this.privAudioConfig=E.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(Q.a[Q.a.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(Q.a[Q.a.SpeechServiceConnection_Key],"");const r=encodeURIComponent(this.privConversation.room.token);let n=this.privSpeechTranslationConfig.getProperty(Q.a[Q.a.SpeechServiceConnection_Host],mt.speechHost);n=n.replace("{region}",this.privConversation.room.cognitiveSpeechRegion);const i=`wss://${n}${mt.speechPath}?${mt.configParams.token}=${r}`;this.privSpeechTranslationConfig.setProperty(Q.a[Q.a.SpeechServiceConnection_Endpoint],i),this.privTranslationRecognizer=new ge(this.privSpeechTranslationConfig,this.privAudioConfig),this.privTranslationRecognizerConnection=ke.fromRecognizer(this.privTranslationRecognizer),this.privTranslationRecognizerConnection.connected=this.onSpeechConnected,this.privTranslationRecognizerConnection.disconnected=this.onSpeechDisconnected,this.privTranslationRecognizer.recognized=this.onSpeechRecognized,this.privTranslationRecognizer.recognizing=this.onSpeechRecognizing,this.privTranslationRecognizer.canceled=this.onSpeechCanceled,this.privTranslationRecognizer.sessionStarted=this.onSpeechSessionStarted,this.privTranslationRecognizer.sessionStopped=this.onSpeechSessionStopped,this.handleCallback(e,t)}catch(e){this.handleError(e,t),this.cancelSpeech()}}startContinuousRecognition(e,t){this.privTranslationRecognizer.startContinuousRecognitionAsync(e,t)}fireCancelEvent(e){var t,r,n,i,o,s,a;try{if(this.canceled){const c=new Vt(null!=(r=null===(t=e)||void 0===t?void 0:t.reason)?r:A.a.Error,null!=(i=null===(n=e)||void 0===n?void 0:n.errorDetails)?i:e,null!=(s=null===(o=e)||void 0===o?void 0:o.errorCode)?s:Ee.a.RuntimeError,void 0,null===(a=e)||void 0===a?void 0:a.sessionId);this.canceled(this,c)}}catch(e){}}cancelSpeech(){var e,t;try{this.privIsSpeaking=!1,null===(e=this.privTranslationRecognizer)||void 0===e||e.stopContinuousRecognitionAsync(),null===(t=this.privTranslationRecognizerConnection)||void 0===t||t.closeConnection(),this.privTranslationRecognizerConnection=void 0,this.privTranslationRecognizer=void 0,this.privSpeechState=Ut.Inactive}catch(e){}}get canSpeak(){return!!this.privConversation.isConnected&&(!this.privIsSpeaking&&this.privSpeechState!==Ut.Connected&&this.privSpeechState!==Ut.Connecting&&!this.privConversation.isMutedByHost)}handleCallback(e,t){if(e){try{e()}catch(e){t&&t(e)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e)}}var lr=r(185),dr=r(186),fr=r(132);class gr{constructor(e,t){const r=e;f.a.throwIfNull(r,"speechConfig"),null!==t&&(this.audioConfig=void 0!==t?t:E.fromDefaultSpeakerOutput()),this.privProperties=r.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.privConnectionFactory=new lr.a,this.synthesisRequestQueue=new fr.a,this.implCommonSynthesizeSetup()}get authorizationToken(){return this.properties.getProperty(Q.a.SpeechServiceAuthorization_Token)}set authorizationToken(e){f.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Q.a.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(Q.a.SpeechServiceConnection_AutoDetectSourceLanguages)===G.a}static FromConfig(e,t,r){const n=e;return t.properties.mergeTo(n.properties),new gr(e,r)}buildSsml(e){const t={"ar-EG":"Microsoft Server Speech Text to Speech Voice (ar-EG, Hoda)","ar-SA":"Microsoft Server Speech Text to Speech Voice (ar-SA, Naayf)","bg-BG":"Microsoft Server Speech Text to Speech Voice (bg-BG, Ivan)","ca-ES":"Microsoft Server Speech Text to Speech Voice (ca-ES, HerenaRUS)","cs-CZ":"Microsoft Server Speech Text to Speech Voice (cs-CZ, Jakub)","da-DK":"Microsoft Server Speech Text to Speech Voice (da-DK, HelleRUS)","de-AT":"Microsoft Server Speech Text to Speech Voice (de-AT, Michael)","de-CH":"Microsoft Server Speech Text to Speech Voice (de-CH, Karsten)","de-DE":"Microsoft Server Speech Text to Speech Voice (de-DE, HeddaRUS)","el-GR":"Microsoft Server Speech Text to Speech Voice (el-GR, Stefanos)","en-AU":"Microsoft Server Speech Text to Speech Voice (en-AU, HayleyRUS)","en-CA":"Microsoft Server Speech Text to Speech Voice (en-CA, HeatherRUS)","en-GB":"Microsoft Server Speech Text to Speech Voice (en-GB, HazelRUS)","en-IE":"Microsoft Server Speech Text to Speech Voice (en-IE, Sean)","en-IN":"Microsoft Server Speech Text to Speech Voice (en-IN, PriyaRUS)","en-US":"Microsoft Server Speech Text to Speech Voice (en-US, AriaRUS)","es-ES":"Microsoft Server Speech Text to Speech Voice (es-ES, HelenaRUS)","es-MX":"Microsoft Server Speech Text to Speech Voice (es-MX, HildaRUS)","fi-FI":"Microsoft Server Speech Text to Speech Voice (fi-FI, HeidiRUS)","fr-CA":"Microsoft Server Speech Text to Speech Voice (fr-CA, HarmonieRUS)","fr-CH":"Microsoft Server Speech Text to Speech Voice (fr-CH, Guillaume)","fr-FR":"Microsoft Server Speech Text to Speech Voice (fr-FR, HortenseRUS)","he-IL":"Microsoft Server Speech Text to Speech Voice (he-IL, Asaf)","hi-IN":"Microsoft Server Speech Text to Speech Voice (hi-IN, Kalpana)","hr-HR":"Microsoft Server Speech Text to Speech Voice (hr-HR, Matej)","hu-HU":"Microsoft Server Speech Text to Speech Voice (hu-HU, Szabolcs)","id-ID":"Microsoft Server Speech Text to Speech Voice (id-ID, Andika)","it-IT":"Microsoft Server Speech Text to Speech Voice (it-IT, LuciaRUS)","ja-JP":"Microsoft Server Speech Text to Speech Voice (ja-JP, HarukaRUS)","ko-KR":"Microsoft Server Speech Text to Speech Voice (ko-KR, HeamiRUS)","ms-MY":"Microsoft Server Speech Text to Speech Voice (ms-MY, Rizwan)","nb-NO":"Microsoft Server Speech Text to Speech Voice (nb-NO, HuldaRUS)","nl-NL":"Microsoft Server Speech Text to Speech Voice (nl-NL, HannaRUS)","pl-PL":"Microsoft Server Speech Text to Speech Voice (pl-PL, PaulinaRUS)","pt-BR":"Microsoft Server Speech Text to Speech Voice (pt-BR, HeloisaRUS)","pt-PT":"Microsoft Server Speech Text to Speech Voice (pt-PT, HeliaRUS)","ro-RO":"Microsoft Server Speech Text to Speech Voice (ro-RO, Andrei)","ru-RU":"Microsoft Server Speech Text to Speech Voice (ru-RU, EkaterinaRUS)","sk-SK":"Microsoft Server Speech Text to Speech Voice (sk-SK, Filip)","sl-SI":"Microsoft Server Speech Text to Speech Voice (sl-SI, Lado)","sv-SE":"Microsoft Server Speech Text to Speech Voice (sv-SE, HedvigRUS)","ta-IN":"Microsoft Server Speech Text to Speech Voice (ta-IN, Valluvar)","te-IN":"Microsoft Server Speech Text to Speech Voice (te-IN, Chitra)","th-TH":"Microsoft Server Speech Text to Speech Voice (th-TH, Pattara)","tr-TR":"Microsoft Server Speech Text to Speech Voice (tr-TR, SedaRUS)","vi-VN":"Microsoft Server Speech Text to Speech Voice (vi-VN, An)","zh-CN":"Microsoft Server Speech Text to Speech Voice (zh-CN, HuihuiRUS)","zh-HK":"Microsoft Server Speech Text to Speech Voice (zh-HK, TracyRUS)","zh-TW":"Microsoft Server Speech Text to Speech Voice (zh-TW, HanHanRUS)"};let r=this.properties.getProperty(Q.a.SpeechServiceConnection_SynthLanguage,"en-US"),n=this.properties.getProperty(Q.a.SpeechServiceConnection_SynthVoice,""),i=gr.XMLEncode(e);return this.autoDetectSourceLanguage?r="en-US":n=n||t[r],n&&(i=`<voice name='${n}'>${i}</voice>`),i=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${r}'>${i}</speak>`,i}speakTextAsync(e,t,r,n){this.speakImpl(e,!1,t,r,n)}speakSsmlAsync(e,t,r,n){this.speakImpl(e,!0,t,r,n)}close(){f.a.throwIfDisposed(this.privDisposed),this.dispose(!0)}get internalData(){return this.privAdapter}dispose(e){this.privDisposed||(e&&this.privAdapter&&this.privAdapter.dispose(),this.privDisposed=!0)}createSynthesizerConfig(e){return new dr.a(e,this.privProperties)}createSynthesisAdapter(e,t,r,n){return new m.a(e,t,n,this,this.audioConfig)}implCommonSynthesizeSetup(){let e="undefined"!=typeof window?"Browser":"Node",t="unknown",r="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);const n=this.createSynthesizerConfig(new o.e(new o.a(new o.b(e,t,r)))),i=this.privProperties.getProperty(Q.a.SpeechServiceConnection_Key,void 0),a=i&&""!==i?new ne.a(i):new ie.a(e=>{const t=this.privProperties.getProperty(Q.a.SpeechServiceAuthorization_Token,void 0);return s.c.fromResult(t)},e=>{const t=this.privProperties.getProperty(Q.a.SpeechServiceAuthorization_Token,void 0);return s.c.fromResult(t)});this.privAdapter=this.createSynthesisAdapter(a,this.privConnectionFactory,this.audioConfig,n),this.privAdapter.audioOutputFormat=S.b.fromSpeechSynthesisOutputFormat(Y.a[this.properties.getProperty(Q.a.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(e,t,r,n,i){try{f.a.throwIfDisposed(this.privDisposed);const o=Object(u.b)();let s;s=i instanceof R?new C.e(i):i instanceof C.b?i:void 0!==i?new I(i):void 0,this.synthesisRequestQueue.enqueue(new yr(o,e,t,e=>{if(this.privSynthesizing=!1,r)try{r(e)}catch(e){n&&n(e)}r=void 0,this.adapterSpeak()},e=>{n&&n(e)},s)),this.adapterSpeak()}catch(e){if(n)if(e instanceof Error){const t=e;n(t.name+": "+t.message)}else n(e);this.dispose(!0)}}adapterSpeak(){return this.privDisposed||this.privSynthesizing?s.c.fromResult(!0):(this.privSynthesizing=!0,this.synthesisRequestQueue.dequeue().onSuccessContinueWithPromise(e=>this.privAdapter.Speak(e.text,e.isSSML,e.requestId,e.cb,e.err,e.dataStream)))}static XMLEncode(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}}class yr{constructor(e,t,r,n,i,o){this.requestId=e,this.text=t,this.isSSML=r,this.cb=n,this.err=i,this.dataStream=o}}var mr=r(57),Sr=r(56),Cr=r(120)},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizingIntent=4]="RecognizingIntent",e[e.RecognizedIntent=5]="RecognizedIntent",e[e.TranslatingSpeech=6]="TranslatingSpeech",e[e.TranslatedSpeech=7]="TranslatedSpeech",e[e.SynthesizingAudio=8]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=9]="SynthesizingAudioCompleted",e[e.SynthesizingAudioStarted=10]="SynthesizingAudioStarted",e[e.EnrollingVoiceProfile=11]="EnrollingVoiceProfile",e[e.EnrolledVoiceProfile=12]="EnrolledVoiceProfile",e[e.RecognizedSpeakers=13]="RecognizedSpeakers",e[e.RecognizedSpeaker=14]="RecognizedSpeaker",e[e.ResetVoiceProfile=15]="ResetVoiceProfile",e[e.DeletedVoiceProfile=16]="DeletedVoiceProfile"}(n||(n={}))},function(e,t,r){"use strict";var n,i;r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i})),function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"}(n||(n={})),function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests"}(i||(i={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{static get TestHooksParamName(){return"testhooks"}static get ConnectionIdHeader(){return"X-ConnectionId"}static get DeploymentIdParamName(){return"cid"}static get FormatParamName(){return"format"}static get LanguageParamName(){return"language"}static get TranslationFromParamName(){return"from"}static get TranslationToParamName(){return"to"}static get Profanify(){return"profanity"}static get EnableAudioLogging(){return"storeAudio"}static get EnableWordLevelTimestamps(){return"wordLevelTimestamps"}static get InitialSilenceTimeoutMs(){return"initialSilenceTimeoutMs"}static get EndSilenceTimeoutMs(){return"endSilenceTimeoutMs"}static get StableIntermediateThreshold(){return"stableIntermediateThreshold"}static get StableTranslation(){return"stableTranslation"}static get EnableLanguageID(){return"lidEnabled"}}},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",e[e.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",e[e.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",e[e.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",e[e.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",e[e.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",e[e.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",e[e.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",e[e.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",e[e.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",e[e.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",e[e.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",e[e.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",e[e.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",e[e.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",e[e.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",e[e.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",e[e.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",e[e.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(17),i=r(4);class o extends n.a{constructor(e,t,r,n,o,s,a,c){if(!t)throw new i.a("path");if(!r)throw new i.a("requestId");const p={};if(p.Path=t,p["X-RequestId"]=r,p["X-Timestamp"]=(new Date).toISOString(),n&&(p["Content-Type"]=n),s&&(p["x-streamid"]=s),a)for(const e in a)e&&(p[e]=a[e]);c?super(e,o,p,c):super(e,o,p),this.privPath=t,this.privRequestId=r,this.privContentType=n,this.privStreamId=s,this.privAdditionalHeaders=a}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}}o.fromConnectionMessage=e=>{let t=null,r=null,n=null,i=null,s=null;const a={};if(e.headers)for(const o in e.headers)o&&(o.toLowerCase()==="Path".toLowerCase()?t=e.headers[o]:o.toLowerCase()==="X-RequestId".toLowerCase()?r=e.headers[o]:o.toLowerCase()==="X-Timestamp".toLowerCase()?i=e.headers[o]:o.toLowerCase()==="Content-Type".toLowerCase()?n=e.headers[o]:o.toLowerCase()==="x-streamid".toLowerCase()?s=e.headers[o]:a[o]=e.headers[o]);return new o(e.messageType,t,r,n,e.body,s,a,e.id)}},function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return s}));var n,i=r(4),o=r(18);!function(e){e[e.Text=0]="Text",e[e.Binary=1]="Binary"}(n||(n={}));class s{constructor(e,t,r,s){if(this.privBody=null,e===n.Text&&t&&"string"!=typeof t)throw new i.b("Payload must be a string");if(e===n.Binary&&t&&!(t instanceof ArrayBuffer))throw new i.b("Payload must be ArrayBuffer");switch(this.privMessageType=e,this.privBody=t,this.privHeaders=r||{},this.privId=s||Object(o.b)(),this.messageType){case n.Binary:this.privSize=null!==this.binaryBody?this.binaryBody.byteLength:0;break;case n.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===n.Binary)throw new i.b("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===n.Text)throw new i.b("Not supported for text message");return this.privBody}get id(){return this.privId}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));const n=()=>{let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)})},i=()=>n().replace(new RegExp("-","g"),"").toUpperCase()},function(e,t,r){"use strict";r.d(t,"k",(function(){return o})),r.d(t,"e",(function(){return s})),r.d(t,"i",(function(){return a})),r.d(t,"g",(function(){return c})),r.d(t,"l",(function(){return p})),r.d(t,"j",(function(){return u})),r.d(t,"h",(function(){return h})),r.d(t,"n",(function(){return v})),r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"d",(function(){return f})),r.d(t,"o",(function(){return g})),r.d(t,"c",(function(){return y})),r.d(t,"m",(function(){return m})),r.d(t,"f",(function(){return S}));var n=r(9);class i extends n.b{constructor(e,t,r){super(e,t),this.privSignature=r}}class o extends i{constructor(e){super("OCSPMemoryCacheHitEvent",n.a.Debug,e)}}class s extends i{constructor(e){super("OCSPCacheMissEvent",n.a.Debug,e)}}class a extends i{constructor(e){super("OCSPDiskCacheHitEvent",n.a.Debug,e)}}class c extends i{constructor(e){super("OCSPCacheUpdateNeededEvent",n.a.Debug,e)}}class p extends i{constructor(e){super("OCSPMemoryCacheStoreEvent",n.a.Debug,e)}}class u extends i{constructor(e){super("OCSPDiskCacheStoreEvent",n.a.Debug,e)}}class h extends i{constructor(e){super("OCSPCacheUpdatehCompleteEvent",n.a.Debug,e)}}class v extends i{constructor(){super("OCSPStapleReceivedEvent",n.a.Debug,"")}}class l extends i{constructor(e,t){super("OCSPCacheEntryExpiredEvent",n.a.Debug,e),this.privExpireTime=t}}class d extends i{constructor(e,t,r){super("OCSPCacheEntryNeedsRefreshEvent",n.a.Debug,e),this.privExpireTime=r,this.privStartTime=t}}class f extends i{constructor(e,t,r){super("OCSPCacheHitEvent",n.a.Debug,e),this.privExpireTime=r,this.privExpireTimeString=new Date(r).toLocaleDateString(),this.privStartTime=t,this.privStartTimeString=new Date(t).toLocaleTimeString()}}class g extends i{constructor(e,t){super("OCSPVerificationFailedEvent",n.a.Debug,e),this.privError=t}}class y extends i{constructor(e,t){super("OCSPCacheFetchErrorEvent",n.a.Debug,e),this.privError=t}}class m extends i{constructor(e){super("OCSPResponseRetrievedEvent",n.a.Debug,e)}}class S extends i{constructor(e,t){super("OCSPCacheUpdateErrorEvent",n.a.Debug,e),this.privError=t}}},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError"}(n||(n={}))},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return v}));var n=r(18),i=r(223),o=r(7),s=r(0),a=r(26);class c{constructor(){}static createPullStream(){return p.create()}}class p extends c{static create(){return new u}}class u extends p{constructor(){super(),this.privId=Object(n.b)(),this.privStream=new i.a}set format(e){null==e&&(this.privFormat=a.b.getDefaultOutputFormat()),this.privFormat=e}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}read(e){const t=new Int8Array(e);let r=0;if(void 0!==this.privLastChunkView){if(this.privLastChunkView.length>e.byteLength)return t.set(this.privLastChunkView.slice(0,e.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(e.byteLength),o.c.fromResult(e.byteLength);t.set(this.privLastChunkView),r=this.privLastChunkView.length,this.privLastChunkView=void 0}const n=new o.a,i=()=>{r<e.byteLength&&!this.privStream.isReadEnded?this.privStream.read().onSuccessContinueWith(o=>{if(void 0===o||o.isEnd)this.privStream.readEnded(),n.resolve(r);else{let n;o.buffer.byteLength>e.byteLength-r?(n=o.buffer.slice(0,e.byteLength-r),this.privLastChunkView=new Int8Array(o.buffer.slice(e.byteLength-r))):n=o.buffer,t.set(new Int8Array(n),r),r+=n.byteLength,i()}}):n.resolve(r)};return i(),n.promise()}write(e){s.a.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}class h extends c{constructor(){super()}static create(e){return new v(e)}}class v extends h{constructor(e){super(),this.privId=Object(n.b)(),this.privCallback=e}set format(e){}write(e){this.privCallback.write&&this.privCallback.write(e)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3);class i{constructor(){this.privKeys=[],this.privValues=[]}getProperty(e,t){let r;r="string"==typeof e?e:n.a[e];for(let e=0;e<this.privKeys.length;e++)if(this.privKeys[e]===r)return this.privValues[e];return t}setProperty(e,t){let r;r="string"==typeof e?e:n.a[e];for(let e=0;e<this.privKeys.length;e++)if(this.privKeys[e]===r)return void(this.privValues[e]=t);this.privKeys.push(r),this.privValues.push(t)}clone(){const e=new i;for(let t=0;t<this.privKeys.length;t++)e.privKeys.push(this.privKeys[t]),e.privValues.push(this.privValues[t]);return e}mergeTo(e){this.privKeys.forEach(t=>{if(void 0===e.getProperty(t,void 0)){const r=this.getProperty(t);e.setProperty(t,r)}})}}},function(e,t,r){(function(t){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof t&&t)||Function("return this")()}).call(this,r(91))},function(e,t,r){var n=r(24),i=r(142),o=r(33),s=r(143),a=r(204),c=r(439),p=i("wks"),u=n.Symbol,h=c?u:u&&u.withoutSetter||s;e.exports=function(e){return o(p,e)||(a&&o(u,e)?p[e]=u[e]:p[e]=h("Symbol."+e)),p[e]}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s}));var n,i=r(15),o=r(30);!function(e){e[e.PCM=1]="PCM",e[e.MuLaw=2]="MuLaw",e[e.Siren=3]="Siren",e[e.MP3=4]="MP3",e[e.SILKSkype=5]="SILKSkype",e[e.Opus=6]="Opus"}(n||(n={}));class s extends o.b{constructor(e,t,r,n,i,o,s,a,c){super(r,o,t),this.formatTag=e,this.avgBytesPerSec=n,this.blockAlign=i,this.priAudioFormatString=s,this.priRequestAudioFormatString=a,this.priHasHeader=c}static fromSpeechSynthesisOutputFormat(e){return void 0===e?s.getDefaultOutputFormat():s.fromSpeechSynthesisOutputFormatString(s.SpeechSynthesisOutputFormatToString[e])}static fromSpeechSynthesisOutputFormatString(e){switch(e){case"raw-8khz-8bit-mono-mulaw":return new s(n.PCM,1,8e3,8e3,1,8,e,e,!1);case"riff-16khz-16kbps-mono-siren":return new s(n.Siren,1,16e3,2e3,40,0,e,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new s(n.Siren,1,16e3,2e3,40,0,e,e,!1);case"audio-16khz-32kbitrate-mono-mp3":return new s(n.MP3,1,16e3,4096,2,16,e,e,!1);case"audio-16khz-128kbitrate-mono-mp3":return new s(n.MP3,1,16e3,16384,2,16,e,e,!1);case"audio-16khz-64kbitrate-mono-mp3":return new s(n.MP3,1,16e3,8192,2,16,e,e,!1);case"audio-24khz-48kbitrate-mono-mp3":return new s(n.MP3,1,16e3,6144,2,16,e,e,!1);case"audio-24khz-96kbitrate-mono-mp3":return new s(n.MP3,1,16e3,12288,2,16,e,e,!1);case"audio-24khz-160kbitrate-mono-mp3":return new s(n.MP3,1,16e3,20480,2,16,e,e,!1);case"raw-16khz-16bit-mono-truesilk":return new s(n.SILKSkype,1,16e3,32e3,2,16,e,e,!1);case"riff-8khz-16bit-mono-pcm":return new s(n.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new s(n.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new s(n.MuLaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new s(n.PCM,1,16e3,32e3,2,16,e,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new s(n.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new s(n.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new s(n.Opus,1,16e3,8192,2,16,e,"ogg-16khz-16bit-mono-opus",!1);case"ogg-24khz-16bit-mono-opus":return new s(n.Opus,1,24e3,8192,2,16,e,"ogg-24khz-16bit-mono-opus",!1);case"riff-16khz-16bit-mono-pcm":default:return new s(n.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return s.fromSpeechSynthesisOutputFormatString("undefined"!=typeof window?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(e){if(this.priHasHeader){new DataView(this.privHeader).setUint32(40,e,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}}s.SpeechSynthesisOutputFormatToString={[i.a.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[i.a.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[i.a.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[i.a.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[i.a.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[i.a.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[i.a.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[i.a.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[i.a.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[i.a.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[i.a.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[i.a.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[i.a.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[i.a.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[i.a.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[i.a.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[i.a.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[i.a.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[i.a.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus"}},function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return c})),r.d(t,"f",(function(){return u})),r.d(t,"e",(function(){return h})),r.d(t,"g",(function(){return v})),r.d(t,"h",(function(){return l}));var n=r(9);class i extends n.b{constructor(e,t,r=n.a.Info){super(e,r),this.privAudioSourceId=t}get audioSourceId(){return this.privAudioSourceId}}class o extends i{constructor(e){super("AudioSourceInitializingEvent",e)}}class s extends i{constructor(e){super("AudioSourceReadyEvent",e)}}class a extends i{constructor(e){super("AudioSourceOffEvent",e)}}class c extends i{constructor(e,t){super("AudioSourceErrorEvent",e,n.a.Error),this.privError=t}get error(){return this.privError}}class p extends i{constructor(e,t,r){super(e,t),this.privAudioNodeId=r}get audioNodeId(){return this.privAudioNodeId}}class u extends p{constructor(e,t){super("AudioStreamNodeAttachingEvent",e,t)}}class h extends p{constructor(e,t){super("AudioStreamNodeAttachedEvent",e,t)}}class v extends p{constructor(e,t){super("AudioStreamNodeDetachedEvent",e,t)}}class l extends p{constructor(e,t,r){super("AudioStreamNodeErrorEvent",e,t),this.privError=r}get error(){return this.privError}}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(243)),n(r(154)),n(r(375)),n(r(376)),n(r(377)),n(r(169)),n(r(391)),n(r(392)),n(r(393)),n(r(110))},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var r=e.call(this,t)||this;return r.name="ArgumentNull",r.message=t,r}return i(t,e),t}(Error);t.ArgumentNullError=o;var s=function(e){function t(t){var r=e.call(this,t)||this;return r.name="InvalidOperation",r.message=t,r}return i(t,e),t}(Error);t.InvalidOperationError=s;var a=function(e){function t(t,r){var n=e.call(this,r)||this;return n.name=t+"ObjectDisposed",n.message=r,n}return i(t,e),t}(Error);t.ObjectDisposedError=a},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));class n{static getDefaultInputFormat(){return i.getDefaultInputFormat()}static getWaveFormatPCM(e,t,r){return new i(e,t,r)}}class i extends n{constructor(e=16e3,t=16,r=1){super(),this.setString=(e,t,r)=>{for(let n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))},this.formatTag=1,this.bitsPerSample=t,this.samplesPerSec=e,this.channels=r,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),this.privHeader=new ArrayBuffer(44);const n=new DataView(this.privHeader);this.setString(n,0,"RIFF"),n.setUint32(4,0,!0),this.setString(n,8,"WAVEfmt "),n.setUint32(16,16,!0),n.setUint16(20,1,!0),n.setUint16(22,this.channels,!0),n.setUint32(24,this.samplesPerSec,!0),n.setUint32(28,this.avgBytesPerSec,!0),n.setUint16(32,this.channels*(this.bitsPerSample/8),!0),n.setUint16(34,this.bitsPerSample,!0),this.setString(n,36,"data"),n.setUint32(40,0,!0)}static getDefaultInputFormat(){return new i}close(){}get header(){return this.privHeader}}},function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return p})),r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return v})),r.d(t,"f",(function(){return o})),r.d(t,"g",(function(){return s}));var n,i,o,s,a=r(3);!function(e){e[e.Interactive=0]="Interactive",e[e.Conversation=1]="Conversation",e[e.Dictation=2]="Dictation"}(n||(n={})),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(i||(i={}));class c{constructor(e,t){this.privRecognitionMode=n.Interactive,this.privSpeechServiceConfig=e||new p(new u(null)),this.privParameters=t}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===n.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=n[e]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==n.Interactive}get autoDetectSourceLanguages(){return this.parameters.getProperty(a.a.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}}class p{constructor(e){this.serialize=()=>JSON.stringify(this,(e,t)=>{if(t&&"object"==typeof t){const e={};for(const r in t)Object.hasOwnProperty.call(t,r)&&(e[r&&r.charAt(0).toLowerCase()+r.substring(1)]=t[r]);return e}return t}),this.context=e}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(e){this.recognition=e.toLowerCase()}}class u{constructor(e){this.system=new h,this.os=e}}class h{constructor(){this.name="SpeechSDK",this.version="1.13.1",this.build="JavaScript",this.lang="JavaScript"}}class v{constructor(e,t,r){this.platform=e,this.name=t,this.version=r}}!function(e){e.Bluetooth="Bluetooth",e.Wired="Wired",e.WiFi="WiFi",e.Cellular="Cellular",e.InBuilt="InBuilt",e.Unknown="Unknown"}(o||(o={})),function(e){e.Phone="Phone",e.Speaker="Speaker",e.Car="Car",e.Headset="Headset",e.Thermostat="Thermostat",e.Microphones="Microphones",e.Deskphone="Deskphone",e.RemoteControl="RemoteControl",e.Unknown="Unknown",e.File="File",e.Stream="Stream"}(s||(s={}))},,function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(1),i=r(3),o=r(14);class s{setCommonUrlParams(e,t,r){this.setUrlParameter(i.a.SpeechServiceConnection_EnableAudioLogging,o.a.EnableAudioLogging,e,t,r),this.setUrlParameter(i.a.SpeechServiceResponse_RequestWordLevelTimestamps,o.a.EnableWordLevelTimestamps,e,t,r),this.setUrlParameter(i.a.SpeechServiceResponse_ProfanityOption,o.a.Profanify,e,t,r),this.setUrlParameter(i.a.SpeechServiceConnection_InitialSilenceTimeoutMs,o.a.InitialSilenceTimeoutMs,e,t,r),this.setUrlParameter(i.a.SpeechServiceConnection_EndSilenceTimeoutMs,o.a.EndSilenceTimeoutMs,e,t,r),this.setUrlParameter(i.a.SpeechServiceResponse_StablePartialResultThreshold,o.a.StableIntermediateThreshold,e,t,r);const s=JSON.parse(e.parameters.getProperty(n.e,"{}"));Object.keys(s).forEach((e,r,n)=>{t[e]=s[e]})}setUrlParameter(e,t,r,n,i){const o=r.parameters.getProperty(e,void 0);!o||i&&-1!==i.search(t)||(n[t]=o.toLocaleLowerCase())}}},function(e,t,r){"use strict";r.d(t,"d",(function(){return s})),r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return c})),r.d(t,"c",(function(){return p}));var n,i=r(9);class o extends i.b{constructor(e,t,r,n=i.a.Info){super(e,n),this.privRequestId=t,this.privSessionId=r}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}class s extends o{constructor(e,t,r,n){super("RecognitionTriggeredEvent",e,t),this.privAudioSourceId=r,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class a extends o{constructor(e,t,r,n){super("ListeningStartedEvent",e,t),this.privAudioSourceId=r,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class c extends o{constructor(e,t,r){super("ConnectingToServiceEvent",e,r),this.privAuthFetchEventid=t}get authFetchEventid(){return this.privAuthFetchEventid}}class p extends o{constructor(e,t,r,n,i){super("RecognitionStartedEvent",e,i),this.privAudioSourceId=t,this.privAudioNodeId=r,this.privAuthFetchEventId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}!function(e){e[e.Success=0]="Success",e[e.AudioSourceError=1]="AudioSourceError",e[e.AudioSourceTimeout=2]="AudioSourceTimeout",e[e.AuthTokenFetchError=3]="AuthTokenFetchError",e[e.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",e[e.UnAuthorized=5]="UnAuthorized",e[e.ConnectTimeout=6]="ConnectTimeout",e[e.ConnectError=7]="ConnectError",e[e.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",e[e.UnknownError=9]="UnknownError"}(n||(n={}))},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"}(n||(n={}))},function(e,t,r){var n=r(52);e.exports=function(e){if(!n(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(12),i=r(36),o=r(20),s=r(13);class a{static implTranslateRecognitionResult(e){let t=n.a.Canceled;switch(e){case s.a.Success:t=n.a.RecognizedSpeech;break;case s.a.NoMatch:case s.a.InitialSilenceTimeout:case s.a.BabbleTimeout:case s.a.EndOfDictation:t=n.a.NoMatch;break;case s.a.Error:default:t=n.a.Canceled}return t}static implTranslateCancelResult(e){let t=i.a.EndOfStream;switch(e){case s.a.Success:case s.a.EndOfDictation:case s.a.NoMatch:t=i.a.EndOfStream;break;case s.a.InitialSilenceTimeout:case s.a.BabbleTimeout:case s.a.Error:default:t=i.a.Error}return t}static implTranslateCancelErrorCode(e){let t=o.a.NoError;switch(e){case s.a.Error:t=o.a.ServiceError;break;case s.a.TooManyRequests:t=o.a.TooManyRequests;break;default:t=o.a.NoError}return t}}},function(e,t,r){var n=r(51);e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,r){var n=r(39),i=r(41),o=r(92);e.exports=n?function(e,t,r){return i.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var n=r(39),i=r(138),o=r(37),s=r(137),a=Object.defineProperty;t.f=n?a:function(e,t,r){if(o(e),t=s(t,!0),o(r),i)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(123);class i extends n.a{constructor(e,t,r,n,i,o,s,a,c,p){super(e,t,r,n,i,o,s,a,c,p)}}},function(e,t,r){e.exports=r(147)},function(e,t){function r(e,t,r,n,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function a(e){r(s,i,o,a,c,"next",e)}function c(e){r(s,i,o,a,c,"throw",e)}a(void 0)}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)}))};t.createGuid=n;t.createNoDashGuid=function(){return n().replace(new RegExp("-","g"),"").toUpperCase()}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t){this.privHeaderName=e,this.privToken=t}get headerName(){return this.privHeaderName}get token(){return this.privToken}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(42);class i extends n.a{constructor(e,t,r,n,i,o,s,a,c){super(t,r,n,i,o,void 0,void 0,s,a,c),this.privTranslations=e}get translations(){return this.privTranslations}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(58);class i extends n.a{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(42);class i extends n.a{constructor(e,t,r,n,i,o,s,a,c,p,u){super(t,r,n,i,o,s,a,c,p,u),this.privIntentId=e}get intentId(){return this.privIntentId}}},function(e,t){},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),s=r(10),a=r(75),c=function(){function e(){}return e.createPullStream=function(){return p.create()},e}();t.AudioOutputStream=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.create=function(){return new u},t}(c);t.PullAudioOutputStream=p;var u=function(e){function t(){var t=e.call(this)||this;return t.privId=o.createNoDashGuid(),t.privStream=new o.Stream,t}return i(t,e),Object.defineProperty(t.prototype,"format",{get:function(){return this.privFormat},set:function(e){null==e&&(this.privFormat=a.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isClosed",{get:function(){return this.privStream.isClosed},enumerable:!0,configurable:!0}),t.prototype.id=function(){return this.privId},t.prototype.read=function(e){var t=this,r=new Int8Array(e),n=0;if(void 0!==this.privLastChunkView){if(this.privLastChunkView.length>e.byteLength)return r.set(this.privLastChunkView.slice(0,e.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(e.byteLength),o.PromiseHelper.fromResult(e.byteLength);r.set(this.privLastChunkView),n=this.privLastChunkView.length,this.privLastChunkView=void 0}var i=new o.Deferred,s=function(){n<e.byteLength&&!t.privStream.isReadEnded?t.privStream.read().onSuccessContinueWith((function(o){if(void 0===o||o.isEnd)t.privStream.readEnded(),i.resolve(n);else{var a=void 0;o.buffer.byteLength>e.byteLength-n?(a=o.buffer.slice(0,e.byteLength-n),t.privLastChunkView=new Int8Array(o.buffer.slice(e.byteLength-n))):a=o.buffer,r.set(new Int8Array(a),n),n+=a.byteLength,s()}})):i.resolve(n)};return s(),i.promise()},t.prototype.write=function(e){s.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})},t.prototype.close=function(){this.privStream.close()},t}(p);t.PullAudioOutputStreamImpl=u;var h=function(e){function t(){return e.call(this)||this}return i(t,e),t.create=function(e){return new v(e)},t}(c);t.PushAudioOutputStream=h;var v=function(e){function t(t){var r=e.call(this)||this;return r.privId=o.createNoDashGuid(),r.privCallback=t,r}return i(t,e),Object.defineProperty(t.prototype,"format",{set:function(e){},enumerable:!0,configurable:!0}),t.prototype.write=function(e){this.privCallback.write&&this.privCallback.write(e)},t.prototype.close=function(){this.privCallback.close&&this.privCallback.close()},t.prototype.id=function(){return this.privId},t}(h);t.PushAudioOutputStreamImpl=v},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return h})),r.d(t,"d",(function(){return v})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return f}));var n=r(31),i=r(133),o=r(61),s=r(479),a=r(7),c=r(27),p=r(18),u=r(30);class h{constructor(){}static createPushStream(e){return v.create(e)}static createPullStream(e,t){return d.create(e,t)}}class v extends h{static create(e){return new l(e)}}class l extends v{constructor(e){super(),this.onEvent=e=>{this.privEvents.onEvent(e),i.a.instance.onEvent(e)},this.privFormat=void 0===e?u.b.getDefaultInputFormat():e,this.privEvents=new o.a,this.privId=Object(p.b)(),this.privStream=new s.a(this.privFormat.avgBytesPerSec/10)}get format(){return a.c.fromResult(this.privFormat)}write(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}get blob(){return this.attach("id").onSuccessContinueWithPromise(t=>{const r=[];let n=e.from("");const i=()=>t.read().onSuccessContinueWithPromise(t=>!t||t.isEnd?"undefined"!=typeof XMLHttpRequest?a.c.fromResult(new Blob(r)):a.c.fromResult(e.from(n)):("undefined"!=typeof Blob?r.push(t.buffer):n=e.concat([n,this.toBuffer(t.buffer)]),i()));return i()})}turnOn(){return this.onEvent(new c.b(this.privId)),this.onEvent(new c.d(this.privId)),a.c.fromResult(!0)}attach(e){return this.onEvent(new c.f(this.privId,e)),this.turnOn().onSuccessContinueWith(e=>this.privStream).onSuccessContinueWith(t=>(this.onEvent(new c.e(this.privId,e)),{detach:()=>{t.readEnded(),this.onEvent(new c.g(this.privId,e)),this.turnOff()},id:()=>e,read:()=>t.read()}))}detach(e){this.onEvent(new c.g(this.privId,e))}turnOff(){return a.c.fromResult(!1)}get events(){return this.privEvents}get deviceInfo(){return a.c.fromResult({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:n.f.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:n.g.Stream})}toBuffer(t){const r=e.alloc(t.byteLength),n=new Uint8Array(t);for(let e=0;e<r.length;++e)r[e]=n[e];return r}}class d extends h{constructor(){super()}static create(e,t){return new f(e,t)}}class f extends d{constructor(e,t){super(),this.onEvent=e=>{this.privEvents.onEvent(e),i.a.instance.onEvent(e)},this.privFormat=void 0===t?u.a.getDefaultInputFormat():t,this.privEvents=new o.a,this.privId=Object(p.b)(),this.privCallback=e,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return a.c.fromResult(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}get blob(){return a.c.fromError("Not implemented")}turnOn(){return this.onEvent(new c.b(this.privId)),this.onEvent(new c.d(this.privId)),a.c.fromResult(!0)}attach(e){return this.onEvent(new c.f(this.privId,e)),this.turnOn().onSuccessContinueWith(t=>(this.onEvent(new c.e(this.privId,e)),{detach:()=>{this.privCallback.close(),this.onEvent(new c.g(this.privId,e)),this.turnOff()},id:()=>e,read:()=>{let e,t=0;for(;t<this.privBufferSize;){const r=new ArrayBuffer(this.privBufferSize-t),n=this.privCallback.read(r);if(void 0===e)e=r;else{new Int8Array(e).set(new Int8Array(r),t)}if(0===n)break;t+=n}return a.c.fromResult({buffer:e.slice(0,t),isEnd:this.privIsClosed||0===t,timeReceived:Date.now()})}}))}detach(e){this.onEvent(new c.g(this.privId,e))}turnOff(){return a.c.fromResult(!1)}get events(){return this.privEvents}get deviceInfo(){return a.c.fromResult({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:n.f.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:n.g.Stream})}}}).call(this,r(74).Buffer)},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){this.privResult=e}get result(){return this.privResult}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t,r,n,i){this.privResultId=e,this.privReason=t,this.privAudioData=r,this.privErrorDetails=n,this.privProperties=i}get resultId(){return this.privResultId}get reason(){return this.privReason}get audioData(){return this.privAudioData}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(78);class i extends n.a{constructor(e,t){super(t),this.privOffset=e}get offset(){return this.privOffset}}},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(7),i=r(17),o=r(225);class s{constructor(){this.toConnectionMessage=e=>{const t=new n.a;try{if(e.messageType===i.b.Text){const r=e.textContent;let n={},o=null;if(r){const e=r.split("\r\n\r\n");e&&e.length>0&&(n=this.parseHeaders(e[0]),e.length>1&&(o=e[1]))}t.resolve(new i.a(e.messageType,o,n,e.id))}else if(e.messageType===i.b.Binary){const r=e.binaryContent;let n={},o=null;if(!r||r.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const s=new DataView(r),a=s.getInt16(0);if(r.byteLength<a+2)throw new Error("Invalid binary message format. Header content missing.");let c="";for(let e=0;e<a;e++)c+=String.fromCharCode(s.getInt8(e+2));n=this.parseHeaders(c),r.byteLength>a+2&&(o=r.slice(2+a)),t.resolve(new i.a(e.messageType,o,n,e.id))}}catch(e){t.reject("Error formatting the message. Error: "+e)}return t.promise()},this.fromConnectionMessage=e=>{const t=new n.a;try{if(e.messageType===i.b.Text){const r=`${this.makeHeaders(e)}\r\n${e.textBody?e.textBody:""}`;t.resolve(new o.a(i.b.Text,r,e.id))}else if(e.messageType===i.b.Binary){const r=this.makeHeaders(e),n=e.binaryBody,s=new Int8Array(this.stringToArrayBuffer(r)),a=new ArrayBuffer(2+s.byteLength+(n?n.byteLength:0)),c=new DataView(a);c.setInt16(0,s.length);for(let e=0;e<s.byteLength;e++)c.setInt8(2+e,s[e]);if(n){const e=new Int8Array(n);for(let t=0;t<e.byteLength;t++)c.setInt8(2+s.byteLength+t,e[t])}t.resolve(new o.a(i.b.Binary,a,e.id))}}catch(e){t.reject("Error formatting the message. "+e)}return t.promise()},this.makeHeaders=e=>{let t="";if(e.headers)for(const r in e.headers)r&&(t+=`${r}: ${e.headers[r]}\r\n`);return t},this.parseHeaders=e=>{const t={};if(e){const r=e.match(/[^\r\n]+/g);if(t)for(const e of r)if(e){const r=e.indexOf(":"),n=r>0?e.substr(0,r).trim().toLowerCase():e,i=r>0&&e.length>r+1?e.substr(r+1).trim():"";t[n]=i}}return t},this.stringToArrayBuffer=e=>{const t=new ArrayBuffer(e.length),r=new DataView(t);for(let t=0;t<e.length;t++)r.setUint8(t,e.charCodeAt(t));return t}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),i=r(18);class o{constructor(e){this.privEventListeners={},this.privIsDisposed=!1,this.onEvent=e=>{if(this.isDisposed())throw new n.c("EventSource");if(this.metadata)for(const t in this.metadata)t&&e.metadata&&(e.metadata[t]||(e.metadata[t]=this.metadata[t]));for(const t in this.privEventListeners)t&&this.privEventListeners[t]&&this.privEventListeners[t](e)},this.attach=e=>{const t=Object(i.b)();return this.privEventListeners[t]=e,{detach:()=>{delete this.privEventListeners[t]}}},this.attachListener=e=>this.attach(e.onEvent),this.isDisposed=()=>this.privIsDisposed,this.dispose=()=>{this.privEventListeners=null,this.privIsDisposed=!0},this.privMetadata=e}get metadata(){return this.privMetadata}}},function(e,t,r){var n=r(232),i=r(93);e.exports=function(e){return n(i(e))}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.getDefaultInputFormat=function(){return s.getDefaultInputFormat()},e.getWaveFormatPCM=function(e,t,r){return new s(e,t,r)},e}();t.AudioStreamFormat=o;var s=function(e){function t(t,r,n){void 0===t&&(t=16e3),void 0===r&&(r=16),void 0===n&&(n=1);var i=e.call(this)||this;i.setString=function(e,t,r){for(var n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))},i.formatTag=1,i.bitsPerSample=r,i.samplesPerSec=t,i.channels=n,i.avgBytesPerSec=i.samplesPerSec*i.channels*(i.bitsPerSample/8),i.blockAlign=i.channels*Math.max(i.bitsPerSample,8),i.privHeader=new ArrayBuffer(44);var o=new DataView(i.privHeader);return i.setString(o,0,"RIFF"),o.setUint32(4,0,!0),i.setString(o,8,"WAVEfmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,i.channels,!0),o.setUint32(24,i.samplesPerSec,!0),o.setUint32(28,i.avgBytesPerSec,!0),o.setUint16(32,i.channels*(i.bitsPerSample/8),!0),o.setUint16(34,i.bitsPerSample,!0),i.setString(o,36,"data"),o.setUint32(40,0,!0),i}return i(t,e),t.getDefaultInputFormat=function(){return new t},t.prototype.close=function(){},Object.defineProperty(t.prototype,"header",{get:function(){return this.privHeader},enumerable:!0,configurable:!0}),t}(o);t.AudioStreamFormatImpl=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(2),o=r(65),s=function(){function e(){}return e.prototype.setCommonUrlParams=function(e,t,r){this.setUrlParameter(i.PropertyId.SpeechServiceConnection_EnableAudioLogging,o.QueryParameterNames.EnableAudioLogging,e,t,r),this.setUrlParameter(i.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,o.QueryParameterNames.EnableWordLevelTimestamps,e,t,r),this.setUrlParameter(i.PropertyId.SpeechServiceResponse_ProfanityOption,o.QueryParameterNames.Profanify,e,t,r),this.setUrlParameter(i.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,o.QueryParameterNames.InitialSilenceTimeoutMs,e,t,r),this.setUrlParameter(i.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,o.QueryParameterNames.EndSilenceTimeoutMs,e,t,r),this.setUrlParameter(i.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,o.QueryParameterNames.StableIntermediateThreshold,e,t,r);var s=JSON.parse(e.parameters.getProperty(n.ServicePropertiesPropertyName,"{}"));Object.keys(s).forEach((function(e,r,n){t[e]=s[e]}))},e.prototype.setUrlParameter=function(e,t,r,n,i){var o=r.parameters.getProperty(e,void 0);!o||i&&-1!==i.search(t)||(n[t]=o.toLocaleLowerCase())},e}();t.ConnectionFactoryBase=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e,"TestHooksParamName",{get:function(){return"testhooks"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ConnectionIdHeader",{get:function(){return"X-ConnectionId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DeploymentIdParamName",{get:function(){return"cid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FormatParamName",{get:function(){return"format"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LanguageParamName",{get:function(){return"language"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"TranslationFromParamName",{get:function(){return"from"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"TranslationToParamName",{get:function(){return"to"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Profanify",{get:function(){return"profanity"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EnableAudioLogging",{get:function(){return"storeAudio"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EnableWordLevelTimestamps",{get:function(){return"wordLevelTimestamps"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"InitialSilenceTimeoutMs",{get:function(){return"initialSilenceTimeoutMs"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EndSilenceTimeoutMs",{get:function(){return"endSilenceTimeoutMs"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"StableIntermediateThreshold",{get:function(){return"stableIntermediateThreshold"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"StableTranslation",{get:function(){return"stableTranslation"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EnableLanguageID",{get:function(){return"lidEnabled"},enumerable:!0,configurable:!0}),e}();t.QueryParameterNames=n},function(e,t){e.exports={}},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return R}));var n=r(482),i=r(7),o=r(17),s=r(480),a=r(4),c=r(61);class p{}p.workerTimers=null,p.clearTimeout=e=>p.timers().clearTimeout(e),p.setTimeout=(e,t)=>p.timers().setTimeout(e,t),p.load=e=>{const t=new Map([[0,()=>{}]]),r=new Map,n=new Worker(e);n.addEventListener("message",({data:e})=>{if(p.isCallNotification(e)){const{params:{timerId:n}}=e,i=t.get(n);if("number"==typeof i){const e=r.get(i);if(void 0===e||e!==n)throw new Error("The timer is in an undefined state.")}else{if(void 0===i)throw new Error("The timer is in an undefined state.");i(),t.delete(n)}}else{if(!p.isClearResponse(e)){const{error:{message:t}}=e;throw new Error(t)}{const{id:n}=e,i=r.get(n);if(void 0===i)throw new Error("The timer is in an undefined state.");r.delete(n),t.delete(i)}}});return{clearTimeout:e=>{const i=Math.random();r.set(i,e),t.set(e,i),n.postMessage({id:i,method:"clear",params:{timerId:e}})},setTimeout:(e,r)=>{const i=Math.random();return t.set(i,e),n.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:i}}),i}}},p.loadWorkerTimers=()=>()=>{if(null!==p.workerTimers)return p.workerTimers;const e=new Blob(['!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error(\'There is no interval scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error(\'The given method "\'.concat(e.method,\'" is not supported\'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);'],{type:"application/javascript; charset=utf-8"}),t=URL.createObjectURL(e);return p.workerTimers=p.load(t),p.workerTimers.setTimeout(()=>URL.revokeObjectURL(t),0),p.workerTimers},p.timers=p.loadWorkerTimers(),p.isCallNotification=e=>void 0!==e.method&&"call"===e.method,p.isClearResponse=e=>null===e.error&&"number"==typeof e.id;var u=r(224),h=r(18),v=r(58),l=r(36),d=r(20),f=r(78),g=r(3),y=r(171),m=r(214),S=r(172),C=r(173),b=r(122),P=r(16);class R{constructor(e,t,r,n,u){if(this.privSetTimeout=setTimeout,this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.sendTelemetryData=()=>{const e=this.privRequestSession.getTelemetry();if(!0!==R.telemetryDataEnabled||this.privIsDisposed||null===e)return i.c.fromResult(!0);if(R.telemetryData)try{R.telemetryData(e)}catch(e){}return this.fetchConnection().onSuccessContinueWith(t=>t.send(new P.a(o.b.Text,"telemetry",this.privRequestSession.requestId,"application/json",e)))},this.receiveMessageOverride=void 0,this.receiveMessage=()=>this.fetchConnection().on(e=>e.read().onSuccessContinueWithPromise(e=>{if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(this.privIsDisposed)return i.c.fromResult(void 0);if(!e)return this.privRequestSession.isRecognizing?this.receiveMessage():i.c.fromResult(!0);this.privServiceHasSentMessage=!0;const t=P.a.fromConnectionMessage(e);if(t.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(t.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const e=y.a.fromJSON(t.textBody),r=new v.a(e.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,r);break;case"speech.enddetected":let n;n=t.textBody.length>0?t.textBody:"{ Offset: 0 }";const o=y.a.fromJSON(n);this.privRecognizerConfig.isContinuousRecognition&&this.privRequestSession.onServiceRecognized(o.Offset+this.privRequestSession.currentTurnAudioOffset);const a=new v.a(o.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,a);break;case"turn.end":this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,this.cancelRecognitionLocal(l.a.EndOfStream,d.a.NoError,void 0));const c=new f.a(this.privRequestSession.sessionId);if(this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)return this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,c),i.c.fromResult(!0);this.fetchConnection().onSuccessContinueWith(e=>{this.sendSpeechContext(e),this.sendWaveHeader(e)});break;default:this.processTypeSpecificMessages(t)||this.privServiceEvents&&this.serviceEvents.onEvent(new s.h(t.path.toLowerCase(),t.textBody))}return this.receiveMessage()}),e=>{}),this.sendSpeechContext=e=>{const t=this.speechContext.toJSON();return t?e.send(new P.a(o.b.Text,"speech.context",this.privRequestSession.requestId,"application/json",t)):i.c.fromResult(!0)},this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.fetchConnectionOverride=void 0,this.sendSpeechServiceConfig=(e,t,r)=>{if(!0!==R.telemetryDataEnabled){const e={context:{system:JSON.parse(r).context.system}};r=JSON.stringify(e)}return r?e.send(new P.a(o.b.Text,"speech.config",t.requestId,"application/json",r)):i.c.fromResult(!0)},this.sendAudio=e=>this.audioSource.format.onSuccessContinueWithPromise(t=>{const r=new i.a;let n=Date.now();const s=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),a=t.avgBytesPerSec/1e3*parseInt(s,10),c=this.privRequestSession.recogNumber,p=()=>{this.privIsDisposed||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing||this.privRequestSession.recogNumber!==c||this.fetchConnection().on(i=>{e.read().on(e=>{if(this.privRequestSession.isSpeechEnded)return void r.resolve(!0);let s,c;!e||e.isEnd?(s=null,c=0):(s=e.buffer,this.privRequestSession.onAudioSent(s.byteLength),c=a>=this.privRequestSession.bytesSent?0:Math.max(0,n-Date.now())),this.privSetTimeout(()=>{var a;null!==s&&(n=Date.now()+1e3*s.byteLength/(2*t.avgBytesPerSec));const c=i.send(new P.a(o.b.Binary,"audio",this.privRequestSession.requestId,null,s));(null===(a=e)||void 0===a?void 0:a.isEnd)?(this.privRequestSession.onSpeechEnded(),r.resolve(!0)):c.continueWith(e=>{p()})},c)},e=>{this.privRequestSession.isSpeechEnded?r.resolve(!0):r.reject(e)})},e=>{r.reject(e)})};return p(),r.promise()}),this.fetchConnection=()=>void 0!==this.fetchConnectionOverride?this.fetchConnectionOverride():this.configureConnection(),!e)throw new a.a("authentication");if(!t)throw new a.a("connectionFactory");if(!r)throw new a.a("audioSource");if(!n)throw new a.a("recognizerConfig");this.privMustReportEndOfStream=!1,this.privAuthentication=e,this.privConnectionFactory=t,this.privAudioSource=r,this.privRecognizerConfig=n,this.privIsDisposed=!1,this.privRecognizer=u,this.privRequestSession=new m.a(this.privAudioSource.id()),this.privConnectionEvents=new c.a,this.privServiceEvents=new c.a,this.privDynamicGrammar=new S.a,this.privSpeechContext=new C.a(this.privDynamicGrammar),this.privAgentConfig=new b.a,"undefined"!=typeof Blob&&"undefined"!=typeof Worker&&(this.privSetTimeout=p.setTimeout)}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(e){this.privRecognizerConfig.parameters.setProperty(g.a.ConversationTranslator_Token,e)}isDisposed(){return this.privIsDisposed}dispose(e){this.privIsDisposed=!0,this.privConnectionConfigurationPromise&&this.privConnectionConfigurationPromise.onSuccessContinueWith(t=>{t.dispose(e)})}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}recognize(e,t,r){return void 0!==this.recognizeOverride?this.recognizeOverride(e,t,r):(this.privConnectionConfigurationPromise=null,this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=t,this.privErrorCallback=r,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events),this.connectImpl(),this.audioSource.attach(this.privRequestSession.audioNodeId).onSuccessContinueWithPromise(e=>{let t;return this.audioSource.format.onSuccessContinueWithPromise(r=>(t=new n.a(e,r.avgBytesPerSec),this.privRequestSession.onAudioSourceAttachCompleted(t,!1),this.audioSource.deviceInfo.onSuccessContinueWithPromise(e=>(this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:e},this.configureConnection().continueWithPromise(e=>{if(e.isError)return this.cancelRecognitionLocal(l.a.Error,d.a.ConnectionFailure,e.error),i.c.fromError(e.error);const r=new f.a(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,r);this.receiveMessage();return this.sendAudio(t).on(e=>{},e=>{this.cancelRecognitionLocal(l.a.Error,d.a.RuntimeError,e)}),i.c.fromResult(!0)})))))}))}stopRecognizing(){return this.privRequestSession.isRecognizing?(this.audioSource.turnOff(),this.sendFinalAudio().onSuccessContinueWithPromise(e=>(this.privRequestSession.onStopRecognizing(),this.privRequestSession.turnCompletionPromise.onSuccessContinueWith(e=>(this.privRequestSession.onStopRecognizing(),this.privRequestSession.dispose(),!0))))):i.c.fromResult(!0)}connect(){this.connectImpl().result()}connectAsync(e,t){this.connectImpl().continueWith(r=>{try{r.isError?t&&t(r.error):r.isCompleted&&e&&e()}catch(e){t&&t(e)}})}disconnect(){void 0===this.disconnectOverride?(this.cancelRecognitionLocal(l.a.Error,d.a.NoError,"Disconnecting"),this.privConnectionPromise.result().isCompleted?this.privConnectionPromise.result().isError||(this.privConnectionPromise.result().result.dispose(),this.privConnectionPromise=null):this.privConnectionPromise.onSuccessContinueWith(e=>{e.dispose()})):this.disconnectOverride()}disconnectAsync(e,t){try{if(void 0!==this.disconnectOverride)return this.disconnectOverride(),void(e&&e());this.cancelRecognitionLocal(l.a.Error,d.a.NoError,"Disconnecting"),this.privConnectionPromise.continueWith(r=>{try{r.isError?t&&t(r.error):r.isCompleted&&(r.result.dispose(),e&&e())}catch(e){t&&t(e)}})}catch(e){t&&t(e)}}sendMessage(e){}sendNetworkMessage(e,t,r,n){const i="string"==typeof t?o.b.Text:o.b.Binary,s="string"==typeof t?"application/json":"";this.fetchConnection().on(o=>{o.send(new P.a(i,e,this.privRequestSession.requestId,s,t)).on(()=>{r&&r()},e=>{n&&n(e)})},e=>{n&&n(e)})}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}cancelRecognitionLocal(e,t,r){this.privRequestSession.isRecognizing&&(this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,t,r))}sendWaveHeader(e){return this.audioSource.format.onSuccessContinueWithPromise(t=>e.send(new P.a(o.b.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",t.header)))}connectImpl(e=!1){if(void 0!==this.connectImplOverride)return this.connectImplOverride(e);if(this.privConnectionPromise)return this.privConnectionPromise.result().isCompleted&&(this.privConnectionPromise.result().isError||this.privConnectionPromise.result().result.state()===u.a.Disconnected)&&!0===this.privServiceHasSentMessage?(this.privConnectionId=null,this.privConnectionPromise=null,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise;this.privAuthFetchEventId=Object(h.b)(),this.privConnectionId=Object(h.b)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);const t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=t.continueWithPromise(t=>{if(t.isError)throw this.privRequestSession.onAuthCompleted(!0,t.error),new Error(t.error);this.privRequestSession.onAuthCompleted(!1);const r=this.privConnectionFactory.create(this.privRecognizerConfig,t.result,this.privConnectionId);return this.privRequestSession.listenForServiceTelemetry(r.events),r.events.attach(e=>{this.connectionEvents.onEvent(e)}),r.open().onSuccessContinueWithPromise(t=>200===t.statusCode?(this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId),this.privRequestSession.onConnectionEstablishCompleted(t.statusCode),i.c.fromResult(r)):403!==t.statusCode||e?(this.privRequestSession.onConnectionEstablishCompleted(t.statusCode,t.reason),i.c.fromError(`Unable to contact server. StatusCode: ${t.statusCode}, ${this.privRecognizerConfig.parameters.getProperty(g.a.SpeechServiceConnection_Endpoint)} Reason: ${t.reason}`)):this.connectImpl(!0))}),this.privConnectionPromise}writeBufferToConsole(e){let t="Buffer Size: ";if(null===e)t+="null";else{const r=new Uint8Array(e);t+=e.byteLength+"\r\n";for(let n=0;n<e.byteLength;n++)t+=r[n].toString(16).padStart(2,"0")+" "}console.info(t)}sendFinalAudio(){const e=new i.a;return this.fetchConnection().on(t=>{t.send(new P.a(o.b.Binary,"audio",this.privRequestSession.requestId,null,null)).on(t=>{e.resolve(!0)},t=>{e.reject(t)})},t=>{e.reject(t)}),e.promise()}configureConnection(){return void 0!==this.configConnectionOverride?this.configConnectionOverride():this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.result().isCompleted&&(this.privConnectionConfigurationPromise.result().isError||this.privConnectionConfigurationPromise.result().result.state()===u.a.Disconnected)?(this.privConnectionConfigurationPromise=null,this.configureConnection()):this.privConnectionConfigurationPromise:(this.privConnectionConfigurationPromise=this.connectImpl().onSuccessContinueWithPromise(e=>this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()).onSuccessContinueWithPromise(t=>this.sendSpeechContext(e).onSuccessContinueWithPromise(t=>this.sendWaveHeader(e).onSuccessContinueWith(t=>e)))),this.privConnectionConfigurationPromise)}}R.telemetryDataEnabled=!0},function(e,t){},function(e,t,r){var n=r(24),i=r(40),o=r(33),s=r(94),a=r(140),c=r(71),p=c.get,u=c.enforce,h=String(String).split("String");(e.exports=function(e,t,r,a){var c=!!a&&!!a.unsafe,p=!!a&&!!a.enumerable,v=!!a&&!!a.noTargetGet;"function"==typeof r&&("string"!=typeof t||o(r,"name")||i(r,"name",t),u(r).source=h.join("string"==typeof t?t:"")),e!==n?(c?!v&&e[t]&&(p=!0):delete e[t],p?e[t]=r:i(e,t,r)):p?e[t]=r:s(t,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&p(this).source||a(this)}))},function(e,t,r){var n,i,o,s=r(233),a=r(24),c=r(52),p=r(40),u=r(33),h=r(95),v=r(97),l=a.WeakMap;if(s){var d=new l,f=d.get,g=d.has,y=d.set;n=function(e,t){return y.call(d,e,t),t},i=function(e){return f.call(d,e)||{}},o=function(e){return g.call(d,e)}}else{var m=h("state");v[m]=!0,n=function(e,t){return p(e,m,t),t},i=function(e){return u(e,m)?e[m]:{}},o=function(e){return u(e,m)}}e.exports={set:n,get:i,has:o,enforce:function(e){return o(e)?i(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!c(t)||(r=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}}},function(e,t,r){var n=r(24);e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(45);!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(t.EventType||(t.EventType={}));var i=function(){function e(e,t){this.privName=e,this.privEventId=n.createNoDashGuid(),this.privEventTime=(new Date).toISOString(),this.privEventType=t,this.privMetadata={}}return Object.defineProperty(e.prototype,"name",{get:function(){return this.privName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventId",{get:function(){return this.privEventId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventTime",{get:function(){return this.privEventTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventType",{get:function(){return this.privEventType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.privMetadata},enumerable:!0,configurable:!0}),e}();t.PlatformEvent=i},function(e,t,r){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var n=r(257),i=r(258),o=r(259);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,r){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return p(this,e,t,r)}function p(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=v(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!c.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|d(t,r),i=(e=a(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(c.isBuffer(t)){var r=0|l(t.length);return 0===(e=a(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?a(e,0):v(e,t);if("Buffer"===t.type&&o(t.data))return v(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(u(t),e=a(e,t<0?0:0|l(t)),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function v(e,t){var r=t.length<0?0:0|l(t.length);e=a(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function l(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function d(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return U(e).length;default:if(n)return F(e).length;t=(""+t).toLowerCase(),n=!0}}function f(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return O(this,t,r);case"latin1":case"binary":return T(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function y(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,r,n,i){var o,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function p(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var u=-1;for(o=r;o<a;o++)if(p(e,o)===p(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===c)return u*s}else-1!==u&&(o-=o-u),u=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){for(var h=!0,v=0;v<c;v++)if(p(e,o+v)!==p(t,v)){h=!1;break}if(h)return o}return-1}function S(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function C(e,t,r,n){return q(F(t,e.length-r),e,r,n)}function b(e,t,r,n){return q(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function P(e,t,r,n){return b(e,t,r,n)}function R(e,t,r,n){return q(U(t),e,r,n)}function w(e,t,r,n){return q(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function I(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function E(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,c,p=e[i],u=null,h=p>239?4:p>223?3:p>191?2:1;if(i+h<=r)switch(h){case 1:p<128&&(u=p);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&p)<<6|63&o)>127&&(u=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&p)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&p)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(u=c)}null===u?(u=65533,h=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,r){return p(null,e,t,r)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,r){return function(e,t,r,n){return u(t),t<=0?a(e,t):void 0!==r?"string"==typeof n?a(e,t).fill(r,n):a(e,t).fill(r):a(e,t)}(null,e,t,r)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=c.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):f.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,r,n,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(o,s),p=this.slice(n,i),u=e.slice(t,r),h=0;h<a;++h)if(p[h]!==u[h]){o=p[h],s=u[h];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return S(this,e,t,r);case"utf8":case"utf-8":return C(this,e,t,r);case"ascii":return b(this,e,t,r);case"latin1":case"binary":return P(this,e,t,r);case"base64":return R(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function O(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function T(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function A(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=B(e[o]);return i}function D(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function _(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,n,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function x(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function k(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function j(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function z(e,t,r,n,o){return o||j(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function N(e,t,r,n,o){return o||j(e,0,r,8),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;r=new c(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},c.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||_(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},c.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||_(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUInt8=function(e,t){return t||_(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||_(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||_(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||_(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||_(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||_(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||_(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||_(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||_(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){t||_(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return t||_(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||_(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||_(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||_(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||_(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||_(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},c.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):k(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);M(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);M(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):k(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,r){return z(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return z(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return N(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return N(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=c.isBuffer(e)?e:F(new c(e,n).toString()),a=s.length;for(o=0;o<r-t;++o)this[o+t]=s[o%a]}return this};var L=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function U(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}).call(this,r(91))},function(e,t,r){"use strict";var n,i,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,a=r(104),c=r(63);!function(e){e[e.PCM=1]="PCM",e[e.MuLaw=2]="MuLaw",e[e.Siren=3]="Siren",e[e.MP3=4]="MP3",e[e.SILKSkype=5]="SILKSkype",e[e.Opus=6]="Opus"}(s=t.AudioFormatTag||(t.AudioFormatTag={}));var p=function(e){function t(t,r,n,i,o,s,a,c,p){var u=e.call(this,n,s,r)||this;return u.formatTag=t,u.avgBytesPerSec=i,u.blockAlign=o,u.priAudioFormatString=a,u.priRequestAudioFormatString=c,u.priHasHeader=p,u}return o(t,e),t.fromSpeechSynthesisOutputFormat=function(e){return void 0===e?t.getDefaultOutputFormat():t.fromSpeechSynthesisOutputFormatString(t.SpeechSynthesisOutputFormatToString[e])},t.fromSpeechSynthesisOutputFormatString=function(e){switch(e){case"raw-8khz-8bit-mono-mulaw":return new t(s.PCM,1,8e3,8e3,1,8,e,e,!1);case"riff-16khz-16kbps-mono-siren":return new t(s.Siren,1,16e3,2e3,40,0,e,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new t(s.Siren,1,16e3,2e3,40,0,e,e,!1);case"audio-16khz-32kbitrate-mono-mp3":return new t(s.MP3,1,16e3,4096,2,16,e,e,!1);case"audio-16khz-128kbitrate-mono-mp3":return new t(s.MP3,1,16e3,16384,2,16,e,e,!1);case"audio-16khz-64kbitrate-mono-mp3":return new t(s.MP3,1,16e3,8192,2,16,e,e,!1);case"audio-24khz-48kbitrate-mono-mp3":return new t(s.MP3,1,16e3,6144,2,16,e,e,!1);case"audio-24khz-96kbitrate-mono-mp3":return new t(s.MP3,1,16e3,12288,2,16,e,e,!1);case"audio-24khz-160kbitrate-mono-mp3":return new t(s.MP3,1,16e3,20480,2,16,e,e,!1);case"raw-16khz-16bit-mono-truesilk":return new t(s.SILKSkype,1,16e3,32e3,2,16,e,e,!1);case"riff-8khz-16bit-mono-pcm":return new t(s.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new t(s.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new t(s.MuLaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new t(s.PCM,1,16e3,32e3,2,16,e,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new t(s.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new t(s.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new t(s.Opus,1,16e3,8192,2,16,e,"ogg-16khz-16bit-mono-opus",!1);case"ogg-24khz-16bit-mono-opus":return new t(s.Opus,1,24e3,8192,2,16,e,"ogg-24khz-16bit-mono-opus",!1);case"riff-16khz-16bit-mono-pcm":default:return new t(s.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}},t.getDefaultOutputFormat=function(){return t.fromSpeechSynthesisOutputFormatString("undefined"!=typeof window?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")},Object.defineProperty(t.prototype,"hasHeader",{get:function(){return this.priHasHeader},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){if(this.hasHeader)return this.privHeader},enumerable:!0,configurable:!0}),t.prototype.updateHeader=function(e){this.priHasHeader&&new DataView(this.privHeader).setUint32(40,e,!0)},Object.defineProperty(t.prototype,"requestAudioFormatString",{get:function(){return this.priRequestAudioFormatString},enumerable:!0,configurable:!0}),t.SpeechSynthesisOutputFormatToString=((i={})[a.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]="raw-8khz-8bit-mono-mulaw",i[a.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]="riff-16khz-16kbps-mono-siren",i[a.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]="audio-16khz-16kbps-mono-siren",i[a.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]="audio-16khz-32kbitrate-mono-mp3",i[a.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]="audio-16khz-128kbitrate-mono-mp3",i[a.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]="audio-16khz-64kbitrate-mono-mp3",i[a.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]="audio-24khz-48kbitrate-mono-mp3",i[a.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]="audio-24khz-96kbitrate-mono-mp3",i[a.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]="audio-24khz-160kbitrate-mono-mp3",i[a.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]="raw-16khz-16bit-mono-truesilk",i[a.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]="riff-16khz-16bit-mono-pcm",i[a.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]="riff-8khz-16bit-mono-pcm",i[a.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]="riff-24khz-16bit-mono-pcm",i[a.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]="riff-8khz-8bit-mono-mulaw",i[a.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]="raw-16khz-16bit-mono-pcm",i[a.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]="raw-24khz-16bit-mono-pcm",i[a.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]="raw-8khz-16bit-mono-pcm",i[a.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]="ogg-16khz-16bit-mono-opus",i[a.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]="ogg-24khz-16bit-mono-opus",i),t}(c.AudioStreamFormatImpl);t.AudioOutputFormatImpl=p},function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(7),i=r(480),o=r(17),s=r(4),a=r(61),c=r(224),p=r(18),u=r(56),h=r(57),v=r(12),l=r(120),d=r(36),f=r(20),g=r(23),y=r(3),m=r(119),S=r(131),C=r(121),b=r(122),P=r(1),R=r(16);class w{constructor(e,t,r,c,p){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.fetchConnectionOverride=void 0,this.receiveMessage=()=>this.fetchConnection().on(e=>e.read().onSuccessContinueWithPromise(e=>{if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(this.privIsDisposed)return n.c.fromResult(void 0);if(!e)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():n.c.fromResult(!0);this.privServiceHasSentMessage=!0;const t=R.a.fromConnectionMessage(e);if(t.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(t.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse();break;case"response":this.privSynthesisTurn.onServiceResponseMessage(t.textBody);break;case"audio":if(this.privSynthesisTurn.streamId.toLowerCase()===t.streamId.toLowerCase()&&t.binaryBody){if(this.privSynthesisTurn.onAudioChunkReceived(t.binaryBody),this.privSpeechSynthesizer.synthesizing)try{const e=w.addHeader(t.binaryBody,this.privSynthesisTurn.audioOutputFormat),r=new u.a(new h.a(this.privSynthesisTurn.requestId,v.a.SynthesizingAudio,e));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,r)}catch(e){}void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.write(t.binaryBody)}break;case"audio.metadata":const e=m.a.fromJSON(t.textBody).Metadata;for(const t of e)if(t.Type.toLowerCase()==="WordBoundary".toLowerCase()){this.privSynthesisTurn.onWordBoundaryEvent(t.Data.text.Text);const e=new l.a(t.Data.Offset,t.Data.text.Text,t.Data.text.Length,this.privSynthesisTurn.currentTextOffset);if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,e)}catch(e){}}break;case"turn.end":let r;this.privSynthesisTurn.onServiceTurnEndResponse();try{r=new h.a(this.privSynthesisTurn.requestId,v.a.SynthesizingAudioCompleted,this.privSynthesisTurn.allReceivedAudioWithHeader),this.privSuccessCallback&&this.privSuccessCallback(r)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new u.a(r))}catch(e){}break;default:this.processTypeSpecificMessages(t)||this.privServiceEvents&&this.serviceEvents.onEvent(new i.h(t.path.toLowerCase(),t.textBody))}return this.receiveMessage()}),e=>{}),this.sendSynthesisContext=e=>{const t=this.synthesisContext.toJSON();return t?e.send(new R.a(o.b.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",t)):n.c.fromResult(!0)},this.sendSpeechServiceConfig=(e,t)=>t?e.send(new R.a(o.b.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",t)):n.c.fromResult(!0),this.sendSsmlMessage=(e,t,r)=>e.send(new R.a(o.b.Text,"ssml",r,"application/ssml+xml",t)),this.fetchConnection=()=>void 0!==this.fetchConnectionOverride?this.fetchConnectionOverride():this.configureConnection(),!e)throw new s.a("authentication");if(!t)throw new s.a("connectionFactory");if(!r)throw new s.a("synthesizerConfig");this.privAuthentication=e,this.privConnectionFactory=t,this.privSynthesizerConfig=r,this.privIsDisposed=!1,this.privSpeechSynthesizer=c,this.privSessionAudioDestination=p,this.privSynthesisTurn=new S.a,this.privConnectionEvents=new a.a,this.privServiceEvents=new a.a,this.privSynthesisContext=new C.a(this.privSpeechSynthesizer),this.privAgentConfig=new b.a,this.connectionEvents.attach(e=>{if("ConnectionClosedEvent"===e.name){const t=e;this.cancelSynthesisLocal(d.a.Error,1007===t.statusCode?f.a.BadRequestParameters:f.a.ConnectionFailure,t.reason+" websocket error code: "+t.statusCode)}})}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(e){this.privAudioOutputFormat=e,this.privSynthesisTurn.audioOutputFormat=e,void 0!==this.privSessionAudioDestination&&(this.privSessionAudioDestination.format=e),void 0!==this.synthesisContext&&(this.synthesisContext.audioOutputFormat=e)}static addHeader(e,t){if(!t.hasHeader)return e;t.updateHeader(e.byteLength);const r=new Uint8Array(e.byteLength+t.header.byteLength);return r.set(new Uint8Array(t.header),0),r.set(new Uint8Array(e),t.header.byteLength),r.buffer}isDisposed(){return this.privIsDisposed}dispose(e){this.privIsDisposed=!0,void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise&&this.privConnectionConfigurationPromise.onSuccessContinueWith(t=>{t.dispose(e)})}connect(){this.connectImpl().result()}connectAsync(e,t){this.connectImpl().continueWith(r=>{try{r.isError?t&&t(r.error):r.isCompleted&&e&&e()}catch(e){t&&t(e)}})}sendNetworkMessage(e,t,r,n){const i="string"==typeof t?o.b.Text:o.b.Binary,s="string"==typeof t?"application/json":"";this.fetchConnection().on(o=>{o.send(new R.a(i,e,this.privSynthesisTurn.requestId,s,t)).on(()=>{r&&r()},e=>{n&&n(e)})},e=>{n&&n(e)})}Speak(e,t,r,i,o,s){let a;return a=t?e:this.privSpeechSynthesizer.buildSsml(e),void 0!==this.speakOverride?this.speakOverride(a,r,i,o):(this.privSuccessCallback=i,this.privErrorCallback=o,this.privSynthesisTurn.startNewSynthesis(r,e,t,s),this.fetchConnection().continueWithPromise(e=>e.isError?(this.cancelSynthesisLocal(d.a.Error,f.a.ConnectionFailure,e.error),n.c.fromError(e.error)):this.sendSynthesisContext(e.result).continueWithPromise(t=>t.isError?(this.cancelSynthesisLocal(d.a.Error,f.a.ConnectionFailure,t.error),n.c.fromError(t.error)):this.sendSsmlMessage(e.result,a,r).continueWithPromise(e=>{if(e.isError)return this.cancelSynthesisLocal(d.a.Error,f.a.ConnectionFailure,e.error),n.c.fromError(e.error);const t=new u.a(new h.a(r,v.a.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,t);this.receiveMessage();return n.c.fromResult(!0)}))))}cancelSynthesis(e,t,r,n){const i=new g.a;i.setProperty(P.b,f.a[r]);const o=new h.a(e,v.a.Canceled,void 0,n,i);if(this.privSpeechSynthesizer.SynthesisCanceled){const e=new u.a(o);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,e)}catch(e){}}if(this.privSuccessCallback)try{this.privSuccessCallback(o)}catch(e){}}cancelSynthesisLocal(e,t,r){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,e,t,r))}processTypeSpecificMessages(e,t,r){return!0}connectImpl(e=!1){if(void 0!==this.connectImplOverride)return this.connectImplOverride(e);if(this.privConnectionPromise)return this.privConnectionPromise.result().isCompleted&&(this.privConnectionPromise.result().isError||this.privConnectionPromise.result().result.state()===c.a.Disconnected)&&!0===this.privServiceHasSentMessage?(this.privConnectionId=null,this.privConnectionPromise=null,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise;this.privAuthFetchEventId=Object(p.b)(),this.privConnectionId=Object(p.b)(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);const t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=t.continueWithPromise(t=>{if(t.isError)throw this.privSynthesisTurn.onAuthCompleted(!0,t.error),new Error(t.error);this.privSynthesisTurn.onAuthCompleted(!1);const r=this.privConnectionFactory.create(this.privSynthesizerConfig,t.result,this.privConnectionId);return r.events.attach(e=>{this.connectionEvents.onEvent(e)}),r.open().onSuccessContinueWithPromise(t=>200===t.statusCode?(this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId),this.privSynthesisTurn.onConnectionEstablishCompleted(t.statusCode),n.c.fromResult(r)):403!==t.statusCode||e?(this.privSynthesisTurn.onConnectionEstablishCompleted(t.statusCode,t.reason),n.c.fromError(`Unable to contact server. StatusCode: ${t.statusCode}, ${this.privSynthesizerConfig.parameters.getProperty(y.a.SpeechServiceConnection_Endpoint)} Reason: ${t.reason}`)):this.connectImpl(!0))}),this.privConnectionPromise}configureConnection(){return void 0!==this.configConnectionOverride?this.configConnectionOverride():this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.result().isCompleted&&(this.privConnectionConfigurationPromise.result().isError||this.privConnectionConfigurationPromise.result().result.state()===c.a.Disconnected)?(this.privConnectionConfigurationPromise=null,this.configureConnection()):this.privConnectionConfigurationPromise:(this.privConnectionConfigurationPromise=this.connectImpl().onSuccessContinueWithPromise(e=>this.sendSpeechServiceConfig(e,this.privSynthesizerConfig.SpeechServiceConfig.serialize()).onSuccessContinueWith(t=>e)),this.privConnectionConfigurationPromise)}}w.telemetryDataEnabled=!0},function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(89),i=r(88),o=r(1),s=r(3),a=r(59),c=r(34),p=r(31),u=r(60),h=r(14);class v extends c.a{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.create=(e,t,r)=>{let c=e.parameters.getProperty(s.a.SpeechServiceConnection_Endpoint,void 0);const v=e.parameters.getProperty(s.a.SpeechServiceConnection_Region,void 0),l=v&&v.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",d=e.parameters.getProperty(s.a.SpeechServiceConnection_Host,"wss://"+v+".stt.speech"+l),f={},g=e.parameters.getProperty(s.a.SpeechServiceConnection_EndpointId,void 0),y=e.parameters.getProperty(s.a.SpeechServiceConnection_RecoLanguage,void 0);if(g?c&&-1!==c.search(h.a.DeploymentIdParamName)||(f[h.a.DeploymentIdParamName]=g):y&&(c&&-1!==c.search(h.a.LanguageParamName)||(f[h.a.LanguageParamName]=y)),c&&-1!==c.search(h.a.FormatParamName)||(f[h.a.FormatParamName]=e.parameters.getProperty(o.d,a.a[a.a.Simple]).toLowerCase()),void 0!==e.autoDetectSourceLanguages&&(f[h.a.EnableLanguageID]="true"),this.setCommonUrlParams(e,f,c),!c)switch(e.recognitionMode){case p.c.Conversation:c="true"===e.parameters.getProperty(o.c,"false")?d+this.dictationRelativeUri:d+this.conversationRelativeUri;break;case p.c.Dictation:c=d+this.dictationRelativeUri;break;default:c=d+this.interactiveRelativeUri}const m={};return void 0!==t.token&&""!==t.token&&(m[t.headerName]=t.token),m[h.a.ConnectionIdHeader]=r,e.parameters.setProperty(s.a.SpeechServiceConnection_Url,c),new n.a(c,f,m,new u.a,i.a.fromRecognizerConfig(e),r)}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){this.privSessionId=e}get sessionId(){return this.privSessionId}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(58);class i extends n.a{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(58);class i extends n.a{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(78);class i extends n.a{constructor(e,t){super(t),this.privResult=e}get result(){return this.privResult}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t){this.privReason=e,this.privAudio=t}get audio(){return this.privAudio}get reason(){return this.privReason}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){this.privSpeechHypothesis=JSON.parse(e)}static fromJSON(e){return new n(e)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(13);class i{constructor(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=n.a[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new i(e)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(13),i=r(67);class o{constructor(e){this.privTranslationPhrase=JSON.parse(e),this.privTranslationPhrase.RecognitionStatus=n.a[this.privTranslationPhrase.RecognitionStatus],void 0!==this.privTranslationPhrase.Translation&&(this.privTranslationPhrase.Translation.TranslationStatus=i.a[this.privTranslationPhrase.Translation.TranslationStatus])}static fromJSON(e){return new o(e)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Translation(){return this.privTranslationPhrase.Translation}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t,r,n,i){this.privCancelReason=t,this.privErrorDetails=r,this.privResult=i,this.privSessionId=e,this.privErrorCode=n}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{static get requestOptions(){return n.privDefaultRequestOptions}static get configParams(){return n.privDefaultParams}static get restErrors(){return n.privRestErrors}}n.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},n.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},n.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3);class i{constructor(e,t,r,n){this.privProxyHostName=e,this.privProxyPort=t,this.privProxyUserName=r,this.privProxyPassword=n}static fromParameters(e){return new i(e.getProperty(n.a.SpeechServiceConnection_ProxyHostName),parseInt(e.getProperty(n.a.SpeechServiceConnection_ProxyPort),10),e.getProperty(n.a.SpeechServiceConnection_ProxyUserName),e.getProperty(n.a.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(e){return this.fromParameters(e.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(4),i=r(18),o=r(224),s=r(7),a=r(132);class c{constructor(e,t){this.privStatusCode=e,this.privReason=t}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}}var p=r(480),u=r(225),h=r(17),v=r(133),l=r(61),d=r(216),f=r.n(d),g=r(217);class y{constructor(e,t,r,i,d){if(this.open=()=>{if(this.privConnectionState===o.a.Disconnected)return s.c.fromError(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise();this.privConnectionEstablishDeferral=new s.a,this.privCertificateValidatedDeferral=new s.a,this.privConnectionState=o.a.Connecting;try{if("undefined"==typeof WebSocket||y.forceNpmWebSocket){const e={headers:this.privHeaders};this.privCertificateValidatedDeferral.resolve(!0);const t=new g.a(this.proxyInfo);e.agent=t.GetAgent(),this.privWebsocketClient=new f.a(this.privUri,e)}else this.privCertificateValidatedDeferral.resolve(!0),this.privWebsocketClient=new WebSocket(this.privUri);this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new a.a,this.privDisconnectDeferral=new s.a,this.privSendMessageQueue=new a.a,this.processSendQueue()}catch(e){return this.privConnectionEstablishDeferral.resolve(new c(500,e)),this.privConnectionEstablishDeferral.promise()}return this.onEvent(new p.g(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=e=>{this.privCertificateValidatedDeferral.promise().on(()=>{this.privConnectionState=o.a.Connected,this.onEvent(new p.d(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new c(200,""))},e=>{this.privConnectionEstablishDeferral.reject(e)})},this.privWebsocketClient.onerror=e=>{this.onEvent(new p.b(this.privConnectionId,e.message,e.type)),this.privLastErrorReceived=e.message},this.privWebsocketClient.onclose=e=>{this.privConnectionState===o.a.Connecting?(this.privConnectionState=o.a.Disconnected,this.privConnectionEstablishDeferral.resolve(new c(e.code,e.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=o.a.Disconnected,this.onEvent(new p.a(this.privConnectionId,e.code,e.reason))),this.onClose(e.code,e.reason)},this.privWebsocketClient.onmessage=e=>{const t=(new Date).toISOString();if(this.privConnectionState===o.a.Connected){const r=new s.a;if(this.privReceivingMessageQueue.enqueueFromPromise(r.promise()),e.data instanceof ArrayBuffer){const n=new u.a(h.b.Binary,e.data);this.privMessageFormatter.toConnectionMessage(n).on(e=>{this.onEvent(new p.e(this.privConnectionId,t,e)),r.resolve(e)},e=>{r.reject("Invalid binary message format. Error: "+e)})}else{const n=new u.a(h.b.Text,e.data);this.privMessageFormatter.toConnectionMessage(n).on(e=>{this.onEvent(new p.e(this.privConnectionId,t,e)),r.resolve(e)},e=>{r.reject("Invalid text message format. Error: "+e)})}}},this.privConnectionEstablishDeferral.promise()},this.send=e=>{if(this.privConnectionState!==o.a.Connected)return s.c.fromError(`Cannot send on connection that is in ${this.privConnectionState} state`);const t=new s.a,r=new s.a;return this.privSendMessageQueue.enqueueFromPromise(r.promise()),this.privMessageFormatter.fromConnectionMessage(e).on(n=>{r.resolve({Message:e,RawWebsocketMessage:n,sendStatusDeferral:t})},e=>{r.reject("Error formatting the message. "+e)}),t.promise()},this.read=()=>this.privConnectionState!==o.a.Connected?s.c.fromError(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue(),this.close=e=>{if(!this.privWebsocketClient){const e=new s.a;return e.resolve(!0),e.promise()}return this.privConnectionState!==o.a.Disconnected&&this.privWebsocketClient.close(1e3,e||"Normal closure by client"),this.privDisconnectDeferral.promise()},this.sendRawMessage=e=>{try{return e?(this.onEvent(new p.f(this.privConnectionId,(new Date).toISOString(),e.Message)),this.isWebsocketOpen?(this.privWebsocketClient.send(e.RawWebsocketMessage.payload),s.c.fromResult(!0)):s.c.fromError("websocket send error: Websocket not ready")):s.c.fromResult(!0)}catch(e){return s.c.fromError("websocket send error: "+e)}},this.onClose=(e,t)=>{const r=`Connection closed. ${e}: ${t}`;this.privConnectionState=o.a.Disconnected,this.privDisconnectDeferral.resolve(!0),this.privReceivingMessageQueue.dispose(t),this.privReceivingMessageQueue.drainAndDispose(e=>{},r),this.privSendMessageQueue.drainAndDispose(e=>{e.sendStatusDeferral.reject(r)},r)},this.processSendQueue=()=>{this.privSendMessageQueue.dequeue().on(e=>{e&&this.sendRawMessage(e).on(t=>{e.sendStatusDeferral.resolve(t),this.processSendQueue()},t=>{e.sendStatusDeferral.reject(t),this.processSendQueue()})},e=>{})},this.onEvent=e=>{this.privConnectionEvents.onEvent(e),v.a.instance.onEvent(e)},!e)throw new n.a("uri");if(!r)throw new n.a("messageFormatter");this.proxyInfo=i,this.privConnectionEvents=new l.a,this.privConnectionId=t,this.privMessageFormatter=r,this.privConnectionState=o.a.None,this.privUri=e,this.privHeaders=d,this.privHeaders["X-ConnectionId"]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}get events(){return this.privConnectionEvents}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}}y.forceNpmWebSocket=!1;class m{constructor(e,t,r,o,s,a){if(this.privIsDisposed=!1,this.dispose=()=>{this.privIsDisposed=!0,this.privConnectionMessageAdapter&&this.privConnectionMessageAdapter.close()},this.isDisposed=()=>this.privIsDisposed,this.state=()=>this.privConnectionMessageAdapter.state,this.open=()=>this.privConnectionMessageAdapter.open(),this.send=e=>this.privConnectionMessageAdapter.send(e),this.read=()=>this.privConnectionMessageAdapter.read(),!e)throw new n.a("uri");if(!o)throw new n.a("messageFormatter");this.privMessageFormatter=o;let c="",p=0;if(t)for(const r in t)if(r){c+=0===p&&-1===e.indexOf("?")?"?":"&";c+=`${r}=${encodeURIComponent(t[r])}`,p++}if(r)for(const t in r)if(t){c+=0===p&&-1===e.indexOf("?")?"?":"&";c+=`${t}=${encodeURIComponent(r[t])}`,p++}this.privUri=e+c,this.privId=a||Object(i.b)(),this.privConnectionMessageAdapter=new y(this.privUri,this.id,this.privMessageFormatter,s,r)}get id(){return this.privId}get events(){return this.privConnectionMessageAdapter.events}}},function(e,t,r){var n=r(24),i=r(134).f,o=r(40),s=r(70),a=r(94),c=r(234),p=r(240);e.exports=function(e,t){var r,u,h,v,l,d=e.target,f=e.global,g=e.stat;if(r=f?n:g?n[d]||a(d,{}):(n[d]||{}).prototype)for(u in t){if(v=t[u],h=e.noTargetGet?(l=i(r,u))&&l.value:r[u],!p(f?u:d+(g?".":"#")+u,e.forced)&&void 0!==h){if(typeof v==typeof h)continue;c(v,h)}(e.sham||h&&h.sham)&&o(v,"sham",!0),s(r,u,v,e)}}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,r){var n=r(24),i=r(40);e.exports=function(e,t){try{i(n,e,t)}catch(r){n[e]=t}return t}},function(e,t,r){var n=r(142),i=r(143),o=n("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t){e.exports=!1},function(e,t){e.exports={}},function(e,t,r){var n=r(72),i=r(24),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(n[e])||o(i[e]):n[e]&&n[e][t]||i[e]&&i[e][t]}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(29);!function(e){e[e.None=0]="None",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(n=t.PromiseState||(t.PromiseState={}));var o=function(){function e(e){var t=this;this.throwIfError=function(){if(t.isError)throw t.error},e.on((function(e){t.privIsCompleted||(t.privIsCompleted=!0,t.privIsError=!1,t.privResult=e)}),(function(e){t.privIsCompleted||(t.privIsCompleted=!0,t.privIsError=!0,t.privError=e)}))}return Object.defineProperty(e.prototype,"isCompleted",{get:function(){return this.privIsCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isError",{get:function(){return this.privIsError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this.privError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),e}();t.PromiseResult=o;var s=function(){var e=this;this.setResult=function(t){e.privOnSetResult(t)},this.setError=function(t){e.privOnSetError(t)},this.on=function(t,r){e.privOnSetResult=t,e.privOnSetError=r}};t.PromiseResultEventSource=s;var a=function(){function e(){}return e.whenAll=function(e){if(!e||0===e.length)throw new i.ArgumentNullError("promises");for(var t=new p,r=[],n=0,o=function(){++n===e.length&&(0===r.length?t.resolve(!0):t.reject(r.join(", ")))},s=0,a=e;s<a.length;s++){a[s].on((function(e){o()}),(function(e){r.push(e),o()}))}return t.promise()},e.fromResult=function(e){var t=new p;return t.resolve(e),t.promise()},e.fromError=function(e){var t=new p;return t.reject(e),t.promise()},e}();t.PromiseHelper=a;var c=function(e){var t=this;this.result=function(){return t.privSink.result},this.continueWith=function(e){if(!e)throw new i.ArgumentNullError("continuationCallback");var r=new p;return t.privSink.on((function(n){try{var i=e(t.privSink.result);r.resolve(i)}catch(e){r.reject(e)}}),(function(n){try{var i=e(t.privSink.result);r.resolve(i)}catch(e){r.reject("'Error handler for error "+n+" threw error "+e+"'")}})),r.promise()},this.onSuccessContinueWith=function(e){if(!e)throw new i.ArgumentNullError("continuationCallback");var r=new p;return t.privSink.on((function(t){try{var n=e(t);r.resolve(n)}catch(e){r.reject(e)}}),(function(e){r.reject(e)})),r.promise()},this.continueWithPromise=function(e){if(!e)throw new i.ArgumentNullError("continuationCallback");var r=new p;return t.privSink.on((function(n){try{var i=e(t.privSink.result);if(!i)throw new Error("'Continuation callback did not return promise'");i.on((function(e){r.resolve(e)}),(function(e){r.reject(e)}))}catch(e){r.reject(e)}}),(function(n){try{var i=e(t.privSink.result);if(!i)throw new Error("Continuation callback did not return promise");i.on((function(e){r.resolve(e)}),(function(e){r.reject(e)}))}catch(e){r.reject("'Error handler for error "+n+" threw error "+e+"'")}})),r.promise()},this.onSuccessContinueWithPromise=function(e){if(!e)throw new i.ArgumentNullError("continuationCallback");var r=new p;return t.privSink.on((function(t){try{var n=e(t);if(!n)throw new Error("Continuation callback did not return promise");n.on((function(e){r.resolve(e)}),(function(e){r.reject(e)}))}catch(e){r.reject(e)}}),(function(e){r.reject(e)})),r.promise()},this.on=function(e,r){if(!e)throw new i.ArgumentNullError("successCallback");if(!r)throw new i.ArgumentNullError("errorCallback");return t.privSink.on(e,r),t},this.finally=function(e){if(!e)throw new i.ArgumentNullError("callback");var r=function(t){e()};return t.on(r,r)},this.privSink=e};t.Promise=c;var p=function(){var e=this;this.state=function(){return e.privSink.state},this.promise=function(){return e.privPromise},this.resolve=function(t){return e.privSink.resolve(t),e},this.reject=function(t){return e.privSink.reject(t),e},this.privSink=new u,this.privPromise=new c(this.privSink)};t.Deferred=p;var u=function(){function e(){var e=this;this.privState=n.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.resolve=function(t){if(e.privState!==n.None)throw new Error("'Cannot resolve a completed promise'");e.privState=n.Resolved,e.privPromiseResultEvents.setResult(t);for(var r=0;r<e.privSuccessHandlers.length;r++)e.executeSuccessCallback(t,e.privSuccessHandlers[r],e.privErrorHandlers[r]);e.detachHandlers()},this.reject=function(t){if(e.privState!==n.None)throw new Error("'Cannot reject a completed promise'");e.privState=n.Rejected,e.privPromiseResultEvents.setError(t);for(var r=0,i=e.privErrorHandlers;r<i.length;r++){var o=i[r];e.executeErrorCallback(t,o)}e.detachHandlers()},this.on=function(t,r){null==t&&(t=function(e){}),e.privState===n.None?(e.privSuccessHandlers.push(t),e.privErrorHandlers.push(r)):(e.privState===n.Resolved?e.executeSuccessCallback(e.privPromiseResult.result,t,r):e.privState===n.Rejected&&e.executeErrorCallback(e.privPromiseResult.error,r),e.detachHandlers())},this.executeSuccessCallback=function(t,r,n){try{r(t)}catch(t){e.executeErrorCallback("'Unhandled callback error: "+t+"'",n)}},this.executeErrorCallback=function(e,t){if(!t)throw new Error("'Unhandled error: "+e+"'");try{t(e)}catch(t){throw new Error("'Unhandled callback error: "+t+". InnerError: "+e+"'")}},this.detachHandlers=function(){e.privErrorHandlers=[],e.privSuccessHandlers=[]},this.privPromiseResultEvents=new s,this.privPromiseResult=new o(this.privPromiseResultEvents)}return Object.defineProperty(e.prototype,"state",{get:function(){return this.privState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"result",{get:function(){return this.privPromiseResult},enumerable:!0,configurable:!0}),e}();t.Sink=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(t.TranslationStatus||(t.TranslationStatus={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.privHeaderName=e,this.privToken=t}return Object.defineProperty(e.prototype,"headerName",{get:function(){return this.privHeaderName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"token",{get:function(){return this.privToken},enumerable:!0,configurable:!0}),e}();t.AuthInfo=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",e[e.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",e[e.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",e[e.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",e[e.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",e[e.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",e[e.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",e[e.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",e[e.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",e[e.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",e[e.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",e[e.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",e[e.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",e[e.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",e[e.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",e[e.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",e[e.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",e[e.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",e[e.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus"}(t.SpeechSynthesisOutputFormat||(t.SpeechSynthesisOutputFormat={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",e[e.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",e[e.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",e[e.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=25]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",e[e.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",e[e.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.SpeechServiceConnection_EnableAudioLogging=32]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceResponse_ProfanityOption=33]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=34]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=35]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=36]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=37]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=38]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.Conversation_ApplicationId=39]="Conversation_ApplicationId",e[e.Conversation_DialogType=40]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=41]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=42]="Conversation_From_Id",e[e.Conversation_Conversation_Id=43]="Conversation_Conversation_Id",e[e.Conversation_Custom_Voice_Deployment_Ids=44]="Conversation_Custom_Voice_Deployment_Ids",e[e.Conversation_Speech_Activity_Template=45]="Conversation_Speech_Activity_Template",e[e.SpeechServiceConnection_Host=46]="SpeechServiceConnection_Host",e[e.ConversationTranslator_Host=47]="ConversationTranslator_Host",e[e.ConversationTranslator_Name=48]="ConversationTranslator_Name",e[e.ConversationTranslator_CorrelationId=49]="ConversationTranslator_CorrelationId",e[e.ConversationTranslator_Token=50]="ConversationTranslator_Token"}(t.PropertyId||(t.PropertyId={}))},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(10),s=r(2),a=function(){};t.DialogServiceConfig=a;var c=function(e){function t(){var t=e.call(this)||this;return t.privSpeechConfig=new s.SpeechConfigImpl,t}return i(t,e),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privSpeechConfig.properties},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{get:function(){return this.privSpeechConfig.speechRecognitionLanguage},set:function(e){o.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechConfig.speechRecognitionLanguage=e},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){this.privSpeechConfig.setProperty(e,t)},t.prototype.getProperty=function(e,t){return this.privSpeechConfig.getProperty(e)},t.prototype.setProxy=function(e,t,r,n){this.setProperty(s.PropertyId.SpeechServiceConnection_ProxyHostName,e),this.setProperty(s.PropertyId.SpeechServiceConnection_ProxyPort,""+t),r&&this.setProperty(s.PropertyId.SpeechServiceConnection_ProxyUserName,r),n&&this.setProperty(s.PropertyId.SpeechServiceConnection_ProxyPassword,n)},t.prototype.setServiceProperty=function(e,t,r){this.privSpeechConfig.setServiceProperty(e,t,r)},t.prototype.close=function(){},t}(a);t.DialogServiceConfigImpl=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),s=function(e){function t(t,r,n,i){void 0===i&&(i=o.EventType.Info);var s=e.call(this,t,i)||this;return s.privRequestId=r,s.privSessionId=n,s}return i(t,e),Object.defineProperty(t.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!0,configurable:!0}),t}(o.PlatformEvent);t.SpeechRecognitionEvent=s;var a=function(e){function t(t,r,n,i){var o=e.call(this,"RecognitionTriggeredEvent",t,r)||this;return o.privAudioSourceId=n,o.privAudioNodeId=i,o}return i(t,e),Object.defineProperty(t.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),t}(s);t.RecognitionTriggeredEvent=a;var c=function(e){function t(t,r,n,i){var o=e.call(this,"ListeningStartedEvent",t,r)||this;return o.privAudioSourceId=n,o.privAudioNodeId=i,o}return i(t,e),Object.defineProperty(t.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),t}(s);t.ListeningStartedEvent=c;var p=function(e){function t(t,r,n){var i=e.call(this,"ConnectingToServiceEvent",t,n)||this;return i.privAuthFetchEventid=r,i}return i(t,e),Object.defineProperty(t.prototype,"authFetchEventid",{get:function(){return this.privAuthFetchEventid},enumerable:!0,configurable:!0}),t}(s);t.ConnectingToServiceEvent=p;var u,h=function(e){function t(t,r,n,i,o){var s=e.call(this,"RecognitionStartedEvent",t,o)||this;return s.privAudioSourceId=r,s.privAudioNodeId=n,s.privAuthFetchEventId=i,s}return i(t,e),Object.defineProperty(t.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authFetchEventId",{get:function(){return this.privAuthFetchEventId},enumerable:!0,configurable:!0}),t}(s);t.RecognitionStartedEvent=h,function(e){e[e.Success=0]="Success",e[e.AudioSourceError=1]="AudioSourceError",e[e.AudioSourceTimeout=2]="AudioSourceTimeout",e[e.AuthTokenFetchError=3]="AuthTokenFetchError",e[e.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",e[e.UnAuthorized=5]="UnAuthorized",e[e.ConnectTimeout=6]="ConnectTimeout",e[e.ConnectError=7]="ConnectError",e[e.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",e[e.UnknownError=9]="UnknownError"}(u=t.RecognitionCompletionStatus||(t.RecognitionCompletionStatus={}));var v=function(e){function t(t,r,n,i,s,a,c,p){var h=e.call(this,"RecognitionEndedEvent",t,s,c===u.Success?o.EventType.Info:o.EventType.Error)||this;return h.privAudioSourceId=r,h.privAudioNodeId=n,h.privAuthFetchEventId=i,h.privStatus=c,h.privError=p,h.privServiceTag=a,h}return i(t,e),Object.defineProperty(t.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authFetchEventId",{get:function(){return this.privAuthFetchEventId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serviceTag",{get:function(){return this.privServiceTag},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this.privStatus},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"error",{get:function(){return this.privError},enumerable:!0,configurable:!0}),t}(s);t.RecognitionEndedEvent=v},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),s=function(e){function t(t,r,n,i,s,a,c,p){var u=this;if(!r)throw new o.ArgumentNullError("path");if(!n)throw new o.ArgumentNullError("requestId");var h={};if(h.Path=r,h["X-RequestId"]=n,h["X-Timestamp"]=(new Date).toISOString(),i&&(h["Content-Type"]=i),a&&(h["x-streamid"]=a),c)for(var v in c)v&&(h[v]=c[v]);return(u=p?e.call(this,t,s,h,p)||this:e.call(this,t,s,h)||this).privPath=r,u.privRequestId=n,u.privContentType=i,u.privStreamId=a,u.privAdditionalHeaders=c,u}return i(t,e),Object.defineProperty(t.prototype,"path",{get:function(){return this.privPath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return this.privContentType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"streamId",{get:function(){return this.privStreamId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"additionalHeaders",{get:function(){return this.privAdditionalHeaders},enumerable:!0,configurable:!0}),t.fromConnectionMessage=function(e){var r=null,n=null,i=null,o=null,s={};if(e.headers)for(var a in e.headers)a&&(a.toLowerCase()==="Path".toLowerCase()?r=e.headers[a]:a.toLowerCase()==="X-RequestId".toLowerCase()?n=e.headers[a]:a.toLowerCase()==="X-Timestamp".toLowerCase()?e.headers[a]:a.toLowerCase()==="Content-Type".toLowerCase()?i=e.headers[a]:a.toLowerCase()==="x-streamid".toLowerCase()?o=e.headers[a]:s[a]=e.headers[a]);return new t(e.messageType,r,n,i,e.body,o,s,e.id)},t}(o.ConnectionMessage);t.SpeechConnectionMessage=s},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"host",{get:function(){return t.privHost},enumerable:!0,configurable:!0}),Object.defineProperty(t,"apiVersion",{get:function(){return t.privApiVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"clientAppId",{get:function(){return t.privClientAppId},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultLanguageCode",{get:function(){return t.privDefaultLanguageCode},enumerable:!0,configurable:!0}),Object.defineProperty(t,"restPath",{get:function(){return t.privRestPath},enumerable:!0,configurable:!0}),Object.defineProperty(t,"webSocketPath",{get:function(){return t.privWebSocketPath},enumerable:!0,configurable:!0}),Object.defineProperty(t,"speechHost",{get:function(){return t.privSpeechHost},enumerable:!0,configurable:!0}),Object.defineProperty(t,"speechPath",{get:function(){return t.privSpeechPath},enumerable:!0,configurable:!0}),t.privHost="dev.microsofttranslator.com",t.privRestPath="/capito/room",t.privApiVersion="2.0",t.privDefaultLanguageCode="en-US",t.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",t.privWebSocketPath="/capito/translate",t.privSpeechHost="{region}.s2s.speech.microsoft.com",t.privSpeechPath="/speech/translation/cognitiveservices/v1",t}(r(110).RestConfigBase);t.ConversationConnectionConfig=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e,"requestOptions",{get:function(){return e.privDefaultRequestOptions},enumerable:!0,configurable:!0}),Object.defineProperty(e,"configParams",{get:function(){return e.privDefaultParams},enumerable:!0,configurable:!0}),Object.defineProperty(e,"restErrors",{get:function(){return e.privRestErrors},enumerable:!0,configurable:!0}),e.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},e.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},e.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"},e}();t.RestConfigBase=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===e&&(e=[]),this.participants=e,this.meId=t}return e.prototype.addOrUpdateParticipant=function(e){if(void 0!==e){var t=this.getParticipantIndex(e.id);return t>-1?this.participants.splice(t,1,e):this.participants.push(e),this.getParticipant(e.id)}},e.prototype.getParticipantIndex=function(e){return this.participants.findIndex((function(t){return t.id===e}))},e.prototype.getParticipant=function(e){return this.participants.find((function(t){return t.id===e}))},e.prototype.deleteParticipant=function(e){this.participants=this.participants.filter((function(t){return t.id!==e}))},Object.defineProperty(e.prototype,"host",{get:function(){return this.participants.find((function(e){return!0===e.isHost}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"me",{get:function(){return this.getParticipant(this.meId)},enumerable:!0,configurable:!0}),e}();t.InternalParticipants=n,t.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},t.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.r(t),r.d(t,"defineEventAttribute",(function(){return y})),r.d(t,"EventTarget",(function(){return C}));var i=new WeakMap,o=new WeakMap;function s(e){var t=i.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function a(e){null==e.passiveListener?e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener)}function c(e,t){i.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});for(var r=Object.keys(t),n=0;n<r.length;++n){var o=r[n];o in this||Object.defineProperty(this,o,p(o))}}function p(e){return{get:function(){return s(this).event[e]},set:function(t){s(this).event[e]=t},configurable:!0,enumerable:!0}}function u(e){return{value:function(){var t=s(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function h(e){if(null==e||e===Object.prototype)return c;var t=o.get(e);return null==t&&(t=function(e,t){var r=Object.keys(t);if(0===r.length)return e;function n(t,r){e.call(this,t,r)}n.prototype=Object.create(e.prototype,{constructor:{value:n,configurable:!0,writable:!0}});for(var i=0;i<r.length;++i){var o=r[i];if(!(o in e.prototype)){var s="function"==typeof Object.getOwnPropertyDescriptor(t,o).value;Object.defineProperty(n.prototype,o,s?u(o):p(o))}}return n}(h(Object.getPrototypeOf(e)),e),o.set(e,t)),t}function v(e){return s(e).immediateStopped}function l(e,t){s(e).passiveListener=t}c.prototype={get type(){return s(this).event.type},get target(){return s(this).eventTarget},get currentTarget(){return s(this).currentTarget},composedPath:function(){var e=s(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return s(this).eventPhase},stopPropagation:function(){var e=s(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation:function(){var e=s(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(s(this).event.bubbles)},get cancelable(){return Boolean(s(this).event.cancelable)},preventDefault:function(){a(s(this))},get defaultPrevented(){return s(this).canceled},get composed(){return Boolean(s(this).event.composed)},get timeStamp(){return s(this).timeStamp},get srcElement(){return s(this).eventTarget},get cancelBubble(){return s(this).stopped},set cancelBubble(e){if(e){var t=s(this);t.stopped=!0,"boolean"==typeof t.event.cancelBubble&&(t.event.cancelBubble=!0)}},get returnValue(){return!s(this).canceled},set returnValue(e){e||a(s(this))},initEvent:function(){}},Object.defineProperty(c.prototype,"constructor",{value:c,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(c.prototype,window.Event.prototype),o.set(window.Event.prototype,c));var d=new WeakMap;function f(e){return null!==e&&"object"===n(e)}function g(e){var t=d.get(e);if(null==t)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function y(e,t){Object.defineProperty(e,"on".concat(t),function(e){return{get:function(){for(var t=g(this).get(e);null!=t;){if(3===t.listenerType)return t.listener;t=t.next}return null},set:function(t){"function"==typeof t||f(t)||(t=null);for(var r=g(this),n=null,i=r.get(e);null!=i;)3===i.listenerType?null!==n?n.next=i.next:null!==i.next?r.set(e,i.next):r.delete(e):n=i,i=i.next;if(null!==t){var o={listener:t,listenerType:3,passive:!1,once:!1,next:null};null===n?r.set(e,o):n.next=o}},configurable:!0,enumerable:!0}}(t))}function m(e){function t(){S.call(this)}t.prototype=Object.create(S.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(var r=0;r<e.length;++r)y(t.prototype,e[r]);return t}function S(){if(!(this instanceof S)){if(1===arguments.length&&Array.isArray(arguments[0]))return m(arguments[0]);if(arguments.length>0){for(var e=new Array(arguments.length),t=0;t<arguments.length;++t)e[t]=arguments[t];return m(e)}throw new TypeError("Cannot call a class as a function")}d.set(this,new Map)}S.prototype={addEventListener:function(e,t,r){if(null!=t){if("function"!=typeof t&&!f(t))throw new TypeError("'listener' should be a function or an object.");var n=g(this),i=f(r),o=(i?Boolean(r.capture):Boolean(r))?1:2,s={listener:t,listenerType:o,passive:i&&Boolean(r.passive),once:i&&Boolean(r.once),next:null},a=n.get(e);if(void 0!==a){for(var c=null;null!=a;){if(a.listener===t&&a.listenerType===o)return;c=a,a=a.next}c.next=s}else n.set(e,s)}},removeEventListener:function(e,t,r){if(null!=t)for(var n=g(this),i=(f(r)?Boolean(r.capture):Boolean(r))?1:2,o=null,s=n.get(e);null!=s;){if(s.listener===t&&s.listenerType===i)return void(null!==o?o.next=s.next:null!==s.next?n.set(e,s.next):n.delete(e));o=s,s=s.next}},dispatchEvent:function(e){if(null==e||"string"!=typeof e.type)throw new TypeError('"event.type" should be a string.');var t=g(this),r=e.type,n=t.get(r);if(null==n)return!0;for(var i=function(e,t){return new(h(Object.getPrototypeOf(t)))(e,t)}(this,e),o=null;null!=n;){if(n.once?null!==o?o.next=n.next:null!==n.next?t.set(r,n.next):t.delete(r):o=n,l(i,n.passive?n.listener:null),"function"==typeof n.listener)try{n.listener.call(this,i)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else 3!==n.listenerType&&"function"==typeof n.listener.handleEvent&&n.listener.handleEvent(i);if(v(i))break;n=n.next}return l(i,null),function(e,t){s(e).eventPhase=t}(i,0),function(e,t){s(e).currentTarget=t}(i,null),!i.defaultPrevented}},Object.defineProperty(S.prototype,"constructor",{value:S,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(S.prototype,window.EventTarget.prototype);var C=S;t.default=C}])},function(e,t){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";e.exports=function(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}},function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n);t.default=i.a}])},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t,r){var n={};n[r(25)("toStringTag")]="z",e.exports="[object z]"===String(n)},function(e,t,r){"use strict";var n=r(381),i=r(383);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=S,t.resolve=function(e,t){return S(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?S(e,!1,!0).resolveObject(t):t},t.format=function(e){i.isString(e)&&(e=S(e));return e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(p),h=["%","/","?",";","#"].concat(u),v=["/","?","#"],l=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},m=r(384);function S(e,t,r){if(e&&i.isObject(e)&&e instanceof o)return e;var n=new o;return n.parse(e,t,r),n}o.prototype.parse=function(e,t,r){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),a=-1!==o&&o<e.indexOf("#")?"?":"#",p=e.split(a);p[0]=p[0].replace(/\\/g,"/");var S=e=p.join(a);if(S=S.trim(),!r&&1===e.split("#").length){var C=c.exec(S);if(C)return this.path=S,this.href=S,this.pathname=C[1],C[2]?(this.search=C[2],this.query=t?m.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var b=s.exec(S);if(b){var P=(b=b[0]).toLowerCase();this.protocol=P,S=S.substr(b.length)}if(r||b||S.match(/^\/\/[^@\/]+@[^@\/]+/)){var R="//"===S.substr(0,2);!R||b&&g[b]||(S=S.substr(2),this.slashes=!0)}if(!g[b]&&(R||b&&!y[b])){for(var w,I,E=-1,O=0;O<v.length;O++){-1!==(T=S.indexOf(v[O]))&&(-1===E||T<E)&&(E=T)}-1!==(I=-1===E?S.lastIndexOf("@"):S.lastIndexOf("@",E))&&(w=S.slice(0,I),S=S.slice(I+1),this.auth=decodeURIComponent(w)),E=-1;for(O=0;O<h.length;O++){var T;-1!==(T=S.indexOf(h[O]))&&(-1===E||T<E)&&(E=T)}-1===E&&(E=S.length),this.host=S.slice(0,E),S=S.slice(E),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var D=this.hostname.split(/\./),_=(O=0,D.length);O<_;O++){var M=D[O];if(M&&!M.match(l)){for(var x="",k=0,j=M.length;k<j;k++)M.charCodeAt(k)>127?x+="x":x+=M[k];if(!x.match(l)){var z=D.slice(0,O),N=D.slice(O+1),L=M.match(d);L&&(z.push(L[1]),N.unshift(L[2])),N.length&&(S="/"+N.join(".")+S),this.hostname=z.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),A||(this.hostname=n.toASCII(this.hostname));var B=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+B,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==S[0]&&(S="/"+S))}if(!f[P])for(O=0,_=u.length;O<_;O++){var U=u[O];if(-1!==S.indexOf(U)){var q=encodeURIComponent(U);q===U&&(q=escape(U)),S=S.split(U).join(q)}}var H=S.indexOf("#");-1!==H&&(this.hash=S.substr(H),S=S.slice(0,H));var W=S.indexOf("?");if(-1!==W?(this.search=S.substr(W),this.query=S.substr(W+1),t&&(this.query=m.parse(this.query)),S=S.slice(0,W)):t&&(this.search="",this.query={}),S&&(this.pathname=S),y[P]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var V=this.search||"";this.path=B+V}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,s="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=m.stringify(this.query));var a=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||y[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),t+o+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+n},o.prototype.resolve=function(e){return this.resolveObject(S(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var r=new o,n=Object.keys(this),s=0;s<n.length;s++){var a=n[s];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),p=0;p<c.length;p++){var u=c[p];"protocol"!==u&&(r[u]=e[u])}return y[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!y[e.protocol]){for(var h=Object.keys(e),v=0;v<h.length;v++){var l=h[v];r[l]=e[l]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||g[e.protocol])r.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var f=r.pathname||"",m=r.search||"";r.path=f+m}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var S=r.pathname&&"/"===r.pathname.charAt(0),C=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=C||S||r.host&&e.pathname,P=b,R=r.pathname&&r.pathname.split("/")||[],w=(d=e.pathname&&e.pathname.split("/")||[],r.protocol&&!y[r.protocol]);if(w&&(r.hostname="",r.port=null,r.host&&(""===R[0]?R[0]=r.host:R.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),b=b&&(""===d[0]||""===R[0])),C)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,R=d;else if(d.length)R||(R=[]),R.pop(),R=R.concat(d),r.search=e.search,r.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(w)r.hostname=r.host=R.shift(),(A=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=A.shift(),r.host=r.hostname=A.shift());return r.search=e.search,r.query=e.query,i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!R.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var I=R.slice(-1)[0],E=(r.host||e.host||R.length>1)&&("."===I||".."===I)||""===I,O=0,T=R.length;T>=0;T--)"."===(I=R[T])?R.splice(T,1):".."===I?(R.splice(T,1),O++):O&&(R.splice(T,1),O--);if(!b&&!P)for(;O--;O)R.unshift("..");!b||""===R[0]||R[0]&&"/"===R[0].charAt(0)||R.unshift(""),E&&"/"!==R.join("/").substr(-1)&&R.push("");var A,D=""===R[0]||R[0]&&"/"===R[0].charAt(0);w&&(r.hostname=r.host=D?"":R.length?R.shift():"",(A=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=A.shift(),r.host=r.hostname=A.shift()));return(b=b||r.host&&R.length)&&!D&&R.unshift(""),R.length?r.pathname=R.join("/"):(r.pathname=null,r.path=null),i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){this.privSynthesisAudioMetadata=JSON.parse(e)}static fromJSON(e){return new n(e)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t,r,n){this.privAduioOffset=e,this.privText=t,this.privWordLength=r,this.privTextOffset=n}get audioOffset(){return this.privAduioOffset}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){this.privContext={},this.privSpeechSynthesizer=e}setSection(e,t){this.privContext[e]=t}set audioOutputFormat(e){this.privAudioOutputFormat=e}toJSON(){const e=this.buildSynthesisContext();return this.setSection("synthesis",e),JSON.stringify(this.privContext)}buildSynthesisContext(){return{audio:{metadataOptions:{sentenceBoundaryEnabled:!1,wordBoundaryEnabled:!!this.privSpeechSynthesizer.wordBoundary},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:this.privSpeechSynthesizer.autoDetectSourceLanguage}}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(e){this.iPrivConfig=e}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t,r,n,i,o,s,a,c,p){this.privResultId=e,this.privReason=t,this.privText=r,this.privDuration=n,this.privOffset=i,this.privLanguage=o,this.privLanguageDetectionConfidence=s,this.privErrorDetails=a,this.privJson=c,this.privProperties=p}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(58);class i extends n.a{constructor(e,t,r,n,i){super(n,i),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(13);class i{constructor(e){this.privDetailedSpeechPhrase=JSON.parse(e),this.privDetailedSpeechPhrase.RecognitionStatus=n.a[this.privDetailedSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new i(e)}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){this.privIntentResponse=JSON.parse(e)}static fromJSON(e){return new n(e)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(48);class i extends n.a{constructor(e,t,r,n,i,o){super(n,i,o),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(67);class i{constructor(e){this.privTranslationHypothesis=JSON.parse(e),this.privTranslationHypothesis.Translation.TranslationStatus=n.a[this.privTranslationHypothesis.Translation.TranslationStatus]}static fromJSON(e){return new i(e)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(13);class i{constructor(e){this.privSynthesisEnd=JSON.parse(e),this.privSynthesisEnd.SynthesisStatus=n.b[this.privSynthesisEnd.SynthesisStatus]}static fromJSON(e){return new i(e)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(23);class i{constructor(){this.privMap=new n.a}get(e,t){return this.privMap.getProperty(e,t)}set(e,t){this.privMap.setProperty(e,t)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(7),i=r(133),o=r(18),s=r(22),a=r(76),c=r(9);class p extends c.b{constructor(e,t,r=c.a.Info){super(e,r),this.privRequestId=t}get requestId(){return this.privRequestId}}class u extends p{constructor(e,t,r){super("SynthesisTriggeredEvent",e),this.privSessionAudioDestinationId=t,this.privTurnAudioDestinationId=r}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}class h extends p{constructor(e,t){super("ConnectingToSynthesisServiceEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}class v extends p{constructor(e,t){super("SynthesisStartedEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}class l{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.onPreConnectionStart=(e,t)=>{this.privAuthFetchEventId=e,this.onEvent(new h(this.privRequestId,this.privAuthFetchEventId))},this.onAuthCompleted=(e,t)=>{e&&this.onComplete()},this.onConnectionEstablishCompleted=(e,t)=>{if(200===e)return this.onEvent(new v(this.requestId,this.privAuthFetchEventId)),void(this.privBytesReceived=0);403===e&&this.onComplete()},this.onServiceResponseMessage=e=>{const t=JSON.parse(e);this.streamId=t.audio.streamId},this.onServiceTurnEndResponse=()=>{this.privTurnDeferral.resolve(!0),this.onComplete()},this.onServiceTurnStartResponse=()=>{this.privTurnDeferral.state()===n.d.None&&this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral=new n.a},this.dispose=e=>{this.privIsDisposed||(this.privIsDisposed=!0)},this.onEvent=e=>{i.a.instance.onEvent(e)},this.onComplete=()=>{this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),void 0!==this.privTurnAudioDestination&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))},this.privRequestId=Object(o.b)(),this.privTurnDeferral=new n.a,this.privTurnDeferral.resolve(!0)}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(e){this.privStreamId=e}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(e){this.privAudioOutputFormat=e}get turnCompletionPromise(){return this.privTurnDeferral.promise()}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get bytesReceived(){return this.privBytesReceived}get allReceivedAudio(){return this.privReceivedAudio?this.privReceivedAudio:this.privIsSynthesisEnded?(this.readAllAudioFromStream(),this.allReceivedAudio):null}get allReceivedAudioWithHeader(){return this.privReceivedAudioWithHeader?this.privReceivedAudioWithHeader:this.privIsSynthesisEnded?this.audioOutputFormat.hasHeader?(this.privReceivedAudioWithHeader=a.a.addHeader(this.allReceivedAudio,this.audioOutputFormat),this.allReceivedAudioWithHeader):this.allReceivedAudio:null}startNewSynthesis(e,t,r,n){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=e,this.privRawText=t,this.privIsSSML=r,this.privAudioOutputStream=new s.c,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,void 0!==n&&(this.privTurnAudioDestination=n,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new u(this.requestId,void 0,void 0===n?void 0:n.id()))}onAudioChunkReceived(e){this.isSynthesizing&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength,void 0!==this.privTurnAudioDestination&&this.privTurnAudioDestination.write(e))}onWordBoundaryEvent(e){this.updateTextOffset(e)}onStopSynthesizing(){this.onComplete()}updateTextOffset(e){this.privTextOffset>=0&&(this.privTextOffset=this.privRawText.indexOf(e,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+e.length),this.privIsSSML&&this.privRawText.indexOf("<",this.privTextOffset+1)>this.privRawText.indexOf(">",this.privTextOffset+1)&&this.updateTextOffset(e))}readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{this.privAudioOutputStream.read(this.privReceivedAudio)}catch(e){this.privReceivedAudio=new ArrayBuffer(0)}}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(4);class i{constructor(e){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.get=e=>(this.throwIfDisposed(),this.privList[e]),this.first=()=>this.get(0),this.last=()=>this.get(this.length()-1),this.add=e=>{this.throwIfDisposed(),this.insertAt(this.privList.length,e)},this.insertAt=(e,t)=>{this.throwIfDisposed(),0===e?this.privList.unshift(t):e===this.privList.length?this.privList.push(t):this.privList.splice(e,0,t),this.triggerSubscriptions(this.privAddSubscriptions)},this.removeFirst=()=>(this.throwIfDisposed(),this.removeAt(0)),this.removeLast=()=>(this.throwIfDisposed(),this.removeAt(this.length()-1)),this.removeAt=e=>(this.throwIfDisposed(),this.remove(e,1)[0]),this.remove=(e,t)=>{this.throwIfDisposed();const r=this.privList.splice(e,t);return this.triggerSubscriptions(this.privRemoveSubscriptions),r},this.clear=()=>{this.throwIfDisposed(),this.remove(0,this.length())},this.length=()=>(this.throwIfDisposed(),this.privList.length),this.onAdded=e=>{this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[t]=e,{detach:()=>{delete this.privAddSubscriptions[t]}}},this.onRemoved=e=>{this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[t]=e,{detach:()=>{delete this.privRemoveSubscriptions[t]}}},this.onDisposed=e=>{this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[t]=e,{detach:()=>{delete this.privDisposedSubscriptions[t]}}},this.join=e=>(this.throwIfDisposed(),this.privList.join(e)),this.toArray=()=>{const e=Array();return this.privList.forEach(t=>{e.push(t)}),e},this.any=e=>(this.throwIfDisposed(),e?this.where(e).length()>0:this.length()>0),this.all=e=>(this.throwIfDisposed(),this.where(e).length()===this.length()),this.forEach=e=>{this.throwIfDisposed();for(let t=0;t<this.length();t++)e(this.privList[t],t)},this.select=e=>{this.throwIfDisposed();const t=[];for(let r=0;r<this.privList.length;r++)t.push(e(this.privList[r],r));return new i(t)},this.where=e=>{this.throwIfDisposed();const t=new i;for(let r=0;r<this.privList.length;r++)e(this.privList[r],r)&&t.add(this.privList[r]);return t},this.orderBy=e=>{this.throwIfDisposed();const t=this.toArray().sort(e);return new i(t)},this.orderByDesc=e=>(this.throwIfDisposed(),this.orderBy((t,r)=>e(r,t))),this.clone=()=>(this.throwIfDisposed(),new i(this.toArray())),this.concat=e=>(this.throwIfDisposed(),new i(this.privList.concat(e.toArray()))),this.concatArray=e=>(this.throwIfDisposed(),new i(this.privList.concat(e))),this.isDisposed=()=>null==this.privList,this.dispose=e=>{this.isDisposed()||(this.privDisposeReason=e,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))},this.throwIfDisposed=()=>{if(this.isDisposed())throw new n.c("List",this.privDisposeReason)},this.triggerSubscriptions=e=>{if(e)for(const t in e)t&&e[t]()},this.privList=[],e)for(const t of e)this.privList.push(t)}}var o,s=r(7);!function(e){e[e.Dequeue=0]="Dequeue",e[e.Peek=1]="Peek"}(o||(o={}));class a{constructor(e){this.privPromiseStore=new i,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.enqueue=e=>{this.throwIfDispose(),this.enqueueFromPromise(s.c.fromResult(e))},this.enqueueFromPromise=e=>{this.throwIfDispose(),this.privPromiseStore.add(e),e.finally(()=>{for(;this.privPromiseStore.length()>0&&this.privPromiseStore.first().result().isCompleted;){const e=this.privPromiseStore.removeFirst();e.result().isError||this.privList.add(e.result().result)}})},this.dequeue=()=>{this.throwIfDispose();const e=new s.a;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:o.Dequeue}),this.drain()),e.promise()},this.peek=()=>{this.throwIfDispose();const e=new s.a;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:o.Peek}),this.drain()),e.promise()},this.length=()=>(this.throwIfDispose(),this.privList.length()),this.isDisposed=()=>null==this.privSubscribers,this.drainAndDispose=(e,t)=>{if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=t,this.privIsDisposing=!0;const r=this.privSubscribers;if(r){for(;r.length()>0;){r.removeFirst().deferral.resolve(void 0)}this.privSubscribers===r&&(this.privSubscribers=r)}for(const e of this.privDetachables)e.detach();if(this.privPromiseStore.length()>0&&e)return s.c.whenAll(this.privPromiseStore.toArray()).continueWith(()=>(this.privSubscribers=null,this.privList.forEach((t,r)=>{e(t)}),this.privList=null,!0));this.privSubscribers=null,this.privList=null}return s.c.fromResult(!0)},this.dispose=e=>{this.drainAndDispose(null,e)},this.drain=()=>{if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const e=this.privSubscribers,t=this.privList;if(e&&t){for(;t.length()>0&&e.length()>0&&!this.privIsDisposing;){const r=e.removeFirst();if(r.type===o.Peek)r.deferral.resolve(t.first());else{const e=t.removeFirst();r.deferral.resolve(e)}}this.privSubscribers===e&&(this.privSubscribers=e),this.privList===t&&(this.privList=t)}this.privIsDrainInProgress=!1}},this.throwIfDispose=()=>{if(this.isDisposed()){if(this.privDisposeReason)throw new n.b(this.privDisposeReason);throw new n.c("Queue")}if(this.privIsDisposing)throw new n.b("Queue disposing")},this.privList=e||new i,this.privDetachables=[],this.privSubscribers=new i,this.privDetachables.push(this.privList.onAdded(this.drain))}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),i=r(61);class o{static get instance(){return o.privInstance}}o.privInstance=new i.a,o.setEventSource=e=>{if(!e)throw new n.a("eventSource");o.privInstance=e}},function(e,t,r){var n=r(39),i=r(135),o=r(92),s=r(62),a=r(137),c=r(33),p=r(138),u=Object.getOwnPropertyDescriptor;t.f=n?u:function(e,t){if(e=s(e),t=a(t,!0),p)try{return u(e,t)}catch(e){}if(c(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t,r){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!n.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){var n=r(52);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){var n=r(39),i=r(51),o=r(139);e.exports=!n&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){var n=r(24),i=r(52),o=n.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},function(e,t,r){var n=r(141),i=Function.toString;"function"!=typeof n.inspectSource&&(n.inspectSource=function(e){return i.call(e)}),e.exports=n.inspectSource},function(e,t,r){var n=r(24),i=r(94),o=n["__core-js_shared__"]||i("__core-js_shared__",{});e.exports=o},function(e,t,r){var n=r(96),i=r(141);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:n?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++r+n).toString(36)}},function(e,t,r){var n=r(33),i=r(62),o=r(237).indexOf,s=r(97);e.exports=function(e,t){var r,a=i(e),c=0,p=[];for(r in a)!n(s,r)&&n(a,r)&&p.push(r);for(;t.length>c;)n(a,r=t[c++])&&(~o(p,r)||p.push(r));return p}},function(e,t,r){var n=r(99),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,r){var n=r(144),i=r(100);e.exports=Object.keys||function(e){return n(e,i)}},function(e,t,r){var n=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof h?t:h,o=Object.create(i.prototype),s=new R(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return I()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=C(s,r);if(a){if(a===u)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=p(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,s),o}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u={};function h(){}function v(){}function l(){}var d={};d[i]=function(){return this};var f=Object.getPrototypeOf,g=f&&f(f(w([])));g&&g!==t&&r.call(g,i)&&(d=g);var y=l.prototype=h.prototype=Object.create(d);function m(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){var n;this._invoke=function(i,o){function s(){return new t((function(n,s){!function n(i,o,s,a){var c=p(e[i],e,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}(i,o,n,s)}))}return n=n?n.then(s,s):s()}}function C(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=p(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function w(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return v.prototype=y.constructor=l,l.constructor=v,v.displayName=a(l,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,a(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},m(S.prototype),S.prototype[o]=function(){return this},e.AsyncIterator=S,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new S(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},m(y),a(y,s,"Generator"),y[i]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=w,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:w(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(28),s=r(10),a=r(2),c=r(163),p=r(155),u=r(53),h=function(){function e(){}return e.fromDefaultMicrophoneInput=function(){var e=new o.PcmRecorder;return new v(new o.MicAudioSource(e))},e.fromMicrophoneInput=function(e){var t=new o.PcmRecorder;return new v(new o.MicAudioSource(t,e))},e.fromWavFileInput=function(e){return new v(new o.FileAudioSource(e))},e.fromStreamInput=function(e){if(e instanceof a.PullAudioInputStreamCallback)return new v(new p.PullAudioInputStreamImpl(e));if(e instanceof a.AudioInputStream)return new v(e);throw new Error("Not Supported Type")},e.fromDefaultSpeakerOutput=function(){return new l(new a.SpeakerAudioDestination)},e.fromSpeakerOutput=function(t){if(void 0===t)return e.fromDefaultSpeakerOutput();if(t instanceof a.SpeakerAudioDestination)return new l(t);throw new Error("Not Supported Type")},e.fromAudioFileOutput=function(e){return new l(new c.AudioFileWriter(e))},e.fromStreamOutput=function(e){if(e instanceof a.PushAudioOutputStreamCallback)return new l(new u.PushAudioOutputStreamImpl(e));if(e instanceof a.PushAudioOutputStream)return new l(e);if(e instanceof a.PullAudioOutputStream)return new l(e);throw new Error("Not Supported Type")},e}();t.AudioConfig=h;var v=function(e){function t(t){var r=e.call(this)||this;return r.privSource=t,r}return i(t,e),Object.defineProperty(t.prototype,"format",{get:function(){return this.privSource.format},enumerable:!0,configurable:!0}),t.prototype.close=function(){this.privSource.turnOff()},t.prototype.id=function(){return this.privSource.id()},Object.defineProperty(t.prototype,"blob",{get:function(){return this.privSource.blob},enumerable:!0,configurable:!0}),t.prototype.turnOn=function(){return this.privSource.turnOn()},t.prototype.attach=function(e){return this.privSource.attach(e)},t.prototype.detach=function(e){return this.privSource.detach(e)},t.prototype.turnOff=function(){return this.privSource.turnOff()},Object.defineProperty(t.prototype,"events",{get:function(){return this.privSource.events},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){if(s.Contracts.throwIfNull(t,"value"),void 0===this.privSource.setProperty)throw new Error("This AudioConfig instance does not support setting properties.");this.privSource.setProperty(e,t)},t.prototype.getProperty=function(e,t){if(void 0!==this.privSource.getProperty)return this.privSource.getProperty(e,t);throw new Error("This AudioConfig instance does not support getting properties.")},Object.defineProperty(t.prototype,"deviceInfo",{get:function(){return this.privSource.deviceInfo},enumerable:!0,configurable:!0}),t}(h);t.AudioConfigImpl=v;var l=function(e){function t(t){var r=e.call(this)||this;return r.privDestination=t,r}return i(t,e),Object.defineProperty(t.prototype,"format",{set:function(e){this.privDestination.format=e},enumerable:!0,configurable:!0}),t.prototype.write=function(e){this.privDestination.write(e)},t.prototype.close=function(){this.privDestination.close()},t.prototype.id=function(){return this.privDestination.id()},t.prototype.setProperty=function(e,t){throw new Error("This AudioConfig instance does not support setting properties.")},t.prototype.getProperty=function(e,t){throw new Error("This AudioConfig instance does not support getting properties.")},t}(h);t.AudioOutputConfigImpl=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(29),o=r(45);!function(e){e[e.Text=0]="Text",e[e.Binary=1]="Binary"}(n=t.MessageType||(t.MessageType={}));var s=function(){function e(e,t,r,s){if(this.privBody=null,e===n.Text&&t&&"string"!=typeof t)throw new i.InvalidOperationError("Payload must be a string");if(e===n.Binary&&t&&!(t instanceof ArrayBuffer))throw new i.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=e,this.privBody=t,this.privHeaders=r||{},this.privId=s||o.createNoDashGuid(),this.messageType){case n.Binary:this.privSize=null!==this.binaryBody?this.binaryBody.byteLength:0;break;case n.Text:this.privSize=this.textBody.length}}return Object.defineProperty(e.prototype,"messageType",{get:function(){return this.privMessageType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headers",{get:function(){return this.privHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this.privBody},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textBody",{get:function(){if(this.privMessageType===n.Binary)throw new i.InvalidOperationError("Not supported for binary message");return this.privBody},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryBody",{get:function(){if(this.privMessageType===n.Text)throw new i.InvalidOperationError("Not supported for text message");return this.privBody},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privId},enumerable:!0,configurable:!0}),e}();t.ConnectionMessage=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(29),i=r(45),o=function(){function e(e){var t=this;this.privEventListeners={},this.privIsDisposed=!1,this.onEvent=function(e){if(t.isDisposed())throw new n.ObjectDisposedError("EventSource");if(t.metadata)for(var r in t.metadata)r&&e.metadata&&(e.metadata[r]||(e.metadata[r]=t.metadata[r]));for(var i in t.privEventListeners)i&&t.privEventListeners[i]&&t.privEventListeners[i](e)},this.attach=function(e){var r=i.createNoDashGuid();return t.privEventListeners[r]=e,{detach:function(){delete t.privEventListeners[r]}}},this.attachListener=function(e){return t.attach(e.onEvent)},this.isDisposed=function(){return t.privIsDisposed},this.dispose=function(){t.privEventListeners=null,t.privIsDisposed=!0},this.privMetadata=e}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.privMetadata},enumerable:!0,configurable:!0}),e}();t.EventSource=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(29),i=function e(t){var r=this;if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.get=function(e){return r.throwIfDisposed(),r.privList[e]},this.first=function(){return r.get(0)},this.last=function(){return r.get(r.length()-1)},this.add=function(e){r.throwIfDisposed(),r.insertAt(r.privList.length,e)},this.insertAt=function(e,t){r.throwIfDisposed(),0===e?r.privList.unshift(t):e===r.privList.length?r.privList.push(t):r.privList.splice(e,0,t),r.triggerSubscriptions(r.privAddSubscriptions)},this.removeFirst=function(){return r.throwIfDisposed(),r.removeAt(0)},this.removeLast=function(){return r.throwIfDisposed(),r.removeAt(r.length()-1)},this.removeAt=function(e){return r.throwIfDisposed(),r.remove(e,1)[0]},this.remove=function(e,t){r.throwIfDisposed();var n=r.privList.splice(e,t);return r.triggerSubscriptions(r.privRemoveSubscriptions),n},this.clear=function(){r.throwIfDisposed(),r.remove(0,r.length())},this.length=function(){return r.throwIfDisposed(),r.privList.length},this.onAdded=function(e){r.throwIfDisposed();var t=r.privSubscriptionIdCounter++;return r.privAddSubscriptions[t]=e,{detach:function(){delete r.privAddSubscriptions[t]}}},this.onRemoved=function(e){r.throwIfDisposed();var t=r.privSubscriptionIdCounter++;return r.privRemoveSubscriptions[t]=e,{detach:function(){delete r.privRemoveSubscriptions[t]}}},this.onDisposed=function(e){r.throwIfDisposed();var t=r.privSubscriptionIdCounter++;return r.privDisposedSubscriptions[t]=e,{detach:function(){delete r.privDisposedSubscriptions[t]}}},this.join=function(e){return r.throwIfDisposed(),r.privList.join(e)},this.toArray=function(){var e=Array();return r.privList.forEach((function(t){e.push(t)})),e},this.any=function(e){return r.throwIfDisposed(),e?r.where(e).length()>0:r.length()>0},this.all=function(e){return r.throwIfDisposed(),r.where(e).length()===r.length()},this.forEach=function(e){r.throwIfDisposed();for(var t=0;t<r.length();t++)e(r.privList[t],t)},this.select=function(t){r.throwIfDisposed();for(var n=[],i=0;i<r.privList.length;i++)n.push(t(r.privList[i],i));return new e(n)},this.where=function(t){r.throwIfDisposed();for(var n=new e,i=0;i<r.privList.length;i++)t(r.privList[i],i)&&n.add(r.privList[i]);return n},this.orderBy=function(t){return r.throwIfDisposed(),new e(r.toArray().sort(t))},this.orderByDesc=function(e){return r.throwIfDisposed(),r.orderBy((function(t,r){return e(r,t)}))},this.clone=function(){return r.throwIfDisposed(),new e(r.toArray())},this.concat=function(t){return r.throwIfDisposed(),new e(r.privList.concat(t.toArray()))},this.concatArray=function(t){return r.throwIfDisposed(),new e(r.privList.concat(t))},this.isDisposed=function(){return null==r.privList},this.dispose=function(e){r.isDisposed()||(r.privDisposeReason=e,r.privList=null,r.privAddSubscriptions=null,r.privRemoveSubscriptions=null,r.triggerSubscriptions(r.privDisposedSubscriptions))},this.throwIfDisposed=function(){if(r.isDisposed())throw new n.ObjectDisposedError("List",r.privDisposeReason)},this.triggerSubscriptions=function(e){if(e)for(var t in e)t&&e[t]()},this.privList=[],t)for(var i=0,o=t;i<o.length;i++){var s=o[i];this.privList.push(s)}};t.List=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(29),o=r(151),s=r(101);!function(e){e[e.Dequeue=0]="Dequeue",e[e.Peek=1]="Peek"}(n||(n={}));var a=function(e){var t=this;this.privPromiseStore=new o.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.enqueue=function(e){t.throwIfDispose(),t.enqueueFromPromise(s.PromiseHelper.fromResult(e))},this.enqueueFromPromise=function(e){t.throwIfDispose(),t.privPromiseStore.add(e),e.finally((function(){for(;t.privPromiseStore.length()>0&&t.privPromiseStore.first().result().isCompleted;){var e=t.privPromiseStore.removeFirst();e.result().isError||t.privList.add(e.result().result)}}))},this.dequeue=function(){t.throwIfDispose();var e=new s.Deferred;return t.privSubscribers&&(t.privSubscribers.add({deferral:e,type:n.Dequeue}),t.drain()),e.promise()},this.peek=function(){t.throwIfDispose();var e=new s.Deferred;return t.privSubscribers&&(t.privSubscribers.add({deferral:e,type:n.Peek}),t.drain()),e.promise()},this.length=function(){return t.throwIfDispose(),t.privList.length()},this.isDisposed=function(){return null==t.privSubscribers},this.drainAndDispose=function(e,r){if(!t.isDisposed()&&!t.privIsDisposing){t.privDisposeReason=r,t.privIsDisposing=!0;var n=t.privSubscribers;if(n){for(;n.length()>0;)n.removeFirst().deferral.resolve(void 0);t.privSubscribers===n&&(t.privSubscribers=n)}for(var i=0,o=t.privDetachables;i<o.length;i++)o[i].detach();if(t.privPromiseStore.length()>0&&e)return s.PromiseHelper.whenAll(t.privPromiseStore.toArray()).continueWith((function(){return t.privSubscribers=null,t.privList.forEach((function(t,r){e(t)})),t.privList=null,!0}));t.privSubscribers=null,t.privList=null}return s.PromiseHelper.fromResult(!0)},this.dispose=function(e){t.drainAndDispose(null,e)},this.drain=function(){if(!t.privIsDrainInProgress&&!t.privIsDisposing){t.privIsDrainInProgress=!0;var e=t.privSubscribers,r=t.privList;if(e&&r){for(;r.length()>0&&e.length()>0&&!t.privIsDisposing;){var i=e.removeFirst();if(i.type===n.Peek)i.deferral.resolve(r.first());else{var o=r.removeFirst();i.deferral.resolve(o)}}t.privSubscribers===e&&(t.privSubscribers=e),t.privList===r&&(t.privList=r)}t.privIsDrainInProgress=!1}},this.throwIfDispose=function(){if(t.isDisposed()){if(t.privDisposeReason)throw new i.InvalidOperationError(t.privDisposeReason);throw new i.ObjectDisposedError("Queue")}if(t.privIsDisposing)throw new i.InvalidOperationError("Queue disposing")},this.privList=e||new o.List,this.privDetachables=[],this.privSubscribers=new o.List,this.privDetachables.push(this.privList.onAdded(this.drain))};t.Queue=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(73),s=function(e){function t(t,r,n){var i=e.call(this,t,r)||this;return i.privSignature=n,i}return i(t,e),t}(o.PlatformEvent);t.OCSPEvent=s;var a=function(e){function t(t){return e.call(this,"OCSPMemoryCacheHitEvent",o.EventType.Debug,t)||this}return i(t,e),t}(s);t.OCSPMemoryCacheHitEvent=a;var c=function(e){function t(t){return e.call(this,"OCSPCacheMissEvent",o.EventType.Debug,t)||this}return i(t,e),t}(s);t.OCSPCacheMissEvent=c;var p=function(e){function t(t){return e.call(this,"OCSPDiskCacheHitEvent",o.EventType.Debug,t)||this}return i(t,e),t}(s);t.OCSPDiskCacheHitEvent=p;var u=function(e){function t(t){return e.call(this,"OCSPCacheUpdateNeededEvent",o.EventType.Debug,t)||this}return i(t,e),t}(s);t.OCSPCacheUpdateNeededEvent=u;var h=function(e){function t(t){return e.call(this,"OCSPMemoryCacheStoreEvent",o.EventType.Debug,t)||this}return i(t,e),t}(s);t.OCSPMemoryCacheStoreEvent=h;var v=function(e){function t(t){return e.call(this,"OCSPDiskCacheStoreEvent",o.EventType.Debug,t)||this}return i(t,e),t}(s);t.OCSPDiskCacheStoreEvent=v;var l=function(e){function t(t){return e.call(this,"OCSPCacheUpdatehCompleteEvent",o.EventType.Debug,t)||this}return i(t,e),t}(s);t.OCSPCacheUpdatehCompleteEvent=l;var d=function(e){function t(){return e.call(this,"OCSPStapleReceivedEvent",o.EventType.Debug,"")||this}return i(t,e),t}(s);t.OCSPStapleReceivedEvent=d;var f=function(e){function t(t){return e.call(this,"OCSPWSUpgradeStartedEvent",o.EventType.Debug,t)||this}return i(t,e),t}(s);t.OCSPWSUpgradeStartedEvent=f;var g=function(e){function t(t,r){var n=e.call(this,"OCSPCacheEntryExpiredEvent",o.EventType.Debug,t)||this;return n.privExpireTime=r,n}return i(t,e),t}(s);t.OCSPCacheEntryExpiredEvent=g;var y=function(e){function t(t,r,n){var i=e.call(this,"OCSPCacheEntryNeedsRefreshEvent",o.EventType.Debug,t)||this;return i.privExpireTime=n,i.privStartTime=r,i}return i(t,e),t}(s);t.OCSPCacheEntryNeedsRefreshEvent=y;var m=function(e){function t(t,r,n){var i=e.call(this,"OCSPCacheHitEvent",o.EventType.Debug,t)||this;return i.privExpireTime=n,i.privExpireTimeString=new Date(n).toLocaleDateString(),i.privStartTime=r,i.privStartTimeString=new Date(r).toLocaleTimeString(),i}return i(t,e),t}(s);t.OCSPCacheHitEvent=m;var S=function(e){function t(t,r){var n=e.call(this,"OCSPVerificationFailedEvent",o.EventType.Debug,t)||this;return n.privError=r,n}return i(t,e),t}(s);t.OCSPVerificationFailedEvent=S;var C=function(e){function t(t,r){var n=e.call(this,"OCSPCacheFetchErrorEvent",o.EventType.Debug,t)||this;return n.privError=r,n}return i(t,e),t}(s);t.OCSPCacheFetchErrorEvent=C;var b=function(e){function t(t){return e.call(this,"OCSPResponseRetrievedEvent",o.EventType.Debug,t)||this}return i(t,e),t}(s);t.OCSPResponseRetrievedEvent=b;var P=function(e){function t(t,r){var n=e.call(this,"OCSPCacheUpdateErrorEvent",o.EventType.Debug,t)||this;return n.privError=r,n}return i(t,e),t}(s);t.OCSPCacheUpdateErrorEvent=P},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(6),o=r(63);t.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";var s=function(){function e(t,r,n){var o=this;this.privRecorder=t,this.deviceId=r,this.privStreams={},this.turnOn=function(){if(o.privInitializeDeferral)return o.privInitializeDeferral.promise();o.privInitializeDeferral=new i.Deferred;try{o.createAudioContext()}catch(t){if(t instanceof Error){var e=t;o.privInitializeDeferral.reject(e.name+": "+e.message)}else o.privInitializeDeferral.reject(t);return o.privInitializeDeferral.promise()}var t=window.navigator,r=t.getUserMedia||t.webkitGetUserMedia||t.mozGetUserMedia||t.msGetUserMedia;if(t.mediaDevices&&(r=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r).catch(n)}),r){var n=function(){o.onEvent(new i.AudioSourceInitializingEvent(o.privId)),r({audio:!o.deviceId||{deviceId:o.deviceId},video:!1},(function(e){o.privMediaStream=e,o.onEvent(new i.AudioSourceReadyEvent(o.privId)),o.privInitializeDeferral.resolve(!0)}),(function(e){var t="Error occurred during microphone initialization: "+e,r=o.privInitializeDeferral;o.privInitializeDeferral=null,r.reject(t),o.onEvent(new i.AudioSourceErrorEvent(o.privId,t))}))};"suspended"===o.privContext.state?o.privContext.resume().then(n,(function(e){o.privInitializeDeferral.reject("Failed to initialize audio context: "+e)})):n()}else{var s="Browser does not support getUserMedia.";o.privInitializeDeferral.reject(s),o.onEvent(new i.AudioSourceErrorEvent(s,""))}return o.privInitializeDeferral.promise()},this.id=function(){return o.privId},this.attach=function(e){return o.onEvent(new i.AudioStreamNodeAttachingEvent(o.privId,e)),o.listen(e).onSuccessContinueWith((function(t){return o.onEvent(new i.AudioStreamNodeAttachedEvent(o.privId,e)),{detach:function(){t.readEnded(),o.turnOff(),delete o.privStreams[e],o.onEvent(new i.AudioStreamNodeDetachedEvent(o.privId,e))},id:function(){return e},read:function(){return t.read()}}}))},this.detach=function(e){e&&o.privStreams[e]&&(o.privStreams[e].close(),delete o.privStreams[e],o.onEvent(new i.AudioStreamNodeDetachedEvent(o.privId,e)))},this.turnOff=function(){for(var e in o.privStreams)if(e){var t=o.privStreams[e];t&&t.close()}return o.onEvent(new i.AudioSourceOffEvent(o.privId)),o.privInitializeDeferral=null,o.destroyAudioContext(),i.PromiseHelper.fromResult(!0)},this.listen=function(e){return o.turnOn().onSuccessContinueWith((function(t){var r=new i.ChunkedArrayBufferStream(o.privOutputChunkSize,e);o.privStreams[e]=r;try{o.privRecorder.record(o.privContext,o.privMediaStream,r)}catch(t){throw o.onEvent(new i.AudioStreamNodeErrorEvent(o.privId,e,t)),t}return r}))},this.onEvent=function(e){o.privEvents.onEvent(e),i.Events.instance.onEvent(e)},this.createAudioContext=function(){if(!o.privContext){if("undefined"==typeof AudioContext)throw new Error("Browser does not support Web Audio API (AudioContext is not available).");navigator.mediaDevices.getSupportedConstraints().sampleRate?o.privContext=new AudioContext({sampleRate:e.AUDIOFORMAT.samplesPerSec}):o.privContext=new AudioContext}},this.destroyAudioContext=function(){if(o.privContext){o.privRecorder.releaseMediaResources(o.privContext);var e=!1;"close"in o.privContext&&(e=!0),e?(o.privContext.close(),o.privContext=null):null!==o.privContext&&"running"===o.privContext.state&&o.privContext.suspend()}},this.privOutputChunkSize=e.AUDIOFORMAT.avgBytesPerSec/10,this.privId=n||i.createNoDashGuid(),this.privEvents=new i.EventSource}return Object.defineProperty(e.prototype,"format",{get:function(){return i.PromiseHelper.fromResult(e.AUDIOFORMAT)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blob",{get:function(){return i.PromiseHelper.fromError("Not implemented for Mic input")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return this.privEvents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceInfo",{get:function(){return this.getMicrophoneLabel().onSuccessContinueWith((function(t){return{bitspersample:e.AUDIOFORMAT.bitsPerSample,channelcount:e.AUDIOFORMAT.channels,connectivity:n.connectivity.Unknown,manufacturer:"Speech SDK",model:t,samplerate:e.AUDIOFORMAT.samplesPerSec,type:n.type.Microphones}}))},enumerable:!0,configurable:!0}),e.prototype.setProperty=function(e,r){if(e!==t.AudioWorkletSourceURLPropertyName)throw new Error("Property '"+e+"' is not supported on Microphone.");this.privRecorder.setWorkletUrl(r)},e.prototype.getMicrophoneLabel=function(){var e=this;if(void 0!==this.privMicrophoneLabel)return i.PromiseHelper.fromResult(this.privMicrophoneLabel);if(void 0===this.privMediaStream||!this.privMediaStream.active)return i.PromiseHelper.fromResult("microphone");this.privMicrophoneLabel="microphone";var t=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(void 0===t)return i.PromiseHelper.fromResult(this.privMicrophoneLabel);var r=new i.Deferred;return navigator.mediaDevices.enumerateDevices().then((function(n){for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s.deviceId===t){e.privMicrophoneLabel=s.label;break}}r.resolve(e.privMicrophoneLabel)}),(function(){return r.resolve(e.privMicrophoneLabel)})),r.promise()},e.AUDIOFORMAT=o.AudioStreamFormat.getDefaultInputFormat(),e}();t.MicAudioSource=s},function(e,t,r){"use strict";(function(e){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),s=r(6),a=r(45),c=r(2),p=r(63),u=function(){function e(){}return e.createPushStream=function(e){return h.create(e)},e.createPullStream=function(e,t){return l.create(e,t)},e}();t.AudioInputStream=u;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.create=function(e){return new v(e)},t}(u);t.PushAudioInputStream=h;var v=function(t){function r(e){var r=t.call(this)||this;return r.onEvent=function(e){r.privEvents.onEvent(e),s.Events.instance.onEvent(e)},r.privFormat=void 0===e?p.AudioStreamFormatImpl.getDefaultInputFormat():e,r.privEvents=new s.EventSource,r.privId=a.createNoDashGuid(),r.privStream=new s.ChunkedArrayBufferStream(r.privFormat.avgBytesPerSec/10),r}return i(r,t),Object.defineProperty(r.prototype,"format",{get:function(){return s.PromiseHelper.fromResult(this.privFormat)},enumerable:!0,configurable:!0}),r.prototype.write=function(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})},r.prototype.close=function(){this.privStream.close()},r.prototype.id=function(){return this.privId},Object.defineProperty(r.prototype,"blob",{get:function(){var t=this;return this.attach("id").onSuccessContinueWithPromise((function(r){var n=[],i=e.from(""),o=function(){return r.read().onSuccessContinueWithPromise((function(r){return!r||r.isEnd?"undefined"!=typeof XMLHttpRequest?s.PromiseHelper.fromResult(new Blob(n)):s.PromiseHelper.fromResult(e.from(i)):("undefined"!=typeof Blob?n.push(r.buffer):i=e.concat([i,t.toBuffer(r.buffer)]),o())}))};return o()}))},enumerable:!0,configurable:!0}),r.prototype.turnOn=function(){return this.onEvent(new s.AudioSourceInitializingEvent(this.privId)),this.onEvent(new s.AudioSourceReadyEvent(this.privId)),s.PromiseHelper.fromResult(!0)},r.prototype.attach=function(e){var t=this;return this.onEvent(new s.AudioStreamNodeAttachingEvent(this.privId,e)),this.turnOn().onSuccessContinueWith((function(e){return t.privStream})).onSuccessContinueWith((function(r){return t.onEvent(new s.AudioStreamNodeAttachedEvent(t.privId,e)),{detach:function(){r.readEnded(),t.onEvent(new s.AudioStreamNodeDetachedEvent(t.privId,e)),t.turnOff()},id:function(){return e},read:function(){return r.read()}}}))},r.prototype.detach=function(e){this.onEvent(new s.AudioStreamNodeDetachedEvent(this.privId,e))},r.prototype.turnOff=function(){return s.PromiseHelper.fromResult(!1)},Object.defineProperty(r.prototype,"events",{get:function(){return this.privEvents},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"deviceInfo",{get:function(){return s.PromiseHelper.fromResult({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:o.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:o.type.Stream})},enumerable:!0,configurable:!0}),r.prototype.toBuffer=function(t){for(var r=e.alloc(t.byteLength),n=new Uint8Array(t),i=0;i<r.length;++i)r[i]=n[i];return r},r}(h);t.PushAudioInputStreamImpl=v;var l=function(e){function t(){return e.call(this)||this}return i(t,e),t.create=function(e,t){return new d(e,t)},t}(u);t.PullAudioInputStream=l;var d=function(e){function t(t,r){var n=e.call(this)||this;return n.onEvent=function(e){n.privEvents.onEvent(e),s.Events.instance.onEvent(e)},n.privFormat=void 0===r?c.AudioStreamFormat.getDefaultInputFormat():r,n.privEvents=new s.EventSource,n.privId=a.createNoDashGuid(),n.privCallback=t,n.privIsClosed=!1,n.privBufferSize=n.privFormat.avgBytesPerSec/10,n}return i(t,e),Object.defineProperty(t.prototype,"format",{get:function(){return s.PromiseHelper.fromResult(this.privFormat)},enumerable:!0,configurable:!0}),t.prototype.close=function(){this.privIsClosed=!0,this.privCallback.close()},t.prototype.id=function(){return this.privId},Object.defineProperty(t.prototype,"blob",{get:function(){return s.PromiseHelper.fromError("Not implemented")},enumerable:!0,configurable:!0}),t.prototype.turnOn=function(){return this.onEvent(new s.AudioSourceInitializingEvent(this.privId)),this.onEvent(new s.AudioSourceReadyEvent(this.privId)),s.PromiseHelper.fromResult(!0)},t.prototype.attach=function(e){var t=this;return this.onEvent(new s.AudioStreamNodeAttachingEvent(this.privId,e)),this.turnOn().onSuccessContinueWith((function(r){return t.onEvent(new s.AudioStreamNodeAttachedEvent(t.privId,e)),{detach:function(){t.privCallback.close(),t.onEvent(new s.AudioStreamNodeDetachedEvent(t.privId,e)),t.turnOff()},id:function(){return e},read:function(){for(var e,r=0;r<t.privBufferSize;){var n=new ArrayBuffer(t.privBufferSize-r),i=t.privCallback.read(n);if(void 0===e)e=n;else new Int8Array(e).set(new Int8Array(n),r);if(0===i)break;r+=i}return s.PromiseHelper.fromResult({buffer:e.slice(0,r),isEnd:t.privIsClosed||0===r,timeReceived:Date.now()})}}}))},t.prototype.detach=function(e){this.onEvent(new s.AudioStreamNodeDetachedEvent(this.privId,e))},t.prototype.turnOff=function(){return s.PromiseHelper.fromResult(!1)},Object.defineProperty(t.prototype,"events",{get:function(){return this.privEvents},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deviceInfo",{get:function(){return s.PromiseHelper.fromResult({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:o.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:o.type.Stream})},enumerable:!0,configurable:!0}),t}(l);t.PullAudioInputStreamImpl=d}).call(this,r(74).Buffer)},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o,s,a,c,p){var u=e.call(this,r,n,i,o,s,void 0,void 0,a,c,p)||this;return u.privTranslations=t,u}return i(t,e),Object.defineProperty(t.prototype,"translations",{get:function(){return this.privTranslations},enumerable:!0,configurable:!0}),t}(r(2).SpeechRecognitionResult);t.TranslationRecognitionResult=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=function(){function e(){this.privKeys=[],this.privValues=[]}return e.prototype.getProperty=function(e,t){var r;r="string"==typeof e?e:n.PropertyId[e];for(var i=0;i<this.privKeys.length;i++)if(this.privKeys[i]===r)return this.privValues[i];return t},e.prototype.setProperty=function(e,t){var r;r="string"==typeof e?e:n.PropertyId[e];for(var i=0;i<this.privKeys.length;i++)if(this.privKeys[i]===r)return void(this.privValues[i]=t);this.privKeys.push(r),this.privValues.push(t)},e.prototype.clone=function(){for(var t=new e,r=0;r<this.privKeys.length;r++)t.privKeys.push(this.privKeys[r]),t.privValues.push(this.privValues[r]);return t},e.prototype.mergeTo=function(e){var t=this;this.privKeys.forEach((function(r){if(void 0===e.getProperty(r,void 0)){var n=t.getProperty(r);e.setProperty(r,n)}}))},e}();t.PropertyCollection=i},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(28),s=r(5),a=r(2),c=r(64),p=r(5),u=r(65),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",t.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",t.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",t.create=function(e,r,n){var i=e.parameters.getProperty(a.PropertyId.SpeechServiceConnection_Endpoint,void 0),c=e.parameters.getProperty(a.PropertyId.SpeechServiceConnection_Region,void 0),h=c&&c.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",v=e.parameters.getProperty(a.PropertyId.SpeechServiceConnection_Host,"wss://"+c+".stt.speech"+h),l={},d=e.parameters.getProperty(a.PropertyId.SpeechServiceConnection_EndpointId,void 0),f=e.parameters.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(d?i&&-1!==i.search(u.QueryParameterNames.DeploymentIdParamName)||(l[u.QueryParameterNames.DeploymentIdParamName]=d):f&&(i&&-1!==i.search(u.QueryParameterNames.LanguageParamName)||(l[u.QueryParameterNames.LanguageParamName]=f)),i&&-1!==i.search(u.QueryParameterNames.FormatParamName)||(l[u.QueryParameterNames.FormatParamName]=e.parameters.getProperty(s.OutputFormatPropertyName,a.OutputFormat[a.OutputFormat.Simple]).toLowerCase()),void 0!==e.autoDetectSourceLanguages&&(l[u.QueryParameterNames.EnableLanguageID]="true"),t.setCommonUrlParams(e,l,i),!i)switch(e.recognitionMode){case p.RecognitionMode.Conversation:i="true"===e.parameters.getProperty(s.ForceDictationPropertyName,"false")?v+t.dictationRelativeUri:v+t.conversationRelativeUri;break;case p.RecognitionMode.Dictation:i=v+t.dictationRelativeUri;break;default:i=v+t.interactiveRelativeUri}var g={};return void 0!==r.token&&""!==r.token&&(g[r.headerName]=r.token),g[u.QueryParameterNames.ConnectionIdHeader]=n,e.parameters.setProperty(a.PropertyId.SpeechServiceConnection_Url,i),new o.WebsocketConnection(i,l,g,new p.WebsocketMessageFormatter,o.ProxyInfo.fromRecognizerConfig(e),n)},t}return i(t,e),t}(c.ConnectionFactoryBase);t.SpeechConnectionFactory=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r){this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}return Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ErrorCode",{get:function(){return this.privErrorCode},enumerable:!0,configurable:!0}),e}();t.CancellationDetailsBase=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(157),o=r(105),s=function(){};t.ConnectionMessage=s;var a=function(){function e(e){var t=this;this.privConnectionMessage=e,this.privProperties=new i.PropertyCollection,this.privConnectionMessage.headers["X-ConnectionId"]&&this.privProperties.setProperty(o.PropertyId.Speech_SessionId,this.privConnectionMessage.headers["X-ConnectionId"]),Object.keys(this.privConnectionMessage.headers).forEach((function(e,r,n){t.privProperties.setProperty(e,t.privConnectionMessage.headers[e])}))}return Object.defineProperty(e.prototype,"path",{get:function(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find((function(e){return e.toLowerCase()==="path".toLowerCase()}))]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTextMessage",{get:function(){return this.privConnectionMessage.messageType===n.MessageType.Text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBinaryMessage",{get:function(){return this.privConnectionMessage.messageType===n.MessageType.Binary},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TextMessage",{get:function(){return this.privConnectionMessage.textBody},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryMessage",{get:function(){return this.privConnectionMessage.binaryBody},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return""},e}();t.ConnectionMessageImpl=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162);t.Conversation=n.Conversation;var i=r(316);t.ConversationExpirationEventArgs=i.ConversationExpirationEventArgs;var o=r(317);t.ConversationParticipantsChangedEventArgs=o.ConversationParticipantsChangedEventArgs;var s=r(318);t.ConversationTranslationCanceledEventArgs=s.ConversationTranslationCanceledEventArgs;var a=r(319);t.ConversationTranslationEventArgs=a.ConversationTranslationEventArgs;var c=r(320);t.ConversationTranslationResult=c.ConversationTranslationResult;var p=r(321);t.ConversationTranslator=p.ConversationTranslator;var u=r(322);t.Participant=u.Participant,t.User=u.User;var h=r(323);t.ParticipantChangedReason=h.ParticipantChangedReason},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n};Object.defineProperty(t,"__esModule",{value:!0});var s=r(5),a=r(10),c=r(2),p=function(){function e(){}return e.createConversationAsync=function(e,t,r){a.Contracts.throwIfNullOrUndefined(e,s.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),a.Contracts.throwIfNullOrUndefined(e.region,s.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),e.subscriptionKey||e.getProperty(c.PropertyId[c.PropertyId.SpeechServiceAuthorization_Token])||a.Contracts.throwIfNullOrUndefined(e.subscriptionKey,s.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));var n=new u(e);return n.createConversationAsync((function(){t&&t()}),(function(e){r&&r(e)})),n},e}();t.Conversation=p;var u=function(e){function t(t){var r=e.call(this)||this;r.privIsDisposed=!1,r.privIsConnected=!1,r.privErrors=s.ConversationConnectionConfig.restErrors,r.onConnected=function(e){r.privIsConnected=!0;try{r.privConversationTranslator.sessionStarted&&r.privConversationTranslator.sessionStarted(r.privConversationTranslator,e)}catch(e){}},r.onDisconnected=function(e){r.close(!1);try{r.privConversationTranslator.sessionStopped&&r.privConversationTranslator.sessionStopped(r.privConversationTranslator,e)}catch(e){}},r.onCanceled=function(e,t){r.close(!1);try{r.privConversationTranslator.canceled&&r.privConversationTranslator.canceled(r.privConversationTranslator,t)}catch(t){}},r.onParticipantUpdateCommandReceived=function(e,t){var n,i;try{var o=r.privParticipants.getParticipant(t.id);if(void 0!==o){switch(t.key){case s.ConversationTranslatorCommandTypes.changeNickname:o.displayName=t.value;break;case s.ConversationTranslatorCommandTypes.setUseTTS:o.useTts=t.value;break;case s.ConversationTranslatorCommandTypes.setProfanityFiltering:o.profanity=t.value;break;case s.ConversationTranslatorCommandTypes.setMute:o.isMuted=t.value;break;case s.ConversationTranslatorCommandTypes.setTranslateToLanguages:o.translateToLanguages=t.value}r.privParticipants.addOrUpdateParticipant(o),(null===(n=r.privConversationTranslator)||void 0===n?void 0:n.participantsChanged)&&(null===(i=r.privConversationTranslator)||void 0===i||i.participantsChanged(r.privConversationTranslator,new c.ConversationParticipantsChangedEventArgs(c.ParticipantChangedReason.Updated,[r.toParticipant(o)],t.sessionId)))}}catch(t){}},r.onLockRoomCommandReceived=function(e,t){},r.onMuteAllCommandReceived=function(e,t){var n,i;try{r.privParticipants.participants.forEach((function(e){return e.isMuted=!e.isHost&&t.isMuted})),(null===(n=r.privConversationTranslator)||void 0===n?void 0:n.participantsChanged)&&(null===(i=r.privConversationTranslator)||void 0===i||i.participantsChanged(r.privConversationTranslator,new c.ConversationParticipantsChangedEventArgs(c.ParticipantChangedReason.Updated,r.toParticipants(!1),t.sessionId)))}catch(t){}},r.onParticipantJoinCommandReceived=function(e,t){var n,i;try{var o=r.privParticipants.addOrUpdateParticipant(t.participant);void 0!==o&&(null===(n=r.privConversationTranslator)||void 0===n?void 0:n.participantsChanged)&&(null===(i=r.privConversationTranslator)||void 0===i||i.participantsChanged(r.privConversationTranslator,new c.ConversationParticipantsChangedEventArgs(c.ParticipantChangedReason.JoinedConversation,[r.toParticipant(o)],t.sessionId)))}catch(t){}},r.onParticipantLeaveCommandReceived=function(e,t){var n,i;try{var o=r.privParticipants.getParticipant(t.participant.id);void 0!==o&&(r.privParticipants.deleteParticipant(t.participant.id),(null===(n=r.privConversationTranslator)||void 0===n?void 0:n.participantsChanged)&&(null===(i=r.privConversationTranslator)||void 0===i||i.participantsChanged(r.privConversationTranslator,new c.ConversationParticipantsChangedEventArgs(c.ParticipantChangedReason.LeftConversation,[r.toParticipant(o)],t.sessionId))))}catch(t){}},r.onTranslationReceived=function(e,t){var n,i,o,a,p,u;try{switch(t.command){case s.ConversationTranslatorMessageTypes.final:(null===(n=r.privConversationTranslator)||void 0===n?void 0:n.transcribed)&&(null===(i=r.privConversationTranslator)||void 0===i||i.transcribed(r.privConversationTranslator,new c.ConversationTranslationEventArgs(t.payload,void 0,t.sessionId)));break;case s.ConversationTranslatorMessageTypes.partial:(null===(o=r.privConversationTranslator)||void 0===o?void 0:o.transcribing)&&(null===(a=r.privConversationTranslator)||void 0===a||a.transcribing(r.privConversationTranslator,new c.ConversationTranslationEventArgs(t.payload,void 0,t.sessionId)));break;case s.ConversationTranslatorMessageTypes.instantMessage:(null===(p=r.privConversationTranslator)||void 0===p?void 0:p.textMessageReceived)&&(null===(u=r.privConversationTranslator)||void 0===u||u.textMessageReceived(r.privConversationTranslator,new c.ConversationTranslationEventArgs(t.payload,void 0,t.sessionId)))}}catch(t){}},r.onParticipantsListReceived=function(e,t){var n,i;try{if(void 0!==t.sessionToken&&null!==t.sessionToken&&(r.privRoom.token=t.sessionToken),r.privParticipants.participants=o(t.participants),void 0!==r.privParticipants.me&&(r.privIsReady=!0),(null===(n=r.privConversationTranslator)||void 0===n?void 0:n.participantsChanged)&&(null===(i=r.privConversationTranslator)||void 0===i||i.participantsChanged(r.privConversationTranslator,new c.ConversationParticipantsChangedEventArgs(c.ParticipantChangedReason.JoinedConversation,r.toParticipants(!0),t.sessionId))),r.me.isHost){var s=r.privConversationTranslator.properties.getProperty(c.PropertyId.ConversationTranslator_Name);void 0!==s&&s.length>0&&s!==r.me.displayName&&r.changeNicknameAsync(s)}}catch(t){}},r.onConversationExpiration=function(e,t){var n,i;try{(null===(n=r.privConversationTranslator)||void 0===n?void 0:n.conversationExpiration)&&(null===(i=r.privConversationTranslator)||void 0===i||i.conversationExpiration(r.privConversationTranslator,t))}catch(t){}},r.privProperties=new c.PropertyCollection,r.privManager=new s.ConversationManager,t.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage])||t.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage],s.ConversationConnectionConfig.defaultLanguageCode),r.privLanguage=t.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage]),0===t.targetLanguages.length&&t.addTargetLanguage(r.privLanguage),t.getProperty(c.PropertyId[c.PropertyId.SpeechServiceResponse_ProfanityOption])||t.setProfanity(c.ProfanityOption.Masked);var n=t.getProperty(c.PropertyId[c.PropertyId.ConversationTranslator_Name]);(null==n||n.length<=1||n.length>50)&&(n="Host"),t.setProperty(c.PropertyId[c.PropertyId.ConversationTranslator_Name],n),r.privConfig=t;var i=t;return a.Contracts.throwIfNull(i,"speechConfig"),r.privProperties=i.properties.clone(),r.privIsConnected=!1,r.privParticipants=new s.InternalParticipants,r.privIsReady=!1,r.privTextMessageMaxLength=1e3,r}return i(t,e),Object.defineProperty(t.prototype,"conversationTranslator",{set:function(e){this.privConversationTranslator=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"room",{get:function(){return this.privRoom},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connection",{get:function(){return this.privConversationRecognizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorizationToken",{get:function(){return this.privToken},set:function(e){a.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this.privConfig},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"conversationId",{get:function(){return this.privRoom?this.privRoom.roomId:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{get:function(){return this.privLanguage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMutedByHost",{get:function(){var e,t;return!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)&&(null===(t=this.privParticipants.me)||void 0===t?void 0:t.isMuted)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isConnected",{get:function(){return this.privIsConnected&&this.privIsReady},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"participants",{get:function(){return this.toParticipants(!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"me",{get:function(){return this.toParticipant(this.privParticipants.me)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"host",{get:function(){return this.toParticipant(this.privParticipants.host)},enumerable:!0,configurable:!0}),t.prototype.createConversationAsync=function(e,t){var r=this;try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,(function(n){n||r.handleError(new Error(r.privErrors.permissionDeniedConnect),t),r.privRoom=n,r.handleCallback(e,t)}),(function(e){r.handleError(e,t)}))}catch(e){this.handleError(e,t)}},t.prototype.startConversationAsync=function(e,t){var r=this;try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),a.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=new s.ConversationTranslatorRecognizer(this.privConfig),this.privConversationRecognizer.conversation=this.privRoom,this.privConversationRecognizerConnection=c.Connection.fromRecognizer(this.privConversationRecognizer),this.privConversationRecognizerConnection.connected=this.onConnected,this.privConversationRecognizerConnection.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(function(){r.handleCallback(e,t)}),(function(e){r.handleError(e,t)}))}catch(e){this.handleError(e,t)}},t.prototype.joinConversationAsync=function(e,t,r,n,i){var o=this;try{a.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),a.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),a.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,(function(e){a.Contracts.throwIfNullOrUndefined(e,o.privErrors.permissionDeniedConnect),o.privRoom=e,o.privConfig.authorizationToken=e.cognitiveSpeechAuthToken,n&&n(e.cognitiveSpeechAuthToken)}),(function(e){o.handleError(e,i)}))}catch(e){this.handleError(e,i)}},t.prototype.deleteConversationAsync=function(e,t){var r=this;try{a.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),a.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),this.privManager.leave(this.privProperties,this.privRoom.token,(function(){r.handleCallback(e,t)}),(function(e){r.handleError(e,t)})),this.dispose()}catch(e){this.handleError(e,t)}},t.prototype.endConversationAsync=function(e,t){try{this.close(!0),this.handleCallback(e,t)}catch(e){this.handleError(e,t)}},t.prototype.lockConversationAsync=function(e,t){var r,n=this;try{a.Contracts.throwIfDisposed(this.privIsDisposed),a.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),a.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),null===(r=this.privConversationRecognizer)||void 0===r||r.sendLockRequest(!0,(function(){n.handleCallback(e,t)}),(function(e){n.handleError(e,t)}))}catch(e){this.handleError(e,t)}},t.prototype.muteAllParticipantsAsync=function(e,t){var r,n=this;try{a.Contracts.throwIfDisposed(this.privIsDisposed),a.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),a.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),a.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),null===(r=this.privConversationRecognizer)||void 0===r||r.sendMuteAllRequest(!0,(function(){n.handleCallback(e,t)}),(function(e){n.handleError(e,t)}))}catch(e){this.handleError(e,t)}},t.prototype.muteParticipantAsync=function(e,t,r){var n,i=this;try{a.Contracts.throwIfDisposed(this.privIsDisposed),a.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),a.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),a.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),null===(n=this.privConversationRecognizer)||void 0===n||n.sendMuteRequest(e,!0,(function(){i.handleCallback(t,r)}),(function(e){i.handleError(e,r)}))}catch(e){this.handleError(e,r)}},t.prototype.removeParticipantAsync=function(e,t,r){var n,i=this;try{a.Contracts.throwIfDisposed(this.privIsDisposed),a.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),a.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),r);var o="";if("string"==typeof e)o=e;else if(e.hasOwnProperty("id")){o=e.id}else if(e.hasOwnProperty("userId")){o=e.userId}a.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","userId")),-1===this.participants.findIndex((function(e){return e.id===o}))&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),null===(n=this.privConversationRecognizer)||void 0===n||n.sendEjectRequest(o,(function(){i.handleCallback(t,r)}),(function(e){i.handleError(e,r)}))}catch(e){this.handleError(e,r)}},t.prototype.unlockConversationAsync=function(e,t){var r,n=this;try{a.Contracts.throwIfDisposed(this.privIsDisposed),a.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),a.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),null===(r=this.privConversationRecognizer)||void 0===r||r.sendLockRequest(!1,(function(){n.handleCallback(e,t)}),(function(e){n.handleError(e,t)}))}catch(e){this.handleError(e,t)}},t.prototype.unmuteAllParticipantsAsync=function(e,t){var r,n=this;try{a.Contracts.throwIfDisposed(this.privIsDisposed),a.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),a.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),null===(r=this.privConversationRecognizer)||void 0===r||r.sendMuteAllRequest(!1,(function(){n.handleCallback(e,t)}),(function(e){n.handleError(e,t)}))}catch(e){this.handleError(e,t)}},t.prototype.unmuteParticipantAsync=function(e,t,r){var n,i=this;try{a.Contracts.throwIfDisposed(this.privIsDisposed),a.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),a.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),a.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),null===(n=this.privConversationRecognizer)||void 0===n||n.sendMuteRequest(e,!1,(function(){i.handleCallback(t,r)}),(function(e){i.handleError(e,r)}))}catch(e){this.handleError(e,r)}},t.prototype.sendTextMessageAsync=function(e,t,r){var n,i=this;try{a.Contracts.throwIfDisposed(this.privIsDisposed),a.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),a.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),a.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),r),null===(n=this.privConversationRecognizer)||void 0===n||n.sendMessageRequest(e,(function(){i.handleCallback(t,r)}),(function(e){i.handleError(e,r)}))}catch(e){this.handleError(e,r)}},t.prototype.changeNicknameAsync=function(e,t,r){var n,i=this;try{a.Contracts.throwIfDisposed(this.privIsDisposed),a.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),a.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),a.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),null===(n=this.privConversationRecognizer)||void 0===n||n.sendChangeNicknameRequest(e,(function(){i.handleCallback(t,r)}),(function(e){i.handleError(e,r)}))}catch(e){this.handleError(e,r)}},t.prototype.isDisposed=function(){return this.privIsDisposed},t.prototype.dispose=function(e){var t;this.isDisposed||(this.privIsDisposed=!0,null===(t=this.config)||void 0===t||t.close(),this.privConversationRecognizerConnection&&(this.privConversationRecognizerConnection.closeConnection(),this.privConversationRecognizerConnection.close(),this.privConversationRecognizerConnection=void 0),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privConversationRecognizer=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0,this.privRoom=void 0)},t.prototype.close=function(e){var t,r,n;try{this.privIsConnected=!1,null===(t=this.privConversationRecognizerConnection)||void 0===t||t.closeConnection(),null===(r=this.privConversationRecognizerConnection)||void 0===r||r.close(),this.privConversationRecognizer.close(),this.privConversationRecognizerConnection=void 0,this.privConversationRecognizer=void 0,null===(n=this.privConversationTranslator)||void 0===n||n.dispose()}catch(e){}e&&this.dispose()},Object.defineProperty(t.prototype,"canSend",{get:function(){var e;return this.privIsConnected&&!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isMuted)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canSendAsHost",{get:function(){var e;return this.privIsConnected&&(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)},enumerable:!0,configurable:!0}),t.prototype.handleCallback=function(e,t){if(e){try{e()}catch(e){t&&t(e)}e=void 0}},t.prototype.handleError=function(e,t){if(t)if(e instanceof Error){var r=e;t(r.name+": "+r.message)}else t(e)},t.prototype.toParticipants=function(e){var t=this,r=this.privParticipants.participants.map((function(e){return t.toParticipant(e)}));return e?r:r.filter((function(e){return!1===e.isHost}))},t.prototype.toParticipant=function(e){return new c.Participant(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage)},t}(p);t.ConversationImpl=u},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(325)),o=r(10),s=function(){function e(e){var t=this;this.id=function(){return t.privId},this.privFd=i.openSync(e,"w")}return Object.defineProperty(e.prototype,"format",{set:function(e){o.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;var t=0;this.privAudioFormat.hasHeader&&(t=this.privAudioFormat.header.byteLength),void 0!==this.privFd&&(this.privWriteStream=i.createWriteStream("",{fd:this.privFd,start:t,autoClose:!1}))},enumerable:!0,configurable:!0}),e.prototype.write=function(e){o.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),void 0!==this.privWriteStream&&this.privWriteStream.write(new Uint8Array(e.slice(0)))},e.prototype.close=function(){var e=this;void 0!==this.privFd&&(this.privWriteStream.on("finish",(function(){e.privAudioFormat.hasHeader&&(e.privAudioFormat.updateHeader(e.privWriteStream.bytesWritten),i.writeSync(e.privFd,new Int8Array(e.privAudioFormat.header),0,e.privAudioFormat.header.byteLength,0)),i.closeSync(e.privFd),e.privFd=void 0})),this.privWriteStream.end())},e}();t.AudioFileWriter=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privActivityResponse=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"conversationId",{get:function(){return this.privActivityResponse.conversationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"messageDataStreamType",{get:function(){return this.privActivityResponse.messageDataStreamType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"messagePayload",{get:function(){return this.privActivityResponse.messagePayload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this.privActivityResponse.version},enumerable:!0,configurable:!0}),e}();t.ActivityPayloadResponse=n,function(e){e[e.None=0]="None",e[e.TextToSpeechAudio=1]="TextToSpeechAudio"}(t.MessageDataStreamType||(t.MessageDataStreamType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(110);function i(e,t){void 0===t&&(t={});var r=function(e){return void 0===e&&(e={}),Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")}(t);return r?e+(-1===e.indexOf("?")?"?":"&")+r:e}function o(e,t){return void 0===t&&(t=null),{data:t||e.statusText,headers:e.getAllResponseHeaders(),json:function(){return JSON.parse(t||'"'+e.statusText+'"')},ok:!1,status:e.status,statusText:e.statusText}}t.extractHeaderValue=function(e,t){var r="";try{var n=t.trim().split(/[\r\n]+/),i={};n.forEach((function(e){var t=e.split(": "),r=t.shift().toLowerCase(),n=t.join(": ");i[r]=n})),r=i[e.toLowerCase()]}catch(e){}return r},t.request=function(e,t,r,s,a,c){void 0===r&&(r={}),void 0===s&&(s=null),void 0===a&&(a={});var p=n.RestConfigBase.requestOptions,u=a.ignoreCache||p.ignoreCache,h=a.headers||p.headers,v=a.timeout||p.timeout,l=new XMLHttpRequest;l.open(e,i(t,r),!0),h&&Object.keys(h).forEach((function(e){return l.setRequestHeader(e,h[e])})),u&&l.setRequestHeader("Cache-Control","no-cache"),l.timeout=v,l.onload=function(e){c(function(e){return{data:e.responseText,headers:e.getAllResponseHeaders(),json:function(){return JSON.parse(e.responseText)},ok:e.status>=200&&e.status<300,status:e.status,statusText:e.statusText}}(l))},l.onerror=function(e){c(o(l,"Failed to make request."))},l.ontimeout=function(e){c(o(l,"Request took longer than expected."))},"post"===e&&s?(l.setRequestHeader("Content-Type","application/json"),l.send(JSON.stringify(s))):l.send()},t.PromiseToEmptyCallback=function(e,t,r){e?e.continueWith((function(e){try{e.isError?r&&r(e.error):t&&t()}catch(t){r&&r("'Unhandled error on promise callback: "+t+". InnerError: "+e.error+"'")}})):r&&r("Null promise")}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i){var o=e.call(this,t,r,n,i)||this,s=JSON.parse(o.textBody);return void 0!==s.type&&(o.privConversationMessageType=s.type),o}return i(t,e),Object.defineProperty(t.prototype,"conversationMessageType",{get:function(){return this.privConversationMessageType},enumerable:!0,configurable:!0}),t}(r(6).ConnectionMessage);t.ConversationConnectionMessage=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),s=function(e){function t(t,r){var n=e.call(this,r)||this;return n.privIsMuted=t,n}return i(t,e),Object.defineProperty(t.prototype,"isMuted",{get:function(){return this.privIsMuted},enumerable:!0,configurable:!0}),t}(o.SessionEventArgs);t.MuteAllEventArgs=s;var a=function(e){function t(t,r){var n=e.call(this,r)||this;return n.privIsLocked=t,n}return i(t,e),Object.defineProperty(t.prototype,"isMuted",{get:function(){return this.privIsLocked},enumerable:!0,configurable:!0}),t}(o.SessionEventArgs);t.LockRoomEventArgs=a;var c=function(e){function t(t,r){var n=e.call(this,r)||this;return n.privParticipant=t,n}return i(t,e),Object.defineProperty(t.prototype,"participant",{get:function(){return this.privParticipant},enumerable:!0,configurable:!0}),t}(o.SessionEventArgs);t.ParticipantEventArgs=c;var p=function(e){function t(t,r,n,i){var o=e.call(this,i)||this;return o.privKey=r,o.privValue=n,o.privParticipantId=t,o}return i(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.privValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.privKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.privParticipantId},enumerable:!0,configurable:!0}),t}(o.SessionEventArgs);t.ParticipantAttributeEventArgs=p;var u=function(e){function t(t,r,n,i,o,s,a,c,p){var u=e.call(this,p)||this;return u.privRoomId=t,u.privSessionToken=r,u.privTranslateTo=n,u.privProfanityFilter=i,u.privRoomProfanityFilter=o,u.privIsRoomLocked=s,u.privIsRoomLocked=a,u.privParticipants=c,u}return i(t,e),Object.defineProperty(t.prototype,"sessionToken",{get:function(){return this.privSessionToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"conversationId",{get:function(){return this.privRoomId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"translateTo",{get:function(){return this.privTranslateTo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"profanityFilter",{get:function(){return this.privProfanityFilter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roomProfanityFilter",{get:function(){return this.privRoomProfanityFilter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRoomLocked",{get:function(){return this.privIsRoomLocked},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMuteAll",{get:function(){return this.privIsMuteAll},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"participants",{get:function(){return this.privParticipants},enumerable:!0,configurable:!0}),t}(o.SessionEventArgs);t.ParticipantsListEventArgs=u;var h=function(){function e(e,t,r){this.privPayload=t,this.privCommand=e,this.privSessionId=r}return Object.defineProperty(e.prototype,"payload",{get:function(){return this.privPayload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"command",{get:function(){return this.privCommand},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!0,configurable:!0}),e}();t.ConversationReceivedTranslationEventArgs=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(2),o=r(5),s=r(108),a=function(){function e(t,r,a,c,p){var u=this;if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.fetchConnectionOverride=void 0,this.receiveMessage=function(){return u.fetchConnection().on((function(t){return t.read().onSuccessContinueWithPromise((function(t){if(void 0!==u.receiveMessageOverride)return u.receiveMessageOverride();if(u.privIsDisposed)return n.PromiseHelper.fromResult(void 0);if(!t)return u.privSynthesisTurn.isSynthesizing?u.receiveMessage():n.PromiseHelper.fromResult(!0);u.privServiceHasSentMessage=!0;var r=s.SpeechConnectionMessage.fromConnectionMessage(t);if(r.requestId.toLowerCase()===u.privSynthesisTurn.requestId.toLowerCase())switch(r.path.toLowerCase()){case"turn.start":u.privSynthesisTurn.onServiceTurnStartResponse();break;case"response":u.privSynthesisTurn.onServiceResponseMessage(r.textBody);break;case"audio":if(u.privSynthesisTurn.streamId.toLowerCase()===r.streamId.toLowerCase()&&r.binaryBody){if(u.privSynthesisTurn.onAudioChunkReceived(r.binaryBody),u.privSpeechSynthesizer.synthesizing)try{var a=e.addHeader(r.binaryBody,u.privSynthesisTurn.audioOutputFormat),c=new i.SpeechSynthesisEventArgs(new i.SpeechSynthesisResult(u.privSynthesisTurn.requestId,i.ResultReason.SynthesizingAudio,a));u.privSpeechSynthesizer.synthesizing(u.privSpeechSynthesizer,c)}catch(e){}void 0!==u.privSessionAudioDestination&&u.privSessionAudioDestination.write(r.binaryBody)}break;case"audio.metadata":for(var p=0,h=o.SynthesisAudioMetadata.fromJSON(r.textBody).Metadata;p<h.length;p++){var v=h[p];if(v.Type.toLowerCase()==="WordBoundary".toLowerCase()){u.privSynthesisTurn.onWordBoundaryEvent(v.Data.text.Text);c=new i.SpeechSynthesisWordBoundaryEventArgs(v.Data.Offset,v.Data.text.Text,v.Data.text.Length,u.privSynthesisTurn.currentTextOffset);if(u.privSpeechSynthesizer.wordBoundary)try{u.privSpeechSynthesizer.wordBoundary(u.privSpeechSynthesizer,c)}catch(e){}}}break;case"turn.end":u.privSynthesisTurn.onServiceTurnEndResponse();var l=void 0;try{l=new i.SpeechSynthesisResult(u.privSynthesisTurn.requestId,i.ResultReason.SynthesizingAudioCompleted,u.privSynthesisTurn.allReceivedAudioWithHeader),u.privSuccessCallback&&u.privSuccessCallback(l)}catch(e){u.privErrorCallback&&u.privErrorCallback(e)}if(u.privSpeechSynthesizer.synthesisCompleted)try{u.privSpeechSynthesizer.synthesisCompleted(u.privSpeechSynthesizer,new i.SpeechSynthesisEventArgs(l))}catch(e){}break;default:u.processTypeSpecificMessages(r)||u.privServiceEvents&&u.serviceEvents.onEvent(new n.ServiceEvent(r.path.toLowerCase(),r.textBody))}return u.receiveMessage()}))}),(function(e){}))},this.sendSynthesisContext=function(e){var t=u.synthesisContext.toJSON();return t?e.send(new s.SpeechConnectionMessage(n.MessageType.Text,"synthesis.context",u.privSynthesisTurn.requestId,"application/json",t)):n.PromiseHelper.fromResult(!0)},this.sendSpeechServiceConfig=function(e,t){return t?e.send(new s.SpeechConnectionMessage(n.MessageType.Text,"speech.config",u.privSynthesisTurn.requestId,"application/json",t)):n.PromiseHelper.fromResult(!0)},this.sendSsmlMessage=function(e,t,r){return e.send(new s.SpeechConnectionMessage(n.MessageType.Text,"ssml",r,"application/ssml+xml",t))},this.fetchConnection=function(){return void 0!==u.fetchConnectionOverride?u.fetchConnectionOverride():u.configureConnection()},!t)throw new n.ArgumentNullError("authentication");if(!r)throw new n.ArgumentNullError("connectionFactory");if(!a)throw new n.ArgumentNullError("synthesizerConfig");this.privAuthentication=t,this.privConnectionFactory=r,this.privSynthesizerConfig=a,this.privIsDisposed=!1,this.privSpeechSynthesizer=c,this.privSessionAudioDestination=p,this.privSynthesisTurn=new o.SynthesisTurn,this.privConnectionEvents=new n.EventSource,this.privServiceEvents=new n.EventSource,this.privSynthesisContext=new o.SynthesisContext(this.privSpeechSynthesizer),this.privAgentConfig=new o.AgentConfig,this.connectionEvents.attach((function(e){if("ConnectionClosedEvent"===e.name){var t=e;u.cancelSynthesisLocal(i.CancellationReason.Error,1007===t.statusCode?i.CancellationErrorCode.BadRequestParameters:i.CancellationErrorCode.ConnectionFailure,t.reason+" websocket error code: "+t.statusCode)}}))}return Object.defineProperty(e.prototype,"synthesisContext",{get:function(){return this.privSynthesisContext},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"agentConfig",{get:function(){return this.privAgentConfig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectionEvents",{get:function(){return this.privConnectionEvents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serviceEvents",{get:function(){return this.privServiceEvents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activityTemplate",{get:function(){return this.privActivityTemplate},set:function(e){this.privActivityTemplate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioOutputFormat",{set:function(e){this.privAudioOutputFormat=e,this.privSynthesisTurn.audioOutputFormat=e,void 0!==this.privSessionAudioDestination&&(this.privSessionAudioDestination.format=e),void 0!==this.synthesisContext&&(this.synthesisContext.audioOutputFormat=e)},enumerable:!0,configurable:!0}),e.addHeader=function(e,t){if(!t.hasHeader)return e;t.updateHeader(e.byteLength);var r=new Uint8Array(e.byteLength+t.header.byteLength);return r.set(new Uint8Array(t.header),0),r.set(new Uint8Array(e),t.header.byteLength),r.buffer},e.prototype.isDisposed=function(){return this.privIsDisposed},e.prototype.dispose=function(e){this.privIsDisposed=!0,void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise&&this.privConnectionConfigurationPromise.onSuccessContinueWith((function(t){t.dispose(e)}))},e.prototype.connect=function(){this.connectImpl().result()},e.prototype.connectAsync=function(e,t){this.connectImpl().continueWith((function(r){try{r.isError?t&&t(r.error):r.isCompleted&&e&&e()}catch(e){t&&t(e)}}))},e.prototype.sendNetworkMessage=function(e,t,r,i){var o=this,a="string"==typeof t?n.MessageType.Text:n.MessageType.Binary,c="string"==typeof t?"application/json":"";this.fetchConnection().on((function(n){n.send(new s.SpeechConnectionMessage(a,e,o.privSynthesisTurn.requestId,c,t)).on((function(){r&&r()}),(function(e){i&&i(e)}))}),(function(e){i&&i(e)}))},e.prototype.Speak=function(e,t,r,o,s,a){var c,p=this;return c=t?e:this.privSpeechSynthesizer.buildSsml(e),void 0!==this.speakOverride?this.speakOverride(c,r,o,s):(this.privSuccessCallback=o,this.privErrorCallback=s,this.privSynthesisTurn.startNewSynthesis(r,e,t,a),this.fetchConnection().continueWithPromise((function(e){return e.isError?(p.cancelSynthesisLocal(i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,e.error),n.PromiseHelper.fromError(e.error)):p.sendSynthesisContext(e.result).continueWithPromise((function(t){return t.isError?(p.cancelSynthesisLocal(i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,t.error),n.PromiseHelper.fromError(t.error)):p.sendSsmlMessage(e.result,c,r).continueWithPromise((function(e){if(e.isError)return p.cancelSynthesisLocal(i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,e.error),n.PromiseHelper.fromError(e.error);var t=new i.SpeechSynthesisEventArgs(new i.SpeechSynthesisResult(r,i.ResultReason.SynthesizingAudioStarted));p.privSpeechSynthesizer.synthesisStarted&&p.privSpeechSynthesizer.synthesisStarted(p.privSpeechSynthesizer,t);p.receiveMessage();return n.PromiseHelper.fromResult(!0)}))}))})))},e.prototype.cancelSynthesis=function(e,t,r,n){var s=new i.PropertyCollection;s.setProperty(o.CancellationErrorCodePropertyName,i.CancellationErrorCode[r]);var a=new i.SpeechSynthesisResult(e,i.ResultReason.Canceled,void 0,n,s);if(this.privSpeechSynthesizer.SynthesisCanceled){var c=new i.SpeechSynthesisEventArgs(a);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,c)}catch(e){}}if(this.privSuccessCallback)try{this.privSuccessCallback(a)}catch(e){}},e.prototype.cancelSynthesisLocal=function(e,t,r){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,e,t,r))},e.prototype.processTypeSpecificMessages=function(e,t,r){return!0},e.prototype.connectImpl=function(e){var t=this;if(void 0===e&&(e=!1),void 0!==this.connectImplOverride)return this.connectImplOverride(e);if(this.privConnectionPromise)return this.privConnectionPromise.result().isCompleted&&(this.privConnectionPromise.result().isError||this.privConnectionPromise.result().result.state()===n.ConnectionState.Disconnected)&&!0===this.privServiceHasSentMessage?(this.privConnectionId=null,this.privConnectionPromise=null,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise;this.privAuthFetchEventId=n.createNoDashGuid(),this.privConnectionId=n.createNoDashGuid(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);var r=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=r.continueWithPromise((function(r){if(r.isError)throw t.privSynthesisTurn.onAuthCompleted(!0,r.error),new Error(r.error);t.privSynthesisTurn.onAuthCompleted(!1);var o=t.privConnectionFactory.create(t.privSynthesizerConfig,r.result,t.privConnectionId);return o.events.attach((function(e){t.connectionEvents.onEvent(e)})),o.open().onSuccessContinueWithPromise((function(r){return 200===r.statusCode?(t.privSynthesisTurn.onPreConnectionStart(t.privAuthFetchEventId,t.privConnectionId),t.privSynthesisTurn.onConnectionEstablishCompleted(r.statusCode),n.PromiseHelper.fromResult(o)):403!==r.statusCode||e?(t.privSynthesisTurn.onConnectionEstablishCompleted(r.statusCode,r.reason),n.PromiseHelper.fromError("Unable to contact server. StatusCode: "+r.statusCode+", "+t.privSynthesizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint)+" Reason: "+r.reason)):t.connectImpl(!0)}))})),this.privConnectionPromise},e.prototype.configureConnection=function(){var e=this;return void 0!==this.configConnectionOverride?this.configConnectionOverride():this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.result().isCompleted&&(this.privConnectionConfigurationPromise.result().isError||this.privConnectionConfigurationPromise.result().result.state()===n.ConnectionState.Disconnected)?(this.privConnectionConfigurationPromise=null,this.configureConnection()):this.privConnectionConfigurationPromise:(this.privConnectionConfigurationPromise=this.connectImpl().onSuccessContinueWithPromise((function(t){return e.sendSpeechServiceConfig(t,e.privSynthesizerConfig.SpeechServiceConfig.serialize()).onSuccessContinueWith((function(e){return t}))})),this.privConnectionConfigurationPromise)},e.telemetryDataEnabled=!0,e}();t.SynthesisAdapterBase=a},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(6),o=n(r(378)),s=r(379),a=function(){function e(t,r,n,a,c){var p=this;if(this.open=function(){if(p.privConnectionState===i.ConnectionState.Disconnected)return i.PromiseHelper.fromError("Cannot open a connection that is in "+p.privConnectionState+" state");if(p.privConnectionEstablishDeferral)return p.privConnectionEstablishDeferral.promise();p.privConnectionEstablishDeferral=new i.Deferred,p.privCertificateValidatedDeferral=new i.Deferred,p.privConnectionState=i.ConnectionState.Connecting;try{if("undefined"==typeof WebSocket||e.forceNpmWebSocket){var t={headers:p.privHeaders};p.privCertificateValidatedDeferral.resolve(!0);var r=new s.CertCheckAgent(p.proxyInfo);t.agent=r.GetAgent(),p.privWebsocketClient=new o.default(p.privUri,t)}else p.privCertificateValidatedDeferral.resolve(!0),p.privWebsocketClient=new WebSocket(p.privUri);p.privWebsocketClient.binaryType="arraybuffer",p.privReceivingMessageQueue=new i.Queue,p.privDisconnectDeferral=new i.Deferred,p.privSendMessageQueue=new i.Queue,p.processSendQueue()}catch(e){return p.privConnectionEstablishDeferral.resolve(new i.ConnectionOpenResponse(500,e)),p.privConnectionEstablishDeferral.promise()}return p.onEvent(new i.ConnectionStartEvent(p.privConnectionId,p.privUri)),p.privWebsocketClient.onopen=function(e){p.privCertificateValidatedDeferral.promise().on((function(){p.privConnectionState=i.ConnectionState.Connected,p.onEvent(new i.ConnectionEstablishedEvent(p.privConnectionId)),p.privConnectionEstablishDeferral.resolve(new i.ConnectionOpenResponse(200,""))}),(function(e){p.privConnectionEstablishDeferral.reject(e)}))},p.privWebsocketClient.onerror=function(e){p.onEvent(new i.ConnectionErrorEvent(p.privConnectionId,e.message,e.type)),p.privLastErrorReceived=e.message},p.privWebsocketClient.onclose=function(e){p.privConnectionState===i.ConnectionState.Connecting?(p.privConnectionState=i.ConnectionState.Disconnected,p.privConnectionEstablishDeferral.resolve(new i.ConnectionOpenResponse(e.code,e.reason+" "+p.privLastErrorReceived))):(p.privConnectionState=i.ConnectionState.Disconnected,p.onEvent(new i.ConnectionClosedEvent(p.privConnectionId,e.code,e.reason))),p.onClose(e.code,e.reason)},p.privWebsocketClient.onmessage=function(e){var t=(new Date).toISOString();if(p.privConnectionState===i.ConnectionState.Connected){var r=new i.Deferred;if(p.privReceivingMessageQueue.enqueueFromPromise(r.promise()),e.data instanceof ArrayBuffer){var n=new i.RawWebsocketMessage(i.MessageType.Binary,e.data);p.privMessageFormatter.toConnectionMessage(n).on((function(e){p.onEvent(new i.ConnectionMessageReceivedEvent(p.privConnectionId,t,e)),r.resolve(e)}),(function(e){r.reject("Invalid binary message format. Error: "+e)}))}else{n=new i.RawWebsocketMessage(i.MessageType.Text,e.data);p.privMessageFormatter.toConnectionMessage(n).on((function(e){p.onEvent(new i.ConnectionMessageReceivedEvent(p.privConnectionId,t,e)),r.resolve(e)}),(function(e){r.reject("Invalid text message format. Error: "+e)}))}}},p.privConnectionEstablishDeferral.promise()},this.send=function(e){if(p.privConnectionState!==i.ConnectionState.Connected)return i.PromiseHelper.fromError("Cannot send on connection that is in "+p.privConnectionState+" state");var t=new i.Deferred,r=new i.Deferred;return p.privSendMessageQueue.enqueueFromPromise(r.promise()),p.privMessageFormatter.fromConnectionMessage(e).on((function(n){r.resolve({Message:e,RawWebsocketMessage:n,sendStatusDeferral:t})}),(function(e){r.reject("Error formatting the message. "+e)})),t.promise()},this.read=function(){return p.privConnectionState!==i.ConnectionState.Connected?i.PromiseHelper.fromError("Cannot read on connection that is in "+p.privConnectionState+" state"):p.privReceivingMessageQueue.dequeue()},this.close=function(e){if(!p.privWebsocketClient){var t=new i.Deferred;return t.resolve(!0),t.promise()}return p.privConnectionState!==i.ConnectionState.Disconnected&&p.privWebsocketClient.close(1e3,e||"Normal closure by client"),p.privDisconnectDeferral.promise()},this.sendRawMessage=function(e){try{return e?(p.onEvent(new i.ConnectionMessageSentEvent(p.privConnectionId,(new Date).toISOString(),e.Message)),p.isWebsocketOpen?(p.privWebsocketClient.send(e.RawWebsocketMessage.payload),i.PromiseHelper.fromResult(!0)):i.PromiseHelper.fromError("websocket send error: Websocket not ready")):i.PromiseHelper.fromResult(!0)}catch(e){return i.PromiseHelper.fromError("websocket send error: "+e)}},this.onClose=function(e,t){var r="Connection closed. "+e+": "+t;p.privConnectionState=i.ConnectionState.Disconnected,p.privDisconnectDeferral.resolve(!0),p.privReceivingMessageQueue.dispose(t),p.privReceivingMessageQueue.drainAndDispose((function(e){}),r),p.privSendMessageQueue.drainAndDispose((function(e){e.sendStatusDeferral.reject(r)}),r)},this.processSendQueue=function(){p.privSendMessageQueue.dequeue().on((function(e){e&&p.sendRawMessage(e).on((function(t){e.sendStatusDeferral.resolve(t),p.processSendQueue()}),(function(t){e.sendStatusDeferral.reject(t),p.processSendQueue()}))}),(function(e){}))},this.onEvent=function(e){p.privConnectionEvents.onEvent(e),i.Events.instance.onEvent(e)},!t)throw new i.ArgumentNullError("uri");if(!n)throw new i.ArgumentNullError("messageFormatter");this.proxyInfo=a,this.privConnectionEvents=new i.EventSource,this.privConnectionId=r,this.privMessageFormatter=n,this.privConnectionState=i.ConnectionState.None,this.privUri=t,this.privHeaders=c,this.privHeaders["X-ConnectionId"]=this.privConnectionId,this.privLastErrorReceived=""}return Object.defineProperty(e.prototype,"state",{get:function(){return this.privConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return this.privConnectionEvents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWebsocketOpen",{get:function(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN},enumerable:!0,configurable:!0}),e.forceNpmWebSocket=!1,e}();t.WebsocketMessageAdapter=a},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var c,p=[],u=!1,h=-1;function v(){u&&c&&(u=!1,c.length?p=c.concat(p):h=-1,p.length&&l())}function l(){if(!u){var e=a(v);u=!0;for(var t=p.length;t;){for(c=p,p=[];++h<t;)c&&c[h].run();h=-1,t=p.length}c=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function f(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];p.push(new d(e,t)),1!==p.length||u||a(l)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.prependListener=f,i.prependOnceListener=f,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){this.privSpeechStartDetected=JSON.parse(e)}static fromJSON(e){return new n(e)}get Offset(){return this.privSpeechStartDetected.Offset}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{addPhrase(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(void 0===this.privGrammars&&void 0===this.privPhrases)return;const e={};if(e.ReferenceGrammars=this.privGrammars,void 0!==this.privPhrases&&0!==this.privPhrases.length){const t=[];this.privPhrases.forEach((e,r,n)=>{t.push({Text:e})}),e.Groups=[{Type:"Generic",Items:t}]}return e}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){this.privContext={},this.privDynamicGrammar=e}setSection(e,t){this.privContext[e]=t}toJSON(){const e=this.privDynamicGrammar.generateGrammarObject();this.setSection("dgi",e);return JSON.stringify(this.privContext)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(7),i=r(4),o=r(46);class s{constructor(e){if(this.fetch=e=>n.c.fromResult(this.privAuthInfo),this.fetchOnExpiry=e=>n.c.fromResult(this.privAuthInfo),!e)throw new i.a("subscriptionKey");this.privAuthInfo=new o.a("Ocp-Apim-Subscription-Key",e)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),i=r(46);class o{constructor(e,t){if(this.fetch=e=>this.privFetchCallback(e).onSuccessContinueWith(e=>new i.a("Authorization",e)),this.fetchOnExpiry=e=>this.privFetchOnExpiryCallback(e).onSuccessContinueWith(e=>new i.a("Authorization",e)),!e)throw new n.a("fetchCallback");if(!t)throw new n.a("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=t}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(23),i=r(3),o=r(42),s=r(12),a=r(79),c=r(59),p=r(20),u=r(124),h=r(68),v=r(83),l=r(84),d=r(38),f=r(13),g=r(1),y=r(125);class m extends h.a{constructor(e,t,r,n,i){if(super(e,t,r,n,i),this.privSpeechRecognizer=i,void 0!==n.autoDetectSourceLanguages){const e=n.autoDetectSourceLanguages.split(",");this.privSpeechContext.setSection("languageId",{languages:e,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}})}}processTypeSpecificMessages(e){let t;const r=new n.a;r.setProperty(i.a.SpeechServiceResponse_JsonResult,e.textBody);let p=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const n=v.a.fromJSON(e.textBody),i=n.Offset+this.privRequestSession.currentTurnAudioOffset;t=new o.a(this.privRequestSession.requestId,s.a.RecognizingSpeech,n.Text,n.Duration,i,n.Language,n.LanguageDetectionConfidence,void 0,e.textBody,r),this.privRequestSession.onHypothesis(i);const u=new a.a(t,n.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,u)}catch(e){}p=!0;break;case"speech.phrase":const h=l.a.fromJSON(e.textBody),m=d.a.implTranslateRecognitionResult(h.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+h.Offset+h.Duration),s.a.Canceled===m){const e=d.a.implTranslateCancelResult(h.RecognitionStatus);this.cancelRecognitionLocal(e,d.a.implTranslateCancelErrorCode(h.RecognitionStatus),void 0)}else{if(!this.privRequestSession.isSpeechEnded||m!==s.a.NoMatch||h.RecognitionStatus===f.a.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(g.d)===c.a[c.a.Simple])t=new o.a(this.privRequestSession.requestId,m,h.DisplayText,h.Duration,h.Offset+this.privRequestSession.currentTurnAudioOffset,h.Language,h.LanguageDetectionConfidence,void 0,e.textBody,r);else{const n=y.a.fromJSON(e.textBody);t=new o.a(this.privRequestSession.requestId,m,n.RecognitionStatus===f.a.Success?n.NBest[0].Display:void 0,n.Duration,n.Offset+this.privRequestSession.currentTurnAudioOffset,n.Language,n.LanguageDetectionConfidence,void 0,e.textBody,r)}const n=new a.a(t,t.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,n)}catch(e){}}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}p=!0}return p}cancelRecognition(e,t,r,i,a){const c=new n.a;if(c.setProperty(g.b,p.a[i]),this.privSpeechRecognizer.canceled){const t=new u.a(r,a,i,void 0,e);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new o.a(t,s.a.Canceled,void 0,void 0,void 0,void 0,void 0,a,void 0,c);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(89),i=r(88),o=r(3),s=r(34),a=r(60);class c extends s.a{constructor(){super(...arguments),this.create=(e,t,r)=>{let s=e.parameters.getProperty(o.a.SpeechServiceConnection_Endpoint);if(!s){const t=e.parameters.getProperty(o.a.SpeechServiceConnection_IntentRegion),r=t&&t.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com";s=e.parameters.getProperty(o.a.SpeechServiceConnection_Host,"wss://"+t+".sr.speech"+r)+"/speech/recognition/interactive/cognitiveservices/v1"}const c={format:"simple",language:e.parameters.getProperty(o.a.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,c,s);const p={};return void 0!==t.token&&""!==t.token&&(p[t.headerName]=t.token),p["X-ConnectionId"]=r,e.parameters.setProperty(o.a.SpeechServiceConnection_Url,s),new n.a(s,c,p,new a.a,i.a.fromRecognizerConfig(e),r)}}getSpeechRegionFromIntentRegion(e){switch(e){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return e}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t){this.modelImpl=e,this.intentName=t}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(17),i=r(23),o=r(3),s=r(49),a=r(12),c=r(48),p=r(20),u=r(127),h=r(68),v=r(83),l=r(84),d=r(38),f=r(126),g=r(1);class y extends h.a{constructor(e,t,r,n,i){super(e,t,r,n,i),this.privIntentRecognizer=i,this.privIntentDataSent=!1}setIntents(e,t){this.privAddedLmIntents=e,this.privUmbrellaIntent=t,this.privIntentDataSent=!0}processTypeSpecificMessages(e){let t,r,p=!1;const u=new i.a;switch(e.messageType===n.b.Text&&u.setProperty(o.a.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":const n=v.a.fromJSON(e.textBody);if(t=new s.a(void 0,this.privRequestSession.requestId,a.a.RecognizingIntent,n.Text,n.Duration,n.Offset+this.privRequestSession.currentTurnAudioOffset,n.Language,n.LanguageDetectionConfidence,void 0,e.textBody,u),this.privRequestSession.onHypothesis(t.offset),r=new c.a(t,n.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,r)}catch(e){}p=!0;break;case"speech.phrase":const h=l.a.fromJSON(e.textBody);t=new s.a(void 0,this.privRequestSession.requestId,d.a.implTranslateRecognitionResult(h.RecognitionStatus),h.DisplayText,h.Duration,h.Offset+this.privRequestSession.currentTurnAudioOffset,h.Language,h.LanguageDetectionConfidence,void 0,e.textBody,u),r=new c.a(t,t.offset,this.privRequestSession.sessionId);const g=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,r)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};!1===this.privIntentDataSent||a.a.NoMatch===r.result.reason?(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),g()):this.privPendingIntentArgs=r,p=!0;break;case"response":if(r=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,void 0===r){if(""===e.textBody)return;r=new c.a(new s.a,0,this.privRequestSession.sessionId)}const y=f.a.fromJSON(e.textBody);let m=this.privAddedLmIntents[y.topScoringIntent.intent];if(void 0!==this.privUmbrellaIntent&&(m=this.privUmbrellaIntent),null!==y&&void 0!==m){const t=void 0===m.intentName?y.topScoringIntent.intent:m.intentName;let n=r.result.reason;void 0!==t&&(n=a.a.RecognizedIntent);const p=void 0!==r.result.properties?r.result.properties:new i.a;p.setProperty(o.a.LanguageUnderstandingServiceResponse_JsonResult,e.textBody),r=new c.a(new s.a(t,r.result.resultId,n,r.result.text,r.result.duration,r.result.offset,void 0,void 0,r.result.errorDetails,r.result.json,p),r.offset,r.sessionId)}if(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,r)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(r.result)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}p=!0}return p}cancelRecognition(e,t,r,n,o){const c=new i.a;if(c.setProperty(g.b,p.a[n]),this.privIntentRecognizer.canceled){const t=new u.a(r,o,n,void 0,void 0,e);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new s.a(void 0,t,a.a.Canceled,void 0,void 0,void 0,void 0,void 0,o,void 0,c);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}}},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.TextIndependentIdentification=0]="TextIndependentIdentification",e[e.TextDependentVerification=1]="TextDependentVerification",e[e.TextIndependentVerification=2]="TextIndependentVerification"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(89),i=r(88),o=r(3),s=r(34),a=r(60),c=r(14);class p extends s.a{constructor(){super(...arguments),this.create=(e,t,r)=>{let s=e.parameters.getProperty(o.a.SpeechServiceConnection_Endpoint,void 0);if(!s){const t=e.parameters.getProperty(o.a.SpeechServiceConnection_Region,void 0),r=t&&t.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com";s=e.parameters.getProperty(o.a.SpeechServiceConnection_Host,"wss://"+t+".s2s.speech"+r)+"/speech/translation/cognitiveservices/v1"}const p={from:e.parameters.getProperty(o.a.SpeechServiceConnection_RecoLanguage),to:e.parameters.getProperty(o.a.SpeechServiceConnection_TranslationToLanguages)};this.setCommonUrlParams(e,p,s),this.setUrlParameter(o.a.SpeechServiceResponse_TranslationRequestStablePartialResult,c.a.StableTranslation,e,p,s);void 0!==e.parameters.getProperty(o.a.SpeechServiceConnection_TranslationVoice,void 0)&&(p.voice=e.parameters.getProperty(o.a.SpeechServiceConnection_TranslationVoice),p.features="texttospeech");const u={};return void 0!==t.token&&""!==t.token&&(u[t.headerName]=t.token),u["X-ConnectionId"]=r,e.parameters.setProperty(o.a.SpeechServiceConnection_Url,s),new n.a(s,p,u,new a.a,i.a.fromRecognizerConfig(e),r)}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return R}));var n=r(17),i=r(67),o=r(23),s=r(3),a=r(47),c=r(12),p=r(80),u=r(82),h=r(81),v=r(86),l=r(36),d=r(20),f=r(130),g=r(68),y=r(128),m=r(85),S=r(13),C=r(38),b=r(129),P=r(1);class R extends g.a{constructor(e,t,r,n,i){super(e,t,r,n,i),this.privTranslationRecognizer=i}processTypeSpecificMessages(e){const t=new o.a;let r=!1;switch(e.messageType===n.b.Text&&t.setProperty(s.a.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"translation.hypothesis":const n=this.fireEventForResult(y.a.fromJSON(e.textBody),t);if(this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+n.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,n)}catch(e){}r=!0;break;case"translation.phrase":const i=m.a.fromJSON(e.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+i.Offset+i.Duration),i.RecognitionStatus===S.a.Success){const e=this.fireEventForResult(i,t);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,e)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(e.result)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}break}{const r=C.a.implTranslateRecognitionResult(i.RecognitionStatus),n=new a.a(void 0,this.privRequestSession.requestId,r,i.Text,i.Duration,this.privRequestSession.currentTurnAudioOffset+i.Offset,void 0,e.textBody,t);if(r===c.a.Canceled){const e=C.a.implTranslateCancelResult(i.RecognitionStatus);this.cancelRecognitionLocal(e,C.a.implTranslateCancelErrorCode(i.RecognitionStatus),void 0)}else{if(!this.privRequestSession.isSpeechEnded||r!==c.a.NoMatch||i.RecognitionStatus===S.a.InitialSilenceTimeout){const e=new p.a(n,n.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,e)}catch(e){}}if(this.privSuccessCallback){try{this.privSuccessCallback(n)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}r=!0;break;case"translation.synthesis":this.sendSynthesisAudio(e.binaryBody,this.privRequestSession.sessionId),r=!0;break;case"translation.synthesis.end":const o=b.a.fromJSON(e.textBody);switch(o.SynthesisStatus){case S.b.Error:if(this.privTranslationRecognizer.synthesizing){const e=new u.a(c.a.Canceled,void 0),t=new h.a(e,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,t)}catch(e){}}if(this.privTranslationRecognizer.canceled){const e=new v.a(this.privRequestSession.sessionId,l.a.Error,o.FailureReason,d.a.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,e)}catch(e){}}break;case S.b.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId)}r=!0}return r}cancelRecognition(e,t,r,n,i){const s=new o.a;if(s.setProperty(P.b,d.a[n]),this.privTranslationRecognizer.canceled){const t=new v.a(e,r,i,n,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new a.a(void 0,t,c.a.Canceled,void 0,void 0,void 0,i,void 0,s);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}fireEventForResult(e,t){let r,n;if(void 0!==e.Translation.Translations){r=new f.a;for(const t of e.Translation.Translations)r.set(t.Language,t.Text)}n=e instanceof m.a?e.Translation.TranslationStatus===i.a.Success?c.a.TranslatedSpeech:c.a.RecognizedSpeech:c.a.TranslatingSpeech;const o=e.Offset+this.privRequestSession.currentTurnAudioOffset,s=new a.a(r,this.privRequestSession.requestId,n,e.Text,e.Duration,o,e.Translation.FailureReason,JSON.stringify(e),t);return new p.a(s,o,this.privRequestSession.sessionId)}sendSynthesisAudio(e,t){const r=void 0===e?c.a.SynthesizingAudioCompleted:c.a.SynthesizingAudio,n=new u.a(r,e),i=new h.a(n,t);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,i)}catch(e){}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t){this.privActivity=e,this.privAudioStream=t}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(31);class i{constructor(e,t){this.privContext=e||new n.a(null),this.privParameters=t}get parameters(){return this.privParameters}get Context(){return this.privContext}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(89),i=r(88),o=r(3),s=r(60),a=r(14);class c{constructor(){this.synthesisUri="/cognitiveservices/websocket/v1",this.create=(e,t,r)=>{let c=e.parameters.getProperty(o.a.SpeechServiceConnection_Endpoint,void 0);const p=e.parameters.getProperty(o.a.SpeechServiceConnection_Region,void 0),u=p&&p.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",h=e.parameters.getProperty(o.a.SpeechServiceConnection_Host,"wss://"+p+".tts.speech"+u);c||(c=h+this.synthesisUri);const v={};return void 0!==t.token&&""!==t.token&&(v[t.headerName]=t.token),v[a.a.ConnectionIdHeader]=r,e.parameters.setProperty(o.a.SpeechServiceConnection_Url,c),new n.a(c,{},v,new s.a,i.a.fromParameters(e.parameters),r)}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(31);!function(e){e[e.Standard=0]="Standard",e[e.Custom=1]="Custom"}(n||(n={}));class o{constructor(e,t){this.privSynthesisServiceType=n.Standard,this.privSpeechServiceConfig=e||new i.e(new i.a(null)),this.privParameters=t}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(e){this.privSynthesisServiceType=e}get SpeechServiceConfig(){return this.privSpeechServiceConfig}}},function(e,t,r){var n=r(188);function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}e.exports=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,t&&t.set(e,r),r}},function(e,t){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=r=function(e){return typeof e}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(t)}e.exports=r},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t,r){var n=r(396);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t,r){var n=r(188),i=r(397);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?i(e):t}},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}e.exports=r},function(e,t){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=r=function(e){return typeof e}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(t)}e.exports=r},function(e,t,r){e.exports=r(147)},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}},function(e,t){function r(e,t,r,n,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function a(e){r(s,i,o,a,c,"next",e)}function c(e){r(s,i,o,a,c,"throw",e)}a(void 0)}))}}},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(413),i={AudioConfig:n.AudioConfig,OutputFormat:n.OutputFormat,ResultReason:n.ResultReason,SpeechConfig:n.SpeechConfig,SpeechRecognizer:n.SpeechRecognizer};t.default=i},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("error"===e){if("function"==typeof ErrorEvent)return new ErrorEvent(e,t)}else if("function"==typeof CustomEvent)return new CustomEvent(e,t);var r=document.createEvent("Event");return r.initEvent(e,!0,!0),Object.entries(t).forEach((function(e){var t=(0,i.default)(e,2),n=t[0],o=t[1];r[n]=o})),r};var i=n(r(421))},function(e,t,r){var n=r(202);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}},function(e,t,r){"use strict";var n=r(187),i=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(r(112)),s=i(r(190)),a=i(r(191)),c=i(r(192)),p=n(r(114));function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,a.default)(this,r)}}var h=function(e){(0,s.default)(r,e);var t=u(r);function r(e){var n;if((0,o.default)(this,r),n=t.call(this),e&&(!e.format||"function"!=typeof e.read))throw new Error("botframework-directlinespeech-sdk: If the first argument is specified, it must be a Cognitive Services audio stream.");return n.audioStream=e,n}return r}(p.default);(0,p.defineEventAttribute)(h,"boundary"),(0,p.defineEventAttribute)(h,"end"),(0,p.defineEventAttribute)(h,"error"),(0,p.defineEventAttribute)(h,"start");var v=h;t.default=v},function(e,t,r){var n=r(51);e.exports=!!Object.getOwnPropertySymbols&&!n((function(){return!String(Symbol())}))},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,r){var n=r(207),i=r(66),o=r(25)("iterator");e.exports=function(e){if(null!=e)return e[o]||e["@@iterator"]||i[n(e)]}},function(e,t,r){var n=r(117),i=r(136),o=r(25)("toStringTag"),s="Arguments"==i(function(){return arguments}());e.exports=n?i:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?r:s?i(t):"Object"==(n=i(t))&&"function"==typeof t.callee?"Arguments":n}},function(e,t,r){"use strict";var n=r(90),i=r(455),o=r(210),s=r(460),a=r(212),c=r(40),p=r(70),u=r(25),h=r(96),v=r(66),l=r(209),d=l.IteratorPrototype,f=l.BUGGY_SAFARI_ITERATORS,g=u("iterator"),y=function(){return this};e.exports=function(e,t,r,u,l,m,S){i(r,t,u);var C,b,P,R=function(e){if(e===l&&T)return T;if(!f&&e in E)return E[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},w=t+" Iterator",I=!1,E=e.prototype,O=E[g]||E["@@iterator"]||l&&E[l],T=!f&&O||R(l),A="Array"==t&&E.entries||O;if(A&&(C=o(A.call(new e)),d!==Object.prototype&&C.next&&(h||o(C)===d||(s?s(C,d):"function"!=typeof C[g]&&c(C,g,y)),a(C,w,!0,!0),h&&(v[w]=y))),"values"==l&&O&&"values"!==O.name&&(I=!0,T=function(){return O.call(this)}),h&&!S||E[g]===T||c(E,g,T),v[t]=T,l)if(b={values:R("values"),keys:m?T:R("keys"),entries:R("entries")},S)for(P in b)(f||I||!(P in E))&&p(E,P,b[P]);else n({target:t,proto:!0,forced:f||I},b);return b}},function(e,t,r){"use strict";var n,i,o,s=r(210),a=r(40),c=r(33),p=r(25),u=r(96),h=p("iterator"),v=!1;[].keys&&("next"in(o=[].keys())?(i=s(s(o)))!==Object.prototype&&(n=i):v=!0),null==n&&(n={}),u||c(n,h)||a(n,h,(function(){return this})),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:v}},function(e,t,r){var n=r(33),i=r(456),o=r(95),s=r(457),a=o("IE_PROTO"),c=Object.prototype;e.exports=s?Object.getPrototypeOf:function(e){return e=i(e),n(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?c:null}},function(e,t,r){var n,i=r(37),o=r(458),s=r(100),a=r(97),c=r(459),p=r(139),u=r(95),h=u("IE_PROTO"),v=function(){},l=function(e){return"<script>"+e+"<\/script>"},d=function(){try{n=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;d=n?function(e){e.write(l("")),e.close();var t=e.parentWindow.Object;return e=null,t}(n):((t=p("iframe")).style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(l("document.F=Object")),e.close(),e.F);for(var r=s.length;r--;)delete d.prototype[s[r]];return d()};a[h]=!0,e.exports=Object.create||function(e,t){var r;return null!==e?(v.prototype=i(e),r=new v,v.prototype=null,r[h]=e):r=d(),void 0===t?r:o(r,t)}},function(e,t,r){var n=r(41).f,i=r(33),o=r(25)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},function(e,t,r){"use strict";r.d(t,"a",(function(){return N}));var n,i=r(482),o=r(18),s=r(17),a=r(7),c=r(480),p=r(224),u=r(36),h=r(20),v=r(78),l=r(58),d=r(3),f=r(23),g=r(42),y=r(12),m=r(79),S=r(15),C=r(183),b=r(124),P=r(4),R=r(26),w=r(22);class I{constructor(e){this.privActivityResponse=JSON.parse(e)}static fromJSON(e){return new I(e)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}!function(e){e[e.None=0]="None",e[e.TextToSpeechAudio=1]="TextToSpeechAudio"}(n||(n={}));class E{constructor(e,t){this.privRequestId=t,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=e,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(e,t){return e.messageDataStreamType===n.TextToSpeechAudio&&(this.privAudioStream=w.a.createPullStream(),this.privAudioStream.format=void 0!==t?t:R.b.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){null===this.privAudioStream||this.privAudioStream.isClosed||this.privAudioStream.close()}complete(){void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}}class O{constructor(){this.privTurnMap=new Map}StartTurn(e){if(this.privTurnMap.has(e))throw new P.b("Service error: There is already a turn with id:"+e);const t=new E(this,e);return this.privTurnMap.set(e,t),this.privTurnMap.get(e)}GetTurn(e){return this.privTurnMap.get(e)}CompleteTurn(e){if(!this.privTurnMap.has(e))throw new P.b("Service error: Received turn end for an unknown turn id:"+e);const t=this.privTurnMap.get(e);return t.complete(),this.privTurnMap.delete(e),t}}var T=r(68),A=r(171),D=r(214),_=r(84),M=r(13),x=r(83),k=r(1),j=r(38),z=r(16);class N extends T.a{constructor(e,t,r,n,p){super(e,t,r,n,p),this.sendMessage=e=>{const t=Object(o.a)(),r=Object(o.b)(),n={context:{interactionId:t},messagePayload:JSON.parse(e),version:.5},i=JSON.stringify(n);this.fetchDialogConnection().onSuccessContinueWith(e=>{e.send(new z.a(s.b.Text,"agent",r,"application/json",i))})},this.listenOnce=(e,t,r)=>(this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=t,this.privErrorCallback=r,this.privDialogRequestSession.startNewRecognition(),this.privDialogRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.dialogConnectImpl(),this.sendPreAudioMessages(),this.privDialogAudioSource.attach(this.privDialogRequestSession.audioNodeId).continueWithPromise(e=>{let t;return e.isError?(this.cancelRecognition(this.privDialogRequestSession.sessionId,this.privDialogRequestSession.requestId,u.a.Error,h.a.ConnectionFailure,e.error),a.c.fromError(e.error)):this.privDialogAudioSource.format.onSuccessContinueWithPromise(r=>(t=new i.a(e.result,r.avgBytesPerSec),this.privDialogRequestSession.onAudioSourceAttachCompleted(t,!1),this.privDialogAudioSource.deviceInfo.onSuccessContinueWithPromise(e=>(this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:e},this.configConnection().continueWithPromise(e=>{if(e.isError)return this.cancelRecognitionLocal(u.a.Error,h.a.ConnectionFailure,e.error),a.c.fromError(e.error);const r=new v.a(this.privDialogRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,r);return this.sendAudio(t).on(e=>{},e=>{this.cancelRecognition(this.privDialogRequestSession.sessionId,this.privDialogRequestSession.requestId,u.a.Error,h.a.RuntimeError,e)}),a.c.fromResult(!0)})))))})),this.sendAudio=e=>this.privDialogAudioSource.format.onSuccessContinueWithPromise(t=>{const r=new a.a;let n=Date.now();const i=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),o=t.avgBytesPerSec/1e3*parseInt(i,10),c=this.privDialogRequestSession.recogNumber,p=()=>{this.privDialogIsDisposed||this.privDialogRequestSession.isSpeechEnded||!this.privDialogRequestSession.isRecognizing||this.privDialogRequestSession.recogNumber!==c||this.fetchDialogConnection().on(i=>{e.read().on(e=>{if(this.privDialogRequestSession.isSpeechEnded)return void r.resolve(!0);let a,c;!e||e.isEnd?(a=null,c=0):(a=e.buffer,this.privDialogRequestSession.onAudioSent(a.byteLength),c=o>=this.privDialogRequestSession.bytesSent?0:Math.max(0,n-Date.now())),setTimeout(()=>{null!==a&&(n=Date.now()+1e3*a.byteLength/(2*t.avgBytesPerSec));const o=i.send(new z.a(s.b.Binary,"audio",this.privDialogRequestSession.requestId,null,a));e&&!e.isEnd?o.continueWith(e=>{p()}):(this.privDialogRequestSession.onSpeechEnded(),r.resolve(!0))},c)},e=>{this.privDialogRequestSession.isSpeechEnded?r.resolve(!0):r.reject(e)})},e=>{r.reject(e)})};return p(),r.promise()}),this.receiveDialogMessageOverride=()=>{const e=new a.a;return this.fetchDialogConnection().on(t=>t.read().onSuccessContinueWithPromise(t=>{const r=this.isDisposed(),n=!this.isDisposed()&&this.terminateMessageLoop;if(r||n)return e.resolve(void 0),a.c.fromResult(void 0);if(!t)return this.receiveDialogMessageOverride();const i=z.a.fromConnectionMessage(t);switch(i.path.toLowerCase()){case"turn.start":{const e=i.requestId.toUpperCase();e!==this.privDialogRequestSession.requestId.toUpperCase()?this.privTurnStateManager.StartTurn(e):this.privDialogRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const e=A.a.fromJSON(i.textBody),t=new l.a(e.Offset,this.privDialogRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,t);break;case"speech.enddetected":let r;r=i.textBody.length>0?i.textBody:"{ Offset: 0 }";const n=A.a.fromJSON(r);this.privDialogRequestSession.onServiceRecognized(n.Offset+this.privDialogRequestSession.currentTurnAudioOffset);const o=new l.a(n.Offset+this.privDialogRequestSession.currentTurnAudioOffset,this.privDialogRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,o);break;case"turn.end":{const e=i.requestId.toUpperCase();if(e!==this.privDialogRequestSession.requestId.toUpperCase())this.privTurnStateManager.CompleteTurn(e);else{const e=new v.a(this.privDialogRequestSession.sessionId);if(this.privDialogRequestSession.onServiceTurnEndResponse(!1),this.privDialogRequestSession.isSpeechEnded&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,e),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:this.processTypeSpecificMessages(i)||this.serviceEvents&&this.serviceEvents.onEvent(new c.h(i.path.toLowerCase(),i.textBody))}return this.receiveDialogMessageOverride()}),t=>(this.terminateMessageLoop=!0,e.resolve(void 0),a.c.fromResult(void 0))),e.promise()},this.fetchDialogConnection=()=>this.configConnection(),this.sendAgentConfig=e=>{if(this.agentConfig&&!this.agentConfigSent){if("custom_commands"===this.privRecognizerConfig.parameters.getProperty(d.a.Conversation_DialogType)){const e=this.agentConfig.get();e.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(d.a.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(e)}const t=this.agentConfig.toJsonString();return this.agentConfigSent=!0,e.send(new z.a(s.b.Text,"agent.config",this.privDialogRequestSession.requestId,"application/json",t))}return a.c.fromResult(!0)},this.sendAgentContext=e=>{const t=Object(o.a)(),r=this.privDialogServiceConnector.properties.getProperty(d.a.Conversation_Speech_Activity_Template),n={channelData:"",context:{interactionId:t},messagePayload:void 0===typeof r?void 0:r,version:.5},i=JSON.stringify(n);return e.send(new z.a(s.b.Text,"speech.agent.context",this.privDialogRequestSession.requestId,"application/json",i))},this.privDialogServiceConnector=p,this.privDialogAuthentication=e,this.receiveMessageOverride=this.receiveDialogMessageOverride,this.privTurnStateManager=new O,this.recognizeOverride=this.listenOnce,this.connectImplOverride=this.dialogConnectImpl,this.configConnectionOverride=this.configConnection,this.fetchConnectionOverride=this.fetchDialogConnection,this.disconnectOverride=this.privDisconnect,this.privDialogAudioSource=r,this.privDialogRequestSession=new D.a(r.id()),this.privDialogConnectionFactory=t,this.privDialogIsDisposed=!1,this.agentConfigSent=!1,this.privLastResult=null}isDisposed(){return this.privDialogIsDisposed}dispose(e){this.privDialogIsDisposed=!0,this.privConnectionConfigPromise&&this.privConnectionConfigPromise.onSuccessContinueWith(t=>{t.dispose(e)})}privDisconnect(){this.cancelRecognition(this.privDialogRequestSession.sessionId,this.privDialogRequestSession.requestId,u.a.Error,h.a.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1,this.privDialogConnectionPromise.result().isCompleted?this.privDialogConnectionPromise.result().isError||(this.privDialogConnectionPromise.result().result.dispose(),this.privDialogConnectionPromise=null):this.privDialogConnectionPromise.onSuccessContinueWith(e=>{e.dispose()})}processTypeSpecificMessages(e){const t=new f.a;let r,n;switch(e.messageType===s.b.Text&&t.setProperty(d.a.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.phrase":const i=_.a.fromJSON(e.textBody);if(this.privDialogRequestSession.onPhraseRecognized(this.privDialogRequestSession.currentTurnAudioOffset+i.Offset+i.Duration),i.RecognitionStatus===M.a.Success){const e=this.fireEventForResult(i,t);if(this.privLastResult=e.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,e)}catch(e){}}n=!0;break;case"speech.hypothesis":const o=x.a.fromJSON(e.textBody),s=o.Offset+this.privDialogRequestSession.currentTurnAudioOffset;r=new g.a(this.privDialogRequestSession.requestId,y.a.RecognizingSpeech,o.Text,o.Duration,s,o.Language,o.LanguageDetectionConfidence,void 0,e.textBody,t),this.privDialogRequestSession.onHypothesis(s);const a=new m.a(r,o.Duration,this.privDialogRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,a)}catch(e){}n=!0;break;case"audio":{const t=e.requestId.toUpperCase(),r=this.privTurnStateManager.GetTurn(t);try{e.binaryBody?r.audioStream.write(e.binaryBody):r.endAudioStream()}catch(e){}}n=!0;break;case"response":{const t=e.requestId.toUpperCase(),r=I.fromJSON(e.textBody),n=this.privTurnStateManager.GetTurn(t);if(r.conversationId){const e=this.agentConfig.get();e.botInfo.conversationId=r.conversationId,this.agentConfig.set(e)}const i=n.processActivityPayload(r,S.a[this.privDialogServiceConnector.properties.getProperty(d.a.SpeechServiceConnection_SynthOutputFormat,void 0)]),o=new C.a(r.messagePayload,i);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,o)}catch(e){}}n=!0}return n}cancelRecognition(e,t,r,n,i){if(this.terminateMessageLoop=!0,this.privDialogRequestSession.isRecognizing&&this.privDialogRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const t=new f.a;t.setProperty(k.b,h.a[n]);const o=new b.a(r,i,n,void 0,e);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,o)}catch(e){}if(this.privSuccessCallback){const e=new g.a(void 0,y.a.Canceled,void 0,void 0,void 0,void 0,void 0,i,void 0,t);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}}sendWaveHeader(e){return this.audioSource.format.onSuccessContinueWithPromise(t=>e.send(new z.a(s.b.Binary,"audio",this.privDialogRequestSession.requestId,"audio/x-wav",t.header)))}dialogConnectImpl(e=!1){if(this.privDialogConnectionPromise)return this.privDialogConnectionPromise.result().isCompleted&&(this.privDialogConnectionPromise.result().isError||this.privDialogConnectionPromise.result().result.state()===p.a.Disconnected)?(this.agentConfigSent=!1,this.privDialogConnectionPromise=null,this.terminateMessageLoop=!0,this.configConnection()):this.privDialogConnectionPromise;this.privDialogAuthFetchEventId=Object(o.b)(),void 0===this.privConnectionId&&(this.privConnectionId=Object(o.b)()),this.privDialogRequestSession.onPreConnectionStart(this.privDialogAuthFetchEventId,this.privConnectionId);const t=e?this.privDialogAuthentication.fetchOnExpiry(this.privDialogAuthFetchEventId):this.privDialogAuthentication.fetch(this.privDialogAuthFetchEventId);return this.privDialogConnectionPromise=t.continueWithPromise(t=>{if(t.isError)throw this.privDialogRequestSession.onAuthCompleted(!0,t.error),new Error(t.error);this.privDialogRequestSession.onAuthCompleted(!1);const r=this.privDialogConnectionFactory.create(this.privRecognizerConfig,t.result,this.privConnectionId);return this.privDialogRequestSession.listenForServiceTelemetry(r.events),r.events.attach(e=>{this.connectionEvents.onEvent(e)}),r.open().onSuccessContinueWithPromise(t=>200===t.statusCode?(this.privDialogRequestSession.onPreConnectionStart(this.privDialogAuthFetchEventId,this.privConnectionId),this.privDialogRequestSession.onConnectionEstablishCompleted(t.statusCode),a.c.fromResult(r)):403!==t.statusCode||e?(this.privDialogRequestSession.onConnectionEstablishCompleted(t.statusCode,t.reason),a.c.fromError(`Unable to contact server. StatusCode: ${t.statusCode}, ${this.privRecognizerConfig.parameters.getProperty(d.a.SpeechServiceConnection_Endpoint)} Reason: ${t.reason}`)):this.dialogConnectImpl(!0))}),this.privConnectionLoop=this.startMessageLoop(),this.privDialogConnectionPromise}startMessageLoop(){this.terminateMessageLoop=!1;return this.receiveDialogMessageOverride().on(e=>!0,e=>{this.cancelRecognition(this.privDialogRequestSession.sessionId,this.privDialogRequestSession.requestId,u.a.Error,h.a.RuntimeError,e)})}configConnection(){return this.privConnectionConfigPromise?this.privConnectionConfigPromise.result().isCompleted&&(this.privConnectionConfigPromise.result().isError||this.privConnectionConfigPromise.result().result.state()===p.a.Disconnected)?(this.privConnectionConfigPromise=null,this.configConnection()):this.privConnectionConfigPromise:this.terminateMessageLoop?(this.terminateMessageLoop=!1,a.c.fromError("Connection to service terminated.")):(this.privConnectionConfigPromise=this.dialogConnectImpl().onSuccessContinueWithPromise(e=>this.sendSpeechServiceConfig(e,this.privDialogRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()).onSuccessContinueWithPromise(t=>this.sendAgentConfig(e).onSuccessContinueWith(t=>e))),this.privConnectionConfigPromise)}sendPreAudioMessages(){this.fetchDialogConnection().onSuccessContinueWith(e=>{this.sendAgentContext(e),this.sendWaveHeader(e)})}fireEventForResult(e,t){const r=j.a.implTranslateRecognitionResult(e.RecognitionStatus),n=e.Offset+this.privDialogRequestSession.currentTurnAudioOffset,i=new g.a(this.privDialogRequestSession.requestId,r,e.DisplayText,e.Duration,n,e.Language,e.LanguageDetectionConfidence,void 0,JSON.stringify(e),t);return new m.a(i,n,this.privDialogRequestSession.sessionId)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(18),i=r(7),o=r(133),s=r(35),a=r(27),c=r(480);class p{constructor(e,t,r){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.onEvent=e=>{this.privIsDisposed||(e instanceof s.d&&e.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof a.f&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof a.e&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof a.a&&e.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof a.h&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof a.g&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Name:"Microphone",Start:this.privMicStartTime})),e instanceof s.a&&e.requestId===this.privRequestId&&(this.privConnectionId=e.sessionId),e instanceof c.g&&e.connectionId===this.privConnectionId&&(this.privConnectionStartTime=e.eventTime),e instanceof c.d&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof c.c&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Error:this.getConnectionError(e.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof c.e&&e.connectionId===this.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path&&(this.privReceivedMessages[e.message.headers.path]||(this.privReceivedMessages[e.message.headers.path]=new Array),this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)))},this.getTelemetry=()=>{const e=new Array;this.privListeningTriggerMetric&&e.push(this.privListeningTriggerMetric),this.privMicMetric&&e.push(this.privMicMetric),this.privConnectionEstablishMetric&&e.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const t={Metrics:e,ReceivedMessages:this.privReceivedMessages},r=JSON.stringify(t);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],r},this.dispose=()=>{this.privIsDisposed=!0},this.getConnectionError=e=>{switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}},this.privRequestId=e,this.privAudioSourceId=t,this.privAudioNodeId=r,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)}hypothesisReceived(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)}get hasTelemetry(){return 0!==Object.keys(this.privReceivedMessages).length||null!==this.privListeningTriggerMetric||null!==this.privMicMetric||null!==this.privConnectionEstablishMetric||0!==this.privPhraseLatencies.length||0!==this.privHypothesisLatencies.length}}class u{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecogNumber=0,this.onAudioSourceAttachCompleted=(e,t,r)=>{this.privAudioNode=e,this.privIsAudioNodeDetached=!1,t?this.onComplete():this.onEvent(new s.b(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))},this.onPreConnectionStart=(e,t)=>{this.privAuthFetchEventId=e,this.privSessionId=t,this.onEvent(new s.a(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))},this.onAuthCompleted=(e,t)=>{e&&this.onComplete()},this.onConnectionEstablishCompleted=(e,t)=>{if(200===e)return this.onEvent(new s.c(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,void(this.privBytesSent=0);403===e&&this.onComplete()},this.onServiceTurnEndResponse=e=>{this.privTurnDeferral.resolve(!0),!e||this.isSpeechEnded?this.onComplete():(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privRequestId=Object(n.b)(),this.privAudioNode.replay())},this.onServiceTurnStartResponse=()=>{this.privTurnDeferral.state()===i.d.None&&this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral=new i.a},this.dispose=e=>{if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)e.detach();this.privServiceTelemetryListener.dispose()}},this.getTelemetry=()=>this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null,this.onEvent=e=>{this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(e),o.a.instance.onEvent(e)},this.onComplete=()=>{this.privIsRecognizing&&(this.privIsRecognizing=!1,this.detachAudioNode())},this.detachAudioNode=()=>{this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&this.privAudioNode.detach())},this.privAudioSourceId=e,this.privRequestId=Object(n.b)(),this.privAudioNodeId=Object(n.b)(),this.privTurnDeferral=new i.a,this.privTurnDeferral.resolve(!0)}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise()}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get bytesSent(){return this.privBytesSent}listenForServiceTelemetry(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRequestId=Object(n.b)(),this.privRecogNumber++,this.privServiceTelemetryListener=new p(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new s.d(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onHypothesis(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))}onPhraseRecognized(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)}onServiceRecognized(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e)}onAudioSent(e){this.privBytesSent+=e}onStopRecognizing(){this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,i=r(87),o=r(4),s=r(7),a=r(222);!function(e){e.Get="get",e.Post="post",e.Delete="delete",e.File="file"}(n||(n={}));class c{constructor(e,t){if(!e)throw new o.a("configParams");this.privHeaders=e.headers,this.privTimeout=e.timeout,this.privIgnoreCache=e.ignoreCache}setHeaders(e,t){this.privHeaders[e]=t}request(e,t,r={},i=null,o=null){const c=new s.a;let p;p="undefined"==typeof XMLHttpRequest?new a.XMLHttpRequest:new XMLHttpRequest;const u=e===n.File?"post":e;return p.open(u,this.withQuery(t,r),!0),this.privHeaders&&Object.keys(this.privHeaders).forEach(e=>p.setRequestHeader(e,this.privHeaders[e])),this.privIgnoreCache&&p.setRequestHeader("Cache-Control","no-cache"),p.timeout=this.privTimeout,p.onload=()=>{c.resolve(this.parseXHRResult(p))},p.onerror=()=>{c.resolve(this.errorResponse(p,"Failed to make request."))},p.ontimeout=()=>{c.resolve(this.errorResponse(p,"Request took longer than expected."))},e===n.File&&o?(p.setRequestHeader("Content-Type","multipart/form-data"),p.send(o)):e===n.Post&&i?(p.setRequestHeader("Content-Type","application/json"),p.send(JSON.stringify(i))):p.send(),c.promise()}parseXHRResult(e){return{data:e.responseText,headers:e.getAllResponseHeaders(),json:()=>JSON.parse(e.responseText),ok:e.status>=200&&e.status<300,status:e.status,statusText:e.statusText}}errorResponse(e,t=null){return{data:t||e.statusText,headers:e.getAllResponseHeaders(),json:()=>JSON.parse(t||'"'+e.statusText+'"'),ok:!1,status:e.status,statusText:e.statusText}}withQuery(e,t={}){const r=this.queryParams(t);return r?e+(-1===e.indexOf("?")?"?":"&")+r:e}queryParams(e={}){return Object.keys(e).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t])).join("&")}}var p=r(3),u=r(180);class h{constructor(e){let t=e.parameters.getProperty(p.a.SpeechServiceConnection_Endpoint,void 0);if(!t){const r=e.parameters.getProperty(p.a.SpeechServiceConnection_Region,"westus"),n=r&&r.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com";t=e.parameters.getProperty(p.a.SpeechServiceConnection_Host,"https://"+r+".api.cognitive"+n+"/speaker/{mode}/v2.0/{dependency}")+"/profiles"}this.privUri=t;const r=i.a.requestOptions;r.headers[i.a.configParams.subscriptionKey]=e.parameters.getProperty(p.a.SpeechServiceConnection_Key,void 0),this.privRestAdapter=new c(r)}createProfile(e,t){const r=this.getOperationUri(e);return this.privRestAdapter.setHeaders(i.a.configParams.contentTypeKey,"application/json"),this.privRestAdapter.request(n.Post,r,{},{locale:t})}createEnrollment(e,t){this.privRestAdapter.setHeaders(i.a.configParams.contentTypeKey,"multipart/form-data");const r=this.getOperationUri(e.profileType)+"/"+e.profileId+"/enrollments";return t.blob.onSuccessContinueWithPromise(e=>this.privRestAdapter.request(n.File,r,{ignoreMinLength:"true"},null,e))}verifySpeaker(e,t){this.privRestAdapter.setHeaders(i.a.configParams.contentTypeKey,"multipart/form-data");const r=this.getOperationUri(e.voiceProfile.profileType)+"/"+e.voiceProfile.profileId+"/verify";return t.blob.continueWithPromise(e=>{if(e.isError){const t=new s.a;return t.resolve({data:e.error}),t.promise()}return this.privRestAdapter.request(n.File,r,{ignoreMinLength:"true"},null,e.result)})}identifySpeaker(e,t){this.privRestAdapter.setHeaders(i.a.configParams.contentTypeKey,"multipart/form-data");const r=this.getOperationUri(u.a.TextIndependentIdentification)+"/identifySingleSpeaker";return t.blob.continueWithPromise(t=>{if(t.isError){const e=new s.a;return e.resolve({data:t.error}),e.promise()}return this.privRestAdapter.request(n.File,r,{profileIds:e.voiceProfileIds,ignoreMinLength:"true"},null,t.result)})}deleteProfile(e){const t=this.getOperationUri(e.profileType)+"/"+e.profileId;return this.privRestAdapter.request(n.Delete,t,{})}resetProfile(e){const t=this.getOperationUri(e.profileType)+"/"+e.profileId+"/reset";return this.privRestAdapter.request(n.Post,t,{})}getOperationUri(e){const t=e===u.a.TextIndependentIdentification?"identification":"verification",r=e===u.a.TextDependentVerification?"text-dependent":"text-independent";return this.privUri.replace("{mode}",t).replace("{dependency}",r)}}},function(e,t){},function(e,t,r){"use strict";(function(e,n){r.d(t,"a",(function(){return g}));var i=r(218),o=r(118),s=r(50),a=r(19),c=r(133),p=r(219),u=r.n(p),h=r(220),v=r.n(h),l=r(221),d=r.n(l),f=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class g{constructor(t){t&&(this.privProxyInfo=t),g.privDiskCache||(g.privDiskCache=new v.a("microsoft-cognitiveservices-speech-sdk-cache",{supportBuffer:!0,location:void 0!==e&&e.env.SPEECH_OCSP_CACHE_ROOT?e.env.SPEECH_OCSP_CACHE_ROOT:void 0}))}static forceReinitDiskCache(){g.privDiskCache=void 0,g.privMemCache={}}GetAgent(e){const t=new u.a.Agent(this.CreateConnection);if(void 0!==this.privProxyInfo&&void 0!==this.privProxyInfo.HostName&&this.privProxyInfo.Port>0){t["privProxyInfo"]=this.privProxyInfo}return t}static GetProxyAgent(e){const t={host:e.HostName,port:e.Port};e.UserName?t.headers={"Proxy-Authentication":"Basic "+new n(e.UserName+":"+(void 0===e.Password)?"":e.Password).toString("base64")}:t.headers={},t.headers.requestOCSP="true";return new d.a(t)}static OCSPCheck(e,t){return f(this,void 0,void 0,(function*(){let r,n,i=!1;const o=yield e;o.cork();const c=o;return new Promise((e,p)=>{o.on("OCSPResponse",e=>{e&&(this.onEvent(new a.n),n=e)}),o.on("error",e=>{i||(i=!0,o.destroy(),p(e))}),c.on("secure",()=>f(this,void 0,void 0,(function*(){const a=c.getPeerCertificate(!0);try{const c=yield this.GetIssuer(a);r=s.request.generate(a.raw,c.raw);const p=r.id.toString("hex");if(!n){const e=yield g.GetResponseFromCache(p,r,t);n=e}yield this.VerifyOCSPResponse(n,r,t),o.uncork(),i=!0,e(o)}catch(e){o.destroy(),i=!0,p(e)}})))})}))}static GetIssuer(e){return e.issuerCertificate?Promise.resolve(e.issuerCertificate):new Promise((t,r)=>{new s.Agent({}).fetchIssuer(e,null,(e,n)=>{e?r(e):t(n)})})}static GetResponseFromCache(e,t,r){return f(this,void 0,void 0,(function*(){let n=g.privMemCache[e];if(n&&this.onEvent(new a.k(e)),!n)try{const t=yield g.privDiskCache.get(e);t.isCached&&(g.onEvent(new a.i(e)),g.StoreMemoryCacheEntry(e,t.value),n=t.value)}catch(e){n=null}if(!n)return n;try{const i=s.utils.parseResponse(n).value.tbsResponseData;if(i.responses.length<1)return void this.onEvent(new a.c(e,"Not enough data in cached response"));const o=i.responses[0].thisUpdate,c=i.responses[0].nextUpdate;if(c<Date.now()+this.testTimeOffset-6e4)this.onEvent(new a.a(e,c)),n=null;else{const n=Math.min(864e5,(c-o)/2);c-(Date.now()+this.testTimeOffset)<n?(this.onEvent(new a.b(e,o,c)),this.UpdateCache(t,r).catch(t=>{this.onEvent(new a.f(e,t.toString()))})):this.onEvent(new a.d(e,o,c))}}catch(t){this.onEvent(new a.c(e,t)),n=null}return n||this.onEvent(new a.e(e)),n}))}static VerifyOCSPResponse(e,t,r){return f(this,void 0,void 0,(function*(){let n=e;t.certID.toString("hex");return n||(n=yield g.GetOCSPResponse(t,r)),new Promise((i,o)=>{s.verify({request:t,response:n},(s,c)=>{s?(g.onEvent(new a.o(t.id.toString("hex"),s)),e?this.VerifyOCSPResponse(null,t,r).then(()=>{i()},e=>{o(e)}):o(s)):(e||g.StoreCacheEntry(t.id.toString("hex"),n),i())})})}))}static UpdateCache(e,t){return f(this,void 0,void 0,(function*(){const r=e.id.toString("hex");this.onEvent(new a.g(r));const n=yield this.GetOCSPResponse(e,t);this.StoreCacheEntry(r,n),this.onEvent(new a.h(e.id.toString("hex")))}))}static StoreCacheEntry(e,t){this.StoreMemoryCacheEntry(e,t),this.StoreDiskCacheEntry(e,t)}static StoreMemoryCacheEntry(e,t){this.privMemCache[e]=t,this.onEvent(new a.l(e))}static StoreDiskCacheEntry(e,t){this.privDiskCache.set(e,t).then(()=>{this.onEvent(new a.j(e))})}static GetOCSPResponse(e,t){let r={};if(t){const e=g.GetProxyAgent(t);r.agent=e}return new Promise((t,n)=>{s.utils.getAuthorityInfo(e.cert,"1.3.6.1.5.5.7.48.1",(i,c)=>{if(i)return void n(i);const p=o.parse(c);r=Object.assign(Object.assign({},r),p),s.utils.getResponse(r,e.data,(r,i)=>{r?n(r):(this.onEvent(new a.m(e.certID.toString("hex"))),t(i))})})})}CreateConnection(t,r){const n=void 0!==e&&"0"!==e.env.NODE_TLS_REJECT_UNAUTHORIZED&&"0"!==e.env.SPEECH_CONDUCT_OCSP_CHECK&&r.secureEndpoint;let o;if(r=Object.assign(Object.assign({},r),{requestOCSP:!g.forceDisableOCSPStapling,servername:r.host}),this.privProxyInfo){const e=g.GetProxyAgent(this.privProxyInfo);o=new Promise((n,i)=>{e.callback(t,r,(e,t)=>{e?i(e):n(t)})})}else o=Promise.resolve(i.connect(r));return n?g.OCSPCheck(o,this.privProxyInfo):o}}g.testTimeOffset=0,g.forceDisableOCSPStapling=!1,g.privMemCache={},g.onEvent=e=>{c.a.instance.onEvent(e)}}).call(this,r(170),r(74).Buffer)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(4),i=r(18),o=r(132);class s{constructor(e){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.read=()=>{if(this.privIsReadEnded)throw new n.b("Stream read has already finished");return this.privReaderQueue.dequeue().onSuccessContinueWith(e=>((void 0===e||e.isEnd)&&this.privReaderQueue.dispose("End of stream reached"),e))},this.readEnded=()=>{this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new o.a)},this.throwIfClosed=()=>{if(this.privIsWriteEnded)throw new n.b("Stream closed")},this.privId=e||Object(i.b)(),this.privReaderQueue=new o.a}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(e){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(e)}catch(e){}}}},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(17),i=r(4),o=r(18);class s{constructor(e,t,r){if(this.privPayload=null,!t)throw new i.a("payload");if(e===n.b.Binary&&!(t instanceof ArrayBuffer))throw new i.b("Payload must be ArrayBuffer");if(e===n.b.Text&&"string"!=typeof t)throw new i.b("Payload must be a string");this.privMessageType=e,this.privPayload=t,this.privId=r||Object(o.b)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===n.b.Binary)throw new i.b("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===n.b.Text)throw new i.b("Not supported for text message");return this.privPayload}get id(){return this.privId}}},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createAdapters",{enumerable:!0,get:function(){return i.default}}),r(229);var i=n(r(242));if("undefined"!=typeof HTMLDocument&&"undefined"!=typeof document&&document instanceof HTMLDocument){var o=document.createElement("meta");o.setAttribute("name","botframework-directlinespeech:version"),o.setAttribute("content","4.11.0"),document.head.appendChild(o)}},,,function(e,t,r){var n=r(230);e.exports=n},function(e,t,r){r(231);var n=r(72);e.exports=n.Object.entries},function(e,t,r){var n=r(90),i=r(241).entries;n({target:"Object",stat:!0},{entries:function(e){return i(e)}})},function(e,t,r){var n=r(51),i=r(136),o="".split;e.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},function(e,t,r){var n=r(24),i=r(140),o=n.WeakMap;e.exports="function"==typeof o&&/native code/.test(i(o))},function(e,t,r){var n=r(33),i=r(235),o=r(134),s=r(41);e.exports=function(e,t){for(var r=i(t),a=s.f,c=o.f,p=0;p<r.length;p++){var u=r[p];n(e,u)||a(e,u,c(t,u))}}},function(e,t,r){var n=r(98),i=r(236),o=r(239),s=r(37);e.exports=n("Reflect","ownKeys")||function(e){var t=i.f(s(e)),r=o.f;return r?t.concat(r(e)):t}},function(e,t,r){var n=r(144),i=r(100).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},function(e,t,r){var n=r(62),i=r(145),o=r(238),s=function(e){return function(t,r,s){var a,c=n(t),p=i(c.length),u=o(s,p);if(e&&r!=r){for(;p>u;)if((a=c[u++])!=a)return!0}else for(;p>u;u++)if((e||u in c)&&c[u]===r)return e||u||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},function(e,t,r){var n=r(99),i=Math.max,o=Math.min;e.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):o(r,t)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(51),i=/#|\.prototype\./,o=function(e,t){var r=a[s(e)];return r==p||r!=c&&("function"==typeof t?n(t):!!t)},s=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},a=o.data={},c=o.NATIVE="N",p=o.POLYFILL="P";e.exports=o},function(e,t,r){var n=r(39),i=r(146),o=r(62),s=r(135).f,a=function(e){return function(t){for(var r,a=o(t),c=i(a),p=c.length,u=0,h=[];p>u;)r=c[u++],n&&!s.call(a,r)||h.push(e?[r,a[r]]:a[r]);return h}};e.exports={entries:a(!0),values:a(!1)}},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return d.apply(this,arguments)};var i=n(r(43)),o=n(r(44)),s=r(148),a=r(478),c=r(154),p=n(r(395)),u=n(r(435)),h=n(r(469)),v=n(r(474)),l=n(r(477));function d(){return(d=(0,o.default)(i.default.mark((function e(t){var r,n,d,f,g,y,m,S,C,b,P,R,w,I,E,O,T,A,D,_,M,x,k,j,z,N;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.audioConfig,n=t.audioContext,d=t.audioInputDeviceId,f=t.enableInternalHTTPSupport,g=t.enableTelemetry,y=t.fetchCredentials,m=t.speechRecognitionEndpointId,S=t.speechRecognitionLanguage,C=void 0===S?"undefined"!=typeof window&&void 0!==window.navigator&&window.navigator.language||"en-US":S,b=t.speechSynthesisDeploymentId,P=t.speechSynthesisOutputFormat,R=t.textNormalization,w=t.userID,I=t.username,y){e.next=3;break}throw new Error('"fetchCredentials" must be specified.');case 3:return e.next=5,(0,l.default)(y);case 5:if(E=e.sent,O=E.authorizationToken,T=E.directLineToken,A=E.region,D=E.subscriptionKey,!(!O&&!D||O&&D||O&&"string"!=typeof O||D&&"string"!=typeof D||f&&!T)){e.next=12;break}throw new Error('"fetchCredentials" must return either "authorizationToken" or "subscriptionKey" as a non-empty string only. If enableInternalHTTPSupport is set to true, then it should also return a non-empty "directLineToken"');case 12:if(void 0!==g&&console.warn("botframework-directlinespeech: Telemetry options are not yet supported. Please refer to Cognitive Services documentation for details."),A&&"string"==typeof A){e.next=15;break}throw new Error('"fetchCredentials" must return "region" as a non-empty string.');case 15:return r&&d?console.warn('botframework-directlinespeech-sdk: Only "audioConfig" or "audioInputDeviceId" can be specified, but not both; ignoring "audioInputDeviceId".'):r||(r=d?s.AudioConfig.fromMicrophoneInput(d):s.AudioConfig.fromDefaultMicrophoneInput(),(_=r.privSource).createAudioContext=function(){if(!_.privContext){var e=window.AudioContext||window.webkitAudioContext;if(void 0===e)throw new Error("Browser does not support Web Audio API (AudioContext/webkitAudioContext is not available).");navigator.mediaDevices.getSupportedConstraints().sampleRate?_.privContext=new e({sampleRate:c.MicAudioSource.AUDIOFORMAT.samplesPerSec}):_.privContext=new e}}),m&&console.warn('botframework-directlinespeech: Custom Speech is currently not supported; ignoring "speechRecognitionEndpointId".'),b&&console.warn('botframework-directlinespeech: Custom Voice is currently not supported; ignoring "speechSynthesisDeploymentId".'),P&&console.warn('botframework-directlinespeech: Synthesis output format is currently not supported; ignoring "speechSynthesisOutputFormat".'),R&&console.warn('botframework-directlinespeech: Text normalization is currently not supported; ignoring "textNormalization".'),(w||I)&&console.warn('botframework-directlinespeech: Custom "userId" and "username" are currently not supported and are ignored.'),M=O?a.BotFrameworkConfig.fromAuthorizationToken(O,A):a.BotFrameworkConfig.fromSubscription(D,A),f&&(M.setProperty(a.PropertyId.SpeechServiceConnection_Endpoint,"wss://".concat(encodeURI(A),".convai.speech.microsoft.com/directline/api/v1")),M.setProperty(a.PropertyId.Conversation_ApplicationId,T)),M.setProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage,C),w&&M.setProperty(a.PropertyId.Conversation_From_Id,w),(x=(0,h.default)(new a.DialogServiceConnector(M,r))).connect(),O&&(k=setInterval((0,o.default)(i.default.mark((function e(){var t,r,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.privIsDisposed&&clearInterval(k),e.next=3,(0,l.default)(y);case 3:if(t=e.sent,r=t.authorizationToken,n=t.region,r){e.next=8;break}return e.abrupt("return",console.warn('botframework-directlinespeech-sdk: Renew token failed because "fetchCredentials" call returned no authorization token.'));case 8:if(A===n){e.next=10;break}return e.abrupt("return",console.warn("botframework-directlinespeech-sdk: Region change is not supported for renewed token. Authorization token is not renewed."));case 10:x.authorizationToken=r;case 11:case"end":return e.stop()}}),e)}))),12e4)),f&&(j=setInterval((0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.privIsDisposed&&clearInterval(j),e.next=3,(0,v.default)(T);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",console.warn("botframework-directlinespeech-sdk: Renew token failed because call to refresh token Direct Line API did not return a new token."));case 6:M.setProperty(a.PropertyId.Conversation_ApplicationId,t),x.properties.setProperty(a.PropertyId.Conversation_ApplicationId,t),x.connect();case 9:case"end":return e.stop()}}),e)}))),9e5)),z=new u.default({dialogServiceConnector:x}),N=(0,p.default)({audioContext:n,enableTelemetry:g,recognizer:x,textNormalization:R}),e.abrupt("return",{directLine:z,webSpeechPonyfillFactory:N});case 32:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=function(e){var t=this;void 0===e&&(e=n.EventType.Warning),this.onEvent=function(e){if(e.eventType>=t.privLogLevelFilter){var r=t.toString(e);switch(e.eventType){case n.EventType.Debug:console.debug(r);break;case n.EventType.Info:console.info(r);break;case n.EventType.Warning:console.warn(r);break;case n.EventType.Error:console.error(r);break;default:console.log(r)}}},this.toString=function(e){var t=[""+e.EventTime,""+e.Name];for(var r in e)if(r&&e.hasOwnProperty(r)&&"eventTime"!==r&&"eventType"!==r&&"eventId"!==r&&"name"!==r&&"constructor"!==r){var n=e[r],i="<NULL>";null!=n&&(i="number"==typeof n||"string"==typeof n?n.toString():JSON.stringify(n)),t.push(r+": "+i)}return t.join(" | ")},this.privLogLevelFilter=e};t.ConsoleLoggingListener=i},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(73),s=function(e){function t(t,r,n){void 0===n&&(n=o.EventType.Info);var i=e.call(this,t,n)||this;return i.privAudioSourceId=r,i}return i(t,e),Object.defineProperty(t.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!0,configurable:!0}),t}(o.PlatformEvent);t.AudioSourceEvent=s;var a=function(e){function t(t){return e.call(this,"AudioSourceInitializingEvent",t)||this}return i(t,e),t}(s);t.AudioSourceInitializingEvent=a;var c=function(e){function t(t){return e.call(this,"AudioSourceReadyEvent",t)||this}return i(t,e),t}(s);t.AudioSourceReadyEvent=c;var p=function(e){function t(t){return e.call(this,"AudioSourceOffEvent",t)||this}return i(t,e),t}(s);t.AudioSourceOffEvent=p;var u=function(e){function t(t,r){var n=e.call(this,"AudioSourceErrorEvent",t,o.EventType.Error)||this;return n.privError=r,n}return i(t,e),Object.defineProperty(t.prototype,"error",{get:function(){return this.privError},enumerable:!0,configurable:!0}),t}(s);t.AudioSourceErrorEvent=u;var h=function(e){function t(t,r,n){var i=e.call(this,t,r)||this;return i.privAudioNodeId=n,i}return i(t,e),Object.defineProperty(t.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),t}(s);t.AudioStreamNodeEvent=h;var v=function(e){function t(t,r){return e.call(this,"AudioStreamNodeAttachingEvent",t,r)||this}return i(t,e),t}(h);t.AudioStreamNodeAttachingEvent=v;var l=function(e){function t(t,r){return e.call(this,"AudioStreamNodeAttachedEvent",t,r)||this}return i(t,e),t}(h);t.AudioStreamNodeAttachedEvent=l;var d=function(e){function t(t,r){return e.call(this,"AudioStreamNodeDetachedEvent",t,r)||this}return i(t,e),t}(h);t.AudioStreamNodeDetachedEvent=d;var f=function(e){function t(t,r,n){var i=e.call(this,"AudioStreamNodeErrorEvent",t,r)||this;return i.privError=n,i}return i(t,e),Object.defineProperty(t.prototype,"error",{get:function(){return this.privError},enumerable:!0,configurable:!0}),t}(h);t.AudioStreamNodeErrorEvent=f},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(73),s=function(e){function t(t,r,n){void 0===n&&(n=o.EventType.Info);var i=e.call(this,t,n)||this;return i.privJsonResult=r,i}return i(t,e),Object.defineProperty(t.prototype,"jsonString",{get:function(){return this.privJsonResult},enumerable:!0,configurable:!0}),t}(o.PlatformEvent);t.ServiceEvent=s;var a=function(e){function t(t,r,n){void 0===n&&(n=o.EventType.Info);var i=e.call(this,t,n)||this;return i.privConnectionId=r,i}return i(t,e),Object.defineProperty(t.prototype,"connectionId",{get:function(){return this.privConnectionId},enumerable:!0,configurable:!0}),t}(o.PlatformEvent);t.ConnectionEvent=a;var c=function(e){function t(t,r,n){var i=e.call(this,"ConnectionStartEvent",t)||this;return i.privUri=r,i.privHeaders=n,i}return i(t,e),Object.defineProperty(t.prototype,"uri",{get:function(){return this.privUri},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headers",{get:function(){return this.privHeaders},enumerable:!0,configurable:!0}),t}(a);t.ConnectionStartEvent=c;var p=function(e){function t(t,r){return e.call(this,"ConnectionEstablishedEvent",t)||this}return i(t,e),t}(a);t.ConnectionEstablishedEvent=p;var u=function(e){function t(t,r,n){var i=e.call(this,"ConnectionClosedEvent",t,o.EventType.Debug)||this;return i.privRreason=n,i.privStatusCode=r,i}return i(t,e),Object.defineProperty(t.prototype,"reason",{get:function(){return this.privRreason},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"statusCode",{get:function(){return this.privStatusCode},enumerable:!0,configurable:!0}),t}(a);t.ConnectionClosedEvent=u;var h=function(e){function t(t,r,n){var i=e.call(this,"ConnectionErrorEvent",t,o.EventType.Debug)||this;return i.privMessage=r,i.privType=n,i}return i(t,e),Object.defineProperty(t.prototype,"message",{get:function(){return this.privMessage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.privType},enumerable:!0,configurable:!0}),t}(a);t.ConnectionErrorEvent=h;var v=function(e){function t(t,r,n){var i=e.call(this,"ConnectionEstablishErrorEvent",t,o.EventType.Error)||this;return i.privStatusCode=r,i.privReason=n,i}return i(t,e),Object.defineProperty(t.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"statusCode",{get:function(){return this.privStatusCode},enumerable:!0,configurable:!0}),t}(a);t.ConnectionEstablishErrorEvent=v;var l=function(e){function t(t,r,n){var i=e.call(this,"ConnectionMessageReceivedEvent",t)||this;return i.privNetworkReceivedTime=r,i.privMessage=n,i}return i(t,e),Object.defineProperty(t.prototype,"networkReceivedTime",{get:function(){return this.privNetworkReceivedTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.privMessage},enumerable:!0,configurable:!0}),t}(a);t.ConnectionMessageReceivedEvent=l;var d=function(e){function t(t,r,n){var i=e.call(this,"ConnectionMessageSentEvent",t)||this;return i.privNetworkSentTime=r,i.privMessage=n,i}return i(t,e),Object.defineProperty(t.prototype,"networkSentTime",{get:function(){return this.privNetworkSentTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.privMessage},enumerable:!0,configurable:!0}),t}(a);t.ConnectionMessageSentEvent=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.privStatusCode=e,this.privReason=t}return Object.defineProperty(e.prototype,"statusCode",{get:function(){return this.privStatusCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),e}();t.ConnectionOpenResponse=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(29),i=r(150),o=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e.privInstance},enumerable:!0,configurable:!0}),e.privInstance=new i.EventSource,e.setEventSource=function(t){if(!t)throw new n.ArgumentNullError("eventSource");e.privInstance=t},e}();t.Events=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"}(t.ConnectionState||(t.ConnectionState={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(149),i=r(29),o=r(45),s=function(){function e(e,t,r){if(this.privPayload=null,!t)throw new i.ArgumentNullError("payload");if(e===n.MessageType.Binary&&!(t instanceof ArrayBuffer))throw new i.InvalidOperationError("Payload must be ArrayBuffer");if(e===n.MessageType.Text&&"string"!=typeof t)throw new i.InvalidOperationError("Payload must be a string");this.privMessageType=e,this.privPayload=t,this.privId=r||o.createNoDashGuid()}return Object.defineProperty(e.prototype,"messageType",{get:function(){return this.privMessageType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"payload",{get:function(){return this.privPayload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textContent",{get:function(){if(this.privMessageType===n.MessageType.Binary)throw new i.InvalidOperationError("Not supported for binary message");return this.privPayload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryContent",{get:function(){if(this.privMessageType===n.MessageType.Text)throw new i.InvalidOperationError("Not supported for text message");return this.privPayload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privId},enumerable:!0,configurable:!0}),e}();t.RawWebsocketMessage=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){var r=this;this.encode=function(e){var t=r.downSampleAudioFrame(e,r.privActualSampleRate,r.privDesiredSampleRate);if(!t)return null;var n=2*t.length,i=new ArrayBuffer(n),o=new DataView(i);return r.floatTo16BitPCM(o,0,t),i},this.setString=function(e,t,r){for(var n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))},this.floatTo16BitPCM=function(e,t,r){for(var n=0;n<r.length;n++,t+=2){var i=Math.max(-1,Math.min(1,r[n]));e.setInt16(t,i<0?32768*i:32767*i,!0)}},this.downSampleAudioFrame=function(e,t,r){if(r===t||r>t)return e;for(var n=t/r,i=Math.round(e.length/n),o=new Float32Array(i),s=0,a=0;a<i;){for(var c=Math.round((a+1)*n),p=0,u=0;s<c&&s<e.length;)p+=e[s++],u++;o[a++]=p/u}return o},this.privActualSampleRate=e,this.privDesiredSampleRate=t};t.RiffPcmEncoder=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(29),i=r(45),o=r(152),s=function(){function e(e){var t=this;this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.read=function(){if(t.privIsReadEnded)throw new n.InvalidOperationError("Stream read has already finished");return t.privReaderQueue.dequeue().onSuccessContinueWith((function(e){return(void 0===e||e.isEnd)&&t.privReaderQueue.dispose("End of stream reached"),e}))},this.readEnded=function(){t.privIsReadEnded||(t.privIsReadEnded=!0,t.privReaderQueue=new o.Queue)},this.throwIfClosed=function(){if(t.privIsWriteEnded)throw new n.InvalidOperationError("Stream closed")},this.privId=e||i.createNoDashGuid(),this.privReaderQueue=new o.Queue}return Object.defineProperty(e.prototype,"isClosed",{get:function(){return this.privIsWriteEnded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReadEnded",{get:function(){return this.privIsReadEnded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privId},enumerable:!0,configurable:!0}),e.prototype.close=function(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)},e.prototype.writeStreamChunk=function(e){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(e)}catch(e){}},e}();t.Stream=s},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){var n=e.call(this,r)||this;return n.privTargetChunkSize=t,n.privNextBufferReadyBytes=0,n}return i(t,e),t.prototype.writeStreamChunk=function(t){if(t.isEnd||0===this.privNextBufferReadyBytes&&t.buffer.byteLength===this.privTargetChunkSize)e.prototype.writeStreamChunk.call(this,t);else for(var r=0;r<t.buffer.byteLength;){void 0===this.privNextBufferToWrite&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=t.timeReceived);var n=Math.min(t.buffer.byteLength-r,this.privTargetChunkSize-this.privNextBufferReadyBytes),i=new Uint8Array(this.privNextBufferToWrite),o=new Uint8Array(t.buffer.slice(r,n+r));i.set(o,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=n,r+=n,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(e.prototype.writeStreamChunk.call(this,{buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}},t.prototype.close=function(){0===this.privNextBufferReadyBytes||this.isClosed||e.prototype.writeStreamChunk.call(this,{buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),e.prototype.close.call(this)},t}(r(6).Stream);t.ChunkedArrayBufferStream=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.workerTimers=null,e.clearTimeout=function(t){return e.timers().clearTimeout(t)},e.setTimeout=function(t,r){return e.timers().setTimeout(t,r)},e.load=function(t){var r=new Map([[0,function(){}]]),n=new Map,i=new Worker(t);i.addEventListener("message",(function(t){var i=t.data;if(e.isCallNotification(i)){var o=i.params.timerId,s=r.get(o);if("number"==typeof s){if(void 0===(c=n.get(s))||c!==o)throw new Error("The timer is in an undefined state.")}else{if(void 0===s)throw new Error("The timer is in an undefined state.");s(),r.delete(o)}}else{if(!e.isClearResponse(i)){var a=i.error.message;throw new Error(a)}var c,p=i.id;if(void 0===(c=n.get(p)))throw new Error("The timer is in an undefined state.");n.delete(p),r.delete(c)}}));return{clearTimeout:function(e){var t=Math.random();n.set(t,e),r.set(e,t),i.postMessage({id:t,method:"clear",params:{timerId:e}})},setTimeout:function(e,t){var n=Math.random();return r.set(n,e),i.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:n}}),n}}},e.loadWorkerTimers=function(){return function(){if(null!==e.workerTimers)return e.workerTimers;var t=new Blob(['!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error(\'There is no interval scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error(\'The given method "\'.concat(e.method,\'" is not supported\'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);'],{type:"application/javascript; charset=utf-8"}),r=URL.createObjectURL(t);return e.workerTimers=e.load(r),e.workerTimers.setTimeout((function(){return URL.revokeObjectURL(r)}),0),e.workerTimers}},e.timers=e.loadWorkerTimers(),e.isCallNotification=function(e){return void 0!==e.method&&"call"===e.method},e.isClearResponse=function(e){return null===e.error&&"number"==typeof e.id},e}();t.Timeout=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(103),o=function(e){var t=this;if(this.fetch=function(e){return n.PromiseHelper.fromResult(t.privAuthInfo)},this.fetchOnExpiry=function(e){return n.PromiseHelper.fromResult(t.privAuthInfo)},!e)throw new n.ArgumentNullError("subscriptionKey");this.privAuthInfo=new i.AuthInfo("Ocp-Apim-Subscription-Key",e)};t.CognitiveSubscriptionKeyAuthentication=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(103),o=function(e,t){var r=this;if(this.fetch=function(e){return r.privFetchCallback(e).onSuccessContinueWith((function(e){return new i.AuthInfo("Authorization",e)}))},this.fetchOnExpiry=function(e){return r.privFetchOnExpiryCallback(e).onSuccessContinueWith((function(e){return new i.AuthInfo("Authorization",e)}))},!e)throw new n.ArgumentNullError("fetchCallback");if(!t)throw new n.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=t};t.CognitiveTokenAuthentication=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(28),s=r(2),a=r(64),c=r(5),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e,r,n){var i=e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_Endpoint);if(!i){var a=e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_IntentRegion),p=a&&a.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com";i=e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_Host,"wss://"+a+".sr.speech"+p)+"/speech/recognition/interactive/cognitiveservices/v1"}var u={format:"simple",language:e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage)};t.setCommonUrlParams(e,u,i);var h={};return void 0!==r.token&&""!==r.token&&(h[r.headerName]=r.token),h["X-ConnectionId"]=n,e.parameters.setProperty(s.PropertyId.SpeechServiceConnection_Url,i),new o.WebsocketConnection(i,u,h,new c.WebsocketMessageFormatter,o.ProxyInfo.fromRecognizerConfig(e),n)},t}return i(t,e),t.prototype.getSpeechRegionFromIntentRegion=function(e){switch(e){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return e}},t}(a.ConnectionFactoryBase);t.IntentConnectionFactory=p},function(e,t,r){"use strict";t.byteLength=function(e){var t=p(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n=p(e),s=n[0],a=n[1],c=new o(function(e,t,r){return 3*(t+r)/4-r}(0,s,a)),u=0,h=a>0?s-4:s;for(r=0;r<h;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;2===a&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,c[u++]=255&t);1===a&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=0,a=r-i;s<a;s+=16383)o.push(u(e,s,s+16383>a?a:s+16383));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)n[a]=s[a],i[s.charCodeAt(a)]=a;function p(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,r){for(var i,o,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,p=c>>1,u=-7,h=r?i-1:0,v=r?-1:1,l=e[t+h];for(h+=v,o=l&(1<<-u)-1,l>>=-u,u+=a;u>0;o=256*o+e[t+h],h+=v,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=n;u>0;s=256*s+e[t+h],h+=v,u-=8);if(0===o)o=1-p;else{if(o===c)return s?NaN:1/0*(l?-1:1);s+=Math.pow(2,n),o-=p}return(l?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,c,p=8*o-i-1,u=(1<<p)-1,h=u>>1,v=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,l=n?0:o-1,d=n?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?v/c:v*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(t*c-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+l]=255&a,l+=d,a/=256,i-=8);for(s=s<<i|a,p+=i;p>0;e[r+l]=255&s,l+=d,s/=256,p-=8);e[r+l-d]|=128*f}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"}(t.CancellationReason||(t.CancellationReason={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){};t.PullAudioInputStreamCallback=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){};t.PushAudioOutputStreamCallback=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=function(){function e(){this.privDisposed=!1}return e.fromFile=function(e){throw n.Contracts.throwIfFileDoesNotExist(e,"fileName"),new Error("Not yet implemented.")},e.fromStream=function(e){throw n.Contracts.throwIfNull(e,"file"),new Error("Not yet implemented.")},e.prototype.close=function(){this.privDisposed||(this.privDisposed=!0)},e}();t.KeywordRecognitionModel=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privSessionId=e}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!0,configurable:!0}),e}();t.SessionEventArgs=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){var n=e.call(this,r)||this;return n.privOffset=t,n}return i(t,e),Object.defineProperty(t.prototype,"offset",{get:function(){return this.privOffset},enumerable:!0,configurable:!0}),t}(r(2).SessionEventArgs);t.RecognitionEventArgs=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(t.OutputFormat||(t.OutputFormat={}))},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var i=e.call(this,r,n)||this;return i.privResult=t,i}return i(t,e),Object.defineProperty(t.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),t}(r(2).RecognitionEventArgs);t.IntentRecognitionEventArgs=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,n,i,o,s,a,c,p){this.privResultId=e,this.privReason=t,this.privText=r,this.privDuration=n,this.privOffset=i,this.privLanguage=o,this.privLanguageDetectionConfidence=s,this.privErrorDetails=a,this.privJson=c,this.privProperties=p}return Object.defineProperty(e.prototype,"resultId",{get:function(){return this.privResultId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.privText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.privDuration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offset",{get:function(){return this.privOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"language",{get:function(){return this.privLanguage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageDetectionConfidence",{get:function(){return this.privLanguageDetectionConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"json",{get:function(){return this.privJson},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),e}();t.RecognitionResult=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o,s,a,c,p,u){return e.call(this,t,r,n,i,o,s,a,c,p,u)||this}return i(t,e),t}(r(2).RecognitionResult);t.SpeechRecognitionResult=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o,s,a,c,p,u,h){var v=e.call(this,r,n,i,o,s,a,c,p,u,h)||this;return v.privIntentId=t,v}return i(t,e),Object.defineProperty(t.prototype,"intentId",{get:function(){return this.privIntentId},enumerable:!0,configurable:!0}),t}(r(2).SpeechRecognitionResult);t.IntentRecognitionResult=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(10),s=function(){function e(){}return e.fromEndpoint=function(e){o.Contracts.throwIfNull(e,"uri"),o.Contracts.throwIfNullOrWhitespace(e.hostname,"uri");var t=new a,r=e.host.indexOf(".");if(-1===r)throw new Error("Could not determine region from endpoint");t.region=e.host.substr(0,r);var n=e.pathname.lastIndexOf("/")+1;if(-1===n)throw new Error("Could not determine appId from endpoint");if(t.appId=e.pathname.substr(n),t.subscriptionKey=e.searchParams.get("subscription-key"),void 0===t.subscriptionKey)throw new Error("Could not determine subscription key from endpoint");return t},e.fromAppId=function(e){o.Contracts.throwIfNullOrWhitespace(e,"appId");var t=new a;return t.appId=e,t},e.fromSubscription=function(e,t,r){o.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),o.Contracts.throwIfNullOrWhitespace(t,"appId"),o.Contracts.throwIfNullOrWhitespace(r,"region");var n=new a;return n.appId=t,n.region=r,n.subscriptionKey=e,n},e}();t.LanguageUnderstandingModel=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(s);t.LanguageUnderstandingModelImpl=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var i=e.call(this,r,n)||this;return i.privResult=t,i}return i(t,e),Object.defineProperty(t.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),t}(r(2).RecognitionEventArgs);t.SpeechRecognitionEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o){var s=e.call(this,i,o)||this;return s.privReason=t,s.privErrorDetails=r,s.privErrorCode=n,s}return i(t,e),Object.defineProperty(t.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorCode",{get:function(){return this.privErrorCode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),t}(r(2).RecognitionEventArgs);t.SpeechRecognitionCanceledEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var i=e.call(this,r,n)||this;return i.privResult=t,i}return i(t,e),Object.defineProperty(t.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),t}(r(2).RecognitionEventArgs);t.TranslationRecognitionEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){var n=e.call(this,r)||this;return n.privResult=t,n}return i(t,e),Object.defineProperty(t.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),t}(r(2).SessionEventArgs);t.TranslationSynthesisEventArgs=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.privReason=e,this.privAudio=t}return Object.defineProperty(e.prototype,"audio",{get:function(){return this.privAudio},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),e}();t.TranslationSynthesisResult=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizingIntent=4]="RecognizingIntent",e[e.RecognizedIntent=5]="RecognizedIntent",e[e.TranslatingSpeech=6]="TranslatingSpeech",e[e.TranslatedSpeech=7]="TranslatedSpeech",e[e.SynthesizingAudio=8]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=9]="SynthesizingAudioCompleted",e[e.SynthesizingAudioStarted=10]="SynthesizingAudioStarted",e[e.EnrollingVoiceProfile=11]="EnrollingVoiceProfile",e[e.EnrolledVoiceProfile=12]="EnrolledVoiceProfile",e[e.RecognizedSpeakers=13]="RecognizedSpeakers",e[e.RecognizedSpeaker=14]="RecognizedSpeaker",e[e.ResetVoiceProfile=15]="ResetVoiceProfile",e[e.DeletedVoiceProfile=16]="DeletedVoiceProfile"}(t.ResultReason||(t.ResultReason={}))},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),s=r(10),a=r(2),c=function(){function e(){}return e.fromSubscription=function(e,t){s.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),s.Contracts.throwIfNullOrWhitespace(t,"region");var r=new p;return r.setProperty(a.PropertyId.SpeechServiceConnection_Region,t),r.setProperty(a.PropertyId.SpeechServiceConnection_IntentRegion,t),r.setProperty(a.PropertyId.SpeechServiceConnection_Key,e),r},e.fromEndpoint=function(e,t){s.Contracts.throwIfNull(e,"endpoint");var r=new p;return r.setProperty(a.PropertyId.SpeechServiceConnection_Endpoint,e.href),void 0!==t&&r.setProperty(a.PropertyId.SpeechServiceConnection_Key,t),r},e.fromHost=function(e,t){s.Contracts.throwIfNull(e,"hostName");var r=new p;return r.setProperty(a.PropertyId.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(""===e.port?"":":"+e.port)),void 0!==t&&r.setProperty(a.PropertyId.SpeechServiceConnection_Key,t),r},e.fromAuthorizationToken=function(e,t){s.Contracts.throwIfNull(e,"authorizationToken"),s.Contracts.throwIfNullOrWhitespace(t,"region");var r=new p;return r.setProperty(a.PropertyId.SpeechServiceConnection_Region,t),r.setProperty(a.PropertyId.SpeechServiceConnection_IntentRegion,t),r.authorizationToken=e,r},e.prototype.close=function(){},e}();t.SpeechConfig=c;var p=function(e){function t(){var t=e.call(this)||this;return t.privProperties=new a.PropertyCollection,t.speechRecognitionLanguage="en-US",t.outputFormat=a.OutputFormat.Simple,t}return i(t,e),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endPoint",{get:function(){return new URL(this.privProperties.getProperty(a.PropertyId.SpeechServiceConnection_Endpoint))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subscriptionKey",{get:function(){return this.privProperties.getProperty(a.PropertyId.SpeechServiceConnection_Key)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"region",{get:function(){return this.privProperties.getProperty(a.PropertyId.SpeechServiceConnection_Region)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorizationToken",{get:function(){return this.privProperties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){this.privProperties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{get:function(){return this.privProperties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage)},set:function(e){this.privProperties.setProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoDetectSourceLanguages",{get:function(){return this.privProperties.getProperty(a.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)},set:function(e){this.privProperties.setProperty(a.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputFormat",{get:function(){return a.OutputFormat[this.privProperties.getProperty(o.OutputFormatPropertyName,void 0)]},set:function(e){this.privProperties.setProperty(o.OutputFormatPropertyName,a.OutputFormat[e])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endpointId",{get:function(){return this.privProperties.getProperty(a.PropertyId.SpeechServiceConnection_EndpointId)},set:function(e){this.privProperties.setProperty(a.PropertyId.SpeechServiceConnection_EndpointId,e)},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){s.Contracts.throwIfNull(t,"value"),this.privProperties.setProperty(e,t)},t.prototype.getProperty=function(e,t){return this.privProperties.getProperty(e,t)},t.prototype.setProxy=function(e,t,r,n){this.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_ProxyHostName],e),this.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_ProxyUserName],r),this.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_ProxyPassword],n)},t.prototype.setServiceProperty=function(e,t,r){var n=JSON.parse(this.privProperties.getProperty(o.ServicePropertiesPropertyName,"{}"));n[e]=t,this.privProperties.setProperty(o.ServicePropertiesPropertyName,JSON.stringify(n))},t.prototype.setProfanity=function(e){this.privProperties.setProperty(a.PropertyId.SpeechServiceResponse_ProfanityOption,a.ProfanityOption[e])},t.prototype.enableAudioLogging=function(){this.privProperties.setProperty(a.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")},t.prototype.requestWordLevelTimestamps=function(){this.privProperties.setProperty(a.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")},t.prototype.enableDictation=function(){this.privProperties.setProperty(o.ForceDictationPropertyName,"true")},t.prototype.clone=function(){var e=new t;return e.privProperties=this.privProperties.clone(),e},Object.defineProperty(t.prototype,"speechSynthesisLanguage",{get:function(){return this.privProperties.getProperty(a.PropertyId.SpeechServiceConnection_SynthLanguage)},set:function(e){this.privProperties.setProperty(a.PropertyId.SpeechServiceConnection_SynthLanguage,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechSynthesisVoiceName",{get:function(){return this.privProperties.getProperty(a.PropertyId.SpeechServiceConnection_SynthVoice)},set:function(e){this.privProperties.setProperty(a.PropertyId.SpeechServiceConnection_SynthVoice,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechSynthesisOutputFormat",{get:function(){return a.SpeechSynthesisOutputFormat[this.privProperties.getProperty(a.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]},set:function(e){this.privProperties.setProperty(a.PropertyId.SpeechServiceConnection_SynthOutputFormat,a.SpeechSynthesisOutputFormat[e])},enumerable:!0,configurable:!0}),t}(c);t.SpeechConfigImpl=p},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),s=r(10),a=r(2),c=function(e){function t(){return e.call(this)||this}return i(t,e),t.fromSubscription=function(e,t){s.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),s.Contracts.throwIfNullOrWhitespace(t,"region");var r=new p;return r.properties.setProperty(a.PropertyId.SpeechServiceConnection_Key,e),r.properties.setProperty(a.PropertyId.SpeechServiceConnection_Region,t),r},t.fromAuthorizationToken=function(e,t){s.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),s.Contracts.throwIfNullOrWhitespace(t,"region");var r=new p;return r.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,e),r.properties.setProperty(a.PropertyId.SpeechServiceConnection_Region,t),r},t.fromHost=function(e,t){s.Contracts.throwIfNull(e,"hostName");var r=new p;return r.setProperty(a.PropertyId.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(""===e.port?"":":"+e.port)),void 0!==t&&r.setProperty(a.PropertyId.SpeechServiceConnection_Key,t),r},t.fromEndpoint=function(e,t){s.Contracts.throwIfNull(e,"endpoint"),s.Contracts.throwIfNull(t,"subscriptionKey");var r=new p;return r.properties.setProperty(a.PropertyId.SpeechServiceConnection_Endpoint,e.href),r.properties.setProperty(a.PropertyId.SpeechServiceConnection_Key,t),r},t}(a.SpeechConfig);t.SpeechTranslationConfig=c;var p=function(e){function t(){var t=e.call(this)||this;return t.privSpeechProperties=new a.PropertyCollection,t.outputFormat=a.OutputFormat.Simple,t}return i(t,e),Object.defineProperty(t.prototype,"authorizationToken",{set:function(e){s.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{set:function(e){s.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subscriptionKey",{get:function(){return this.privSpeechProperties.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_Key])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputFormat",{get:function(){return a.OutputFormat[this.privSpeechProperties.getProperty(o.OutputFormatPropertyName,void 0)]},set:function(e){this.privSpeechProperties.setProperty(o.OutputFormatPropertyName,a.OutputFormat[e])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endpointId",{get:function(){return this.privSpeechProperties.getProperty(a.PropertyId.SpeechServiceConnection_EndpointId)},set:function(e){this.privSpeechProperties.setProperty(a.PropertyId.SpeechServiceConnection_EndpointId,e)},enumerable:!0,configurable:!0}),t.prototype.addTargetLanguage=function(e){s.Contracts.throwIfNullOrWhitespace(e,"value");var t=this.targetLanguages;t.push(e),this.privSpeechProperties.setProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(","))},Object.defineProperty(t.prototype,"targetLanguages",{get:function(){return void 0!==this.privSpeechProperties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)?this.privSpeechProperties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"voiceName",{get:function(){return this.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_TranslationVoice])},set:function(e){s.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"region",{get:function(){return this.privSpeechProperties.getProperty(a.PropertyId.SpeechServiceConnection_Region)},enumerable:!0,configurable:!0}),t.prototype.setProxy=function(e,t,r,n){this.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_ProxyHostName],e),this.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_ProxyUserName],r),this.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_ProxyPassword],n)},t.prototype.getProperty=function(e,t){return this.privSpeechProperties.getProperty(e,t)},t.prototype.setProperty=function(e,t){this.privSpeechProperties.setProperty(e,t)},Object.defineProperty(t.prototype,"properties",{get:function(){return this.privSpeechProperties},enumerable:!0,configurable:!0}),t.prototype.close=function(){},t.prototype.setServiceProperty=function(e,t,r){var n=JSON.parse(this.privSpeechProperties.getProperty(o.ServicePropertiesPropertyName,"{}"));n[e]=t,this.privSpeechProperties.setProperty(o.ServicePropertiesPropertyName,JSON.stringify(n))},t.prototype.setProfanity=function(e){this.privSpeechProperties.setProperty(a.PropertyId.SpeechServiceResponse_ProfanityOption,a.ProfanityOption[e])},t.prototype.enableAudioLogging=function(){this.privSpeechProperties.setProperty(a.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")},t.prototype.requestWordLevelTimestamps=function(){this.privSpeechProperties.setProperty(a.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")},t.prototype.enableDictation=function(){this.privSpeechProperties.setProperty(o.ForceDictationPropertyName,"true")},Object.defineProperty(t.prototype,"speechSynthesisLanguage",{get:function(){return this.privSpeechProperties.getProperty(a.PropertyId.SpeechServiceConnection_SynthLanguage)},set:function(e){this.privSpeechProperties.setProperty(a.PropertyId.SpeechServiceConnection_SynthLanguage,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechSynthesisVoiceName",{get:function(){return this.privSpeechProperties.getProperty(a.PropertyId.SpeechServiceConnection_SynthVoice)},set:function(e){this.privSpeechProperties.setProperty(a.PropertyId.SpeechServiceConnection_SynthVoice,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechSynthesisOutputFormat",{get:function(){return a.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(a.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]},set:function(e){this.privSpeechProperties.setProperty(a.PropertyId.SpeechServiceConnection_SynthOutputFormat,a.SpeechSynthesisOutputFormat[e])},enumerable:!0,configurable:!0}),t}(c);t.SpeechTranslationConfigImpl=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(6),o=r(10),s=r(2),a=function(){function e(e,t,r){this.audioConfig=void 0!==e?e:s.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=r,this.implCommonRecognizerSetup()}return e.prototype.close=function(){o.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)},Object.defineProperty(e.prototype,"internalData",{get:function(){return this.privReco},enumerable:!0,configurable:!0}),e.prototype.dispose=function(e){this.privDisposed||(e&&this.privReco&&(this.privReco.audioSource.turnOff(),this.privReco.dispose()),this.privDisposed=!0)},Object.defineProperty(e,"telemetryEnabled",{get:function(){return n.ServiceRecognizerBase.telemetryDataEnabled},enumerable:!0,configurable:!0}),e.enableTelemetry=function(e){n.ServiceRecognizerBase.telemetryDataEnabled=e},e.prototype.implCommonRecognizerSetup=function(){var e=this,t="undefined"!=typeof window?"Browser":"Node",r="unknown",o="unknown";"undefined"!=typeof navigator&&(t=t+"/"+navigator.platform,r=navigator.userAgent,o=navigator.appVersion);var a=this.createRecognizerConfig(new n.SpeechServiceConfig(new n.Context(new n.OS(t,r,o)))),c=this.privProperties.getProperty(s.PropertyId.SpeechServiceConnection_Key,void 0),p=c&&""!==c?new n.CognitiveSubscriptionKeyAuthentication(c):new n.CognitiveTokenAuthentication((function(t){var r=e.privProperties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token,void 0);return i.PromiseHelper.fromResult(r)}),(function(t){var r=e.privProperties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token,void 0);return i.PromiseHelper.fromResult(r)}));this.privReco=this.createServiceRecognizer(p,this.privConnectionFactory,this.audioConfig,a)},e.prototype.recognizeOnceAsyncImpl=function(e,t,r){var n=this;try{o.Contracts.throwIfDisposed(this.privDisposed),this.implRecognizerStop().on((function(i){try{n.privReco.recognize(e,(function(e){n.implRecognizerStop().on((function(r){t&&t(e)}),(function(e){r&&r(e)}))}),(function(e){n.implRecognizerStop(),r&&r(e)})).on((function(e){}),(function(e){r&&r(e)}))}catch(e){if(r)if(e instanceof Error){var o=e;r(o.name+": "+o.message)}else r(e);n.dispose(!0)}}),(function(e){r&&r(e)}))}catch(e){if(r)if(e instanceof Error){var i=e;r(i.name+": "+i.message)}else r(e);this.dispose(!0)}},e.prototype.startContinuousRecognitionAsyncImpl=function(e,t,r){var n=this;try{o.Contracts.throwIfDisposed(this.privDisposed),this.implRecognizerStop().on((function(i){n.privReco.recognize(e,void 0,void 0).on((function(e){if(t){try{t()}catch(e){r&&r(e)}t=void 0}}),(function(e){r&&r(e),n.dispose(!0)}))}),(function(e){r&&r(e),n.dispose(!0)}))}catch(e){if(r)if(e instanceof Error){var i=e;r(i.name+": "+i.message)}else r(e);this.dispose(!0)}},e.prototype.stopContinuousRecognitionAsyncImpl=function(e,t){try{o.Contracts.throwIfDisposed(this.privDisposed),this.implRecognizerStop().on((function(r){if(e)try{e()}catch(e){t&&t(e)}}),(function(e){t&&t(e)}))}catch(e){if(t)if(e instanceof Error){var r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}},e.prototype.implRecognizerStop=function(){return this.privReco?this.privReco.stopRecognizing():i.PromiseHelper.fromResult(!0)},e}();t.Recognizer=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),s=r(158),a=r(10),c=r(2),p=function(e){function t(t,r){var n=this,i=t;return a.Contracts.throwIfNull(i,"speechConfig"),a.Contracts.throwIfNullOrWhitespace(i.properties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage),c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage]),(n=e.call(this,r,i.properties,new s.SpeechConnectionFactory)||this).privDisposedSpeechRecognizer=!1,n}return i(t,e),t.FromConfig=function(e,r,n){var i=e;return r.properties.mergeTo(i.properties),new t(e,n)},Object.defineProperty(t.prototype,"endpointId",{get:function(){return a.Contracts.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(c.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(c.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){a.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{get:function(){return a.Contracts.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputFormat",{get:function(){return a.Contracts.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(o.OutputFormatPropertyName,c.OutputFormat[c.OutputFormat.Simple])===c.OutputFormat[c.OutputFormat.Simple]?c.OutputFormat.Simple:c.OutputFormat.Detailed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),t.prototype.recognizeOnceAsync=function(e,t){this.recognizeOnceAsyncImpl(o.RecognitionMode.Interactive,e,t)},t.prototype.startContinuousRecognitionAsync=function(e,t){this.startContinuousRecognitionAsyncImpl(o.RecognitionMode.Conversation,e,t)},t.prototype.stopContinuousRecognitionAsync=function(e,t){this.stopContinuousRecognitionAsyncImpl(e,t)},t.prototype.startKeywordRecognitionAsync=function(e,t,r){a.Contracts.throwIfNull(e,"model"),r&&r("Not yet implemented.")},t.prototype.stopKeywordRecognitionAsync=function(e,t){e&&e()},t.prototype.close=function(){a.Contracts.throwIfDisposed(this.privDisposedSpeechRecognizer),this.dispose(!0)},t.prototype.dispose=function(t){this.privDisposedSpeechRecognizer||(t&&(this.implRecognizerStop(),this.privDisposedSpeechRecognizer=!0),e.prototype.dispose.call(this,t))},t.prototype.createRecognizerConfig=function(e){return new o.RecognizerConfig(e,this.properties)},t.prototype.createServiceRecognizer=function(e,t,r,n){var i=r;return new o.SpeechServiceRecognizer(e,t,i,n,this)},t}(c.Recognizer);t.SpeechRecognizer=p},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),s=r(10),a=r(2),c=function(e){function t(t,r){var n=this;s.Contracts.throwIfNullOrUndefined(t,"speechConfig");var i=t;return s.Contracts.throwIfNullOrUndefined(i,"speechConfig"),(n=e.call(this,r,i.properties,new o.IntentConnectionFactory)||this).privAddedIntents=[],n.privAddedLmIntents={},n.privDisposedIntentRecognizer=!1,n.privProperties=i.properties,s.Contracts.throwIfNullOrWhitespace(n.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage),a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage]),n}return i(t,e),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{get:function(){return s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),t.prototype.recognizeOnceAsync=function(e,t){if(s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),0!==Object.keys(this.privAddedLmIntents).length||void 0!==this.privUmbrellaIntent){var r=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",r.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(r.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}this.recognizeOnceAsyncImpl(o.RecognitionMode.Interactive,e,t)},t.prototype.startContinuousRecognitionAsync=function(e,t){if(0!==Object.keys(this.privAddedLmIntents).length){var r=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",r.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(r.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}this.startContinuousRecognitionAsyncImpl(o.RecognitionMode.Conversation,e,t)},t.prototype.stopContinuousRecognitionAsync=function(e,t){this.stopContinuousRecognitionAsyncImpl(e,t)},t.prototype.startKeywordRecognitionAsync=function(e,t,r){s.Contracts.throwIfNull(e,"model"),r&&r("Not yet implemented.")},t.prototype.stopKeywordRecognitionAsync=function(e,t){e&&e()},t.prototype.addIntent=function(e,t){s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),s.Contracts.throwIfNullOrWhitespace(t,"intentId"),s.Contracts.throwIfNullOrWhitespace(e,"simplePhrase"),this.privAddedIntents.push([t,e])},t.prototype.addIntentWithLanguageModel=function(e,t,r){s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),s.Contracts.throwIfNullOrWhitespace(e,"intentId"),s.Contracts.throwIfNull(t,"model");var n=t;s.Contracts.throwIfNullOrWhitespace(n.appId,"model.appId"),this.privAddedLmIntents[e]=new o.AddedLmIntent(n,r)},t.prototype.addAllIntents=function(e,t){s.Contracts.throwIfNull(e,"model");var r=e;s.Contracts.throwIfNullOrWhitespace(r.appId,"model.appId"),this.privUmbrellaIntent=new o.AddedLmIntent(r,t)},t.prototype.close=function(){s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.dispose(!0)},t.prototype.createRecognizerConfig=function(e){return new o.RecognizerConfig(e,this.properties)},t.prototype.createServiceRecognizer=function(e,t,r,n){var i=r;return new o.IntentServiceRecognizer(e,t,i,n,this)},t.prototype.dispose=function(t){this.privDisposedIntentRecognizer||t&&(this.privDisposedIntentRecognizer=!0,e.prototype.dispose.call(this,t))},t.prototype.buildSpeechContext=function(){var e,t,r,n=[];void 0!==this.privUmbrellaIntent&&(e=this.privUmbrellaIntent.modelImpl.appId,t=this.privUmbrellaIntent.modelImpl.region,r=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(var i=0,o=Object.keys(this.privAddedLmIntents);i<o.length;i++){var s=o[i],c=this.privAddedLmIntents[s];if(void 0===e)e=c.modelImpl.appId;else if(e!==c.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(void 0===t)t=c.modelImpl.region;else if(t!==c.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(void 0===r)r=c.modelImpl.subscriptionKey;else if(r!==c.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");var p="luis/"+e+"-PRODUCTION#"+s;n.push(p)}return{Intent:{id:e,key:void 0===r?this.privProperties.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_Key]):r,provider:"LUIS"},ReferenceGrammars:void 0===this.privUmbrellaIntent?n:["luis/"+e+"-PRODUCTION"]}},t}(a.Recognizer);t.IntentRecognizer=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.TextIndependentIdentification=0]="TextIndependentIdentification",e[e.TextDependentVerification=1]="TextDependentVerification",e[e.TextIndependentVerification=2]="TextIndependentVerification"}(t.VoiceProfileType||(t.VoiceProfileType={}))},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),s=r(10),a=r(2),c=function(e){function t(t,r){var n=this,i=t;return s.Contracts.throwIfNull(i,"speechConfig"),(n=e.call(this,r,i.properties,new o.TranslationConnectionFactory)||this).privDisposedTranslationRecognizer=!1,n.privProperties=i.properties.clone(),void 0!==n.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)&&s.Contracts.throwIfNullOrWhitespace(n.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice),a.PropertyId[a.PropertyId.SpeechServiceConnection_TranslationVoice]),s.Contracts.throwIfNullOrWhitespace(n.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages),a.PropertyId[a.PropertyId.SpeechServiceConnection_TranslationToLanguages]),s.Contracts.throwIfNullOrWhitespace(n.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage),a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage]),n}return i(t,e),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{get:function(){return s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetLanguages",{get:function(){return s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"voiceName",{get:function(){return s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),t.prototype.recognizeOnceAsync=function(e,t){s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.recognizeOnceAsyncImpl(o.RecognitionMode.Conversation,e,t)},t.prototype.startContinuousRecognitionAsync=function(e,t){this.startContinuousRecognitionAsyncImpl(o.RecognitionMode.Conversation,e,t)},t.prototype.stopContinuousRecognitionAsync=function(e,t){this.stopContinuousRecognitionAsyncImpl(e,t)},t.prototype.close=function(){s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.dispose(!0)},t.prototype.dispose=function(t){this.privDisposedTranslationRecognizer||t&&(this.implRecognizerStop(),this.privDisposedTranslationRecognizer=!0,e.prototype.dispose.call(this,t))},t.prototype.createRecognizerConfig=function(e){return new o.RecognizerConfig(e,this.properties)},t.prototype.createServiceRecognizer=function(e,t,r,n){var i=r;return new o.TranslationServiceRecognizer(e,t,i,n,this)},t}(a.Recognizer);t.TranslationRecognizer=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=function(){function e(){this.privMap=new n.PropertyCollection}return e.prototype.get=function(e,t){return this.privMap.getProperty(e,t)},e.prototype.set=function(e,t){this.privMap.setProperty(e,t)},e}();t.Translations=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(t.NoMatchReason||(t.NoMatchReason={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(2),o=function(){function e(e){this.privReason=e}return e.fromResult=function(t){var r=n.SimpleSpeechPhrase.fromJSON(t.json),o=i.NoMatchReason.NotRecognized;switch(r.RecognitionStatus){case n.RecognitionStatus.BabbleTimeout:o=i.NoMatchReason.InitialBabbleTimeout;break;case n.RecognitionStatus.InitialSilenceTimeout:o=i.NoMatchReason.InitialSilenceTimeout;break;default:o=i.NoMatchReason.NotRecognized}return new e(o)},Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),e}();t.NoMatchDetails=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,n,i){this.privCancelReason=t,this.privErrorDetails=r,this.privResult=i,this.privSessionId=e,this.privErrorCode=n}return Object.defineProperty(e.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privCancelReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorCode",{get:function(){return this.privErrorCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),e}();t.TranslationRecognitionCanceledEventArgs=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o,s){var a=e.call(this,i,o,s)||this;return a.privReason=t,a.privErrorDetails=r,a.privErrorCode=n,a}return i(t,e),Object.defineProperty(t.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorCode",{get:function(){return this.privErrorCode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),t}(r(2).IntentRecognitionEventArgs);t.IntentRecognitionCanceledEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),s=r(159),a=r(2),c=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return i(t,e),t.fromResult=function(e){var r=a.CancellationReason.Error,n=a.CancellationErrorCode.NoError;if(e instanceof a.RecognitionResult&&e.json){var i=o.SimpleSpeechPhrase.fromJSON(e.json);r=o.EnumTranslation.implTranslateCancelResult(i.RecognitionStatus)}return e.properties&&(n=a.CancellationErrorCode[e.properties.getProperty(o.CancellationErrorCodePropertyName,a.CancellationErrorCode[a.CancellationErrorCode.NoError])]),new t(r,e.errorDetails,n)},t}(s.CancellationDetailsBase);t.CancellationDetails=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError"}(t.CancellationErrorCode||(t.CancellationErrorCode={}))},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(r(2).SessionEventArgs);t.ConnectionEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var i=e.call(this,n)||this;return i.privJsonResult=t,i.privEventName=r,i}return i(t,e),Object.defineProperty(t.prototype,"jsonString",{get:function(){return this.privJsonResult},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventName",{get:function(){return this.privEventName},enumerable:!0,configurable:!0}),t}(r(2).SessionEventArgs);t.ServiceEventArgs=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(160),o=r(10),s=r(2),a=function(){function e(){}return e.fromRecognizer=function(t){var r=t.internalData,n=new e;return n.privInternalData=r,n.setupEvents(),n},e.fromSynthesizer=function(t){var r=t.internalData,n=new e;return n.privInternalData=r,n.setupEvents(),n},e.prototype.openConnection=function(){this.privInternalData.connect()},e.prototype.closeConnection=function(){if(this.privInternalData instanceof n.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");this.privInternalData.disconnect()},e.prototype.setMessageProperty=function(e,t,r){if(o.Contracts.throwIfNullOrWhitespace(t,"propertyName"),this.privInternalData instanceof n.ServiceRecognizerBase){if("speech.context"!==e.toLowerCase())throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(t,r)}else if(this.privInternalData instanceof n.SynthesisAdapterBase){if("synthesis.context"!==e.toLowerCase())throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(t,r)}},e.prototype.sendMessageAsync=function(e,t,r,n){this.privInternalData.sendNetworkMessage(e,t,r,n)},e.prototype.close=function(){},e.prototype.setupEvents=function(){var e=this;this.privEventListener=this.privInternalData.connectionEvents.attach((function(t){"ConnectionEstablishedEvent"===t.name?e.connected&&e.connected(new s.ConnectionEventArgs(t.connectionId)):"ConnectionClosedEvent"===t.name?e.disconnected&&e.disconnected(new s.ConnectionEventArgs(t.connectionId)):"ConnectionMessageSentEvent"===t.name?e.messageSent&&e.messageSent(new s.ConnectionMessageEventArgs(new i.ConnectionMessageImpl(t.message))):"ConnectionMessageReceivedEvent"===t.name&&e.messageReceived&&e.messageReceived(new s.ConnectionMessageEventArgs(new i.ConnectionMessageImpl(t.message)))})),this.privServiceEventListener=this.privInternalData.serviceEvents.attach((function(t){e.receivedServiceMessage&&e.receivedServiceMessage(new s.ServiceEventArgs(t.jsonString,t.name))}))},e}();t.Connection=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privGrammerBuilder=e.dynamicGrammar}return e.fromRecognizer=function(t){return new e(t.internalData)},e.prototype.addPhrase=function(e){this.privGrammerBuilder.addPhrase(e)},e.prototype.addPhrases=function(e){this.privGrammerBuilder.addPhrase(e)},e.prototype.clear=function(){this.privGrammerBuilder.clearPhrases()},e}();t.PhraseListGrammar=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(10),s=r(106),a=r(2),c=function(e){function t(){return e.call(this)||this}return i(t,e),t.fromSubscription=function(e,t,r){o.Contracts.throwIfNullOrWhitespace(e,"subscription"),o.Contracts.throwIfNullOrWhitespace(t,"region");var n=new s.DialogServiceConfigImpl;return n.setProperty(a.PropertyId.Conversation_DialogType,"bot_framework"),n.setProperty(a.PropertyId.SpeechServiceConnection_Key,e),n.setProperty(a.PropertyId.SpeechServiceConnection_Region,t),r&&n.setProperty(a.PropertyId.Conversation_ApplicationId,r),n},t.fromAuthorizationToken=function(e,t){o.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),o.Contracts.throwIfNullOrWhitespace(t,"region");var r=new s.DialogServiceConfigImpl;return r.setProperty(a.PropertyId.Conversation_DialogType,"bot_framework"),r.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,e),r.setProperty(a.PropertyId.SpeechServiceConnection_Region,t),r},t}(s.DialogServiceConfigImpl);t.BotFrameworkConfig=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(10),s=r(106),a=r(2),c=function(e){function t(){return e.call(this)||this}return i(t,e),t.fromSubscription=function(e,t,r){o.Contracts.throwIfNullOrWhitespace(e,"applicationId"),o.Contracts.throwIfNullOrWhitespace(t,"subscription"),o.Contracts.throwIfNullOrWhitespace(r,"region");var n=new s.DialogServiceConfigImpl;return n.setProperty(a.PropertyId.Conversation_DialogType,"custom_commands"),n.setProperty(a.PropertyId.Conversation_ApplicationId,e),n.setProperty(a.PropertyId.SpeechServiceConnection_Key,t),n.setProperty(a.PropertyId.SpeechServiceConnection_Region,r),n},t.fromAuthorizationToken=function(e,t,r){o.Contracts.throwIfNullOrWhitespace(e,"applicationId"),o.Contracts.throwIfNullOrWhitespace(t,"authorizationToken"),o.Contracts.throwIfNullOrWhitespace(r,"region");var n=new s.DialogServiceConfigImpl;return n.setProperty(a.PropertyId.Conversation_DialogType,"custom_commands"),n.setProperty(a.PropertyId.Conversation_ApplicationId,e),n.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,t),n.setProperty(a.PropertyId.SpeechServiceConnection_Region,r),n},Object.defineProperty(t.prototype,"applicationId",{get:function(){return this.getProperty(a.PropertyId.Conversation_ApplicationId)},set:function(e){o.Contracts.throwIfNullOrWhitespace(e,"value"),this.setProperty(a.PropertyId.Conversation_ApplicationId,e)},enumerable:!0,configurable:!0}),t}(s.DialogServiceConfigImpl);t.CustomCommandsConfig=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(299),s=r(5),a=r(10),c=r(2),p=r(105),u=r(104),h=function(e){function t(t,r){var n=this,i=t;a.Contracts.throwIfNull(t,"dialogConfig"),(n=e.call(this,r,i.properties,new o.DialogConnectionFactory)||this).isTurnComplete=!0,n.privIsDisposed=!1,n.privProperties=i.properties.clone();var s=n.buildAgentConfig();return n.privReco.agentConfig.set(s),n}return i(t,e),t.prototype.connect=function(){this.privReco.connect()},t.prototype.disconnect=function(){this.privReco.disconnect()},Object.defineProperty(t.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(p.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){a.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(p.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechActivityTemplate",{get:function(){return this.properties.getProperty(p.PropertyId.Conversation_Speech_Activity_Template)},set:function(e){this.properties.setProperty(p.PropertyId.Conversation_Speech_Activity_Template,e)},enumerable:!0,configurable:!0}),t.prototype.listenOnceAsync=function(e,t){var r=this;if(this.isTurnComplete)try{a.Contracts.throwIfDisposed(this.privIsDisposed),this.connect(),this.implRecognizerStop(),this.isTurnComplete=!1,this.privReco.recognize(s.RecognitionMode.Conversation,(function(t){r.implRecognizerStop(),r.isTurnComplete=!0,e&&e(t)}),(function(e){r.implRecognizerStop(),r.isTurnComplete=!0,t&&t(e)})).on((function(e){}),(function(e){t&&t(e)}))}catch(e){if(t)if(e instanceof Error){var n=e;t(n.name+": "+n.message)}else t(e);this.dispose(!0)}},t.prototype.sendActivityAsync=function(e){this.privReco.sendMessage(e)},t.prototype.close=function(){a.Contracts.throwIfDisposed(this.privIsDisposed),this.dispose(!0)},t.prototype.dispose=function(t){this.privIsDisposed||t&&(this.implRecognizerStop(),this.privIsDisposed=!0,e.prototype.dispose.call(this,t))},t.prototype.createRecognizerConfig=function(e){return new s.RecognizerConfig(e,this.privProperties)},t.prototype.createServiceRecognizer=function(e,t,r,n){var i=r;return new s.DialogServiceAdapter(e,t,i,n,this)},t.prototype.buildAgentConfig=function(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(p.PropertyId.Conversation_ApplicationId),conversationId:this.properties.getProperty(p.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(p.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:u.SpeechSynthesisOutputFormat[this.properties.getProperty(p.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]},version:.2}},t}(c.Recognizer);t.DialogServiceConnector=h},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(28),s=r(2),a=r(64),c=r(5),p=r(65),u="convai.speech",h={authHeader:"X-DLS-Secret",resourcePath:"",version:"v3"},v={authHeader:"X-CommandsAppId",resourcePath:"commands",version:"v1"};function l(e){switch(e){case"custom_commands":return v;case"bot_framework":return h}throw new Error("Invalid dialog type '"+e+"'")}var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e,r,n){var i=e.parameters.getProperty(s.PropertyId.Conversation_ApplicationId,""),a=e.parameters.getProperty(s.PropertyId.Conversation_DialogType),h=e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_Region),v=e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),d={};d[p.QueryParameterNames.LanguageParamName]=v,d[p.QueryParameterNames.FormatParamName]=e.parameters.getProperty(s.PropertyId.SpeechServiceResponse_OutputFormatOption,s.OutputFormat[s.OutputFormat.Simple]).toLowerCase();var f=l(a),g=f.resourcePath,y=f.version,m=f.authHeader,S={};null!=r.token&&""!==r.token&&(S[r.headerName]=r.token),S[p.QueryParameterNames.ConnectionIdHeader]=n,""!==i&&(S[m]=i);var C=e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_Endpoint,"");if(""===C){var b=h&&h.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com";C=""===i?"wss://"+h+"."+u+b+"/api/"+y:"wss://"+h+"."+u+b+"/"+g+"/api/"+y}return t.setCommonUrlParams(e,d,C),new o.WebsocketConnection(C,d,S,new c.WebsocketMessageFormatter,o.ProxyInfo.fromRecognizerConfig(e),n)},t}return i(t,e),t}(a.ConnectionFactoryBase);t.DialogConnectionFactory=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.privActivity=e,this.privAudioStream=t}return Object.defineProperty(e.prototype,"activity",{get:function(){return this.privActivity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioStream",{get:function(){return this.privAudioStream},enumerable:!0,configurable:!0}),e}();t.ActivityReceivedEventArgs=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UriQueryParameter=0]="UriQueryParameter"}(t.ServicePropertyChannel||(t.ServicePropertyChannel={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"}(t.ProfanityOption||(t.ProfanityOption={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(29),i=function(){function e(e){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,this.init(e)}return e.prototype.playAudioSample=function(e){this.ensureInitializedContext();var t=this.formatAudioData(e),r=new Float32Array(this.samples.length+t.length);r.set(this.samples,0),r.set(t,this.samples.length),this.samples=r},e.prototype.stopAudio=function(){null!==this.audioContext&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close(),this.audioContext=null)},e.prototype.init=function(e){this.audioFormat=e,this.samples=new Float32Array},e.prototype.ensureInitializedContext=function(){var e=this;if(null===this.audioContext){this.createAudioContext();this.autoUpdateBufferTimer=setInterval((function(){e.updateAudioBuffer()}),200)}},e.prototype.createAudioContext=function(){this.audioContext=new AudioContext,this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime},e.prototype.formatAudioData=function(e){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(e),128);case 16:return this.formatArrayBuffer(new Int16Array(e),32768);case 32:return this.formatArrayBuffer(new Int32Array(e),2147483648);default:throw new n.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}},e.prototype.formatArrayBuffer=function(e,t){for(var r=new Float32Array(e.length),n=0;n<e.length;n++)r[n]=e[n]/t;return r},e.prototype.updateAudioBuffer=function(){if(0!==this.samples.length){for(var e=this.audioFormat.channels,t=this.audioContext.createBufferSource(),r=this.samples.length/e,n=this.audioContext.createBuffer(e,r,this.audioFormat.samplesPerSec),i=0;i<e;i++)for(var o=i,s=n.getChannelData(i),a=0;a<this.samples.length;a++,o+=e)s[a]=this.samples[o];this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),t.buffer=n,t.connect(this.gainNode),t.start(this.startTime),this.startTime+=n.duration,this.samples=new Float32Array}},e}();t.BaseAudioPlayer=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privConnectionMessage=e}return Object.defineProperty(e.prototype,"message",{get:function(){return this.privConnectionMessage},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return"Message: "+this.privConnectionMessage.toString()},e}();t.ConnectionMessageEventArgs=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.privId=e,this.privProfileType=t}return Object.defineProperty(e.prototype,"profileId",{get:function(){return this.privId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profileType",{get:function(){return this.privProfileType},enumerable:!0,configurable:!0}),e}();t.VoiceProfile=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),s=r(10),a=r(2),c=function(){function e(e,t,r){this.privReason=e,this.privProperties=new a.PropertyCollection,this.privReason!==a.ResultReason.Canceled?(this.privDetails=JSON.parse(t),s.Contracts.throwIfNullOrUndefined(t,"JSON"),"enrolling"===this.privDetails.enrollmentStatus.toLowerCase()&&(this.privReason=a.ResultReason.EnrollingVoiceProfile)):(this.privErrorDetails=r,this.privProperties.setProperty(o.CancellationErrorCodePropertyName,a.CancellationErrorCode[a.CancellationErrorCode.ServiceError]))}return Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enrollmentsCount",{get:function(){return this.privDetails.enrollmentsCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enrollmentsLength",{get:function(){return this.privDetails.enrollmentsLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),e}();t.VoiceProfileEnrollmentResult=c;var p=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return i(t,e),t.fromResult=function(e){var r=a.CancellationReason.Error,n=a.CancellationErrorCode.NoError;return e.properties&&(n=a.CancellationErrorCode[e.properties.getProperty(o.CancellationErrorCodePropertyName,a.CancellationErrorCode[a.CancellationErrorCode.NoError])]),new t(r,e.errorDetails,n)},t}(a.CancellationDetailsBase);t.VoiceProfileEnrollmentCancellationDetails=p},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),s=r(10),a=r(2),c=function(){function e(e,t){this.privReason=e,this.privProperties=new a.PropertyCollection,e===a.ResultReason.Canceled&&(s.Contracts.throwIfNullOrUndefined(t,"statusText"),this.privErrorDetails=t,this.privProperties.setProperty(o.CancellationErrorCodePropertyName,a.CancellationErrorCode[a.CancellationErrorCode.ServiceError]))}return Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),e}();t.VoiceProfileResult=c;var p=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return i(t,e),t.fromResult=function(e){var r=a.CancellationReason.Error,n=a.CancellationErrorCode.NoError;return e.properties&&(n=a.CancellationErrorCode[e.properties.getProperty(o.CancellationErrorCodePropertyName,a.CancellationErrorCode[a.CancellationErrorCode.NoError])]),new t(r,e.errorDetails,n)},t}(a.CancellationDetailsBase);t.VoiceProfileCancellationDetails=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(10),o=r(2),s=function(){function e(e){var t=e;i.Contracts.throwIfNull(t,"speechConfig"),this.privProperties=t.properties.clone(),this.implClientSetup()}return Object.defineProperty(e.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){i.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),e.prototype.createProfileAsync=function(e,t,r,n){this.privAdapter.createProfile(e,t).on((function(t){if(r){var n=t.json(),i=new o.VoiceProfile(n.profileId,e);r(i)}}),(function(e){n&&n(e)}))},e.prototype.enrollProfileAsync=function(e,t,r,n){var s=t;i.Contracts.throwIfNullOrUndefined(s,"audioConfig"),this.privAdapter.createEnrollment(e,s).on((function(e){r&&r(new o.VoiceProfileEnrollmentResult(e.ok?o.ResultReason.EnrolledVoiceProfile:o.ResultReason.Canceled,e.data,e.statusText))}),(function(e){n&&n(e)}))},e.prototype.deleteProfileAsync=function(e,t,r){var n=this;this.privAdapter.deleteProfile(e).on((function(e){n.handleResultCallbacks(e,o.ResultReason.DeletedVoiceProfile,t)}),(function(e){r&&r(e)}))},e.prototype.resetProfileAsync=function(e,t,r){var n=this;this.privAdapter.resetProfile(e).on((function(e){n.handleResultCallbacks(e,o.ResultReason.ResetVoiceProfile,t)}),(function(e){r&&r(e)}))},e.prototype.close=function(){},e.prototype.implClientSetup=function(){var e="undefined"!=typeof window?"Browser":"Node",t="unknown",r="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);var i=new n.SpeakerRecognitionConfig(new n.Context(new n.OS(e,t,r)),this.privProperties);this.privAdapter=new n.SpeakerIdMessageAdapter(i)},e.prototype.handleResultCallbacks=function(e,t,r){r&&r(new o.VoiceProfileResult(e.ok?t:o.ResultReason.Canceled,e.statusText))},e}();t.VoiceProfileClient=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(10),o=r(2),s=function(){function e(e,t){var r=e;i.Contracts.throwIfNull(r,"speechConfig"),this.privAudioConfigImpl=t,i.Contracts.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privProperties=r.properties.clone(),this.implSRSetup()}return Object.defineProperty(e.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){i.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),e.prototype.recognizeOnceAsync=function(e,t,r){var n=this;if(e instanceof o.SpeakerIdentificationModel)this.privAdapter.identifySpeaker(e,this.privAudioConfigImpl).continueWith((function(e){n.handleResultCallbacks(e,o.SpeakerRecognitionResultType.Identify,void 0,t,r)}));else{if(!(e instanceof o.SpeakerVerificationModel))throw new Error("SpeakerRecognizer.recognizeOnce: Unexpected model type");this.privAdapter.verifySpeaker(e,this.privAudioConfigImpl).continueWith((function(i){n.handleResultCallbacks(i,o.SpeakerRecognitionResultType.Verify,e.voiceProfile.profileId,t,r)}))}},e.prototype.close=function(){},e.prototype.implSRSetup=function(){var e="undefined"!=typeof window?"Browser":"Node",t="unknown",r="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);var i=new n.SpeakerRecognitionConfig(new n.Context(new n.OS(e,t,r)),this.privProperties);this.privAdapter=new n.SpeakerIdMessageAdapter(i)},e.prototype.handleResultCallbacks=function(e,t,r,n,i){try{e.isError?i&&i(e.error):e.isCompleted&&n&&n(new o.SpeakerRecognitionResult(t,e.result.data,r,e.result.ok?o.ResultReason.RecognizedSpeaker:o.ResultReason.Canceled))}catch(e){i&&i(e)}},e}();t.SpeakerRecognizer=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(2),o=function(){function e(e){var t=this;if(this.privVoiceProfiles=[],n.Contracts.throwIfNullOrUndefined(e,"VoiceProfiles"),0===e.length)throw new Error("Empty Voice Profiles array");e.forEach((function(e){if(e.profileType!==i.VoiceProfileType.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+e.profileId);t.privVoiceProfiles.push(e)}))}return e.fromProfiles=function(t){return new e(t)},Object.defineProperty(e.prototype,"voiceProfileIds",{get:function(){return this.privVoiceProfiles.map((function(e){return e.profileId})).join(",")},enumerable:!0,configurable:!0}),e}();t.SpeakerIdentificationModel=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(2),o=function(){function e(e){if(n.Contracts.throwIfNullOrUndefined(e,"VoiceProfile"),e.profileType===i.VoiceProfileType.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=e}return e.fromProfile=function(t){return new e(t)},Object.defineProperty(e.prototype,"voiceProfile",{get:function(){return this.privVoiceProfile},enumerable:!0,configurable:!0}),e}();t.SpeakerVerificationModel=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(10),o=r(2),s=function(){function e(){this.privProperties=new o.PropertyCollection}return e.fromOpenRange=function(){var t=new e;return t.properties.setProperty(o.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,n.AutoDetectSourceLanguagesOpenRangeOptionName),t},e.fromLanguages=function(t){i.Contracts.throwIfArrayEmptyOrWhitespace(t,"languages");var r=new e;return r.properties.setProperty(o.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,t.join()),r},e.fromSourceLanguageConfigs=function(t){if(t.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");var r=new e,n=[];return t.forEach((function(e){if(n.push(e.language),void 0!==e.endpointId&&""!==e.endpointId){var t=e.language+o.PropertyId.SpeechServiceConnection_EndpointId.toString();r.properties.setProperty(t,e.endpointId)}})),r.properties.setProperty(o.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,n.join()),r},Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),e}();t.AutoDetectSourceLanguageConfig=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=function(){function e(e,t){n.Contracts.throwIfNullOrUndefined(e,"language"),n.Contracts.throwIfNullOrUndefined(t,"languageDetectionConfidence"),this.privLanguage=e,this.privLanguageDetectionConfidence=t}return e.fromResult=function(t){return new e(t.language,t.languageDetectionConfidence)},Object.defineProperty(e.prototype,"language",{get:function(){return this.privLanguage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageDetectionConfidence",{get:function(){return this.privLanguageDetectionConfidence},enumerable:!0,configurable:!0}),e}();t.AutoDetectSourceLanguageResult=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=function(){function e(e,t){n.Contracts.throwIfNullOrUndefined(e,"language"),this.privLanguage=e,this.privEndpointId=t}return e.fromLanguage=function(t,r){return new e(t,r)},Object.defineProperty(e.prototype,"language",{get:function(){return this.privLanguage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endpointId",{get:function(){return this.privEndpointId},enumerable:!0,configurable:!0}),e}();t.SourceLanguageConfig=i},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o,s=r(5),a=r(10),c=r(2);!function(e){e[e.Verify=0]="Verify",e[e.Identify=1]="Identify"}(o=t.SpeakerRecognitionResultType||(t.SpeakerRecognitionResultType={}));var p=function(){function e(e,t,r,n){if(void 0===n&&(n=c.ResultReason.RecognizedSpeaker),this.privProperties=new c.PropertyCollection,this.privReason=n,this.privReason!==c.ResultReason.Canceled)if(e===o.Identify){var i=JSON.parse(t);a.Contracts.throwIfNullOrUndefined(i,"JSON"),this.privProfileId=i.identifiedProfile.profileId,this.privScore=i.identifiedProfile.score}else{i=JSON.parse(t);a.Contracts.throwIfNullOrUndefined(i,"JSON"),this.privScore=i.score,"accept"!==i.recognitionResult.toLowerCase()&&(this.privReason=c.ResultReason.NoMatch),void 0!==r&&""!==r&&(this.privProfileId=r)}else{i=JSON.parse(t);a.Contracts.throwIfNullOrUndefined(i,"JSON"),this.privErrorDetails=i.statusText,this.privProperties.setProperty(s.CancellationErrorCodePropertyName,c.CancellationErrorCode[c.CancellationErrorCode.ServiceError])}this.privProperties.setProperty(c.PropertyId.SpeechServiceResponse_JsonResult,t)}return Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profileId",{get:function(){return this.privProfileId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"score",{get:function(){return this.privScore},enumerable:!0,configurable:!0}),e}();t.SpeakerRecognitionResult=p;var u=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return i(t,e),t.fromResult=function(e){var r=c.CancellationReason.Error,n=c.CancellationErrorCode.NoError;return e.properties&&(n=c.CancellationErrorCode[e.properties.getProperty(s.CancellationErrorCodePropertyName,c.CancellationErrorCode[c.CancellationErrorCode.NoError])]),new t(r,e.errorDetails,n)},t}(c.CancellationDetailsBase);t.SpeakerRecognitionCancellationDetails=u},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){var n=e.call(this,r)||this;return n.privExpirationTime=t,n}return i(t,e),Object.defineProperty(t.prototype,"expirationTime",{get:function(){return this.privExpirationTime},enumerable:!0,configurable:!0}),t}(r(2).SessionEventArgs);t.ConversationExpirationEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var i=e.call(this,n)||this;return i.privReason=t,i.privParticipant=r,i}return i(t,e),Object.defineProperty(t.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"participants",{get:function(){return this.privParticipant},enumerable:!0,configurable:!0}),t}(r(2).SessionEventArgs);t.ConversationParticipantsChangedEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o){var s=e.call(this,i,o)||this;return s.privReason=t,s.privErrorDetails=r,s.privErrorCode=n,s}return i(t,e),Object.defineProperty(t.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorCode",{get:function(){return this.privErrorCode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),t}(r(2).RecognitionEventArgs);t.ConversationTranslationCanceledEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var i=e.call(this,r,n)||this;return i.privResult=t,i}return i(t,e),Object.defineProperty(t.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),t}(r(2).RecognitionEventArgs);t.ConversationTranslationEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o,s,a,c,p,u,h){var v=e.call(this,r,i,o,s,a,c,p,u,h)||this;return v.privId=t,v.privOrigLang=n,v}return i(t,e),Object.defineProperty(t.prototype,"participantId",{get:function(){return this.privId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalLang",{get:function(){return this.privOrigLang},enumerable:!0,configurable:!0}),t}(r(156).TranslationRecognitionResult);t.ConversationTranslationResult=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(5),o=r(10),s=r(2),a=r(162),c=r(161);!function(e){e[e.Inactive=0]="Inactive",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected"}(n=t.SpeechState||(t.SpeechState={}));var p=function(){function e(e){var t=this;this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privSpeechState=n.Inactive,this.privErrors=i.ConversationConnectionConfig.restErrors,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.onSpeechConnected=function(e){t.privSpeechState=n.Connected},this.onSpeechDisconnected=function(e){t.privSpeechState=n.Inactive,t.cancelSpeech()},this.onSpeechRecognized=function(e,r){var n;(null===(n=r.result)||void 0===n?void 0:n.errorDetails)&&(t.cancelSpeech(),t.fireCancelEvent(r.result.errorDetails))},this.onSpeechRecognizing=function(e,t){},this.onSpeechCanceled=function(e,r){if(t.privSpeechState!==n.Inactive)try{t.cancelSpeech()}catch(e){t.privSpeechState=n.Inactive}},this.onSpeechSessionStarted=function(e,r){t.privSpeechState=n.Connected},this.onSpeechSessionStopped=function(e,r){t.privSpeechState=n.Inactive},this.privProperties=new s.PropertyCollection,this.privAudioConfig=e}return Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speechRecognitionLanguage",{get:function(){return this.privSpeechRecognitionLanguage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"participants",{get:function(){var e;return null===(e=this.privConversation)||void 0===e?void 0:e.participants},enumerable:!0,configurable:!0}),e.prototype.joinConversationAsync=function(e,t,r,n,c){var p=this;try{if("string"==typeof e){o.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),o.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),c);var u=r;null!=u&&""!==u||(u=i.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=s.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(s.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(u),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage],u),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.ConversationTranslator_Name],t);var h=this.privProperties.getProperty(s.PropertyId.ConversationTranslator_Host);h&&this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.ConversationTranslator_Host],h);var v=this.privProperties.getProperty(s.PropertyId.SpeechServiceConnection_Host);v&&this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Host],v),this.privConversation=new a.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(e,t,u,(function(e){e||p.handleError(new Error(p.privErrors.permissionDeniedConnect),c),p.privSpeechTranslationConfig.authorizationToken=e,p.privConversation.startConversationAsync((function(){p.handleCallback(n,c)}),(function(e){p.handleError(e,c)}))}),(function(e){p.handleError(e,c)}))}else"object"==typeof e?(o.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),o.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(s.PropertyId.ConversationTranslator_Name,t),this.privConversation=e,this.privConversation.conversationTranslator=this,o.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),o.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=e.config,this.handleCallback(r,n)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),n)}catch(e){this.handleError(e,"string"==typeof r?c:n)}},e.prototype.leaveConversationAsync=function(e,t){var r=this;try{this.cancelSpeech(),this.privConversation.endConversationAsync((function(){r.privConversation.deleteConversationAsync((function(){r.handleCallback(e,t),r.dispose()}),(function(e){r.handleError(e,t)}))}),(function(e){r.handleError(e,t)}))}catch(e){this.handleError(e,t)}},e.prototype.sendTextMessageAsync=function(e,t,r){var n;try{o.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),o.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}",e)),null===(n=this.privConversation)||void 0===n||n.sendTextMessageAsync(e,t,r)}catch(e){this.handleError(e,r)}},e.prototype.startTranscribingAsync=function(e,t){var r=this;try{o.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),o.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),t),void 0===this.privTranslationRecognizer?this.connectTranslatorRecognizer((function(){r.startContinuousRecognition((function(){r.privIsSpeaking=!0,r.handleCallback(e,t)}),(function(e){r.privIsSpeaking=!1,r.cancelSpeech(),r.handleError(e,t)}))}),(function(e){r.handleError(e,t)})):this.startContinuousRecognition((function(){r.privIsSpeaking=!0,r.handleCallback(e,t)}),(function(e){r.privIsSpeaking=!1,r.cancelSpeech(),r.handleError(e,t)}))}catch(e){this.handleError(e,t),this.cancelSpeech()}},e.prototype.stopTranscribingAsync=function(e,t){var r,n=this;try{if(!this.privIsSpeaking)return this.cancelSpeech(),void this.handleCallback(e,t);this.privIsSpeaking=!1,null===(r=this.privTranslationRecognizer)||void 0===r||r.stopContinuousRecognitionAsync((function(){n.handleCallback(e,t)}),(function(e){n.handleError(e,t),n.cancelSpeech()}))}catch(e){this.handleError(e,t),this.cancelSpeech()}},e.prototype.isDisposed=function(){return this.privIsDisposed},e.prototype.dispose=function(e){var t,r;this.isDisposed&&!this.privIsSpeaking||(this.cancelSpeech(),this.privIsDisposed=!0,null===(t=this.privSpeechTranslationConfig)||void 0===t||t.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,null===(r=this.privConversation)||void 0===r||r.dispose(),this.privConversation=void 0)},e.prototype.connectTranslatorRecognizer=function(e,t){try{void 0===this.privAudioConfig&&(this.privAudioConfig=s.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key],"");var r=encodeURIComponent(this.privConversation.room.token),n=this.privSpeechTranslationConfig.getProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Host],i.ConversationConnectionConfig.speechHost),o="wss://"+(n=n.replace("{region}",this.privConversation.room.cognitiveSpeechRegion))+i.ConversationConnectionConfig.speechPath+"?"+i.ConversationConnectionConfig.configParams.token+"="+r;this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Endpoint],o),this.privTranslationRecognizer=new s.TranslationRecognizer(this.privSpeechTranslationConfig,this.privAudioConfig),this.privTranslationRecognizerConnection=s.Connection.fromRecognizer(this.privTranslationRecognizer),this.privTranslationRecognizerConnection.connected=this.onSpeechConnected,this.privTranslationRecognizerConnection.disconnected=this.onSpeechDisconnected,this.privTranslationRecognizer.recognized=this.onSpeechRecognized,this.privTranslationRecognizer.recognizing=this.onSpeechRecognizing,this.privTranslationRecognizer.canceled=this.onSpeechCanceled,this.privTranslationRecognizer.sessionStarted=this.onSpeechSessionStarted,this.privTranslationRecognizer.sessionStopped=this.onSpeechSessionStopped,this.handleCallback(e,t)}catch(e){this.handleError(e,t),this.cancelSpeech()}},e.prototype.startContinuousRecognition=function(e,t){this.privTranslationRecognizer.startContinuousRecognitionAsync(e,t)},e.prototype.fireCancelEvent=function(e){var t,r,n,i,o,a,p;try{if(this.canceled){var u=new c.ConversationTranslationCanceledEventArgs(null!=(r=null===(t=e)||void 0===t?void 0:t.reason)?r:s.CancellationReason.Error,null!=(i=null===(n=e)||void 0===n?void 0:n.errorDetails)?i:e,null!=(a=null===(o=e)||void 0===o?void 0:o.errorCode)?a:s.CancellationErrorCode.RuntimeError,void 0,null===(p=e)||void 0===p?void 0:p.sessionId);this.canceled(this,u)}}catch(e){}},e.prototype.cancelSpeech=function(){var e,t;try{this.privIsSpeaking=!1,null===(e=this.privTranslationRecognizer)||void 0===e||e.stopContinuousRecognitionAsync(),null===(t=this.privTranslationRecognizerConnection)||void 0===t||t.closeConnection(),this.privTranslationRecognizerConnection=void 0,this.privTranslationRecognizer=void 0,this.privSpeechState=n.Inactive}catch(e){}},Object.defineProperty(e.prototype,"canSpeak",{get:function(){return!!this.privConversation.isConnected&&(!this.privIsSpeaking&&this.privSpeechState!==n.Connected&&this.privSpeechState!==n.Connecting&&!this.privConversation.isMutedByHost)},enumerable:!0,configurable:!0}),e.prototype.handleCallback=function(e,t){if(e){try{e()}catch(e){t&&t(e)}e=void 0}},e.prototype.handleError=function(e,t){if(t)if(e instanceof Error){var r=e;t(r.name+": "+r.message)}else t(e)},e}();t.ConversationTranslator=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=function(){function e(e){this.privUserId=e}return Object.defineProperty(e.prototype,"userId",{get:function(){return this.privUserId},enumerable:!0,configurable:!0}),e}();t.User=i;var o=function(){function e(e,t,r,i,o,s,a){this.privId=e,this.privAvatar=t,this.privDisplayName=r,this.privIsHost=i,this.privIsMuted=o,this.privIsUsingTts=s,this.privPreferredLanguage=a,this.privPoperties=new n.PropertyCollection}return Object.defineProperty(e.prototype,"avatar",{get:function(){return this.privAvatar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return this.privDisplayName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredLanguage",{get:function(){return this.privPreferredLanguage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHost",{get:function(){return this.privIsHost},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMuted",{get:function(){return this.privIsMuted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUsingTts",{get:function(){return this.privIsUsingTts},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privPoperties},enumerable:!0,configurable:!0}),e}();t.Participant=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.JoinedConversation=0]="JoinedConversation",e[e.LeftConversation=1]="LeftConversation",e[e.Updated=2]="Updated"}(t.ParticipantChangedReason||(t.ParticipantChangedReason={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(6),o=r(163),s=r(75),a=r(53),c=r(10),p=r(2),u=function(){function e(e,t){var r=e;c.Contracts.throwIfNull(r,"speechConfig"),null!==t&&(this.audioConfig=void 0!==t?t:p.AudioConfig.fromDefaultSpeakerOutput()),this.privProperties=r.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.privConnectionFactory=new n.SpeechSynthesisConnectionFactory,this.synthesisRequestQueue=new i.Queue,this.implCommonSynthesizeSetup()}return Object.defineProperty(e.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(p.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){c.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(p.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoDetectSourceLanguage",{get:function(){return this.properties.getProperty(p.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===n.AutoDetectSourceLanguagesOpenRangeOptionName},enumerable:!0,configurable:!0}),e.FromConfig=function(t,r,n){var i=t;return r.properties.mergeTo(i.properties),new e(t,n)},e.prototype.buildSsml=function(t){var r,n=((r={})["ar-EG"]="Microsoft Server Speech Text to Speech Voice (ar-EG, Hoda)",r["ar-SA"]="Microsoft Server Speech Text to Speech Voice (ar-SA, Naayf)",r["bg-BG"]="Microsoft Server Speech Text to Speech Voice (bg-BG, Ivan)",r["ca-ES"]="Microsoft Server Speech Text to Speech Voice (ca-ES, HerenaRUS)",r["cs-CZ"]="Microsoft Server Speech Text to Speech Voice (cs-CZ, Jakub)",r["da-DK"]="Microsoft Server Speech Text to Speech Voice (da-DK, HelleRUS)",r["de-AT"]="Microsoft Server Speech Text to Speech Voice (de-AT, Michael)",r["de-CH"]="Microsoft Server Speech Text to Speech Voice (de-CH, Karsten)",r["de-DE"]="Microsoft Server Speech Text to Speech Voice (de-DE, HeddaRUS)",r["el-GR"]="Microsoft Server Speech Text to Speech Voice (el-GR, Stefanos)",r["en-AU"]="Microsoft Server Speech Text to Speech Voice (en-AU, HayleyRUS)",r["en-CA"]="Microsoft Server Speech Text to Speech Voice (en-CA, HeatherRUS)",r["en-GB"]="Microsoft Server Speech Text to Speech Voice (en-GB, HazelRUS)",r["en-IE"]="Microsoft Server Speech Text to Speech Voice (en-IE, Sean)",r["en-IN"]="Microsoft Server Speech Text to Speech Voice (en-IN, PriyaRUS)",r["en-US"]="Microsoft Server Speech Text to Speech Voice (en-US, AriaRUS)",r["es-ES"]="Microsoft Server Speech Text to Speech Voice (es-ES, HelenaRUS)",r["es-MX"]="Microsoft Server Speech Text to Speech Voice (es-MX, HildaRUS)",r["fi-FI"]="Microsoft Server Speech Text to Speech Voice (fi-FI, HeidiRUS)",r["fr-CA"]="Microsoft Server Speech Text to Speech Voice (fr-CA, HarmonieRUS)",r["fr-CH"]="Microsoft Server Speech Text to Speech Voice (fr-CH, Guillaume)",r["fr-FR"]="Microsoft Server Speech Text to Speech Voice (fr-FR, HortenseRUS)",r["he-IL"]="Microsoft Server Speech Text to Speech Voice (he-IL, Asaf)",r["hi-IN"]="Microsoft Server Speech Text to Speech Voice (hi-IN, Kalpana)",r["hr-HR"]="Microsoft Server Speech Text to Speech Voice (hr-HR, Matej)",r["hu-HU"]="Microsoft Server Speech Text to Speech Voice (hu-HU, Szabolcs)",r["id-ID"]="Microsoft Server Speech Text to Speech Voice (id-ID, Andika)",r["it-IT"]="Microsoft Server Speech Text to Speech Voice (it-IT, LuciaRUS)",r["ja-JP"]="Microsoft Server Speech Text to Speech Voice (ja-JP, HarukaRUS)",r["ko-KR"]="Microsoft Server Speech Text to Speech Voice (ko-KR, HeamiRUS)",r["ms-MY"]="Microsoft Server Speech Text to Speech Voice (ms-MY, Rizwan)",r["nb-NO"]="Microsoft Server Speech Text to Speech Voice (nb-NO, HuldaRUS)",r["nl-NL"]="Microsoft Server Speech Text to Speech Voice (nl-NL, HannaRUS)",r["pl-PL"]="Microsoft Server Speech Text to Speech Voice (pl-PL, PaulinaRUS)",r["pt-BR"]="Microsoft Server Speech Text to Speech Voice (pt-BR, HeloisaRUS)",r["pt-PT"]="Microsoft Server Speech Text to Speech Voice (pt-PT, HeliaRUS)",r["ro-RO"]="Microsoft Server Speech Text to Speech Voice (ro-RO, Andrei)",r["ru-RU"]="Microsoft Server Speech Text to Speech Voice (ru-RU, EkaterinaRUS)",r["sk-SK"]="Microsoft Server Speech Text to Speech Voice (sk-SK, Filip)",r["sl-SI"]="Microsoft Server Speech Text to Speech Voice (sl-SI, Lado)",r["sv-SE"]="Microsoft Server Speech Text to Speech Voice (sv-SE, HedvigRUS)",r["ta-IN"]="Microsoft Server Speech Text to Speech Voice (ta-IN, Valluvar)",r["te-IN"]="Microsoft Server Speech Text to Speech Voice (te-IN, Chitra)",r["th-TH"]="Microsoft Server Speech Text to Speech Voice (th-TH, Pattara)",r["tr-TR"]="Microsoft Server Speech Text to Speech Voice (tr-TR, SedaRUS)",r["vi-VN"]="Microsoft Server Speech Text to Speech Voice (vi-VN, An)",r["zh-CN"]="Microsoft Server Speech Text to Speech Voice (zh-CN, HuihuiRUS)",r["zh-HK"]="Microsoft Server Speech Text to Speech Voice (zh-HK, TracyRUS)",r["zh-TW"]="Microsoft Server Speech Text to Speech Voice (zh-TW, HanHanRUS)",r),i=this.properties.getProperty(p.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),o=this.properties.getProperty(p.PropertyId.SpeechServiceConnection_SynthVoice,""),s=e.XMLEncode(t);return this.autoDetectSourceLanguage?i="en-US":o=o||n[i],o&&(s="<voice name='"+o+"'>"+s+"</voice>"),s="<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='"+i+"'>"+s+"</speak>"},e.prototype.speakTextAsync=function(e,t,r,n){this.speakImpl(e,!1,t,r,n)},e.prototype.speakSsmlAsync=function(e,t,r,n){this.speakImpl(e,!0,t,r,n)},e.prototype.close=function(){c.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)},Object.defineProperty(e.prototype,"internalData",{get:function(){return this.privAdapter},enumerable:!0,configurable:!0}),e.prototype.dispose=function(e){this.privDisposed||(e&&this.privAdapter&&this.privAdapter.dispose(),this.privDisposed=!0)},e.prototype.createSynthesizerConfig=function(e){return new n.SynthesizerConfig(e,this.privProperties)},e.prototype.createSynthesisAdapter=function(e,t,r,i){return new n.SynthesisAdapterBase(e,t,i,this,this.audioConfig)},e.prototype.implCommonSynthesizeSetup=function(){var e=this,t="undefined"!=typeof window?"Browser":"Node",r="unknown",o="unknown";"undefined"!=typeof navigator&&(t=t+"/"+navigator.platform,r=navigator.userAgent,o=navigator.appVersion);var a=this.createSynthesizerConfig(new n.SpeechServiceConfig(new n.Context(new n.OS(t,r,o)))),c=this.privProperties.getProperty(p.PropertyId.SpeechServiceConnection_Key,void 0),u=c&&""!==c?new n.CognitiveSubscriptionKeyAuthentication(c):new n.CognitiveTokenAuthentication((function(t){var r=e.privProperties.getProperty(p.PropertyId.SpeechServiceAuthorization_Token,void 0);return i.PromiseHelper.fromResult(r)}),(function(t){var r=e.privProperties.getProperty(p.PropertyId.SpeechServiceAuthorization_Token,void 0);return i.PromiseHelper.fromResult(r)}));this.privAdapter=this.createSynthesisAdapter(u,this.privConnectionFactory,this.audioConfig,a),this.privAdapter.audioOutputFormat=s.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(p.SpeechSynthesisOutputFormat[this.properties.getProperty(p.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])},e.prototype.speakImpl=function(e,t,r,n,s){var u=this;try{c.Contracts.throwIfDisposed(this.privDisposed);var v=i.createNoDashGuid(),l=void 0;l=s instanceof p.PushAudioOutputStreamCallback?new a.PushAudioOutputStreamImpl(s):s instanceof p.PullAudioOutputStream?s:void 0!==s?new o.AudioFileWriter(s):void 0,this.synthesisRequestQueue.enqueue(new h(v,e,t,(function(e){if(u.privSynthesizing=!1,r)try{r(e)}catch(e){n&&n(e)}r=void 0,u.adapterSpeak()}),(function(e){n&&n(e)}),l)),this.adapterSpeak()}catch(e){if(n)if(e instanceof Error){var d=e;n(d.name+": "+d.message)}else n(e);this.dispose(!0)}},e.prototype.adapterSpeak=function(){var e=this;return this.privDisposed||this.privSynthesizing?i.PromiseHelper.fromResult(!0):(this.privSynthesizing=!0,this.synthesisRequestQueue.dequeue().onSuccessContinueWithPromise((function(t){return e.privAdapter.Speak(t.text,t.isSSML,t.requestId,t.cb,t.err,t.dataStream)})))},e.XMLEncode=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},e}();t.SpeechSynthesizer=u;var h=function(e,t,r,n,i,o){this.requestId=e,this.text=t,this.isSSML=r,this.cb=n,this.err=i,this.dataStream=o};t.SynthesisRequest=h},function(e,t){},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,n,i){this.privResultId=e,this.privReason=t,this.privAudioData=r,this.privErrorDetails=n,this.privProperties=i}return Object.defineProperty(e.prototype,"resultId",{get:function(){return this.privResultId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioData",{get:function(){return this.privAudioData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),e}();t.SpeechSynthesisResult=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privResult=e}return Object.defineProperty(e.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),e}();t.SpeechSynthesisEventArgs=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,n){this.privAduioOffset=e,this.privText=t,this.privWordLength=r,this.privTextOffset=n}return Object.defineProperty(e.prototype,"audioOffset",{get:function(){return this.privAduioOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.privText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wordLength",{get:function(){return this.privWordLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textOffset",{get:function(){return this.privTextOffset},enumerable:!0,configurable:!0}),e}();t.SpeechSynthesisWordBoundaryEventArgs=n},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});var i=r(5),o=r(6),s=r(75),a=r(53),c=((n={})[s.AudioFormatTag.PCM]="audio/wav",n[s.AudioFormatTag.MP3]="audio/mpeg",n[s.AudioFormatTag.Opus]="audio/ogg",n),p=function(){function e(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||o.createNoDashGuid(),this.privIsPaused=!1,this.privIsClosed=!1}return e.prototype.id=function(){return this.privId},e.prototype.write=function(e){void 0!==this.privAudioBuffer?(this.privAudioBuffer.push(e),this.updateSourceBuffer()):void 0!==this.privAudioOutputStream&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)},e.prototype.close=function(){if(this.privIsClosed=!0,void 0!==this.privSourceBuffer)this.handleSourceBufferUpdateEnd();else if(void 0!==this.privAudioOutputStream){var e=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(e),this.privFormat.hasHeader&&(e=i.SynthesisAdapterBase.addHeader(e,this.privFormat));var t=new Blob([e],{type:c[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(t),this.notifyPlayback()}},Object.defineProperty(e.prototype,"format",{set:function(e){var t=this;if("undefined"!=typeof AudioContext||void 0!==window.webkitAudioContext){this.privFormat=e;var r=c[this.privFormat.formatTag];void 0===r?console.warn("Unknown mimeType for format "+s.AudioFormatTag[this.privFormat.formatTag]+"."):"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported(r)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=function(e){t.privMediaSourceOpened=!0,t.privMediaSource.duration=1800,t.privSourceBuffer=t.privMediaSource.addSourceBuffer(r),t.privSourceBuffer.onupdate=function(e){t.updateSourceBuffer()},t.privSourceBuffer.onupdateend=function(e){t.handleSourceBufferUpdateEnd()},t.privSourceBuffer.onupdatestart=function(e){t.privAppendingToBuffer=!1}},this.updateSourceBuffer()):(console.warn("Format "+s.AudioFormatTag[this.privFormat.formatTag]+" could not be played by MSE, streaming playback is not enabled."),this.privAudioOutputStream=new a.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClosed",{get:function(){return this.privIsClosed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return void 0!==this.privAudio?this.privAudio.currentTime:-1},enumerable:!0,configurable:!0}),e.prototype.pause=function(){this.privIsPaused||void 0===this.privAudio||(this.privAudio.pause(),this.privIsPaused=!0)},e.prototype.resume=function(){this.privIsPaused&&void 0!==this.privAudio&&(this.privAudio.play(),this.privIsPaused=!1)},Object.defineProperty(e.prototype,"internalAudio",{get:function(){return this.privAudio},enumerable:!0,configurable:!0}),e.prototype.updateSourceBuffer=function(){if(void 0!==this.privAudioBuffer&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;var e=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(e)}catch(t){return this.privAudioBuffer.unshift(e),void console.log("buffer filled, pausing addition of binaries until space is made")}this.notifyPlayback()}else this.canEndStream()&&this.handleSourceBufferUpdateEnd()},e.prototype.handleSourceBufferUpdateEnd=function(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),this.notifyPlayback())},e.prototype.notifyPlayback=function(){var e=this;this.privPlaybackStarted||void 0===this.privAudio||(this.privAudio.onended=function(){e.onAudioEnd&&e.onAudioEnd(e)},this.privIsPaused||this.privAudio.play(),this.privPlaybackStarted=!0)},e.prototype.canEndStream=function(){return this.isClosed&&void 0!==this.privSourceBuffer&&0===this.privAudioBuffer.length&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&"open"===this.privMediaSource.readyState},e.prototype.sourceBufferAvailable=function(){return void 0!==this.privSourceBuffer&&!this.privSourceBuffer.updating},e}();t.SpeakerAudioDestination=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(28),i=r(6),o=r(2),s=r(5),a=r(108),c=function(){function e(t,r,n,c,p){var u=this;if(this.privSetTimeout=setTimeout,this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.sendTelemetryData=function(){var t=u.privRequestSession.getTelemetry();if(!0!==e.telemetryDataEnabled||u.privIsDisposed||null===t)return i.PromiseHelper.fromResult(!0);if(e.telemetryData)try{e.telemetryData(t)}catch(e){}return u.fetchConnection().onSuccessContinueWith((function(e){return e.send(new a.SpeechConnectionMessage(i.MessageType.Text,"telemetry",u.privRequestSession.requestId,"application/json",t))}))},this.receiveMessageOverride=void 0,this.receiveMessage=function(){return u.fetchConnection().on((function(e){return e.read().onSuccessContinueWithPromise((function(e){if(void 0!==u.receiveMessageOverride)return u.receiveMessageOverride();if(u.privIsDisposed)return i.PromiseHelper.fromResult(void 0);if(!e)return u.privRequestSession.isRecognizing?u.receiveMessage():i.PromiseHelper.fromResult(!0);u.privServiceHasSentMessage=!0;var t=a.SpeechConnectionMessage.fromConnectionMessage(e);if(t.requestId.toLowerCase()===u.privRequestSession.requestId.toLowerCase())switch(t.path.toLowerCase()){case"turn.start":u.privMustReportEndOfStream=!0,u.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":var r=s.SpeechDetected.fromJSON(t.textBody),n=new o.RecognitionEventArgs(r.Offset,u.privRequestSession.sessionId);u.privRecognizer.speechStartDetected&&u.privRecognizer.speechStartDetected(u.privRecognizer,n);break;case"speech.enddetected":var c=void 0;c=t.textBody.length>0?t.textBody:"{ Offset: 0 }";var p=s.SpeechDetected.fromJSON(c);u.privRecognizerConfig.isContinuousRecognition&&u.privRequestSession.onServiceRecognized(p.Offset+u.privRequestSession.currentTurnAudioOffset);var h=new o.RecognitionEventArgs(p.Offset+u.privRequestSession.currentTurnAudioOffset,u.privRequestSession.sessionId);u.privRecognizer.speechEndDetected&&u.privRecognizer.speechEndDetected(u.privRecognizer,h);break;case"turn.end":u.sendTelemetryData(),u.privRequestSession.isSpeechEnded&&u.privMustReportEndOfStream&&(u.privMustReportEndOfStream=!1,u.cancelRecognitionLocal(o.CancellationReason.EndOfStream,o.CancellationErrorCode.NoError,void 0));var v=new o.SessionEventArgs(u.privRequestSession.sessionId);if(u.privRequestSession.onServiceTurnEndResponse(u.privRecognizerConfig.isContinuousRecognition),!u.privRecognizerConfig.isContinuousRecognition||u.privRequestSession.isSpeechEnded||!u.privRequestSession.isRecognizing)return u.privRecognizer.sessionStopped&&u.privRecognizer.sessionStopped(u.privRecognizer,v),i.PromiseHelper.fromResult(!0);u.fetchConnection().onSuccessContinueWith((function(e){u.sendSpeechContext(e),u.sendWaveHeader(e)}));break;default:u.processTypeSpecificMessages(t)||u.privServiceEvents&&u.serviceEvents.onEvent(new i.ServiceEvent(t.path.toLowerCase(),t.textBody))}return u.receiveMessage()}))}),(function(e){}))},this.sendSpeechContext=function(e){var t=u.speechContext.toJSON();return t?e.send(new a.SpeechConnectionMessage(i.MessageType.Text,"speech.context",u.privRequestSession.requestId,"application/json",t)):i.PromiseHelper.fromResult(!0)},this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.fetchConnectionOverride=void 0,this.sendSpeechServiceConfig=function(t,r,n){if(!0!==e.telemetryDataEnabled){var o={context:{system:JSON.parse(n).context.system}};n=JSON.stringify(o)}return n?t.send(new a.SpeechConnectionMessage(i.MessageType.Text,"speech.config",r.requestId,"application/json",n)):i.PromiseHelper.fromResult(!0)},this.sendAudio=function(e){return u.audioSource.format.onSuccessContinueWithPromise((function(t){var r=new i.Deferred,n=Date.now(),o=u.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),s=t.avgBytesPerSec/1e3*parseInt(o,10),c=u.privRequestSession.recogNumber,p=function(){u.privIsDisposed||u.privRequestSession.isSpeechEnded||!u.privRequestSession.isRecognizing||u.privRequestSession.recogNumber!==c||u.fetchConnection().on((function(o){e.read().on((function(e){var c,h;u.privRequestSession.isSpeechEnded?r.resolve(!0):(!e||e.isEnd?(c=null,h=0):(c=e.buffer,u.privRequestSession.onAudioSent(c.byteLength),h=s>=u.privRequestSession.bytesSent?0:Math.max(0,n-Date.now())),u.privSetTimeout((function(){var s;null!==c&&(n=Date.now()+1e3*c.byteLength/(2*t.avgBytesPerSec));var h=o.send(new a.SpeechConnectionMessage(i.MessageType.Binary,"audio",u.privRequestSession.requestId,null,c));(null===(s=e)||void 0===s?void 0:s.isEnd)?(u.privRequestSession.onSpeechEnded(),r.resolve(!0)):h.continueWith((function(e){p()}))}),h))}),(function(e){u.privRequestSession.isSpeechEnded?r.resolve(!0):r.reject(e)}))}),(function(e){r.reject(e)}))};return p(),r.promise()}))},this.fetchConnection=function(){return void 0!==u.fetchConnectionOverride?u.fetchConnectionOverride():u.configureConnection()},!t)throw new i.ArgumentNullError("authentication");if(!r)throw new i.ArgumentNullError("connectionFactory");if(!n)throw new i.ArgumentNullError("audioSource");if(!c)throw new i.ArgumentNullError("recognizerConfig");this.privMustReportEndOfStream=!1,this.privAuthentication=t,this.privConnectionFactory=r,this.privAudioSource=n,this.privRecognizerConfig=c,this.privIsDisposed=!1,this.privRecognizer=p,this.privRequestSession=new s.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new i.EventSource,this.privServiceEvents=new i.EventSource,this.privDynamicGrammar=new s.DynamicGrammarBuilder,this.privSpeechContext=new s.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new s.AgentConfig,"undefined"!=typeof Blob&&"undefined"!=typeof Worker&&(this.privSetTimeout=i.Timeout.setTimeout)}return Object.defineProperty(e.prototype,"audioSource",{get:function(){return this.privAudioSource},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speechContext",{get:function(){return this.privSpeechContext},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dynamicGrammar",{get:function(){return this.privDynamicGrammar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"agentConfig",{get:function(){return this.privAgentConfig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"conversationTranslatorToken",{set:function(e){this.privRecognizerConfig.parameters.setProperty(o.PropertyId.ConversationTranslator_Token,e)},enumerable:!0,configurable:!0}),e.prototype.isDisposed=function(){return this.privIsDisposed},e.prototype.dispose=function(e){this.privIsDisposed=!0,this.privConnectionConfigurationPromise&&this.privConnectionConfigurationPromise.onSuccessContinueWith((function(t){t.dispose(e)}))},Object.defineProperty(e.prototype,"connectionEvents",{get:function(){return this.privConnectionEvents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serviceEvents",{get:function(){return this.privServiceEvents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recognitionMode",{get:function(){return this.privRecognizerConfig.recognitionMode},enumerable:!0,configurable:!0}),e.prototype.recognize=function(e,t,r){var s=this;return void 0!==this.recognizeOverride?this.recognizeOverride(e,t,r):(this.privConnectionConfigurationPromise=null,this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=t,this.privErrorCallback=r,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events),this.connectImpl(),this.audioSource.attach(this.privRequestSession.audioNodeId).onSuccessContinueWithPromise((function(e){var t;return s.audioSource.format.onSuccessContinueWithPromise((function(r){return t=new n.ReplayableAudioNode(e,r.avgBytesPerSec),s.privRequestSession.onAudioSourceAttachCompleted(t,!1),s.audioSource.deviceInfo.onSuccessContinueWithPromise((function(e){return s.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:e},s.configureConnection().continueWithPromise((function(e){if(e.isError)return s.cancelRecognitionLocal(o.CancellationReason.Error,o.CancellationErrorCode.ConnectionFailure,e.error),i.PromiseHelper.fromError(e.error);var r=new o.SessionEventArgs(s.privRequestSession.sessionId);s.privRecognizer.sessionStarted&&s.privRecognizer.sessionStarted(s.privRecognizer,r);s.receiveMessage();return s.sendAudio(t).on((function(e){}),(function(e){s.cancelRecognitionLocal(o.CancellationReason.Error,o.CancellationErrorCode.RuntimeError,e)})),i.PromiseHelper.fromResult(!0)}))}))}))})))},e.prototype.stopRecognizing=function(){var e=this;return this.privRequestSession.isRecognizing?(this.audioSource.turnOff(),this.sendFinalAudio().onSuccessContinueWithPromise((function(t){return e.privRequestSession.onStopRecognizing(),e.privRequestSession.turnCompletionPromise.onSuccessContinueWith((function(t){return e.privRequestSession.onStopRecognizing(),e.privRequestSession.dispose(),!0}))}))):i.PromiseHelper.fromResult(!0)},e.prototype.connect=function(){this.connectImpl().result()},e.prototype.connectAsync=function(e,t){this.connectImpl().continueWith((function(r){try{r.isError?t&&t(r.error):r.isCompleted&&e&&e()}catch(e){t&&t(e)}}))},e.prototype.disconnect=function(){void 0===this.disconnectOverride?(this.cancelRecognitionLocal(o.CancellationReason.Error,o.CancellationErrorCode.NoError,"Disconnecting"),this.privConnectionPromise.result().isCompleted?this.privConnectionPromise.result().isError||(this.privConnectionPromise.result().result.dispose(),this.privConnectionPromise=null):this.privConnectionPromise.onSuccessContinueWith((function(e){e.dispose()}))):this.disconnectOverride()},e.prototype.disconnectAsync=function(e,t){try{if(void 0!==this.disconnectOverride)return this.disconnectOverride(),void(e&&e());this.cancelRecognitionLocal(o.CancellationReason.Error,o.CancellationErrorCode.NoError,"Disconnecting"),this.privConnectionPromise.continueWith((function(r){try{r.isError?t&&t(r.error):r.isCompleted&&(r.result.dispose(),e&&e())}catch(e){t&&t(e)}}))}catch(e){t&&t(e)}},e.prototype.sendMessage=function(e){},e.prototype.sendNetworkMessage=function(e,t,r,n){var o=this,s="string"==typeof t?i.MessageType.Text:i.MessageType.Binary,c="string"==typeof t?"application/json":"";this.fetchConnection().on((function(i){i.send(new a.SpeechConnectionMessage(s,e,o.privRequestSession.requestId,c,t)).on((function(){r&&r()}),(function(e){n&&n(e)}))}),(function(e){n&&n(e)}))},Object.defineProperty(e.prototype,"activityTemplate",{get:function(){return this.privActivityTemplate},set:function(e){this.privActivityTemplate=e},enumerable:!0,configurable:!0}),e.prototype.cancelRecognitionLocal=function(e,t,r){this.privRequestSession.isRecognizing&&(this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,t,r))},e.prototype.sendWaveHeader=function(e){var t=this;return this.audioSource.format.onSuccessContinueWithPromise((function(r){return e.send(new a.SpeechConnectionMessage(i.MessageType.Binary,"audio",t.privRequestSession.requestId,"audio/x-wav",r.header))}))},e.prototype.connectImpl=function(e){var t=this;if(void 0===e&&(e=!1),void 0!==this.connectImplOverride)return this.connectImplOverride(e);if(this.privConnectionPromise)return this.privConnectionPromise.result().isCompleted&&(this.privConnectionPromise.result().isError||this.privConnectionPromise.result().result.state()===i.ConnectionState.Disconnected)&&!0===this.privServiceHasSentMessage?(this.privConnectionId=null,this.privConnectionPromise=null,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise;this.privAuthFetchEventId=i.createNoDashGuid(),this.privConnectionId=i.createNoDashGuid(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);var r=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=r.continueWithPromise((function(r){if(r.isError)throw t.privRequestSession.onAuthCompleted(!0,r.error),new Error(r.error);t.privRequestSession.onAuthCompleted(!1);var n=t.privConnectionFactory.create(t.privRecognizerConfig,r.result,t.privConnectionId);return t.privRequestSession.listenForServiceTelemetry(n.events),n.events.attach((function(e){t.connectionEvents.onEvent(e)})),n.open().onSuccessContinueWithPromise((function(r){return 200===r.statusCode?(t.privRequestSession.onPreConnectionStart(t.privAuthFetchEventId,t.privConnectionId),t.privRequestSession.onConnectionEstablishCompleted(r.statusCode),i.PromiseHelper.fromResult(n)):403!==r.statusCode||e?(t.privRequestSession.onConnectionEstablishCompleted(r.statusCode,r.reason),i.PromiseHelper.fromError("Unable to contact server. StatusCode: "+r.statusCode+", "+t.privRecognizerConfig.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Endpoint)+" Reason: "+r.reason)):t.connectImpl(!0)}))})),this.privConnectionPromise},e.prototype.writeBufferToConsole=function(e){var t="Buffer Size: ";if(null===e)t+="null";else{var r=new Uint8Array(e);t+=e.byteLength+"\r\n";for(var n=0;n<e.byteLength;n++)t+=r[n].toString(16).padStart(2,"0")+" "}console.info(t)},e.prototype.sendFinalAudio=function(){var e=this,t=new i.Deferred;return this.fetchConnection().on((function(r){r.send(new a.SpeechConnectionMessage(i.MessageType.Binary,"audio",e.privRequestSession.requestId,null,null)).on((function(e){t.resolve(!0)}),(function(e){t.reject(e)}))}),(function(e){t.reject(e)})),t.promise()},e.prototype.configureConnection=function(){var e=this;return void 0!==this.configConnectionOverride?this.configConnectionOverride():this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.result().isCompleted&&(this.privConnectionConfigurationPromise.result().isError||this.privConnectionConfigurationPromise.result().result.state()===i.ConnectionState.Disconnected)?(this.privConnectionConfigurationPromise=null,this.configureConnection()):this.privConnectionConfigurationPromise:(this.privConnectionConfigurationPromise=this.connectImpl().onSuccessContinueWithPromise((function(t){return e.sendSpeechServiceConfig(t,e.privRequestSession,e.privRecognizerConfig.SpeechServiceConfig.serialize()).onSuccessContinueWithPromise((function(r){return e.sendSpeechContext(t).onSuccessContinueWithPromise((function(r){return e.sendWaveHeader(t).onSuccessContinueWith((function(e){return t}))}))}))})),this.privConnectionConfigurationPromise)},e.telemetryDataEnabled=!0,e}();t.ServiceRecognizerBase=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(2);!function(e){e[e.Interactive=0]="Interactive",e[e.Conversation=1]="Conversation",e[e.Dictation=2]="Dictation"}(n=t.RecognitionMode||(t.RecognitionMode={})),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(t.SpeechResultFormat||(t.SpeechResultFormat={}));var o=function(){function e(e,t){this.privRecognitionMode=n.Interactive,this.privSpeechServiceConfig=e||new s(new a(null)),this.privParameters=t}return Object.defineProperty(e.prototype,"parameters",{get:function(){return this.privParameters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recognitionMode",{get:function(){return this.privRecognitionMode},set:function(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===n.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=n[e]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SpeechServiceConfig",{get:function(){return this.privSpeechServiceConfig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recognitionActivityTimeout",{get:function(){return this.privRecognitionActivityTimeout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isContinuousRecognition",{get:function(){return this.privRecognitionMode!==n.Interactive},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoDetectSourceLanguages",{get:function(){return this.parameters.getProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)},enumerable:!0,configurable:!0}),e}();t.RecognizerConfig=o;var s=function(){function e(e){var t=this;this.serialize=function(){return JSON.stringify(t,(function(e,t){if(t&&"object"==typeof t){var r={};for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n&&n.charAt(0).toLowerCase()+n.substring(1)]=t[n]);return r}return t}))},this.context=e}return Object.defineProperty(e.prototype,"Context",{get:function(){return this.context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Recognition",{get:function(){return this.recognition},set:function(e){this.recognition=e.toLowerCase()},enumerable:!0,configurable:!0}),e}();t.SpeechServiceConfig=s;var a=function(e){this.system=new c,this.os=e};t.Context=a;var c=function(){this.name="SpeechSDK",this.version="1.13.1",this.build="JavaScript",this.lang="JavaScript"};t.System=c;var p=function(e,t,r){this.platform=e,this.name=t,this.version=r};t.OS=p;var u=function(e,t,r){this.manufacturer=e,this.model=t,this.version=r};t.Device=u,function(e){e.Bluetooth="Bluetooth",e.Wired="Wired",e.WiFi="WiFi",e.Cellular="Cellular",e.InBuilt="InBuilt",e.Unknown="Unknown"}(t.connectivity||(t.connectivity={})),function(e){e.Phone="Phone",e.Speaker="Speaker",e.Car="Car",e.Headset="Headset",e.Thermostat="Thermostat",e.Microphones="Microphones",e.Deskphone="Deskphone",e.RemoteControl="RemoteControl",e.Unknown="Unknown",e.File="File",e.Stream="Stream"}(t.type||(t.type={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=function(){var e=this;this.toConnectionMessage=function(t){var r=new n.Deferred;try{if(t.messageType===n.MessageType.Text){var i=t.textContent,o={},s=null;if(i){var a=i.split("\r\n\r\n");a&&a.length>0&&(o=e.parseHeaders(a[0]),a.length>1&&(s=a[1]))}r.resolve(new n.ConnectionMessage(t.messageType,s,o,t.id))}else if(t.messageType===n.MessageType.Binary){var c=t.binaryContent;if(o={},s=null,!c||c.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");var p=new DataView(c),u=p.getInt16(0);if(c.byteLength<u+2)throw new Error("Invalid binary message format. Header content missing.");for(var h="",v=0;v<u;v++)h+=String.fromCharCode(p.getInt8(v+2));o=e.parseHeaders(h),c.byteLength>u+2&&(s=c.slice(2+u)),r.resolve(new n.ConnectionMessage(t.messageType,s,o,t.id))}}catch(e){r.reject("Error formatting the message. Error: "+e)}return r.promise()},this.fromConnectionMessage=function(t){var r=new n.Deferred;try{if(t.messageType===n.MessageType.Text){var i=e.makeHeaders(t)+"\r\n"+(t.textBody?t.textBody:"");r.resolve(new n.RawWebsocketMessage(n.MessageType.Text,i,t.id))}else if(t.messageType===n.MessageType.Binary){var o=e.makeHeaders(t),s=t.binaryBody,a=new Int8Array(e.stringToArrayBuffer(o)),c=(i=new ArrayBuffer(2+a.byteLength+(s?s.byteLength:0)),new DataView(i));c.setInt16(0,a.length);for(var p=0;p<a.byteLength;p++)c.setInt8(2+p,a[p]);if(s){var u=new Int8Array(s);for(p=0;p<u.byteLength;p++)c.setInt8(2+a.byteLength+p,u[p])}r.resolve(new n.RawWebsocketMessage(n.MessageType.Binary,i,t.id))}}catch(e){r.reject("Error formatting the message. "+e)}return r.promise()},this.makeHeaders=function(e){var t="";if(e.headers)for(var r in e.headers)r&&(t+=r+": "+e.headers[r]+"\r\n");return t},this.parseHeaders=function(e){var t={};if(e){var r=e.match(/[^\r\n]+/g);if(t)for(var n=0,i=r;n<i.length;n++){var o=i[n];if(o){var s=o.indexOf(":"),a=s>0?o.substr(0,s).trim().toLowerCase():o,c=s>0&&o.length>s+1?o.substr(s+1).trim():"";t[a]=c}}}return t},this.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new DataView(t),n=0;n<e.length;n++)r.setUint8(n,e.charCodeAt(n));return t}};t.WebsocketMessageFormatter=i},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(28),s=r(2),a=r(64),c=r(5),p=r(65),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e,r,n){var i=e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!i){var a=e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_Region,void 0),u=a&&a.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com";i=e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_Host,"wss://"+a+".s2s.speech"+u)+"/speech/translation/cognitiveservices/v1"}var h={from:e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage),to:e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages)};t.setCommonUrlParams(e,h,i),t.setUrlParameter(s.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,p.QueryParameterNames.StableTranslation,e,h,i);void 0!==e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)&&(h.voice=e.parameters.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice),h.features="texttospeech");var v={};return void 0!==r.token&&""!==r.token&&(v[r.headerName]=r.token),v["X-ConnectionId"]=n,e.parameters.setProperty(s.PropertyId.SpeechServiceConnection_Url,i),new o.WebsocketConnection(i,h,v,new c.WebsocketMessageFormatter,o.ProxyInfo.fromRecognizerConfig(e),n)},t}return i(t,e),t}(a.ConnectionFactoryBase);t.TranslationConnectionFactory=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(28),i=r(2),o=r(5),s=r(65),a=function(){var e=this;this.synthesisUri="/cognitiveservices/websocket/v1",this.create=function(t,r,a){var c=t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint,void 0),p=t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region,void 0),u=p&&p.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",h=t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,"wss://"+p+".tts.speech"+u);c||(c=h+e.synthesisUri);var v={};return void 0!==r.token&&""!==r.token&&(v[r.headerName]=r.token),v[s.QueryParameterNames.ConnectionIdHeader]=a,t.parameters.setProperty(i.PropertyId.SpeechServiceConnection_Url,c),new n.WebsocketConnection(c,{},v,new o.WebsocketMessageFormatter,n.ProxyInfo.fromParameters(t.parameters),a)}};t.SpeechSynthesisConnectionFactory=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(5),o=function(){function e(){}return e.implTranslateRecognitionResult=function(e){var t=n.ResultReason.Canceled;switch(e){case i.RecognitionStatus.Success:t=n.ResultReason.RecognizedSpeech;break;case i.RecognitionStatus.NoMatch:case i.RecognitionStatus.InitialSilenceTimeout:case i.RecognitionStatus.BabbleTimeout:case i.RecognitionStatus.EndOfDictation:t=n.ResultReason.NoMatch;break;case i.RecognitionStatus.Error:default:t=n.ResultReason.Canceled}return t},e.implTranslateCancelResult=function(e){var t=n.CancellationReason.EndOfStream;switch(e){case i.RecognitionStatus.Success:case i.RecognitionStatus.EndOfDictation:case i.RecognitionStatus.NoMatch:t=n.CancellationReason.EndOfStream;break;case i.RecognitionStatus.InitialSilenceTimeout:case i.RecognitionStatus.BabbleTimeout:case i.RecognitionStatus.Error:default:t=n.CancellationReason.Error}return t},e.implTranslateCancelErrorCode=function(e){var t=n.CancellationErrorCode.NoError;switch(e){case i.RecognitionStatus.Error:t=n.CancellationErrorCode.ServiceError;break;case i.RecognitionStatus.TooManyRequests:t=n.CancellationErrorCode.TooManyRequests;break;default:t=n.CancellationErrorCode.NoError}return t},e}();t.EnumTranslation=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"}(t.SynthesisStatus||(t.SynthesisStatus={})),function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests"}(t.RecognitionStatus||(t.RecognitionStatus={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=function(){function e(e){this.privSynthesisEnd=JSON.parse(e),this.privSynthesisEnd.SynthesisStatus=n.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"SynthesisStatus",{get:function(){return this.privSynthesisEnd.SynthesisStatus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FailureReason",{get:function(){return this.privSynthesisEnd.FailureReason},enumerable:!0,configurable:!0}),e}();t.TranslationSynthesisEnd=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(102),i=function(){function e(e){this.privTranslationHypothesis=JSON.parse(e),this.privTranslationHypothesis.Translation.TranslationStatus=n.TranslationStatus[this.privTranslationHypothesis.Translation.TranslationStatus]}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privTranslationHypothesis.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privTranslationHypothesis.Offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){return this.privTranslationHypothesis.Text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Translation",{get:function(){return this.privTranslationHypothesis.Translation},enumerable:!0,configurable:!0}),e}();t.TranslationHypothesis=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(102),o=function(){function e(e){this.privTranslationPhrase=JSON.parse(e),this.privTranslationPhrase.RecognitionStatus=n.RecognitionStatus[this.privTranslationPhrase.RecognitionStatus],void 0!==this.privTranslationPhrase.Translation&&(this.privTranslationPhrase.Translation.TranslationStatus=i.TranslationStatus[this.privTranslationPhrase.Translation.TranslationStatus])}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"RecognitionStatus",{get:function(){return this.privTranslationPhrase.RecognitionStatus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privTranslationPhrase.Offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privTranslationPhrase.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){return this.privTranslationPhrase.Text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Translation",{get:function(){return this.privTranslationPhrase.Translation},enumerable:!0,configurable:!0}),e}();t.TranslationPhrase=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),s=r(2),a=r(5),c=function(e){function t(t,r,n,i,o){var s=e.call(this,t,r,n,i,o)||this;return s.privTranslationRecognizer=o,s}return i(t,e),t.prototype.processTypeSpecificMessages=function(e){var t=new s.PropertyCollection,r=!1;switch(e.messageType===o.MessageType.Text&&t.setProperty(s.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"translation.hypothesis":var n=this.fireEventForResult(a.TranslationHypothesis.fromJSON(e.textBody),t);if(this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+n.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,n)}catch(e){}r=!0;break;case"translation.phrase":var i=a.TranslationPhrase.fromJSON(e.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+i.Offset+i.Duration),i.RecognitionStatus===a.RecognitionStatus.Success){var c=this.fireEventForResult(i,t);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,c)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(c.result)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}break}var p=a.EnumTranslation.implTranslateRecognitionResult(i.RecognitionStatus),u=new s.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,p,i.Text,i.Duration,this.privRequestSession.currentTurnAudioOffset+i.Offset,void 0,e.textBody,t);if(p===s.ResultReason.Canceled){var h=a.EnumTranslation.implTranslateCancelResult(i.RecognitionStatus);this.cancelRecognitionLocal(h,a.EnumTranslation.implTranslateCancelErrorCode(i.RecognitionStatus),void 0)}else{if(!this.privRequestSession.isSpeechEnded||p!==s.ResultReason.NoMatch||i.RecognitionStatus===a.RecognitionStatus.InitialSilenceTimeout){var v=new s.TranslationRecognitionEventArgs(u,u.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,v)}catch(e){}}if(this.privSuccessCallback){try{this.privSuccessCallback(u)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}r=!0;break;case"translation.synthesis":this.sendSynthesisAudio(e.binaryBody,this.privRequestSession.sessionId),r=!0;break;case"translation.synthesis.end":var l=a.TranslationSynthesisEnd.fromJSON(e.textBody);switch(l.SynthesisStatus){case a.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){var d=new s.TranslationSynthesisResult(s.ResultReason.Canceled,void 0),f=new s.TranslationSynthesisEventArgs(d,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,f)}catch(e){}}if(this.privTranslationRecognizer.canceled){var g=new s.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,s.CancellationReason.Error,l.FailureReason,s.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,g)}catch(e){}}break;case a.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId)}r=!0}return r},t.prototype.cancelRecognition=function(e,t,r,n,i){var o=new s.PropertyCollection;if(o.setProperty(a.CancellationErrorCodePropertyName,s.CancellationErrorCode[n]),this.privTranslationRecognizer.canceled){var c=new s.TranslationRecognitionCanceledEventArgs(e,r,i,n,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,c)}catch(e){}}if(this.privSuccessCallback){var p=new s.TranslationRecognitionResult(void 0,t,s.ResultReason.Canceled,void 0,void 0,void 0,i,void 0,o);try{this.privSuccessCallback(p),this.privSuccessCallback=void 0}catch(e){}}},t.prototype.fireEventForResult=function(e,t){var r,n;if(void 0!==e.Translation.Translations){r=new s.Translations;for(var i=0,c=e.Translation.Translations;i<c.length;i++){var p=c[i];r.set(p.Language,p.Text)}}n=e instanceof a.TranslationPhrase?e.Translation.TranslationStatus===o.TranslationStatus.Success?s.ResultReason.TranslatedSpeech:s.ResultReason.RecognizedSpeech:s.ResultReason.TranslatingSpeech;var u=e.Offset+this.privRequestSession.currentTurnAudioOffset,h=new s.TranslationRecognitionResult(r,this.privRequestSession.requestId,n,e.Text,e.Duration,u,e.Translation.FailureReason,JSON.stringify(e),t);return new s.TranslationRecognitionEventArgs(h,u,this.privRequestSession.sessionId)},t.prototype.sendSynthesisAudio=function(e,t){var r=void 0===e?s.ResultReason.SynthesizingAudioCompleted:s.ResultReason.SynthesizingAudio,n=new s.TranslationSynthesisResult(r,e),i=new s.TranslationSynthesisEventArgs(n,t);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,i)}catch(e){}},t}(a.ServiceRecognizerBase);t.TranslationServiceRecognizer=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privSpeechStartDetected=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privSpeechStartDetected.Offset},enumerable:!0,configurable:!0}),e}();t.SpeechDetected=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privSpeechHypothesis=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"Text",{get:function(){return this.privSpeechHypothesis.Text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privSpeechHypothesis.Offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privSpeechHypothesis.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Language",{get:function(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LanguageDetectionConfidence",{get:function(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence},enumerable:!0,configurable:!0}),e}();t.SpeechHypothesis=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),s=r(5),a=function(e){function t(t,r,n,i,o){var s=e.call(this,t,r,n,i,o)||this;if(s.privSpeechRecognizer=o,void 0!==i.autoDetectSourceLanguages){var a=i.autoDetectSourceLanguages.split(",");s.privSpeechContext.setSection("languageId",{languages:a,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),s.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}})}return s}return i(t,e),t.prototype.processTypeSpecificMessages=function(e){var t,r=new o.PropertyCollection;r.setProperty(o.PropertyId.SpeechServiceResponse_JsonResult,e.textBody);var n=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":var i=s.SpeechHypothesis.fromJSON(e.textBody),a=i.Offset+this.privRequestSession.currentTurnAudioOffset;t=new o.SpeechRecognitionResult(this.privRequestSession.requestId,o.ResultReason.RecognizingSpeech,i.Text,i.Duration,a,i.Language,i.LanguageDetectionConfidence,void 0,e.textBody,r),this.privRequestSession.onHypothesis(a);var c=new o.SpeechRecognitionEventArgs(t,i.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,c)}catch(e){}n=!0;break;case"speech.phrase":var p=s.SimpleSpeechPhrase.fromJSON(e.textBody),u=s.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+p.Offset+p.Duration),o.ResultReason.Canceled===u){var h=s.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus);this.cancelRecognitionLocal(h,s.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus),void 0)}else{if(!this.privRequestSession.isSpeechEnded||u!==o.ResultReason.NoMatch||p.RecognitionStatus===s.RecognitionStatus.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(s.OutputFormatPropertyName)===o.OutputFormat[o.OutputFormat.Simple])t=new o.SpeechRecognitionResult(this.privRequestSession.requestId,u,p.DisplayText,p.Duration,p.Offset+this.privRequestSession.currentTurnAudioOffset,p.Language,p.LanguageDetectionConfidence,void 0,e.textBody,r);else{var v=s.DetailedSpeechPhrase.fromJSON(e.textBody);t=new o.SpeechRecognitionResult(this.privRequestSession.requestId,u,v.RecognitionStatus===s.RecognitionStatus.Success?v.NBest[0].Display:void 0,v.Duration,v.Offset+this.privRequestSession.currentTurnAudioOffset,v.Language,v.LanguageDetectionConfidence,void 0,e.textBody,r)}var l=new o.SpeechRecognitionEventArgs(t,t.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,l)}catch(e){}}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}n=!0}return n},t.prototype.cancelRecognition=function(e,t,r,n,i){var a=new o.PropertyCollection;if(a.setProperty(s.CancellationErrorCodePropertyName,o.CancellationErrorCode[n]),this.privSpeechRecognizer.canceled){var c=new o.SpeechRecognitionCanceledEventArgs(r,i,n,void 0,e);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,c)}catch(e){}}if(this.privSuccessCallback){var p=new o.SpeechRecognitionResult(t,o.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,i,void 0,a);try{this.privSuccessCallback(p),this.privSuccessCallback=void 0}catch(e){}}},t}(s.ServiceRecognizerBase);t.SpeechServiceRecognizer=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=function(){function e(e){this.privDetailedSpeechPhrase=JSON.parse(e),this.privDetailedSpeechPhrase.RecognitionStatus=n.RecognitionStatus[this.privDetailedSpeechPhrase.RecognitionStatus]}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"RecognitionStatus",{get:function(){return this.privDetailedSpeechPhrase.RecognitionStatus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NBest",{get:function(){return this.privDetailedSpeechPhrase.NBest},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privDetailedSpeechPhrase.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privDetailedSpeechPhrase.Offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Language",{get:function(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LanguageDetectionConfidence",{get:function(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence},enumerable:!0,configurable:!0}),e}();t.DetailedSpeechPhrase=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=function(){function e(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=n.RecognitionStatus[this.privSimpleSpeechPhrase.RecognitionStatus]}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"RecognitionStatus",{get:function(){return this.privSimpleSpeechPhrase.RecognitionStatus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DisplayText",{get:function(){return this.privSimpleSpeechPhrase.DisplayText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privSimpleSpeechPhrase.Offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privSimpleSpeechPhrase.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Language",{get:function(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LanguageDetectionConfidence",{get:function(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence},enumerable:!0,configurable:!0}),e}();t.SimpleSpeechPhrase=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){this.modelImpl=e,this.intentName=t};t.AddedLmIntent=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),s=r(2),a=r(5),c=function(e){function t(t,r,n,i,o){var s=e.call(this,t,r,n,i,o)||this;return s.privIntentRecognizer=o,s.privIntentDataSent=!1,s}return i(t,e),t.prototype.setIntents=function(e,t){this.privAddedLmIntents=e,this.privUmbrellaIntent=t,this.privIntentDataSent=!0},t.prototype.processTypeSpecificMessages=function(e){var t,r,n=this,i=!1,c=new s.PropertyCollection;switch(e.messageType===o.MessageType.Text&&c.setProperty(s.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":var p=a.SpeechHypothesis.fromJSON(e.textBody);if(t=new s.IntentRecognitionResult(void 0,this.privRequestSession.requestId,s.ResultReason.RecognizingIntent,p.Text,p.Duration,p.Offset+this.privRequestSession.currentTurnAudioOffset,p.Language,p.LanguageDetectionConfidence,void 0,e.textBody,c),this.privRequestSession.onHypothesis(t.offset),r=new s.IntentRecognitionEventArgs(t,p.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,r)}catch(e){}i=!0;break;case"speech.phrase":var u=a.SimpleSpeechPhrase.fromJSON(e.textBody);t=new s.IntentRecognitionResult(void 0,this.privRequestSession.requestId,a.EnumTranslation.implTranslateRecognitionResult(u.RecognitionStatus),u.DisplayText,u.Duration,u.Offset+this.privRequestSession.currentTurnAudioOffset,u.Language,u.LanguageDetectionConfidence,void 0,e.textBody,c),r=new s.IntentRecognitionEventArgs(t,t.offset,this.privRequestSession.sessionId);!1===this.privIntentDataSent||s.ResultReason.NoMatch===r.result.reason?(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),function(){if(n.privIntentRecognizer.recognized)try{n.privIntentRecognizer.recognized(n.privIntentRecognizer,r)}catch(e){}if(n.privSuccessCallback){try{n.privSuccessCallback(t)}catch(e){n.privErrorCallback&&n.privErrorCallback(e)}n.privSuccessCallback=void 0,n.privErrorCallback=void 0}}()):this.privPendingIntentArgs=r,i=!0;break;case"response":if(r=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,void 0===r){if(""===e.textBody)return;r=new s.IntentRecognitionEventArgs(new s.IntentRecognitionResult,0,this.privRequestSession.sessionId)}var h=a.IntentResponse.fromJSON(e.textBody),v=this.privAddedLmIntents[h.topScoringIntent.intent];if(void 0!==this.privUmbrellaIntent&&(v=this.privUmbrellaIntent),null!==h&&void 0!==v){var l=void 0===v.intentName?h.topScoringIntent.intent:v.intentName,d=r.result.reason;void 0!==l&&(d=s.ResultReason.RecognizedIntent);var f=void 0!==r.result.properties?r.result.properties:new s.PropertyCollection;f.setProperty(s.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,e.textBody),r=new s.IntentRecognitionEventArgs(new s.IntentRecognitionResult(l,r.result.resultId,d,r.result.text,r.result.duration,r.result.offset,void 0,void 0,r.result.errorDetails,r.result.json,f),r.offset,r.sessionId)}if(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,r)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(r.result)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}i=!0}return i},t.prototype.cancelRecognition=function(e,t,r,n,i){var o=new s.PropertyCollection;if(o.setProperty(a.CancellationErrorCodePropertyName,s.CancellationErrorCode[n]),this.privIntentRecognizer.canceled){var c=new s.IntentRecognitionCanceledEventArgs(r,i,n,void 0,void 0,e);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,c)}catch(e){}}if(this.privSuccessCallback){var p=new s.IntentRecognitionResult(void 0,t,s.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,i,void 0,o);try{this.privSuccessCallback(p),this.privSuccessCallback=void 0}catch(e){}}},t}(a.ServiceRecognizerBase);t.IntentServiceRecognizer=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privIntentResponse=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"query",{get:function(){return this.privIntentResponse.query},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topScoringIntent",{get:function(){return this.privIntentResponse.topScoringIntent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entities",{get:function(){return this.privIntentResponse.entities},enumerable:!0,configurable:!0}),e}();t.IntentResponse=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(107),o=r(350),s=function(){function e(e){var t=this;this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecogNumber=0,this.onAudioSourceAttachCompleted=function(e,r,n){t.privAudioNode=e,t.privIsAudioNodeDetached=!1,r?t.onComplete():t.onEvent(new i.ListeningStartedEvent(t.privRequestId,t.privSessionId,t.privAudioSourceId,t.privAudioNodeId))},this.onPreConnectionStart=function(e,r){t.privAuthFetchEventId=e,t.privSessionId=r,t.onEvent(new i.ConnectingToServiceEvent(t.privRequestId,t.privAuthFetchEventId,t.privSessionId))},this.onAuthCompleted=function(e,r){e&&t.onComplete()},this.onConnectionEstablishCompleted=function(e,r){if(200===e)return t.onEvent(new i.RecognitionStartedEvent(t.requestId,t.privAudioSourceId,t.privAudioNodeId,t.privAuthFetchEventId,t.privSessionId)),t.privAudioNode&&t.privAudioNode.replay(),t.privTurnStartAudioOffset=t.privLastRecoOffset,void(t.privBytesSent=0);403===e&&t.onComplete()},this.onServiceTurnEndResponse=function(e){t.privTurnDeferral.resolve(!0),!e||t.isSpeechEnded?t.onComplete():(t.privTurnStartAudioOffset=t.privLastRecoOffset,t.privRequestId=n.createNoDashGuid(),t.privAudioNode.replay())},this.onServiceTurnStartResponse=function(){t.privTurnDeferral.state()===n.PromiseState.None&&t.privTurnDeferral.reject("Another turn started before current completed."),t.privTurnDeferral=new n.Deferred},this.dispose=function(e){if(!t.privIsDisposed){t.privIsDisposed=!0;for(var r=0,n=t.privDetachables;r<n.length;r++){n[r].detach()}t.privServiceTelemetryListener.dispose()}},this.getTelemetry=function(){return t.privServiceTelemetryListener.hasTelemetry?t.privServiceTelemetryListener.getTelemetry():null},this.onEvent=function(e){t.privServiceTelemetryListener&&t.privServiceTelemetryListener.onEvent(e),n.Events.instance.onEvent(e)},this.onComplete=function(){t.privIsRecognizing&&(t.privIsRecognizing=!1,t.detachAudioNode())},this.detachAudioNode=function(){t.privIsAudioNodeDetached||(t.privIsAudioNodeDetached=!0,t.privAudioNode&&t.privAudioNode.detach())},this.privAudioSourceId=e,this.privRequestId=n.createNoDashGuid(),this.privAudioNodeId=n.createNoDashGuid(),this.privTurnDeferral=new n.Deferred,this.privTurnDeferral.resolve(!0)}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"turnCompletionPromise",{get:function(){return this.privTurnDeferral.promise()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSpeechEnded",{get:function(){return this.privIsSpeechEnded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRecognizing",{get:function(){return this.privIsRecognizing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTurnAudioOffset",{get:function(){return this.privTurnStartAudioOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recogNumber",{get:function(){return this.privRecogNumber},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesSent",{get:function(){return this.privBytesSent},enumerable:!0,configurable:!0}),e.prototype.listenForServiceTelemetry=function(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))},e.prototype.startNewRecognition=function(){this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRequestId=n.createNoDashGuid(),this.privRecogNumber++,this.privServiceTelemetryListener=new o.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new i.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))},e.prototype.onHypothesis=function(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))},e.prototype.onPhraseRecognized=function(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)},e.prototype.onServiceRecognized=function(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e)},e.prototype.onAudioSent=function(e){this.privBytesSent+=e},e.prototype.onStopRecognizing=function(){this.onComplete()},e.prototype.onSpeechEnded=function(){this.privIsSpeechEnded=!0},e}();t.RequestSession=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(107),o=function(){function e(e,t,r){var o=this;this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.onEvent=function(e){o.privIsDisposed||(e instanceof i.RecognitionTriggeredEvent&&e.requestId===o.privRequestId&&(o.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof n.AudioStreamNodeAttachingEvent&&e.audioSourceId===o.privAudioSourceId&&e.audioNodeId===o.privAudioNodeId&&(o.privMicStartTime=e.eventTime),e instanceof n.AudioStreamNodeAttachedEvent&&e.audioSourceId===o.privAudioSourceId&&e.audioNodeId===o.privAudioNodeId&&(o.privMicStartTime=e.eventTime),e instanceof n.AudioSourceErrorEvent&&e.audioSourceId===o.privAudioSourceId&&(o.privMicMetric||(o.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:o.privMicStartTime})),e instanceof n.AudioStreamNodeErrorEvent&&e.audioSourceId===o.privAudioSourceId&&e.audioNodeId===o.privAudioNodeId&&(o.privMicMetric||(o.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:o.privMicStartTime})),e instanceof n.AudioStreamNodeDetachedEvent&&e.audioSourceId===o.privAudioSourceId&&e.audioNodeId===o.privAudioNodeId&&(o.privMicMetric||(o.privMicMetric={End:e.eventTime,Name:"Microphone",Start:o.privMicStartTime})),e instanceof i.ConnectingToServiceEvent&&e.requestId===o.privRequestId&&(o.privConnectionId=e.sessionId),e instanceof n.ConnectionStartEvent&&e.connectionId===o.privConnectionId&&(o.privConnectionStartTime=e.eventTime),e instanceof n.ConnectionEstablishedEvent&&e.connectionId===o.privConnectionId&&(o.privConnectionEstablishMetric||(o.privConnectionEstablishMetric={End:e.eventTime,Id:o.privConnectionId,Name:"Connection",Start:o.privConnectionStartTime})),e instanceof n.ConnectionEstablishErrorEvent&&e.connectionId===o.privConnectionId&&(o.privConnectionEstablishMetric||(o.privConnectionEstablishMetric={End:e.eventTime,Error:o.getConnectionError(e.statusCode),Id:o.privConnectionId,Name:"Connection",Start:o.privConnectionStartTime})),e instanceof n.ConnectionMessageReceivedEvent&&e.connectionId===o.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path&&(o.privReceivedMessages[e.message.headers.path]||(o.privReceivedMessages[e.message.headers.path]=new Array),o.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)))},this.getTelemetry=function(){var e=new Array;o.privListeningTriggerMetric&&e.push(o.privListeningTriggerMetric),o.privMicMetric&&e.push(o.privMicMetric),o.privConnectionEstablishMetric&&e.push(o.privConnectionEstablishMetric),o.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:o.privPhraseLatencies}),o.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:o.privHypothesisLatencies});var t={Metrics:e,ReceivedMessages:o.privReceivedMessages},r=JSON.stringify(t);return o.privReceivedMessages={},o.privListeningTriggerMetric=null,o.privMicMetric=null,o.privConnectionEstablishMetric=null,o.privPhraseLatencies=[],o.privHypothesisLatencies=[],r},this.dispose=function(){o.privIsDisposed=!0},this.getConnectionError=function(e){switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}},this.privRequestId=e,this.privAudioSourceId=t,this.privAudioNodeId=r,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}return e.prototype.phraseReceived=function(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)},e.prototype.hypothesisReceived=function(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)},Object.defineProperty(e.prototype,"hasTelemetry",{get:function(){return 0!==Object.keys(this.privReceivedMessages).length||null!==this.privListeningTriggerMetric||null!==this.privMicMetric||null!==this.privConnectionEstablishMetric||0!==this.privPhraseLatencies.length||0!==this.privHypothesisLatencies.length},enumerable:!0,configurable:!0}),e}();t.ServiceTelemetryListener=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privContext={},this.privDynamicGrammar=e}return e.prototype.setSection=function(e,t){this.privContext[e]=t},e.prototype.toJSON=function(){var e=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",e),JSON.stringify(this.privContext)},e}();t.SpeechContext=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.addPhrase=function(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)},e.prototype.clearPhrases=function(){this.privPhrases=void 0},e.prototype.addReferenceGrammar=function(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)},e.prototype.clearGrammars=function(){this.privGrammars=void 0},e.prototype.generateGrammarObject=function(){if(void 0!==this.privGrammars||void 0!==this.privPhrases){var e={};if(e.ReferenceGrammars=this.privGrammars,void 0!==this.privPhrases&&0!==this.privPhrases.length){var t=[];this.privPhrases.forEach((function(e,r,n){t.push({Text:e})})),e.Groups=[{Type:"Generic",Items:t}]}return e}},e}();t.DynamicGrammarBuilder=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(28),s=r(6),a=r(2),c=r(354),p=r(5),u=r(164),h=r(108),v=function(e){function t(t,r,n,i,u){var v=e.call(this,t,r,n,i,u)||this;return v.sendMessage=function(e){var t=s.createGuid(),r=s.createNoDashGuid(),n={context:{interactionId:t},messagePayload:JSON.parse(e),version:.5},i=JSON.stringify(n);v.fetchDialogConnection().onSuccessContinueWith((function(e){e.send(new h.SpeechConnectionMessage(s.MessageType.Text,"agent",r,"application/json",i))}))},v.listenOnce=function(e,t,r){return v.privRecognizerConfig.recognitionMode=e,v.privSuccessCallback=t,v.privErrorCallback=r,v.privDialogRequestSession.startNewRecognition(),v.privDialogRequestSession.listenForServiceTelemetry(v.privDialogAudioSource.events),v.dialogConnectImpl(),v.sendPreAudioMessages(),v.privDialogAudioSource.attach(v.privDialogRequestSession.audioNodeId).continueWithPromise((function(e){var t;return e.isError?(v.cancelRecognition(v.privDialogRequestSession.sessionId,v.privDialogRequestSession.requestId,a.CancellationReason.Error,a.CancellationErrorCode.ConnectionFailure,e.error),s.PromiseHelper.fromError(e.error)):v.privDialogAudioSource.format.onSuccessContinueWithPromise((function(r){return t=new o.ReplayableAudioNode(e.result,r.avgBytesPerSec),v.privDialogRequestSession.onAudioSourceAttachCompleted(t,!1),v.privDialogAudioSource.deviceInfo.onSuccessContinueWithPromise((function(e){return v.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:e},v.configConnection().continueWithPromise((function(e){if(e.isError)return v.cancelRecognitionLocal(a.CancellationReason.Error,a.CancellationErrorCode.ConnectionFailure,e.error),s.PromiseHelper.fromError(e.error);var r=new a.SessionEventArgs(v.privDialogRequestSession.sessionId);return v.privRecognizer.sessionStarted&&v.privRecognizer.sessionStarted(v.privRecognizer,r),v.sendAudio(t).on((function(e){}),(function(e){v.cancelRecognition(v.privDialogRequestSession.sessionId,v.privDialogRequestSession.requestId,a.CancellationReason.Error,a.CancellationErrorCode.RuntimeError,e)})),s.PromiseHelper.fromResult(!0)}))}))}))}))},v.sendAudio=function(e){return v.privDialogAudioSource.format.onSuccessContinueWithPromise((function(t){var r=new s.Deferred,n=Date.now(),i=v.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),o=t.avgBytesPerSec/1e3*parseInt(i,10),a=v.privDialogRequestSession.recogNumber,c=function(){v.privDialogIsDisposed||v.privDialogRequestSession.isSpeechEnded||!v.privDialogRequestSession.isRecognizing||v.privDialogRequestSession.recogNumber!==a||v.fetchDialogConnection().on((function(i){e.read().on((function(e){var a,p;v.privDialogRequestSession.isSpeechEnded?r.resolve(!0):(!e||e.isEnd?(a=null,p=0):(a=e.buffer,v.privDialogRequestSession.onAudioSent(a.byteLength),p=o>=v.privDialogRequestSession.bytesSent?0:Math.max(0,n-Date.now())),setTimeout((function(){null!==a&&(n=Date.now()+1e3*a.byteLength/(2*t.avgBytesPerSec));var o=i.send(new h.SpeechConnectionMessage(s.MessageType.Binary,"audio",v.privDialogRequestSession.requestId,null,a));e&&!e.isEnd?o.continueWith((function(e){c()})):(v.privDialogRequestSession.onSpeechEnded(),r.resolve(!0))}),p))}),(function(e){v.privDialogRequestSession.isSpeechEnded?r.resolve(!0):r.reject(e)}))}),(function(e){r.reject(e)}))};return c(),r.promise()}))},v.receiveDialogMessageOverride=function(){var e=new s.Deferred;return v.fetchDialogConnection().on((function(t){return t.read().onSuccessContinueWithPromise((function(t){var r=v.isDisposed(),n=!v.isDisposed()&&v.terminateMessageLoop;if(r||n)return e.resolve(void 0),s.PromiseHelper.fromResult(void 0);if(!t)return v.receiveDialogMessageOverride();var i=h.SpeechConnectionMessage.fromConnectionMessage(t);switch(i.path.toLowerCase()){case"turn.start":var o=i.requestId.toUpperCase();o!==v.privDialogRequestSession.requestId.toUpperCase()?v.privTurnStateManager.StartTurn(o):v.privDialogRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":var c=p.SpeechDetected.fromJSON(i.textBody),u=new a.RecognitionEventArgs(c.Offset,v.privDialogRequestSession.sessionId);v.privRecognizer.speechStartDetected&&v.privRecognizer.speechStartDetected(v.privRecognizer,u);break;case"speech.enddetected":var l=void 0;l=i.textBody.length>0?i.textBody:"{ Offset: 0 }";var d=p.SpeechDetected.fromJSON(l);v.privDialogRequestSession.onServiceRecognized(d.Offset+v.privDialogRequestSession.currentTurnAudioOffset);var f=new a.RecognitionEventArgs(d.Offset+v.privDialogRequestSession.currentTurnAudioOffset,v.privDialogRequestSession.sessionId);v.privRecognizer.speechEndDetected&&v.privRecognizer.speechEndDetected(v.privRecognizer,f);break;case"turn.end":var g=i.requestId.toUpperCase();if(g!==v.privDialogRequestSession.requestId.toUpperCase())v.privTurnStateManager.CompleteTurn(g);else{var y=new a.SessionEventArgs(v.privDialogRequestSession.sessionId);if(v.privDialogRequestSession.onServiceTurnEndResponse(!1),v.privDialogRequestSession.isSpeechEnded&&v.privRecognizer.sessionStopped&&v.privRecognizer.sessionStopped(v.privRecognizer,y),v.privSuccessCallback&&v.privLastResult){try{v.privSuccessCallback(v.privLastResult),v.privLastResult=null}catch(e){v.privErrorCallback&&v.privErrorCallback(e)}v.privSuccessCallback=void 0,v.privErrorCallback=void 0}}break;default:v.processTypeSpecificMessages(i)||v.serviceEvents&&v.serviceEvents.onEvent(new s.ServiceEvent(i.path.toLowerCase(),i.textBody))}return v.receiveDialogMessageOverride()}))}),(function(t){return v.terminateMessageLoop=!0,e.resolve(void 0),s.PromiseHelper.fromResult(void 0)})),e.promise()},v.fetchDialogConnection=function(){return v.configConnection()},v.sendAgentConfig=function(e){if(v.agentConfig&&!v.agentConfigSent){if("custom_commands"===v.privRecognizerConfig.parameters.getProperty(a.PropertyId.Conversation_DialogType)){var t=v.agentConfig.get();t.botInfo.commandsCulture=v.privRecognizerConfig.parameters.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),v.agentConfig.set(t)}var r=v.agentConfig.toJsonString();return v.agentConfigSent=!0,e.send(new h.SpeechConnectionMessage(s.MessageType.Text,"agent.config",v.privDialogRequestSession.requestId,"application/json",r))}return s.PromiseHelper.fromResult(!0)},v.sendAgentContext=function(e){var t=s.createGuid(),r=v.privDialogServiceConnector.properties.getProperty(a.PropertyId.Conversation_Speech_Activity_Template),n={channelData:"",context:{interactionId:t},messagePayload:void 0===typeof r?void 0:r,version:.5},i=JSON.stringify(n);return e.send(new h.SpeechConnectionMessage(s.MessageType.Text,"speech.agent.context",v.privDialogRequestSession.requestId,"application/json",i))},v.privDialogServiceConnector=u,v.privDialogAuthentication=t,v.receiveMessageOverride=v.receiveDialogMessageOverride,v.privTurnStateManager=new c.DialogServiceTurnStateManager,v.recognizeOverride=v.listenOnce,v.connectImplOverride=v.dialogConnectImpl,v.configConnectionOverride=v.configConnection,v.fetchConnectionOverride=v.fetchDialogConnection,v.disconnectOverride=v.privDisconnect,v.privDialogAudioSource=n,v.privDialogRequestSession=new p.RequestSession(n.id()),v.privDialogConnectionFactory=r,v.privDialogIsDisposed=!1,v.agentConfigSent=!1,v.privLastResult=null,v}return i(t,e),t.prototype.isDisposed=function(){return this.privDialogIsDisposed},t.prototype.dispose=function(e){this.privDialogIsDisposed=!0,this.privConnectionConfigPromise&&this.privConnectionConfigPromise.onSuccessContinueWith((function(t){t.dispose(e)}))},t.prototype.privDisconnect=function(){this.cancelRecognition(this.privDialogRequestSession.sessionId,this.privDialogRequestSession.requestId,a.CancellationReason.Error,a.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1,this.privDialogConnectionPromise.result().isCompleted?this.privDialogConnectionPromise.result().isError||(this.privDialogConnectionPromise.result().result.dispose(),this.privDialogConnectionPromise=null):this.privDialogConnectionPromise.onSuccessContinueWith((function(e){e.dispose()}))},t.prototype.processTypeSpecificMessages=function(e){var t,r,n=new a.PropertyCollection;switch(e.messageType===s.MessageType.Text&&n.setProperty(a.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.phrase":var i=p.SimpleSpeechPhrase.fromJSON(e.textBody);if(this.privDialogRequestSession.onPhraseRecognized(this.privDialogRequestSession.currentTurnAudioOffset+i.Offset+i.Duration),i.RecognitionStatus===p.RecognitionStatus.Success){var o=this.fireEventForResult(i,n);if(this.privLastResult=o.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,o)}catch(e){}}r=!0;break;case"speech.hypothesis":var c=p.SpeechHypothesis.fromJSON(e.textBody),h=c.Offset+this.privDialogRequestSession.currentTurnAudioOffset;t=new a.SpeechRecognitionResult(this.privDialogRequestSession.requestId,a.ResultReason.RecognizingSpeech,c.Text,c.Duration,h,c.Language,c.LanguageDetectionConfidence,void 0,e.textBody,n),this.privDialogRequestSession.onHypothesis(h);var v=new a.SpeechRecognitionEventArgs(t,c.Duration,this.privDialogRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,v)}catch(e){}r=!0;break;case"audio":var l=e.requestId.toUpperCase(),d=this.privTurnStateManager.GetTurn(l);try{e.binaryBody?d.audioStream.write(e.binaryBody):d.endAudioStream()}catch(e){}r=!0;break;case"response":var f=e.requestId.toUpperCase(),g=u.ActivityPayloadResponse.fromJSON(e.textBody);d=this.privTurnStateManager.GetTurn(f);if(g.conversationId){var y=this.agentConfig.get();y.botInfo.conversationId=g.conversationId,this.agentConfig.set(y)}var m=d.processActivityPayload(g,a.SpeechSynthesisOutputFormat[this.privDialogServiceConnector.properties.getProperty(a.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]),S=new a.ActivityReceivedEventArgs(g.messagePayload,m);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,S)}catch(e){}r=!0}return r},t.prototype.cancelRecognition=function(e,t,r,n,i){if(this.terminateMessageLoop=!0,this.privDialogRequestSession.isRecognizing&&this.privDialogRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){var o=new a.PropertyCollection;o.setProperty(p.CancellationErrorCodePropertyName,a.CancellationErrorCode[n]);var s=new a.SpeechRecognitionCanceledEventArgs(r,i,n,void 0,e);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,s)}catch(e){}if(this.privSuccessCallback){var c=new a.SpeechRecognitionResult(void 0,a.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,i,void 0,o);try{this.privSuccessCallback(c),this.privSuccessCallback=void 0}catch(e){}}}},t.prototype.sendWaveHeader=function(e){var t=this;return this.audioSource.format.onSuccessContinueWithPromise((function(r){return e.send(new h.SpeechConnectionMessage(s.MessageType.Binary,"audio",t.privDialogRequestSession.requestId,"audio/x-wav",r.header))}))},t.prototype.dialogConnectImpl=function(e){var t=this;if(void 0===e&&(e=!1),this.privDialogConnectionPromise)return this.privDialogConnectionPromise.result().isCompleted&&(this.privDialogConnectionPromise.result().isError||this.privDialogConnectionPromise.result().result.state()===s.ConnectionState.Disconnected)?(this.agentConfigSent=!1,this.privDialogConnectionPromise=null,this.terminateMessageLoop=!0,this.configConnection()):this.privDialogConnectionPromise;this.privDialogAuthFetchEventId=s.createNoDashGuid(),void 0===this.privConnectionId&&(this.privConnectionId=s.createNoDashGuid()),this.privDialogRequestSession.onPreConnectionStart(this.privDialogAuthFetchEventId,this.privConnectionId);var r=e?this.privDialogAuthentication.fetchOnExpiry(this.privDialogAuthFetchEventId):this.privDialogAuthentication.fetch(this.privDialogAuthFetchEventId);return this.privDialogConnectionPromise=r.continueWithPromise((function(r){if(r.isError)throw t.privDialogRequestSession.onAuthCompleted(!0,r.error),new Error(r.error);t.privDialogRequestSession.onAuthCompleted(!1);var n=t.privDialogConnectionFactory.create(t.privRecognizerConfig,r.result,t.privConnectionId);return t.privDialogRequestSession.listenForServiceTelemetry(n.events),n.events.attach((function(e){t.connectionEvents.onEvent(e)})),n.open().onSuccessContinueWithPromise((function(r){return 200===r.statusCode?(t.privDialogRequestSession.onPreConnectionStart(t.privDialogAuthFetchEventId,t.privConnectionId),t.privDialogRequestSession.onConnectionEstablishCompleted(r.statusCode),s.PromiseHelper.fromResult(n)):403!==r.statusCode||e?(t.privDialogRequestSession.onConnectionEstablishCompleted(r.statusCode,r.reason),s.PromiseHelper.fromError("Unable to contact server. StatusCode: "+r.statusCode+", "+t.privRecognizerConfig.parameters.getProperty(a.PropertyId.SpeechServiceConnection_Endpoint)+" Reason: "+r.reason)):t.dialogConnectImpl(!0)}))})),this.privConnectionLoop=this.startMessageLoop(),this.privDialogConnectionPromise},t.prototype.startMessageLoop=function(){var e=this;return this.terminateMessageLoop=!1,this.receiveDialogMessageOverride().on((function(e){return!0}),(function(t){e.cancelRecognition(e.privDialogRequestSession.sessionId,e.privDialogRequestSession.requestId,a.CancellationReason.Error,a.CancellationErrorCode.RuntimeError,t)}))},t.prototype.configConnection=function(){var e=this;return this.privConnectionConfigPromise?this.privConnectionConfigPromise.result().isCompleted&&(this.privConnectionConfigPromise.result().isError||this.privConnectionConfigPromise.result().result.state()===s.ConnectionState.Disconnected)?(this.privConnectionConfigPromise=null,this.configConnection()):this.privConnectionConfigPromise:this.terminateMessageLoop?(this.terminateMessageLoop=!1,s.PromiseHelper.fromError("Connection to service terminated.")):(this.privConnectionConfigPromise=this.dialogConnectImpl().onSuccessContinueWithPromise((function(t){return e.sendSpeechServiceConfig(t,e.privDialogRequestSession,e.privRecognizerConfig.SpeechServiceConfig.serialize()).onSuccessContinueWithPromise((function(r){return e.sendAgentConfig(t).onSuccessContinueWith((function(e){return t}))}))})),this.privConnectionConfigPromise)},t.prototype.sendPreAudioMessages=function(){var e=this;this.fetchDialogConnection().onSuccessContinueWith((function(t){e.sendAgentContext(t),e.sendWaveHeader(t)}))},t.prototype.fireEventForResult=function(e,t){var r=p.EnumTranslation.implTranslateRecognitionResult(e.RecognitionStatus),n=e.Offset+this.privDialogRequestSession.currentTurnAudioOffset,i=new a.SpeechRecognitionResult(this.privDialogRequestSession.requestId,r,e.DisplayText,e.Duration,n,e.Language,e.LanguageDetectionConfidence,void 0,JSON.stringify(e),t);return new a.SpeechRecognitionEventArgs(i,n,this.privDialogRequestSession.sessionId)},t}(p.ServiceRecognizerBase);t.DialogServiceAdapter=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(29),i=r(355),o=function(){function e(){this.privTurnMap=new Map}return e.prototype.StartTurn=function(e){if(this.privTurnMap.has(e))throw new n.InvalidOperationError("Service error: There is already a turn with id:"+e);var t=new i.DialogServiceTurnState(this,e);return this.privTurnMap.set(e,t),this.privTurnMap.get(e)},e.prototype.GetTurn=function(e){return this.privTurnMap.get(e)},e.prototype.CompleteTurn=function(e){if(!this.privTurnMap.has(e))throw new n.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+e);var t=this.privTurnMap.get(e);return t.complete(),this.privTurnMap.delete(e),t},e}();t.DialogServiceTurnStateManager=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(75),i=r(53),o=r(164),s=function(){function e(e,t){this.privRequestId=t,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=e,this.resetTurnEndTimeout()}return Object.defineProperty(e.prototype,"audioStream",{get:function(){return this.resetTurnEndTimeout(),this.privAudioStream},enumerable:!0,configurable:!0}),e.prototype.processActivityPayload=function(e,t){return e.messageDataStreamType===o.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=i.AudioOutputStream.createPullStream(),this.privAudioStream.format=void 0!==t?t:n.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream},e.prototype.endAudioStream=function(){null===this.privAudioStream||this.privAudioStream.isClosed||this.privAudioStream.close()},e.prototype.complete=function(){void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.endAudioStream()},e.prototype.resetTurnEndTimeout=function(){var e=this;void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout((function(){e.privTurnManager.CompleteTurn(e.privRequestId)}),2e3)},e}();t.DialogServiceTurnState=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.toJsonString=function(){return JSON.stringify(this.iPrivConfig)},e.prototype.get=function(){return this.iPrivConfig},e.prototype.set=function(e){this.iPrivConfig=e},e}();t.AgentConfig=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(358);t.ConversationManager=n.ConversationManager;var i=r(359);t.ConversationTranslatorRecognizer=i.ConversationTranslatorRecognizer;var o=r(109);t.ConversationConnectionConfig=o.ConversationConnectionConfig;var s=r(167);t.ConversationReceivedTranslationEventArgs=s.ConversationReceivedTranslationEventArgs,t.LockRoomEventArgs=s.LockRoomEventArgs,t.MuteAllEventArgs=s.MuteAllEventArgs,t.ParticipantAttributeEventArgs=s.ParticipantAttributeEventArgs,t.ParticipantEventArgs=s.ParticipantEventArgs,t.ParticipantsListEventArgs=s.ParticipantsListEventArgs;var a=r(111);t.ConversationTranslatorCommandTypes=a.ConversationTranslatorCommandTypes,t.ConversationTranslatorMessageTypes=a.ConversationTranslatorMessageTypes,t.InternalParticipants=a.InternalParticipants},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(2),o=r(109),s=r(165),a=function(){function e(){this.privRequestParams=o.ConversationConnectionConfig.configParams,this.privErrors=o.ConversationConnectionConfig.restErrors,this.privHost=o.ConversationConnectionConfig.host,this.privApiVersion=o.ConversationConnectionConfig.apiVersion,this.privRestPath=o.ConversationConnectionConfig.restPath}return e.prototype.createOrJoin=function(e,t,r,a){var c=this;try{n.Contracts.throwIfNullOrUndefined(e,"args");var p=e.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,o.ConversationConnectionConfig.defaultLanguageCode),u=e.getProperty(i.PropertyId.ConversationTranslator_Name),h=e.getProperty(i.PropertyId.ConversationTranslator_Host,this.privHost),v=e.getProperty(i.PropertyId.ConversationTranslator_CorrelationId),l=e.getProperty(i.PropertyId.SpeechServiceConnection_Key),d=e.getProperty(i.PropertyId.SpeechServiceConnection_Region),f=e.getProperty(i.PropertyId.SpeechServiceAuthorization_Token);n.Contracts.throwIfNullOrWhitespace(p,"languageCode"),n.Contracts.throwIfNullOrWhitespace(u,"nickname"),n.Contracts.throwIfNullOrWhitespace(h,"endpointHost");var g={};g[this.privRequestParams.apiVersion]=this.privApiVersion,g[this.privRequestParams.languageCode]=p,g[this.privRequestParams.nickname]=u;var y={};v&&(y[this.privRequestParams.correlationId]=v),y[this.privRequestParams.clientAppId]=o.ConversationConnectionConfig.clientAppId,void 0!==t?g[this.privRequestParams.roomId]=t:(n.Contracts.throwIfNullOrUndefined(d,this.privErrors.authInvalidSubscriptionRegion),y[this.privRequestParams.subscriptionRegion]=d,l?y[this.privRequestParams.subscriptionKey]=l:f?y[this.privRequestParams.authorization]="Bearer "+f:n.Contracts.throwIfNullOrUndefined(l,this.privErrors.authInvalidSubscriptionKey));var m={};m.headers=y;var S="https://"+h+this.privRestPath;s.request("post",S,g,null,m,(function(e){var t=s.extractHeaderValue(c.privRequestParams.requestId,e.headers);if(e.ok){var n=JSON.parse(e.data);if(n&&(n.requestId=t),r){try{r(n)}catch(e){a&&a(e)}r=void 0}}else if(a){var i=c.privErrors.invalidCreateJoinConversationResponse.replace("{status}",e.status.toString()),o=void 0;try{i+=" ["+(o=JSON.parse(e.data)).error.code+": "+o.error.message+"]"}catch(t){i+=" ["+e.data+"]"}t&&(i+=" "+t),a(i)}}))}catch(e){if(a)if(e instanceof Error){var C=e;a(C.name+": "+C.message)}else a(e)}},e.prototype.leave=function(e,t,r,o){try{n.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","config")),n.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","token"));var a=e.getProperty(i.PropertyId.ConversationTranslator_Host,this.privHost),c=e.getProperty(i.PropertyId.ConversationTranslator_CorrelationId),p={};p[this.privRequestParams.apiVersion]=this.privApiVersion,p[this.privRequestParams.sessionToken]=t;var u={};c&&(u[this.privRequestParams.correlationId]=c);var h={};h.headers=u;var v="https://"+a+this.privRestPath;s.request("delete",v,p,null,h,(function(e){if(e.ok,r){try{r()}catch(e){o&&o(e)}r=void 0}}))}catch(e){if(o)if(e instanceof Error){var l=e;o(l.name+": "+l.message)}else o(e)}},e}();t.ConversationManager=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),s=r(10),a=r(2),c=r(360),p=r(362),u=r(111),h=r(165),v=function(e){function t(t,r){var n=this,i=t;return s.Contracts.throwIfNull(i,"speechConfig"),(n=e.call(this,r,i.properties,new c.ConversationConnectionFactory)||this).privIsDisposed=!1,n.privProperties=i.properties.clone(),n}return i(t,e),Object.defineProperty(t.prototype,"conversation",{set:function(e){this.privRoom=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{get:function(){return this.privSpeechRecognitionLanguage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),t.prototype.isDisposed=function(){return this.privIsDisposed},t.prototype.connect=function(e,t,r){try{s.Contracts.throwIfDisposed(this.privIsDisposed),s.Contracts.throwIfNullOrWhitespace(e,"token"),this.privReco.conversationTranslatorToken=e,this.privReco.connectAsync(t,r)}catch(e){if(r)if(e instanceof Error){var n=e;r(n.name+": "+n.message)}else r(e)}},t.prototype.disconnect=function(e,t){try{s.Contracts.throwIfDisposed(this.privIsDisposed),this.privRoom=void 0,this.privReco.disconnectAsync(e,t)}catch(e){if(t)if(e instanceof Error){var r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}},t.prototype.sendMessageRequest=function(e,t,r){try{s.Contracts.throwIfDisposed(this.privIsDisposed),s.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),s.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),s.Contracts.throwIfNullOrWhitespace(e,"message");var n={participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:u.ConversationTranslatorMessageTypes.instantMessage};this.sendMessage(JSON.stringify(n),t,r)}catch(e){if(r)if(e instanceof Error){var i=e;r(i.name+": "+i.message)}else r(e);this.dispose(!0)}},t.prototype.sendLockRequest=function(e,t,r){try{s.Contracts.throwIfDisposed(this.privIsDisposed),s.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),s.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),s.Contracts.throwIfNullOrUndefined(e,"isLocked");var n={command:u.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:u.ConversationTranslatorMessageTypes.participantCommand,value:e};this.sendMessage(JSON.stringify(n),t,r)}catch(e){if(r)if(e instanceof Error){var i=e;r(i.name+": "+i.message)}else r(e);this.dispose(!0)}},t.prototype.sendMuteAllRequest=function(e,t,r){try{s.Contracts.throwIfDisposed(this.privIsDisposed),s.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),s.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),s.Contracts.throwIfNullOrUndefined(e,"isMuted");var n={command:u.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:u.ConversationTranslatorMessageTypes.participantCommand,value:e};this.sendMessage(JSON.stringify(n),t,r)}catch(e){if(r)if(e instanceof Error){var i=e;r(i.name+": "+i.message)}else r(e);this.dispose(!0)}},t.prototype.sendMuteRequest=function(e,t,r,n){try{s.Contracts.throwIfDisposed(this.privIsDisposed),s.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),s.Contracts.throwIfNullOrWhitespace(e,"participantId"),s.Contracts.throwIfNullOrUndefined(t,"isMuted");var i={command:u.ConversationTranslatorCommandTypes.setMute,participantId:e,roomid:this.privRoom.roomId,type:u.ConversationTranslatorMessageTypes.participantCommand,value:t};this.sendMessage(JSON.stringify(i),r,n)}catch(e){if(n)if(e instanceof Error){var o=e;n(o.name+": "+o.message)}else n(e);this.dispose(!0)}},t.prototype.sendEjectRequest=function(e,t,r){try{s.Contracts.throwIfDisposed(this.privIsDisposed),s.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),s.Contracts.throwIfNullOrWhitespace(e,"participantId");var n={command:u.ConversationTranslatorCommandTypes.ejectParticipant,participantId:e,roomid:this.privRoom.roomId,type:u.ConversationTranslatorMessageTypes.participantCommand};if(this.sendMessage(JSON.stringify(n),t,r),t)try{t()}catch(e){r&&r(e)}}catch(e){if(r)if(e instanceof Error){var i=e;r(i.name+": "+i.message)}else r(e);this.dispose(!0)}},t.prototype.sendChangeNicknameRequest=function(e,t,r){try{s.Contracts.throwIfDisposed(this.privIsDisposed),s.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),s.Contracts.throwIfNullOrWhitespace(e,"nickname");var n={command:u.ConversationTranslatorCommandTypes.changeNickname,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:u.ConversationTranslatorMessageTypes.participantCommand,value:e};this.sendMessage(JSON.stringify(n),t,r)}catch(e){if(r)if(e instanceof Error){var i=e;r(i.name+": "+i.message)}else r(e);this.dispose(!0)}},t.prototype.close=function(){s.Contracts.throwIfDisposed(this.privIsDisposed),this.dispose(!0)},t.prototype.dispose=function(t){this.privIsDisposed||t&&(this.privIsDisposed=!0,e.prototype.dispose.call(this,t))},t.prototype.createRecognizerConfig=function(e){return new o.RecognizerConfig(e,this.privProperties)},t.prototype.createServiceRecognizer=function(e,t,r,n){var i=r;return new p.ConversationServiceAdapter(e,t,i,n,this)},t.prototype.sendMessage=function(e,t,r){var n=this.privReco;h.PromiseToEmptyCallback(n.sendMessageAsync(e),t,r)},t}(a.Recognizer);t.ConversationTranslatorRecognizer=v},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(28),s=r(6),a=r(10),c=r(2),p=r(64),u=r(109),h=r(361),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.create=function(e,t,r){var n=e.parameters.getProperty(c.PropertyId.ConversationTranslator_Host,u.ConversationConnectionConfig.host),i=e.parameters.getProperty(c.PropertyId.ConversationTranslator_CorrelationId,s.createGuid()),p="wss://"+n+u.ConversationConnectionConfig.webSocketPath,v=e.parameters.getProperty(c.PropertyId.ConversationTranslator_Token,void 0);a.Contracts.throwIfNullOrUndefined(v,"token");var l={};return l[u.ConversationConnectionConfig.configParams.apiVersion]=u.ConversationConnectionConfig.apiVersion,l[u.ConversationConnectionConfig.configParams.token]=v,l[u.ConversationConnectionConfig.configParams.correlationId]=i,new o.WebsocketConnection(p,l,{},new h.ConversationWebsocketMessageFormatter,o.ProxyInfo.fromRecognizerConfig(e),r)},t}(p.ConnectionFactoryBase);t.ConversationConnectionFactory=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(166),o=function(){this.toConnectionMessage=function(e){var t=new n.Deferred;try{if(e.messageType===n.MessageType.Text){var r=new i.ConversationConnectionMessage(e.messageType,e.textContent,{},e.id);t.resolve(r)}else e.messageType===n.MessageType.Binary&&t.resolve(new i.ConversationConnectionMessage(e.messageType,e.binaryContent,void 0,e.id))}catch(e){t.reject("Error formatting the message. Error: "+e)}return t.promise()},this.fromConnectionMessage=function(e){var t=new n.Deferred;try{if(e.messageType===n.MessageType.Text){var r=""+(e.textBody?e.textBody:"");t.resolve(new n.RawWebsocketMessage(n.MessageType.Text,r,e.id))}}catch(e){t.reject("Error formatting the message. "+e)}return t.promise()}};t.ConversationWebsocketMessageFormatter=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),s=r(101),a=r(2),c=r(5),p=r(166),u=r(363),h=r(167),v=r(111),l=r(364),d=function(e){function t(t,r,n,i,c){var d=e.call(this,t,r,n,i,c)||this;return d.privLastPartialUtteranceId="",d.sendMessageAsync=function(e){var t=new s.Sink;return d.fetchConversationConnection().continueWith((function(r){try{r.isError?t.reject(r.error):r.result.send(new p.ConversationConnectionMessage(o.MessageType.Text,e)).continueWith((function(e){try{e.isError?t.reject(e.error):t.resolve(e.result)}catch(e){t.reject("Unhandled inner error: "+e)}}))}catch(e){t.reject("Unhandled error: "+e)}})),new o.Promise(t)},d.noOp=function(){},d.receiveConversationMessageOverride=function(e,t){var r=new o.Deferred;return d.fetchConversationConnection().on((function(e){return e.read().onSuccessContinueWithPromise((function(e){var t=d.isDisposed(),n=!d.isDisposed()&&d.terminateMessageLoop,i=d.privConversationRequestSession.sessionId,s=!1;if(t||n)return r.resolve(void 0),o.PromiseHelper.fromResult(void 0);if(!e)return d.receiveConversationMessageOverride();try{switch(e.conversationMessageType.toLowerCase()){case"info":case"participant_command":case"command":var c=l.CommandResponsePayload.fromJSON(e.textBody);switch(c.command.toLowerCase()){case"participantlist":var p=l.ParticipantsListPayloadResponse.fromJSON(e.textBody),u=p.participants.map((function(e){return{avatar:e.avatar,displayName:e.nickname,id:e.participantId,isHost:e.ishost,isMuted:e.ismuted,isUsingTts:e.usetts,preferredLanguage:e.locale}}));d.privConversationServiceConnector.participantsListReceived&&d.privConversationServiceConnector.participantsListReceived(d.privConversationServiceConnector,new h.ParticipantsListEventArgs(p.roomid,p.token,p.translateTo,p.profanityFilter,p.roomProfanityFilter,p.roomLocked,p.muteAll,u,i));break;case"settranslatetolanguages":d.privConversationServiceConnector.participantUpdateCommandReceived&&d.privConversationServiceConnector.participantUpdateCommandReceived(d.privConversationServiceConnector,new h.ParticipantAttributeEventArgs(c.participantId,v.ConversationTranslatorCommandTypes.setTranslateToLanguages,c.value,i));break;case"setprofanityfiltering":d.privConversationServiceConnector.participantUpdateCommandReceived&&d.privConversationServiceConnector.participantUpdateCommandReceived(d.privConversationServiceConnector,new h.ParticipantAttributeEventArgs(c.participantId,v.ConversationTranslatorCommandTypes.setProfanityFiltering,c.value,i));break;case"setmute":d.privConversationServiceConnector.participantUpdateCommandReceived&&d.privConversationServiceConnector.participantUpdateCommandReceived(d.privConversationServiceConnector,new h.ParticipantAttributeEventArgs(c.participantId,v.ConversationTranslatorCommandTypes.setMute,c.value,i));break;case"setmuteall":d.privConversationServiceConnector.muteAllCommandReceived&&d.privConversationServiceConnector.muteAllCommandReceived(d.privConversationServiceConnector,new h.MuteAllEventArgs(c.value,i));break;case"roomexpirationwarning":d.privConversationServiceConnector.conversationExpiration&&d.privConversationServiceConnector.conversationExpiration(d.privConversationServiceConnector,new a.ConversationExpirationEventArgs(c.value,d.privConversationRequestSession.sessionId));break;case"setusetts":d.privConversationServiceConnector.participantUpdateCommandReceived&&d.privConversationServiceConnector.participantUpdateCommandReceived(d.privConversationServiceConnector,new h.ParticipantAttributeEventArgs(c.participantId,v.ConversationTranslatorCommandTypes.setUseTTS,c.value,i));break;case"setlockstate":d.privConversationServiceConnector.lockRoomCommandReceived&&d.privConversationServiceConnector.lockRoomCommandReceived(d.privConversationServiceConnector,new h.LockRoomEventArgs(c.value,i));break;case"changenickname":d.privConversationServiceConnector.participantUpdateCommandReceived&&d.privConversationServiceConnector.participantUpdateCommandReceived(d.privConversationServiceConnector,new h.ParticipantAttributeEventArgs(c.participantId,v.ConversationTranslatorCommandTypes.changeNickname,c.nickname,i));break;case"joinsession":var f=l.ParticipantPayloadResponse.fromJSON(e.textBody),g={avatar:f.avatar,displayName:f.nickname,id:f.participantId,isHost:f.ishost,isMuted:f.ismuted,isUsingTts:f.usetts,preferredLanguage:f.locale};d.privConversationServiceConnector.participantJoinCommandReceived&&d.privConversationServiceConnector.participantJoinCommandReceived(d.privConversationServiceConnector,new h.ParticipantEventArgs(g,i));break;case"leavesession":var y={id:c.participantId};d.privConversationServiceConnector.participantLeaveCommandReceived&&d.privConversationServiceConnector.participantLeaveCommandReceived(d.privConversationServiceConnector,new h.ParticipantEventArgs(y,i));break;case"disconnectsession":c.participantId}break;case"partial":case"final":var m=l.SpeechResponsePayload.fromJSON(e.textBody),S=new a.ConversationTranslationResult(m.participantId,d.getTranslations(m.translations),m.language,void 0,void 0,m.recognition,void 0,void 0,e.textBody,void 0);m.isFinal?((void 0!==S.text&&S.text.length>0||m.id===d.privLastPartialUtteranceId)&&(s=!0),s&&d.privConversationServiceConnector.translationReceived&&d.privConversationServiceConnector.translationReceived(d.privConversationServiceConnector,new h.ConversationReceivedTranslationEventArgs(v.ConversationTranslatorMessageTypes.final,S,i))):void 0!==S.text&&(d.privLastPartialUtteranceId=m.id,d.privConversationServiceConnector.translationReceived&&d.privConversationServiceConnector.translationReceived(d.privConversationServiceConnector,new h.ConversationReceivedTranslationEventArgs(v.ConversationTranslatorMessageTypes.partial,S,i)));break;case"translated_message":var C=l.TextResponsePayload.fromJSON(e.textBody),b=new a.ConversationTranslationResult(C.participantId,d.getTranslations(C.translations),C.language,void 0,void 0,C.originalText,void 0,void 0,void 0,e.textBody,void 0);d.privConversationServiceConnector.translationReceived&&d.privConversationServiceConnector.translationReceived(d.privConversationServiceConnector,new h.ConversationReceivedTranslationEventArgs(v.ConversationTranslatorMessageTypes.instantMessage,b,i))}}catch(e){}return d.receiveConversationMessageOverride()}))}),(function(e){d.terminateMessageLoop=!0})),r.promise()},d.fetchConversationConnection=function(){return d.configConnection()},d.privConversationServiceConnector=c,d.privConversationAuthentication=t,d.receiveMessageOverride=d.receiveConversationMessageOverride,d.recognizeOverride=d.noOp,d.connectImplOverride=d.conversationConnectImpl,d.configConnectionOverride=d.configConnection,d.fetchConnectionOverride=d.fetchConversationConnection,d.disconnectOverride=d.privDisconnect,d.privConversationRequestSession=new u.ConversationRequestSession(o.createNoDashGuid()),d.privConversationConnectionFactory=r,d.privConversationIsDisposed=!1,d}return i(t,e),t.prototype.isDisposed=function(){return this.privConversationIsDisposed},t.prototype.dispose=function(e){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise&&this.privConnectionConfigPromise.onSuccessContinueWith((function(t){t.dispose(e)}))},t.prototype.sendMessage=function(e){this.fetchConversationConnection().onSuccessContinueWith((function(t){t.send(new p.ConversationConnectionMessage(o.MessageType.Text,e))}))},t.prototype.privDisconnect=function(){this.terminateMessageLoop||(this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,a.CancellationReason.Error,a.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.privConversationConnectionPromise.result().isCompleted?this.privConversationConnectionPromise.result().isError||(this.privConversationConnectionPromise.result().result.dispose(),this.privConversationConnectionPromise=null):this.privConversationConnectionPromise.onSuccessContinueWith((function(e){e.dispose()})))},t.prototype.processTypeSpecificMessages=function(e,t,r){return!0},t.prototype.cancelRecognition=function(e,t,r,n,i){this.terminateMessageLoop=!0;var o=new a.ConversationTranslationCanceledEventArgs(r,i,n,void 0,e);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,o)}catch(e){}},t.prototype.conversationConnectImpl=function(e){var t=this;if(void 0===e&&(e=!1),this.privConversationConnectionPromise)return this.privConversationConnectionPromise.result().isCompleted&&(this.privConversationConnectionPromise.result().isError||this.privConversationConnectionPromise.result().result.state()===o.ConnectionState.Disconnected)?(this.privConnectionId=null,this.privConversationConnectionPromise=null,this.terminateMessageLoop=!0,this.conversationConnectImpl()):this.privConversationConnectionPromise;this.privConversationAuthFetchEventId=o.createNoDashGuid(),void 0===this.privConnectionId&&(this.privConnectionId=o.createNoDashGuid()),this.privConversationRequestSession.onPreConnectionStart(this.privConversationAuthFetchEventId,this.privConnectionId);var r=e?this.privConversationAuthentication.fetchOnExpiry(this.privConversationAuthFetchEventId):this.privConversationAuthentication.fetch(this.privConversationAuthFetchEventId);return this.privConversationConnectionPromise=r.continueWithPromise((function(r){if(r.isError)throw t.privConversationRequestSession.onAuthCompleted(!0,r.error),new Error(r.error);t.privConversationRequestSession.onAuthCompleted(!1);var n=t.privConversationConnectionFactory.create(t.privRecognizerConfig,r.result,t.privConnectionId);return n.events.attach((function(e){t.connectionEvents.onEvent(e)})),n.open().onSuccessContinueWithPromise((function(r){if(200===r.statusCode){t.privConversationRequestSession.onPreConnectionStart(t.privConversationAuthFetchEventId,t.privConnectionId),t.privConversationRequestSession.onConnectionEstablishCompleted(r.statusCode);var i=new a.SessionEventArgs(t.privConversationRequestSession.sessionId);return t.privConversationServiceConnector.connectionOpened&&t.privConversationServiceConnector.connectionOpened(t.privConversationServiceConnector,i),o.PromiseHelper.fromResult(n)}return 403!==r.statusCode||e?(t.privConversationRequestSession.onConnectionEstablishCompleted(r.statusCode,r.reason),o.PromiseHelper.fromError("Unable to contact server. StatusCode: "+r.statusCode+", "+t.privRecognizerConfig.parameters.getProperty(a.PropertyId.SpeechServiceConnection_Endpoint)+" Reason: "+r.reason)):t.conversationConnectImpl(!0)}))})),this.privConnectionLoop=this.startMessageLoop(),this.privConversationConnectionPromise},t.prototype.startMessageLoop=function(){var e=this;return this.terminateMessageLoop=!1,this.receiveConversationMessageOverride().on((function(e){return!0}),(function(t){e.cancelRecognition(e.privRequestSession?e.privRequestSession.sessionId:"",e.privRequestSession?e.privRequestSession.requestId:"",a.CancellationReason.Error,a.CancellationErrorCode.RuntimeError,t)}))},t.prototype.configConnection=function(){return this.privConnectionConfigPromise?this.privConnectionConfigPromise.result().isCompleted&&(this.privConnectionConfigPromise.result().isError||this.privConnectionConfigPromise.result().result.state()===o.ConnectionState.Disconnected)?(this.privConnectionConfigPromise=null,this.configConnection()):this.privConnectionConfigPromise:this.terminateMessageLoop?o.PromiseHelper.fromResult(void 0):(this.privConnectionConfigPromise=this.conversationConnectImpl().onSuccessContinueWith((function(e){return e})),this.privConnectionConfigPromise)},t.prototype.getTranslations=function(e){var t;if(void 0!==e){t=new a.Translations;for(var r=0,n=e;r<n.length;r++){var i=n[r];t.set(i.lang,i.translation)}}return t},t}(c.ServiceRecognizerBase);t.ConversationServiceAdapter=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=function(){function e(e){var t=this;this.privIsDisposed=!1,this.privDetachables=new Array,this.onPreConnectionStart=function(e,r){t.privSessionId=r},this.onAuthCompleted=function(e,r){e&&t.onComplete()},this.onConnectionEstablishCompleted=function(e,r){200!==e&&403===e&&t.onComplete()},this.onServiceTurnEndResponse=function(e){e?t.privRequestId=n.createNoDashGuid():t.onComplete()},this.dispose=function(e){if(!t.privIsDisposed){t.privIsDisposed=!0;for(var r=0,n=t.privDetachables;r<n.length;r++){n[r].detach()}}},this.onComplete=function(){},this.privSessionId=e,this.privRequestId=n.createNoDashGuid(),this.privRequestCompletionDeferral=new n.Deferred}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"completionPromise",{get:function(){return this.privRequestCompletionDeferral.promise()},enumerable:!0,configurable:!0}),e}();t.ConversationRequestSession=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(365);t.CommandResponsePayload=n.CommandResponsePayload;var i=r(366);t.ParticipantsListPayloadResponse=i.ParticipantsListPayloadResponse,t.ParticipantPayloadResponse=i.ParticipantPayloadResponse;var o=r(367);t.SpeechResponsePayload=o.SpeechResponsePayload,t.TextResponsePayload=o.TextResponsePayload},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privCommandResponse=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"type",{get:function(){return this.privCommandResponse.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"command",{get:function(){return this.privCommandResponse.command},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privCommandResponse.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nickname",{get:function(){return this.privCommandResponse.nickname},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"participantId",{get:function(){return this.privCommandResponse.participantId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roomid",{get:function(){return this.privCommandResponse.roomid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.privCommandResponse.value},enumerable:!0,configurable:!0}),e}();t.CommandResponsePayload=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privParticipantsPayloadResponse=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"roomid",{get:function(){return this.privParticipantsPayloadResponse.roomid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privParticipantsPayloadResponse.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"command",{get:function(){return this.privParticipantsPayloadResponse.command},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"participants",{get:function(){return this.privParticipantsPayloadResponse.participants},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"token",{get:function(){return this.privParticipantsPayloadResponse.token},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"translateTo",{get:function(){return this.privParticipantsPayloadResponse.translateTo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profanityFilter",{get:function(){return this.privParticipantsPayloadResponse.profanityFilter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roomProfanityFilter",{get:function(){return this.privParticipantsPayloadResponse.roomProfanityFilter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roomLocked",{get:function(){return this.privParticipantsPayloadResponse.roomLocked},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muteAll",{get:function(){return this.privParticipantsPayloadResponse.muteAll},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.privParticipantsPayloadResponse.type},enumerable:!0,configurable:!0}),e}();t.ParticipantsListPayloadResponse=n;var i=function(){function e(e){this.privParticipantPayloadResponse=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"nickname",{get:function(){return this.privParticipantPayloadResponse.nickname},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"locale",{get:function(){return this.privParticipantPayloadResponse.locale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"usetts",{get:function(){return this.privParticipantPayloadResponse.usetts},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ismuted",{get:function(){return this.privParticipantPayloadResponse.ismuted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ishost",{get:function(){return this.privParticipantPayloadResponse.ishost},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"participantId",{get:function(){return this.privParticipantPayloadResponse.participantId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatar",{get:function(){return this.privParticipantPayloadResponse.avatar},enumerable:!0,configurable:!0}),e}();t.ParticipantPayloadResponse=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privSpeechResponse=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"recognition",{get:function(){return this.privSpeechResponse.recognition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"translations",{get:function(){return this.privSpeechResponse.translations},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privSpeechResponse.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"language",{get:function(){return this.privSpeechResponse.language},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nickname",{get:function(){return this.privSpeechResponse.nickname},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"participantId",{get:function(){return this.privSpeechResponse.participantId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roomid",{get:function(){return this.privSpeechResponse.roomid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestamp",{get:function(){return this.privSpeechResponse.timestamp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.privSpeechResponse.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFinal",{get:function(){return"final"===this.privSpeechResponse.type},enumerable:!0,configurable:!0}),e}();t.SpeechResponsePayload=n;var i=function(){function e(e){this.privTextResponse=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"originalText",{get:function(){return this.privTextResponse.originalText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"translations",{get:function(){return this.privTextResponse.translations},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privTextResponse.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"language",{get:function(){return this.privTextResponse.language},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nickname",{get:function(){return this.privTextResponse.nickname},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"participantId",{get:function(){return this.privTextResponse.participantId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roomid",{get:function(){return this.privTextResponse.roomid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestamp",{get:function(){return this.privTextResponse.timestamp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.privTextResponse.type},enumerable:!0,configurable:!0}),e}();t.TextResponsePayload=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privSynthesisAudioMetadata=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"Metadata",{get:function(){return this.privSynthesisAudioMetadata.Metadata},enumerable:!0,configurable:!0}),e}();t.SynthesisAudioMetadata=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(53),o=r(168),s=r(370),a=function(){function e(){var e=this;this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.onPreConnectionStart=function(t,r){e.privAuthFetchEventId=t,e.onEvent(new s.ConnectingToSynthesisServiceEvent(e.privRequestId,e.privAuthFetchEventId))},this.onAuthCompleted=function(t,r){t&&e.onComplete()},this.onConnectionEstablishCompleted=function(t,r){if(200===t)return e.onEvent(new s.SynthesisStartedEvent(e.requestId,e.privAuthFetchEventId)),void(e.privBytesReceived=0);403===t&&e.onComplete()},this.onServiceResponseMessage=function(t){var r=JSON.parse(t);e.streamId=r.audio.streamId},this.onServiceTurnEndResponse=function(){e.privTurnDeferral.resolve(!0),e.onComplete()},this.onServiceTurnStartResponse=function(){e.privTurnDeferral.state()===n.PromiseState.None&&e.privTurnDeferral.reject("Another turn started before current completed."),e.privTurnDeferral=new n.Deferred},this.dispose=function(t){e.privIsDisposed||(e.privIsDisposed=!0)},this.onEvent=function(e){n.Events.instance.onEvent(e)},this.onComplete=function(){e.privIsSynthesizing&&(e.privIsSynthesizing=!1,e.privIsSynthesisEnded=!0,e.privAudioOutputStream.close(),void 0!==e.privTurnAudioDestination&&(e.privTurnAudioDestination.close(),e.privTurnAudioDestination=void 0))},this.privRequestId=n.createNoDashGuid(),this.privTurnDeferral=new n.Deferred,this.privTurnDeferral.resolve(!0)}return Object.defineProperty(e.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"streamId",{get:function(){return this.privStreamId},set:function(e){this.privStreamId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioOutputFormat",{get:function(){return this.privAudioOutputFormat},set:function(e){this.privAudioOutputFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"turnCompletionPromise",{get:function(){return this.privTurnDeferral.promise()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSynthesisEnded",{get:function(){return this.privIsSynthesisEnded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSynthesizing",{get:function(){return this.privIsSynthesizing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTextOffset",{get:function(){return this.privTextOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesReceived",{get:function(){return this.privBytesReceived},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allReceivedAudio",{get:function(){return this.privReceivedAudio?this.privReceivedAudio:this.privIsSynthesisEnded?(this.readAllAudioFromStream(),this.allReceivedAudio):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allReceivedAudioWithHeader",{get:function(){return this.privReceivedAudioWithHeader?this.privReceivedAudioWithHeader:this.privIsSynthesisEnded?this.audioOutputFormat.hasHeader?(this.privReceivedAudioWithHeader=o.SynthesisAdapterBase.addHeader(this.allReceivedAudio,this.audioOutputFormat),this.allReceivedAudioWithHeader):this.allReceivedAudio:null},enumerable:!0,configurable:!0}),e.prototype.startNewSynthesis=function(e,t,r,n){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=e,this.privRawText=t,this.privIsSSML=r,this.privAudioOutputStream=new i.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,void 0!==n&&(this.privTurnAudioDestination=n,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new s.SynthesisTriggeredEvent(this.requestId,void 0,void 0===n?void 0:n.id()))},e.prototype.onAudioChunkReceived=function(e){this.isSynthesizing&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength,void 0!==this.privTurnAudioDestination&&this.privTurnAudioDestination.write(e))},e.prototype.onWordBoundaryEvent=function(e){this.updateTextOffset(e)},e.prototype.onStopSynthesizing=function(){this.onComplete()},e.prototype.updateTextOffset=function(e){this.privTextOffset>=0&&(this.privTextOffset=this.privRawText.indexOf(e,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+e.length),this.privIsSSML&&this.privRawText.indexOf("<",this.privTextOffset+1)>this.privRawText.indexOf(">",this.privTextOffset+1)&&this.updateTextOffset(e))},e.prototype.readAllAudioFromStream=function(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{this.privAudioOutputStream.read(this.privReceivedAudio)}catch(e){this.privReceivedAudio=new ArrayBuffer(0)}}},e}();t.SynthesisTurn=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),s=function(e){function t(t,r,n){void 0===n&&(n=o.EventType.Info);var i=e.call(this,t,n)||this;return i.privRequestId=r,i}return i(t,e),Object.defineProperty(t.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!0,configurable:!0}),t}(o.PlatformEvent);t.SpeechSynthesisEvent=s;var a=function(e){function t(t,r,n){var i=e.call(this,"SynthesisTriggeredEvent",t)||this;return i.privSessionAudioDestinationId=r,i.privTurnAudioDestinationId=n,i}return i(t,e),Object.defineProperty(t.prototype,"audioSessionDestinationId",{get:function(){return this.privSessionAudioDestinationId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTurnDestinationId",{get:function(){return this.privTurnAudioDestinationId},enumerable:!0,configurable:!0}),t}(s);t.SynthesisTriggeredEvent=a;var c=function(e){function t(t,r){var n=e.call(this,"ConnectingToSynthesisServiceEvent",t)||this;return n.privAuthFetchEventId=r,n}return i(t,e),Object.defineProperty(t.prototype,"authFetchEventId",{get:function(){return this.privAuthFetchEventId},enumerable:!0,configurable:!0}),t}(s);t.ConnectingToSynthesisServiceEvent=c;var p=function(e){function t(t,r){var n=e.call(this,"SynthesisStartedEvent",t)||this;return n.privAuthFetchEventId=r,n}return i(t,e),Object.defineProperty(t.prototype,"authFetchEventId",{get:function(){return this.privAuthFetchEventId},enumerable:!0,configurable:!0}),t}(s);t.SynthesisStartedEvent=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(5);!function(e){e[e.Standard=0]="Standard",e[e.Custom=1]="Custom"}(n=t.SynthesisServiceType||(t.SynthesisServiceType={}));var o=function(){function e(e,t){this.privSynthesisServiceType=n.Standard,this.privSpeechServiceConfig=e||new i.SpeechServiceConfig(new i.Context(null)),this.privParameters=t}return Object.defineProperty(e.prototype,"parameters",{get:function(){return this.privParameters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"synthesisServiceType",{get:function(){return this.privSynthesisServiceType},set:function(e){this.privSynthesisServiceType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SpeechServiceConfig",{get:function(){return this.privSpeechServiceConfig},enumerable:!0,configurable:!0}),e}();t.SynthesizerConfig=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privContext={},this.privSpeechSynthesizer=e}return e.prototype.setSection=function(e,t){this.privContext[e]=t},Object.defineProperty(e.prototype,"audioOutputFormat",{set:function(e){this.privAudioOutputFormat=e},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){var e=this.buildSynthesisContext();return this.setSection("synthesis",e),JSON.stringify(this.privContext)},e.prototype.buildSynthesisContext=function(){return{audio:{metadataOptions:{sentenceBoundaryEnabled:!1,wordBoundaryEnabled:!!this.privSpeechSynthesizer.wordBoundary},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:this.privSpeechSynthesizer.autoDetectSourceLanguage}}},e}();t.SynthesisContext=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=function(){function e(e,t){this.privContext=e||new n.Context(null),this.privParameters=t}return Object.defineProperty(e.prototype,"parameters",{get:function(){return this.privParameters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Context",{get:function(){return this.privContext},enumerable:!0,configurable:!0}),e}();t.SpeakerRecognitionConfig=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(28),i=r(6),o=r(2),s=function(){function e(e){var t=e.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!t){var r=e.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Region,"westus"),i=r&&r.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com";t=e.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Host,"https://"+r+".api.cognitive"+i+"/speaker/{mode}/v2.0/{dependency}")+"/profiles"}this.privUri=t;var s=n.RestConfigBase.requestOptions;s.headers[n.RestConfigBase.configParams.subscriptionKey]=e.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Key,void 0),this.privRestAdapter=new n.RestMessageAdapter(s)}return e.prototype.createProfile=function(e,t){var r=this.getOperationUri(e);return this.privRestAdapter.setHeaders(n.RestConfigBase.configParams.contentTypeKey,"application/json"),this.privRestAdapter.request(n.RestRequestType.Post,r,{},{locale:t})},e.prototype.createEnrollment=function(e,t){var r=this;this.privRestAdapter.setHeaders(n.RestConfigBase.configParams.contentTypeKey,"multipart/form-data");var i=this.getOperationUri(e.profileType)+"/"+e.profileId+"/enrollments";return t.blob.onSuccessContinueWithPromise((function(e){return r.privRestAdapter.request(n.RestRequestType.File,i,{ignoreMinLength:"true"},null,e)}))},e.prototype.verifySpeaker=function(e,t){var r=this;this.privRestAdapter.setHeaders(n.RestConfigBase.configParams.contentTypeKey,"multipart/form-data");var o=this.getOperationUri(e.voiceProfile.profileType)+"/"+e.voiceProfile.profileId+"/verify";return t.blob.continueWithPromise((function(e){if(e.isError){var t=new i.Deferred;return t.resolve({data:e.error}),t.promise()}return r.privRestAdapter.request(n.RestRequestType.File,o,{ignoreMinLength:"true"},null,e.result)}))},e.prototype.identifySpeaker=function(e,t){var r=this;this.privRestAdapter.setHeaders(n.RestConfigBase.configParams.contentTypeKey,"multipart/form-data");var s=this.getOperationUri(o.VoiceProfileType.TextIndependentIdentification)+"/identifySingleSpeaker";return t.blob.continueWithPromise((function(t){if(t.isError){var o=new i.Deferred;return o.resolve({data:t.error}),o.promise()}return r.privRestAdapter.request(n.RestRequestType.File,s,{profileIds:e.voiceProfileIds,ignoreMinLength:"true"},null,t.result)}))},e.prototype.deleteProfile=function(e){var t=this.getOperationUri(e.profileType)+"/"+e.profileId;return this.privRestAdapter.request(n.RestRequestType.Delete,t,{})},e.prototype.resetProfile=function(e){var t=this.getOperationUri(e.profileType)+"/"+e.profileId+"/reset";return this.privRestAdapter.request(n.RestRequestType.Post,t,{})},e.prototype.getOperationUri=function(e){var t=e===o.VoiceProfileType.TextIndependentIdentification?"identification":"verification",r=e===o.VoiceProfileType.TextDependentVerification?"text-dependent":"text-independent";return this.privUri.replace("{mode}",t).replace("{dependency}",r)},e}();t.SpeakerIdMessageAdapter=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(6),o=r(63),s=function(){function e(e,t){var r=this;this.privStreams={},this.turnOn=function(){if("undefined"==typeof FileReader){var e="Browser does not support FileReader.";return r.onEvent(new i.AudioSourceErrorEvent(e,"")),i.PromiseHelper.fromError(e)}if(r.privFile.name.lastIndexOf(".wav")!==r.privFile.name.length-4){e=r.privFile.name+" is not supported. Only WAVE files are allowed at the moment.";return r.onEvent(new i.AudioSourceErrorEvent(e,"")),i.PromiseHelper.fromError(e)}return r.onEvent(new i.AudioSourceInitializingEvent(r.privId)),r.onEvent(new i.AudioSourceReadyEvent(r.privId)),i.PromiseHelper.fromResult(!0)},this.id=function(){return r.privId},this.attach=function(e){return r.onEvent(new i.AudioStreamNodeAttachingEvent(r.privId,e)),r.upload(e).onSuccessContinueWith((function(t){return r.onEvent(new i.AudioStreamNodeAttachedEvent(r.privId,e)),{detach:function(){t.readEnded(),delete r.privStreams[e],r.onEvent(new i.AudioStreamNodeDetachedEvent(r.privId,e)),r.turnOff()},id:function(){return e},read:function(){return t.read()}}}))},this.detach=function(e){e&&r.privStreams[e]&&(r.privStreams[e].close(),delete r.privStreams[e],r.onEvent(new i.AudioStreamNodeDetachedEvent(r.privId,e)))},this.turnOff=function(){for(var e in r.privStreams)if(e){var t=r.privStreams[e];t&&!t.isClosed&&t.close()}return r.onEvent(new i.AudioSourceOffEvent(r.privId)),i.PromiseHelper.fromResult(!0)},this.readHeader=function(){var e=r.privFile.slice(0,44),t=new FileReader,n=new i.Deferred;return t.onload=function(e){var t=e.target.result,r=new DataView(t);"RIFF"!==String.fromCharCode(r.getUint8(0),r.getUint8(1),r.getUint8(2),r.getUint8(3))&&n.reject("Invalid WAV header in file, RIFF was not found"),"WAVEfmt"!==String.fromCharCode(r.getUint8(8),r.getUint8(9),r.getUint8(10),r.getUint8(11),r.getUint8(12),r.getUint8(13),r.getUint8(14))&&n.reject("Invalid WAV header in file, WAVEfmt was not found");var i=r.getUint16(22,!0),s=r.getUint32(24,!0),a=r.getUint16(34,!0);n.resolve(o.AudioStreamFormat.getWaveFormatPCM(s,a,i))},t.readAsArrayBuffer(e),n.promise()},this.upload=function(e){return r.turnOn().onSuccessContinueWithPromise((function(t){return r.privAudioFormatPromise.onSuccessContinueWith((function(t){new i.ChunkedArrayBufferStream(3200);var n=new FileReader,o=new i.ChunkedArrayBufferStream(t.avgBytesPerSec/10,e);r.privStreams[e]=o;n.onload=function(e){o.isClosed||(o.writeStreamChunk({buffer:n.result,isEnd:!1,timeReceived:Date.now()}),o.close())},n.onerror=function(t){var n="Error occurred while processing '"+r.privFile.name+"'. "+t;throw r.onEvent(new i.AudioStreamNodeErrorEvent(r.privId,e,n)),new Error(n)};var s=r.privFile.slice(44);return n.readAsArrayBuffer(s),o}))}))},this.onEvent=function(e){r.privEvents.onEvent(e),i.Events.instance.onEvent(e)},this.privId=t||i.createNoDashGuid(),this.privEvents=new i.EventSource,this.privFile=e,this.privAudioFormatPromise=this.readHeader()}return Object.defineProperty(e.prototype,"format",{get:function(){return this.privAudioFormatPromise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blob",{get:function(){return i.PromiseHelper.fromResult(this.privFile)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return this.privEvents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceInfo",{get:function(){return this.privAudioFormatPromise.onSuccessContinueWithPromise((function(e){return i.PromiseHelper.fromResult({bitspersample:e.bitsPerSample,channelcount:e.channels,connectivity:n.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:e.samplesPerSec,type:n.type.File})}))},enumerable:!0,configurable:!0}),e}();t.FileAudioSource=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=function(){function e(){var e=this;this.record=function(t,r,i){var o=function(){var e=0;try{return t.createScriptProcessor(e,1,1)}catch(n){e=2048;for(var r=t.sampleRate;e<16384&&r>=32e3;)e<<=1,r>>=1;return t.createScriptProcessor(e,1,1)}}(),s=new n.RiffPcmEncoder(t.sampleRate,16e3);o.onaudioprocess=function(e){var t=e.inputBuffer.getChannelData(0);if(i&&!i.isClosed){var r=s.encode(t);r&&(i.writeStreamChunk({buffer:r,isEnd:!1,timeReceived:Date.now()}),!1)}};var a=t.createMediaStreamSource(r);e.privSpeechProcessorScript&&t.audioWorklet?t.audioWorklet.addModule(e.privSpeechProcessorScript).then((function(){var n=new AudioWorkletNode(t,"speech-processor");n.port.onmessage=function(e){var t=e.data;if(i&&!i.isClosed){var r=s.encode(t);r&&(i.writeStreamChunk({buffer:r,isEnd:!1,timeReceived:Date.now()}),!1)}},a.connect(n),n.connect(t.destination),e.privMediaResources={scriptProcessorNode:n,source:a,stream:r}})).catch((function(){a.connect(o),o.connect(t.destination),e.privMediaResources={scriptProcessorNode:o,source:a,stream:r}})):(a.connect(o),o.connect(t.destination),e.privMediaResources={scriptProcessorNode:o,source:a,stream:r})},this.releaseMediaResources=function(t){e.privMediaResources&&(e.privMediaResources.scriptProcessorNode&&(e.privMediaResources.scriptProcessorNode.disconnect(t.destination),e.privMediaResources.scriptProcessorNode=null),e.privMediaResources.source&&(e.privMediaResources.source.disconnect(),e.privMediaResources.stream.getTracks().forEach((function(e){return e.stop()})),e.privMediaResources.source=null))}}return e.prototype.setWorkletUrl=function(e){this.privSpeechProcessorScript=e},e}();t.PcmRecorder=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(169),o=function(){function e(e,t,r,o,s,a){var c=this;if(this.privIsDisposed=!1,this.dispose=function(){c.privIsDisposed=!0,c.privConnectionMessageAdapter&&c.privConnectionMessageAdapter.close()},this.isDisposed=function(){return c.privIsDisposed},this.state=function(){return c.privConnectionMessageAdapter.state},this.open=function(){return c.privConnectionMessageAdapter.open()},this.send=function(e){return c.privConnectionMessageAdapter.send(e)},this.read=function(){return c.privConnectionMessageAdapter.read()},!e)throw new n.ArgumentNullError("uri");if(!o)throw new n.ArgumentNullError("messageFormatter");this.privMessageFormatter=o;var p="",u=0;if(t)for(var h in t){if(h)p+=0===u&&-1===e.indexOf("?")?"?":"&",p+=h+"="+encodeURIComponent(t[h]),u++}if(r)for(var v in r){if(v)p+=0===u&&-1===e.indexOf("?")?"?":"&",p+=v+"="+encodeURIComponent(r[v]),u++}this.privUri=e+p,this.privId=a||n.createNoDashGuid(),this.privConnectionMessageAdapter=new i.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,s,r)}return Object.defineProperty(e.prototype,"id",{get:function(){return this.privId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return this.privConnectionMessageAdapter.events},enumerable:!0,configurable:!0}),e}();t.WebsocketConnection=o},function(e,t){},function(e,t,r){"use strict";(function(e,n){var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var p=a(r(380)),u=a(r(118)),h=a(r(387)),v=r(6),l=c(r(388)),d=c(r(389)),f=c(r(390)),g=r(153),y=function(){function t(r){r&&(this.privProxyInfo=r),t.privDiskCache||(t.privDiskCache=new d.default("microsoft-cognitiveservices-speech-sdk-cache",{supportBuffer:!0,location:void 0!==e&&e.env.SPEECH_OCSP_CACHE_ROOT?e.env.SPEECH_OCSP_CACHE_ROOT:void 0}))}return t.forceReinitDiskCache=function(){t.privDiskCache=void 0,t.privMemCache={}},t.prototype.GetAgent=function(e){var t=new l.default.Agent(this.CreateConnection);if(void 0!==this.privProxyInfo&&void 0!==this.privProxyInfo.HostName&&this.privProxyInfo.Port>0){t.privProxyInfo=this.privProxyInfo}return t},t.GetProxyAgent=function(e){var t={host:e.HostName,port:e.Port};return e.UserName?t.headers={"Proxy-Authentication":"Basic "+new n(e.UserName+":"+(void 0===e.Password)?"":e.Password).toString("base64")}:t.headers={},t.headers.requestOCSP="true",new f.default(t)},t.OCSPCheck=function(e,r){return o(this,void 0,void 0,(function(){var n,i,a,c,p,u=this;return s(this,(function(l){switch(l.label){case 0:return a=!1,[4,e];case 1:return(c=l.sent()).cork(),p=c,[2,new Promise((function(e,l){c.on("OCSPResponse",(function(e){e&&(u.onEvent(new v.OCSPStapleReceivedEvent),i=e)})),c.on("error",(function(e){a||(a=!0,c.destroy(),l(e))})),p.on("secure",(function(){return o(u,void 0,void 0,(function(){var o,u,v,d,f;return s(this,(function(s){switch(s.label){case 0:o=p.getPeerCertificate(!0),s.label=1;case 1:return s.trys.push([1,6,,7]),[4,this.GetIssuer(o)];case 2:return u=s.sent(),n=h.request.generate(o.raw,u.raw),v=n.id.toString("hex"),i?[3,4]:[4,t.GetResponseFromCache(v,n,r)];case 3:d=s.sent(),i=d,s.label=4;case 4:return[4,this.VerifyOCSPResponse(i,n,r)];case 5:return s.sent(),c.uncork(),a=!0,e(c),[3,7];case 6:return f=s.sent(),c.destroy(),a=!0,l(f),[3,7];case 7:return[2]}}))}))}))}))]}}))}))},t.GetIssuer=function(e){return e.issuerCertificate?Promise.resolve(e.issuerCertificate):new Promise((function(t,r){new h.Agent({}).fetchIssuer(e,null,(function(e,n){e?r(e):t(n)}))}))},t.GetResponseFromCache=function(e,r,n){return o(this,void 0,void 0,(function(){var i,o,a,c,p,u,l,d=this;return s(this,(function(s){switch(s.label){case 0:if((i=t.privMemCache[e])&&this.onEvent(new v.OCSPMemoryCacheHitEvent(e)),i)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,t.privDiskCache.get(e)];case 2:return(o=s.sent()).isCached&&(t.onEvent(new v.OCSPDiskCacheHitEvent(e)),t.StoreMemoryCacheEntry(e,o.value),i=o.value),[3,4];case 3:return s.sent(),i=null,[3,4];case 4:if(!i)return[2,i];try{if(a=h.utils.parseResponse(i),(c=a.value.tbsResponseData).responses.length<1)return this.onEvent(new v.OCSPCacheFetchErrorEvent(e,"Not enough data in cached response")),[2];p=c.responses[0].thisUpdate,(u=c.responses[0].nextUpdate)<Date.now()+this.testTimeOffset-6e4?(this.onEvent(new v.OCSPCacheEntryExpiredEvent(e,u)),i=null):(l=Math.min(864e5,(u-p)/2),u-(Date.now()+this.testTimeOffset)<l?(this.onEvent(new v.OCSPCacheEntryNeedsRefreshEvent(e,p,u)),this.UpdateCache(r,n).catch((function(t){d.onEvent(new g.OCSPCacheUpdateErrorEvent(e,t.toString()))}))):this.onEvent(new v.OCSPCacheHitEvent(e,p,u)))}catch(t){this.onEvent(new v.OCSPCacheFetchErrorEvent(e,t)),i=null}return i||this.onEvent(new v.OCSPCacheMissEvent(e)),[2,i]}}))}))},t.VerifyOCSPResponse=function(e,r,n){return o(this,void 0,void 0,(function(){var i,o=this;return s(this,(function(s){switch(s.label){case 0:return i=e,r.certID.toString("hex"),i?[3,2]:[4,t.GetOCSPResponse(r,n)];case 1:i=s.sent(),s.label=2;case 2:return[2,new Promise((function(s,a){h.verify({request:r,response:i},(function(c,p){c?(t.onEvent(new v.OCSPVerificationFailedEvent(r.id.toString("hex"),c)),e?o.VerifyOCSPResponse(null,r,n).then((function(){s()}),(function(e){a(e)})):a(c)):(e||t.StoreCacheEntry(r.id.toString("hex"),i),s())}))}))]}}))}))},t.UpdateCache=function(e,t){return o(this,void 0,void 0,(function(){var r,n;return s(this,(function(i){switch(i.label){case 0:return r=e.id.toString("hex"),this.onEvent(new v.OCSPCacheUpdateNeededEvent(r)),[4,this.GetOCSPResponse(e,t)];case 1:return n=i.sent(),this.StoreCacheEntry(r,n),this.onEvent(new v.OCSPCacheUpdatehCompleteEvent(e.id.toString("hex"))),[2]}}))}))},t.StoreCacheEntry=function(e,t){this.StoreMemoryCacheEntry(e,t),this.StoreDiskCacheEntry(e,t)},t.StoreMemoryCacheEntry=function(e,t){this.privMemCache[e]=t,this.onEvent(new v.OCSPMemoryCacheStoreEvent(e))},t.StoreDiskCacheEntry=function(e,t){var r=this;this.privDiskCache.set(e,t).then((function(){r.onEvent(new v.OCSPDiskCacheStoreEvent(e))}))},t.GetOCSPResponse=function(e,r){var n=this,o={};if(r){var s=t.GetProxyAgent(r);o.agent=s}return new Promise((function(t,r){h.utils.getAuthorityInfo(e.cert,"1.3.6.1.5.5.7.48.1",(function(s,a){if(s)r(s);else{var c=u.parse(a);o=i(i({},o),c),h.utils.getResponse(o,e.data,(function(i,o){i?r(i):(n.onEvent(new v.OCSPResponseRetrievedEvent(e.certID.toString("hex"))),t(o))}))}}))}))},t.prototype.CreateConnection=function(r,n){var o,s=void 0!==e&&"0"!==e.env.NODE_TLS_REJECT_UNAUTHORIZED&&"0"!==e.env.SPEECH_CONDUCT_OCSP_CHECK&&n.secureEndpoint;if(n=i(i({},n),{requestOCSP:!t.forceDisableOCSPStapling,servername:n.host}),this.privProxyInfo){var a=t.GetProxyAgent(this.privProxyInfo);o=new Promise((function(e,t){a.callback(r,n,(function(r,n){r?t(r):e(n)}))}))}else o=Promise.resolve(p.connect(n));return s?t.OCSPCheck(o,this.privProxyInfo):o},t.testTimeOffset=0,t.forceDisableOCSPStapling=!1,t.privMemCache={},t.onEvent=function(e){v.Events.instance.onEvent(e)},t}();t.CertCheckAgent=y}).call(this,r(170),r(74).Buffer)},function(e,t){},function(e,t,r){(function(e,n){var i;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(o){t&&t.nodeType,e&&e.nodeType;var s="object"==typeof n&&n;s.global!==s&&s.window!==s&&s.self;var a,c=2147483647,p=/^xn--/,u=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,v={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},l=Math.floor,d=String.fromCharCode;function f(e){throw new RangeError(v[e])}function g(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function y(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+g((e=e.replace(h,".")).split("."),t).join(".")}function m(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function S(e){return g(e,(function(e){var t="";return e>65535&&(t+=d((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=d(e)})).join("")}function C(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function b(e,t,r){var n=0;for(e=r?l(e/700):e>>1,e+=l(e/t);e>455;n+=36)e=l(e/35);return l(n+36*e/(e+38))}function P(e){var t,r,n,i,o,s,a,p,u,h,v,d=[],g=e.length,y=0,m=128,C=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&f("not-basic"),d.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<g;){for(o=y,s=1,a=36;i>=g&&f("invalid-input"),((p=(v=e.charCodeAt(i++))-48<10?v-22:v-65<26?v-65:v-97<26?v-97:36)>=36||p>l((c-y)/s))&&f("overflow"),y+=p*s,!(p<(u=a<=C?1:a>=C+26?26:a-C));a+=36)s>l(c/(h=36-u))&&f("overflow"),s*=h;C=b(y-o,t=d.length+1,0==o),l(y/t)>c-m&&f("overflow"),m+=l(y/t),y%=t,d.splice(y++,0,m)}return S(d)}function R(e){var t,r,n,i,o,s,a,p,u,h,v,g,y,S,P,R=[];for(g=(e=m(e)).length,t=128,r=0,o=72,s=0;s<g;++s)(v=e[s])<128&&R.push(d(v));for(n=i=R.length,i&&R.push("-");n<g;){for(a=c,s=0;s<g;++s)(v=e[s])>=t&&v<a&&(a=v);for(a-t>l((c-r)/(y=n+1))&&f("overflow"),r+=(a-t)*y,t=a,s=0;s<g;++s)if((v=e[s])<t&&++r>c&&f("overflow"),v==t){for(p=r,u=36;!(p<(h=u<=o?1:u>=o+26?26:u-o));u+=36)P=p-h,S=36-h,R.push(d(C(h+P%S,0))),p=l(P/S);R.push(d(C(p,0))),o=b(r,y,n==i),r=0,++n}++r,++t}return R.join("")}a={version:"1.4.1",ucs2:{decode:m,encode:S},decode:P,encode:R,toASCII:function(e){return y(e,(function(e){return u.test(e)?"xn--"+R(e):e}))},toUnicode:function(e){return y(e,(function(e){return p.test(e)?P(e.slice(4).toLowerCase()):e}))}},void 0===(i=function(){return a}.call(t,r,t,e))||(e.exports=i)}()}).call(this,r(382)(e),r(91))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){"use strict";t.decode=t.parse=r(385),t.encode=t.stringify=r(386)},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&",r=r||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var p=e.length;c>0&&p>c&&(p=c);for(var u=0;u<p;++u){var h,v,l,d,f=e[u].replace(a,"%20"),g=f.indexOf(r);g>=0?(h=f.substr(0,g),v=f.substr(g+1)):(h=f,v=""),l=decodeURIComponent(h),d=decodeURIComponent(v),n(s,l)?i(s[l])?s[l].push(d):s[l]=[s[l],d]:s[l]=d}return s};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,a){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?o(s(e),(function(s){var a=encodeURIComponent(n(s))+r;return i(e[s])?o(e[s],(function(e){return a+encodeURIComponent(n(e))})).join(t):a+encodeURIComponent(n(e[s]))})).join(t):a?encodeURIComponent(n(a))+r+encodeURIComponent(n(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=function(){function e(e,t){var r=this;this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.id=function(){return r.privAudioNode.id()},this.privAudioNode=e,this.privBytesPerSecond=t}return e.prototype.read=function(){var e=this;if(this.privReplay&&0!==this.privBuffers.length){var t=this.privReplayOffset-this.privBufferStartOffset,r=Math.round(t*this.privBytesPerSecond*1e-7);0!=r%2&&r++;for(var i=0;i<this.privBuffers.length&&r>=this.privBuffers[i].chunk.buffer.byteLength;)r-=this.privBuffers[i++].chunk.buffer.byteLength;var s=this.privBuffers[i].chunk.buffer.slice(r);return this.privReplayOffset+=s.byteLength/this.privBytesPerSecond*1e7,i===this.privBuffers.length-1&&(this.privReplay=!1),n.PromiseHelper.fromResult({buffer:s,isEnd:!1,timeReceived:this.privBuffers[i].chunk.timeReceived})}return this.privAudioNode.read().onSuccessContinueWith((function(t){return t&&t.buffer&&(e.privBuffers.push(new o(t,e.privBufferSerial++,e.privBufferedBytes)),e.privBufferedBytes+=t.buffer.byteLength),t}))},e.prototype.detach=function(){this.privAudioNode.detach(),this.privBuffers=void 0},e.prototype.replay=function(){this.privBuffers&&0!==this.privBuffers.length&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)},e.prototype.shrinkBuffers=function(e){if(void 0!==this.privBuffers){this.privLastShrinkOffset=e;for(var t=e-this.privBufferStartOffset,r=Math.round(t*this.privBytesPerSecond*1e-7),n=0;n<this.privBuffers.length&&r>=this.privBuffers[n].chunk.buffer.byteLength;)r-=this.privBuffers[n++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-r/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(n)}},e.prototype.findTimeAtOffset=function(e){if(e<this.privBufferStartOffset||void 0===this.privBuffers)return 0;for(var t=0,r=this.privBuffers;t<r.length;t++){var n=r[t],i=n.byteOffset/this.privBytesPerSecond*1e7,o=i+n.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(e>=i&&e<=o)return n.chunk.timeReceived}return 0},e}();t.ReplayableAudioNode=i;var o=function(e,t,r){this.chunk=e,this.serial=t,this.byteOffset=r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=function(){function e(e,t,r,n){this.privProxyHostName=e,this.privProxyPort=t,this.privProxyUserName=r,this.privProxyPassword=n}return e.fromParameters=function(t){return new e(t.getProperty(n.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(t.getProperty(n.PropertyId.SpeechServiceConnection_ProxyPort),10),t.getProperty(n.PropertyId.SpeechServiceConnection_ProxyUserName),t.getProperty(n.PropertyId.SpeechServiceConnection_ProxyPassword))},e.fromRecognizerConfig=function(e){return this.fromParameters(e.parameters)},Object.defineProperty(e.prototype,"HostName",{get:function(){return this.privProxyHostName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Port",{get:function(){return this.privProxyPort},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UserName",{get:function(){return this.privProxyUserName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Password",{get:function(){return this.privProxyPassword},enumerable:!0,configurable:!0}),e}();t.ProxyInfo=i},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i,o=r(6),s=n(r(394));!function(e){e.Get="get",e.Post="post",e.Delete="delete",e.File="file"}(i=t.RestRequestType||(t.RestRequestType={}));var a=function(){function e(e,t){if(!e)throw new o.ArgumentNullError("configParams");this.privHeaders=e.headers,this.privTimeout=e.timeout,this.privIgnoreCache=e.ignoreCache}return e.prototype.setHeaders=function(e,t){this.privHeaders[e]=t},e.prototype.request=function(e,t,r,n,a){var c=this;void 0===r&&(r={}),void 0===n&&(n=null),void 0===a&&(a=null);var p,u=new o.Deferred;p="undefined"==typeof XMLHttpRequest?new s.XMLHttpRequest:new XMLHttpRequest;var h=e===i.File?"post":e;return p.open(h,this.withQuery(t,r),!0),this.privHeaders&&Object.keys(this.privHeaders).forEach((function(e){return p.setRequestHeader(e,c.privHeaders[e])})),this.privIgnoreCache&&p.setRequestHeader("Cache-Control","no-cache"),p.timeout=this.privTimeout,p.onload=function(){u.resolve(c.parseXHRResult(p))},p.onerror=function(){u.resolve(c.errorResponse(p,"Failed to make request."))},p.ontimeout=function(){u.resolve(c.errorResponse(p,"Request took longer than expected."))},e===i.File&&a?(p.setRequestHeader("Content-Type","multipart/form-data"),p.send(a)):e===i.Post&&n?(p.setRequestHeader("Content-Type","application/json"),p.send(JSON.stringify(n))):p.send(),u.promise()},e.prototype.parseXHRResult=function(e){return{data:e.responseText,headers:e.getAllResponseHeaders(),json:function(){return JSON.parse(e.responseText)},ok:e.status>=200&&e.status<300,status:e.status,statusText:e.statusText}},e.prototype.errorResponse=function(e,t){return void 0===t&&(t=null),{data:t||e.statusText,headers:e.getAllResponseHeaders(),json:function(){return JSON.parse(t||'"'+e.statusText+'"')},ok:!1,status:e.status,statusText:e.statusText}},e.prototype.withQuery=function(e,t){void 0===t&&(t={});var r=this.queryParams(t);return r?e+(-1===e.indexOf("?")?"?":"&")+r:e},e.prototype.queryParams=function(e){return void 0===e&&(e={}),Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")},e}();t.RestMessageAdapter=a},function(e,t){},function(e,t,r){"use strict";var n=r(187),i=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.audioContext,r=e.enableTelemetry,n=e.ponyfill,i=void 0===n?{AudioContext:window.AudioContext||window.webkitAudioContext}:n,b=e.recognizer,P=e.textNormalization;if(!i.AudioContext)return console.warn("botframework-directlinespeech-sdk: This browser does not support Web Audio API. Speech support is disabled."),function(){return{}};return function(){var e=(0,v.createSpeechRecognitionPonyfillFromRecognizer)({createRecognizer:function(){return b},enableTelemetry:r,looseEvents:!0,textNormalization:P}),n=e.SpeechGrammarList,R=e.SpeechRecognition;t||(t=new i.AudioContext);var w=(0,g.default)(),I=w.cancelAll,E=w.push,O=function(e){(0,p.default)(v,e);var r,n,i=(r=v,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,h.default)(r);if(n){var i=(0,h.default)(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return(0,u.default)(this,e)});function v(){return(0,a.default)(this,v),i.apply(this,arguments)}return(0,c.default)(v,[{key:"cancel",value:function(){I()}},{key:"getVoices",value:function(){return[]}},{key:"speak",value:function(e){E((function(){var r=new l.default,n=r.signal;return{abort:r.abort.bind(r),result:(0,s.default)(o.default.mark((function r(){return o.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.dispatchEvent((0,d.default)("start")),r.prev=1,!e.audioStream){r.next=7;break}return r.next=5,(0,m.default)(t,e.audioStream,{signal:n});case 5:r.next=9;break;case 7:return r.next=9,(0,S.default)(t);case 9:r.next=15;break;case 11:if(r.prev=11,r.t0=r.catch(1),"aborted"===r.t0.message){r.next=15;break}return r.abrupt("return",e.dispatchEvent((0,f.default)(r.t0)));case 15:e.dispatchEvent((0,d.default)("end"));case 16:case"end":return r.stop()}}),r,null,[[1,11]])})))()}})).result.catch((function(e){if(!/^cancelled/i.test(e.message))throw e}))}}]),v}(y.default);return(0,y.defineEventAttribute)(O,"voiceschanged"),{SpeechGrammarList:n,SpeechRecognition:R,speechSynthesis:new O,SpeechSynthesisUtterance:C.default}}};var o=i(r(43)),s=i(r(44)),a=i(r(112)),c=i(r(189)),p=i(r(190)),u=i(r(191)),h=i(r(192)),v=r(398),l=i(r(420)),d=i(r(200)),f=i(r(425)),g=i(r(426)),y=n(r(114)),m=i(r(427)),S=i(r(431)),C=i(r(203))},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,r){"use strict";var n=r(399);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createSpeechRecognitionPonyfillFromRecognizer",{enumerable:!0,get:function(){return i.createSpeechRecognitionPonyfillFromRecognizer}}),t.default=void 0;var i=n(r(400)),o=i.default;t.default=o},function(e,t,r){var n=r(193);function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}e.exports=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,t&&t.set(e,r),r}},function(e,t,r){"use strict";var n=r(54);Object.defineProperty(t,"__esModule",{value:!0}),t.createSpeechRecognitionPonyfillFromRecognizer=M,t.default=void 0;var i=n(r(194)),o=n(r(401)),s=n(r(196)),a=n(r(197)),c=n(r(406)),p=n(r(408)),u=n(r(410)),h=n(r(113)),v=n(r(198)),l=r(114),d=n(r(411)),f=n(r(414)),g=n(r(415)),y=n(r(419)),m=n(r(199));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,p.default)(this,r)}}function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){(0,h.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var P=m.default.AudioConfig,R=m.default.OutputFormat,w=m.default.ResultReason,I=m.default.SpeechConfig,E=m.default.SpeechRecognizer;function O(e){var t=e.duration,r=e.errorDetails,n=e.json,i=e.offset,o=e.properties,s=e.reason,a=e.resultId,c=e.text;return{duration:t,errorDetails:r,json:JSON.parse(n),offset:i,properties:o,reason:s,resultId:a,text:c}}function T(e,t){return function(){return e.apply(void 0,arguments).onSuccessContinueWith((function(e){return t(e)}))}}function A(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return new Promise((function(t,n){return e.apply(void 0,r.concat([t,n]))}))}}var D=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.data,i=r.emma,o=r.interpretation,s=r.resultIndex,a=r.results;(0,v.default)(this,e),this.data=n,this.emma=i,this.interpretation=o,this.resultIndex=s,this.results=a,this.type=t};function _(e){var t,r,n=e.attach;return e.attach=T(n.bind(e),(function(n){return b(b({},n),{},{read:T(n.read.bind(n),(function(n){var i,o;return!t&&(i=n.buffer,o=new Int16Array(i),[].reduce.call(o,(function(e,t){return e+Math.abs(t)}),0)/o.length>150)&&(e.events.onEvent({name:"FirstAudibleChunk"}),t=!0),r?{buffer:new ArrayBuffer(0),isEnd:!0,timeReceived:Date.now()}:n}))})})),{audioConfig:e,pause:function(){r=!0},unprepare:function(){e.attach=n}}}function M(e){var t=e.createRecognizer,r=e.enableTelemetry,n=e.looseEvents,p=e.referenceGrammars,u=e.textNormalization;E.enableTelemetry(!1!==r);var h=function(e){(0,c.default)(l,e);var r,h=S(l);function l(){var e;return(0,v.default)(this,l),(e=h.call(this))._continuous=!1,e._interimResults=!1,e._lang="undefined"!=typeof window?window.document.documentElement.getAttribute("lang")||window.navigator.language:"en-US",e._grammars=new y.default,e._maxAlternatives=1,e}return(0,a.default)(l,[{key:"emitCognitiveServices",value:function(e,t){this.dispatchEvent(new D("cognitiveservices",{data:b(b({},t),{},{type:e})}))}},{key:"start",value:function(){var e=this;this._startOnce().catch((function(t){e.dispatchEvent(new ErrorEvent("error",{error:t,message:t&&(t.stack||t.message)}))}))}},{key:"_startOnce",value:(r=(0,s.default)(i.default.mark((function e(){var r,s,a,c,h,v,l,g,y,m,S,C,b,P,R,I,E,T=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(this.lang);case 2:return r=e.sent,s=_(r.audioConfig),a=s.pause,c=s.unprepare,e.prev=4,h=(0,f.default)(),y=r.audioConfig.events.attach((function(e){var t=e.name;"AudioSourceReadyEvent"===t?h.push({audioSourceReady:{}}):"AudioSourceOffEvent"===t?h.push({audioSourceOff:{}}):"FirstAudibleChunk"===t&&h.push({firstAudibleChunk:{}})})),m=y.detach,r.canceled=function(e,t){var r=t.errorDetails,n=t.offset,i=t.reason,o=t.sessionId;h.push({canceled:{errorDetails:r,offset:n,reason:i,sessionId:o}})},r.recognized=function(e,t){var r=t.offset,n=t.result,i=t.sessionId;h.push({recognized:{offset:r,result:O(n),sessionId:i}})},r.recognizing=function(e,t){var r=t.offset,n=t.result,i=t.sessionId;h.push({recognizing:{offset:r,result:O(n),sessionId:i}})},r.sessionStarted=function(e,t){var r=t.sessionId;h.push({sessionStarted:{sessionId:r}})},r.sessionStopped=function(e,t){var r=t.sessionId;h.push({sessionStopped:{sessionId:r}})},r.speechStartDetected=function(e,t){var r=t.offset,n=t.sessionId;h.push({speechStartDetected:{offset:r,sessionId:n}})},r.speechEndDetected=function(e,t){var r=t.sessionId;h.push({speechEndDetected:{sessionId:r}})},S=this.grammars.phrases,C=r.privReco.dynamicGrammar,p&&p.length&&C.addReferenceGrammar(p),S&&S.length&&C.addPhrase(S),e.next=20,A(r.startContinuousRecognitionAsync.bind(r))();case 20:r.stopContinuousRecognitionAsync?(this.abort=function(){return h.push({abort:{}})},this.stop=function(){return h.push({stop:{}})}):this.abort=this.stop=void 0,R=[],I=i.default.mark((function e(t){var s,c,p,f,y,m,S,C,I,E,O,_;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.shift();case 2:if(s=e.sent,c=s.abort,p=s.audioSourceOff,f=s.audioSourceReady,y=s.canceled,m=s.firstAudibleChunk,S=s.recognized,C=s.recognizing,I=s.stop,Object.keys(s).forEach((function(e){return T.emitCognitiveServices(e,s[e])})),E=y&&y.errorDetails,!/Permission[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]denied/.test(E||"")){e.next=9;break}return P={error:"not-allowed",type:"error"},e.abrupt("return","break");case 9:if(t||T.dispatchEvent(new D("start")),!E){e.next=15;break}return/1006/.test(E)?(b||(T.dispatchEvent(new D("audiostart")),T.dispatchEvent(new D("audioend"))),P={error:"network",type:"error"}):P={error:"unknown",type:"error"},e.abrupt("return","break");case 15:if(!c&&!I){e.next=22;break}if(c?(P={error:"aborted",type:"error"},g="abort"):(a(),g="stop"),!c||!r.stopContinuousRecognitionAsync){e.next=20;break}return e.next=20,A(r.stopContinuousRecognitionAsync.bind(r))();case 20:e.next=61;break;case 22:if(!f){e.next=27;break}T.dispatchEvent(new D("audiostart")),b=!0,e.next=61;break;case 27:if(!m){e.next=32;break}T.dispatchEvent(new D("soundstart")),v=!0,e.next=61;break;case 32:if(!p){e.next=40;break}return l&&T.dispatchEvent(new D("speechend")),v&&T.dispatchEvent(new D("soundend")),b&&T.dispatchEvent(new D("audioend")),b=v=l=!1,e.abrupt("return","break");case 40:if("abort"===g){e.next=61;break}if(!S||!S.result||S.result.reason!==w.NoMatch){e.next=45;break}P={error:"no-speech",type:"error"},e.next=61;break;case 45:if(!S&&!C){e.next=61;break}if(b||(T.dispatchEvent(new D("audiostart")),b=!0),v||(T.dispatchEvent(new D("soundstart")),v=!0),l||(T.dispatchEvent(new D("speechstart")),l=!0),!S){e.next=60;break}if(O=(0,d.default)(S.result,{maxAlternatives:T.maxAlternatives,textNormalization:u}),(_=!!O[0].transcript)&&(R=[].concat((0,o.default)(R),[O]),T.continuous&&T.dispatchEvent(new D("result",{results:R}))),P=T.continuous&&_?null:{results:R,type:"result"},T.continuous||!r.stopContinuousRecognitionAsync){e.next=57;break}return e.next=57,A(r.stopContinuousRecognitionAsync.bind(r))();case 57:n&&P&&_&&(T.dispatchEvent(new D(P.type,P)),P=null),e.next=61;break;case 60:C&&T.interimResults&&T.dispatchEvent(new D("result",{results:[].concat((0,o.default)(R),[(0,d.default)(C.result,{maxAlternatives:T.maxAlternatives,textNormalization:u})])}));case 61:case"end":return e.stop()}}),e)})),E=0;case 24:if(g&&!b){e.next=32;break}return e.delegateYield(I(E),"t0",26);case 26:if("break"!==e.t0){e.next=29;break}return e.abrupt("break",32);case 29:E++,e.next=24;break;case 32:l&&this.dispatchEvent(new D("speechend")),v&&this.dispatchEvent(new D("soundend")),b&&this.dispatchEvent(new D("audioend")),P&&("result"!==P.type||P.results.length||(P={error:"no-speech",type:"error"}),"error"===P.type?this.dispatchEvent(new ErrorEvent("error",P)):this.dispatchEvent(new D(P.type,P))),this.dispatchEvent(new D("end")),m(),e.next=44;break;case 40:throw e.prev=40,e.t1=e.catch(4),console.error(e.t1),e.t1;case 44:return e.prev=44,c(),r.dispose(),e.finish(44);case 48:case"end":return e.stop()}}),e,this,[[4,40,44,48]])}))),function(){return r.apply(this,arguments)})},{key:"continuous",get:function(){return this._continuous},set:function(e){this._continuous=e}},{key:"grammars",get:function(){return this._grammars},set:function(e){if(!(e instanceof y.default))throw new Error("The provided value is not of type 'SpeechGrammarList'");this._grammars=e}},{key:"interimResults",get:function(){return this._interimResults},set:function(e){this._interimResults=e}},{key:"maxAlternatives",get:function(){return this._maxAlternatives},set:function(e){this._maxAlternatives=e}},{key:"lang",get:function(){return this._lang},set:function(e){this._lang=e}}]),l}(l.EventTarget);return(0,l.defineEventAttribute)(h.prototype,"audioend"),(0,l.defineEventAttribute)(h.prototype,"audiostart"),(0,l.defineEventAttribute)(h.prototype,"cognitiveservices"),(0,l.defineEventAttribute)(h.prototype,"end"),(0,l.defineEventAttribute)(h.prototype,"error"),(0,l.defineEventAttribute)(h.prototype,"nomatch"),(0,l.defineEventAttribute)(h.prototype,"result"),(0,l.defineEventAttribute)(h.prototype,"soundend"),(0,l.defineEventAttribute)(h.prototype,"soundstart"),(0,l.defineEventAttribute)(h.prototype,"speechend"),(0,l.defineEventAttribute)(h.prototype,"speechstart"),(0,l.defineEventAttribute)(h.prototype,"start"),{SpeechGrammarList:y.default,SpeechRecognition:h,SpeechRecognitionEvent:D}}t.default=function(e){var t=(0,g.default)(e),r=t.audioConfig,n=void 0===r?P.fromDefaultMicrophoneInput():r,o=t.enableTelemetry,a=void 0===o||o,c=t.fetchCredentials,p=t.looseEvents,u=t.referenceGrammars,h=t.speechRecognitionEndpointId,v=t.textNormalization,l=void 0===v?"display":v;return n||window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia?M({audioConfig:n,createRecognizer:function(){var e=(0,s.default)(i.default.mark((function e(t){var r,o,s,a,p,u,v;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:return r=e.sent,o=r.authorizationToken,s=r.region,a=r.speechRecognitionHostname,p=r.subscriptionKey,a?(v={hostname:a,port:443,protocol:"wss:"},o?(u=I.fromHost(v)).authorizationToken=o:u=I.fromHost(v,p)):u=o?I.fromAuthorizationToken(o,s):I.fromSubscription(p,s),h&&(u.endpointId=h),u.outputFormat=R.Detailed,u.speechRecognitionLanguage=t||"en-US",e.abrupt("return",new E(u,n));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),enableTelemetry:a,looseEvents:p,referenceGrammars:u,textNormalization:l}):(console.warn("web-speech-cognitive-services: This browser does not support WebRTC and it will not work with Cognitive Services Speech Services."),{})}},function(e,t,r){var n=r(402),i=r(403),o=r(404),s=r(405);e.exports=function(e){return n(e)||i(e)||o(e)||s()}},function(e,t,r){var n=r(195);e.exports=function(e){if(Array.isArray(e))return n(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t,r){var n=r(195);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,r){var n=r(407);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},function(e,t,r){var n=r(193),i=r(409);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?i(e):t}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}e.exports=r},function(e,t,r){"use strict";var n=r(54);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.maxAlternatives,n=void 0===r?1/0:r,o=t.textNormalization,c=void 0===o?"display":o;if(e.reason===s||e.reason===a&&!e.json.NBest){var p=[{confidence:.5,transcript:e.text}];return e.reason===a&&(p.isFinal=!0),p}if(e.reason===a){var u=(0,i.default)((e.json.NBest||[]).slice(0,n).map((function(e){var t=e.Confidence,r=e.Display,n=e.ITN,i=e.Lexical,o=e.MaskedITN;return{confidence:t,transcript:"itn"===c?n:"lexical"===c?i:"maskeditn"===c?o:r}})),{isFinal:!0});return u}return[]};var i=n(r(412)),o=n(r(199)).default.ResultReason,s=o.RecognizingSpeech,a=o.RecognizedSpeech},function(e,t,r){"use strict";var n=r(54);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=s(s(s({},[].reduce.call(e,(function(e,t,r){return e[r]=t,e}),{})),t),{},(0,i.default)({length:e.length},Symbol.iterator,(function(){return[].slice.call(r)[Symbol.iterator]()})));return r};var i=n(r(113));function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(28);r(6).Events.instance.attachListener(new n.ConsoleLoggingListener),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(2))},function(e,t,r){"use strict";var n=r(54);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=[];return{push:function(r){if(e){var n=e.resolve;e=null,n(r)}else t.push(r)},shift:function(){return t.length?Promise.resolve(t.shift()):(e||(e=(0,i.default)())).promise}}};var i=n(r(115))},function(e,t,r){"use strict";var n=r(54);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.authorizationToken,r=e.credentials,n=e.looseEvent,i=e.looseEvents,p=e.region,v=void 0===p?"westus":p,l=e.subscriptionKey,d=(0,a.default)(e,["authorizationToken","credentials","looseEvent","looseEvents","region","subscriptionKey"]);void 0!==n&&(console.warn('web-speech-cognitive-services: The option "looseEvent" should be named as "looseEvents".'),i=n);if(!r){if(!t&&!l)throw new Error("web-speech-cognitive-services: Credentials must be specified.");console.warn("web-speech-cognitive-services: We are deprecating authorizationToken, region, and subscriptionKey. Please use credentials instead. The deprecated option will be removed on or after 2020-11-14."),r=function(){var e=(0,s.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,(0,c.default)(t);case 3:e.t1=e.sent,e.t2=v,e.t0={authorizationToken:e.t1,region:e.t2},e.next=13;break;case 8:return e.t3=v,e.next=11,(0,c.default)(l);case 11:e.t4=e.sent,e.t0={region:e.t3,subscriptionKey:e.t4};case 13:return e.abrupt("return",e.t0);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}return u(u({},d),{},{fetchCredentials:(f=(0,s.default)(o.default.mark((function e(){var t,n,i,s,a,p,u,v;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.default)(r);case 2:if(t=e.sent,n=t.authorizationToken,i=t.customVoiceHostname,s=t.region,a=t.speechRecognitionHostname,p=t.speechSynthesisHostname,u=t.subscriptionKey,!(!n&&!u||n&&u)){e.next=13;break}throw new Error('web-speech-cognitive-services: Either "authorizationToken" or "subscriptionKey" must be provided.');case 13:if(s||a&&p){e.next=17;break}throw new Error('web-speech-cognitive-services: Either "region" or "speechRecognitionHostname" and "speechSynthesisHostname" must be set.');case 17:if(!s||!(i||a||p)){e.next=21;break}throw new Error('web-speech-cognitive-services: Only either "region" or "customVoiceHostname", "speechRecognitionHostname" and "speechSynthesisHostname" can be set.');case 21:if(!n){e.next=26;break}if("string"==typeof n){e.next=24;break}throw new Error('web-speech-cognitive-services: "authorizationToken" must be a string.');case 24:e.next=28;break;case 26:if("string"==typeof u){e.next=28;break}throw new Error('web-speech-cognitive-services: "subscriptionKey" must be a string.');case 28:return h&&u&&(console.warn("web-speech-cognitive-services: In production environment, subscription key should not be used, authorization token should be used instead."),h=!1),v=n?{authorizationToken:n}:{subscriptionKey:u},s?v.region=s:(v.customVoiceHostname=i,v.speechRecognitionHostname=a,v.speechSynthesisHostname=p),e.abrupt("return",v);case 32:case"end":return e.stop()}}),e)}))),function(){return f.apply(this,arguments)}),looseEvents:i});var f};var i=n(r(113)),o=n(r(194)),s=n(r(196)),a=n(r(416)),c=n(r(418));function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h=!0},function(e,t,r){var n=r(417);e.exports=function(e,t){if(null==e)return{};var r,i,o=n(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}},function(e,t){e.exports=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"function"==typeof e?e():e}},function(e,t,r){"use strict";var n=r(54);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(198)),o=n(r(197)),s=function(){function e(){(0,i.default)(this,e),this._phrases=[]}return(0,o.default)(e,[{key:"addFromString",value:function(){throw new Error("JSGF is not supported")}},{key:"phrases",get:function(){return this._phrases},set:function(e){if(Array.isArray(e))this._phrases=e;else{if("string"!=typeof e)throw new Error("The provided value is not an array or of type 'string'");this._phrases=[e]}}}]),e}();t.default=s},function(e,t){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.r(t),r.d(t,"AbortController",(function(){return k})),r.d(t,"AbortSignal",(function(){return j}));var i=new WeakMap,o=new WeakMap;function s(e){var t=i.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function a(e){null==e.passiveListener?e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener)}function c(e,t){i.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});for(var r=Object.keys(t),n=0;n<r.length;++n){var o=r[n];o in this||Object.defineProperty(this,o,p(o))}}function p(e){return{get:function(){return s(this).event[e]},set:function(t){s(this).event[e]=t},configurable:!0,enumerable:!0}}function u(e){return{value:function(){var t=s(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function h(e){if(null==e||e===Object.prototype)return c;var t=o.get(e);return null==t&&(t=function(e,t){var r=Object.keys(t);if(0===r.length)return e;function n(t,r){e.call(this,t,r)}n.prototype=Object.create(e.prototype,{constructor:{value:n,configurable:!0,writable:!0}});for(var i=0;i<r.length;++i){var o=r[i];if(!(o in e.prototype)){var s="function"==typeof Object.getOwnPropertyDescriptor(t,o).value;Object.defineProperty(n.prototype,o,s?u(o):p(o))}}return n}(h(Object.getPrototypeOf(e)),e),o.set(e,t)),t}function v(e){return s(e).immediateStopped}function l(e,t){s(e).passiveListener=t}c.prototype={get type(){return s(this).event.type},get target(){return s(this).eventTarget},get currentTarget(){return s(this).currentTarget},composedPath:function(){var e=s(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return s(this).eventPhase},stopPropagation:function(){var e=s(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation:function(){var e=s(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(s(this).event.bubbles)},get cancelable(){return Boolean(s(this).event.cancelable)},preventDefault:function(){a(s(this))},get defaultPrevented(){return s(this).canceled},get composed(){return Boolean(s(this).event.composed)},get timeStamp(){return s(this).timeStamp},get srcElement(){return s(this).eventTarget},get cancelBubble(){return s(this).stopped},set cancelBubble(e){if(e){var t=s(this);t.stopped=!0,"boolean"==typeof t.event.cancelBubble&&(t.event.cancelBubble=!0)}},get returnValue(){return!s(this).canceled},set returnValue(e){e||a(s(this))},initEvent:function(){}},Object.defineProperty(c.prototype,"constructor",{value:c,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(c.prototype,window.Event.prototype),o.set(window.Event.prototype,c));var d=new WeakMap;function f(e){return null!==e&&"object"===n(e)}function g(e){var t=d.get(e);if(null==t)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function y(e,t){Object.defineProperty(e,"on".concat(t),function(e){return{get:function(){for(var t=g(this).get(e);null!=t;){if(3===t.listenerType)return t.listener;t=t.next}return null},set:function(t){"function"==typeof t||f(t)||(t=null);for(var r=g(this),n=null,i=r.get(e);null!=i;)3===i.listenerType?null!==n?n.next=i.next:null!==i.next?r.set(e,i.next):r.delete(e):n=i,i=i.next;if(null!==t){var o={listener:t,listenerType:3,passive:!1,once:!1,next:null};null===n?r.set(e,o):n.next=o}},configurable:!0,enumerable:!0}}(t))}function m(e){function t(){S.call(this)}t.prototype=Object.create(S.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(var r=0;r<e.length;++r)y(t.prototype,e[r]);return t}function S(){if(!(this instanceof S)){if(1===arguments.length&&Array.isArray(arguments[0]))return m(arguments[0]);if(arguments.length>0){for(var e=new Array(arguments.length),t=0;t<arguments.length;++t)e[t]=arguments[t];return m(e)}throw new TypeError("Cannot call a class as a function")}d.set(this,new Map)}S.prototype={addEventListener:function(e,t,r){if(null!=t){if("function"!=typeof t&&!f(t))throw new TypeError("'listener' should be a function or an object.");var n=g(this),i=f(r),o=(i?Boolean(r.capture):Boolean(r))?1:2,s={listener:t,listenerType:o,passive:i&&Boolean(r.passive),once:i&&Boolean(r.once),next:null},a=n.get(e);if(void 0!==a){for(var c=null;null!=a;){if(a.listener===t&&a.listenerType===o)return;c=a,a=a.next}c.next=s}else n.set(e,s)}},removeEventListener:function(e,t,r){if(null!=t)for(var n=g(this),i=(f(r)?Boolean(r.capture):Boolean(r))?1:2,o=null,s=n.get(e);null!=s;){if(s.listener===t&&s.listenerType===i)return void(null!==o?o.next=s.next:null!==s.next?n.set(e,s.next):n.delete(e));o=s,s=s.next}},dispatchEvent:function(e){if(null==e||"string"!=typeof e.type)throw new TypeError('"event.type" should be a string.');var t=g(this),r=e.type,n=t.get(r);if(null==n)return!0;for(var i=function(e,t){return new(h(Object.getPrototypeOf(t)))(e,t)}(this,e),o=null;null!=n;){if(n.once?null!==o?o.next=n.next:null!==n.next?t.set(r,n.next):t.delete(r):o=n,l(i,n.passive?n.listener:null),"function"==typeof n.listener)try{n.listener.call(this,i)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else 3!==n.listenerType&&"function"==typeof n.listener.handleEvent&&n.listener.handleEvent(i);if(v(i))break;n=n.next}return l(i,null),function(e,t){s(e).eventPhase=t}(i,0),function(e,t){s(e).currentTarget=t}(i,null),!i.defaultPrevented}},Object.defineProperty(S.prototype,"constructor",{value:S,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(S.prototype,window.EventTarget.prototype);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t,r){return t&&P(e.prototype,t),r&&P(e,r),e}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=O(e);if(t){var i=O(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(r,e);var t=I(r);function r(){throw b(this,r),t.call(this),new TypeError("AbortSignal cannot be constructed directly")}return R(r,[{key:"aborted",get:function(){var e=A.get(this);if("boolean"!=typeof e)throw new TypeError("Expected 'this' to be an 'AbortSignal' object, but got ".concat(null===this?"null":C(this)));return e}}]),r}(S);y(T.prototype,"abort");var A=new WeakMap;Object.defineProperties(T.prototype,{aborted:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"===C(Symbol.toStringTag)&&Object.defineProperty(T.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});var D=function(){function e(){var t;b(this,e),_.set(this,(t=Object.create(T.prototype),S.call(t),A.set(t,!1),t))}return R(e,[{key:"abort",value:function(){var e;e=M(this),!1===A.get(e)&&(A.set(e,!0),e.dispatchEvent({type:"abort"}))}},{key:"signal",get:function(){return M(this)}}]),e}(),_=new WeakMap;function M(e){var t=_.get(e);if(null==t)throw new TypeError("Expected 'this' to be an 'AbortController' object, but got ".concat(null===e?"null":C(e)));return t}Object.defineProperties(D.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"===C(Symbol.toStringTag)&&Object.defineProperty(D.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"});var x=D,k=("undefined"==typeof window?{}:window).AbortController||x,j=("undefined"==typeof window?{}:window).AbortSignal||T;t.default=k}])},function(e,t,r){var n=r(422),i=r(423),o=r(201),s=r(424);e.exports=function(e,t){return n(e)||i(e,t)||o(e,t)||s()}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)("error",{error:e})};var i=n(r(200))},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=[],t={cancelAll:function(){e.forEach((function(e){return(0,e.cancel)()}))},push:function(t){var r,n=(0,s.default)(),a=(0,s.default)(),c={promise:a.promise},p=c.cancel=function(){t=function(){return{result:Promise.reject(new Error("cancelled before start"))}},r&&r(),n.reject(new Error("cancelled in the midway"))},u=function(){var s=(0,o.default)(i.default.mark((function o(){var s,p,u;return i.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s=t(),p=s.abort,u=s.result,r=p,i.prev=2,i.t0=a,i.next=6,Promise.race([u,n.promise]);case 6:i.t1=i.sent,i.t0.resolve.call(i.t0,i.t1),i.next=13;break;case 10:i.prev=10,i.t2=i.catch(2),a.reject(i.t2);case 13:e=e.filter((function(e){return e!==c}));case 14:case"end":return i.stop()}}),o,null,[[2,10]])})));return function(){return s.apply(this,arguments)}}(),h=e[e.length-1],v=h&&h.promise||Promise.resolve();return e.push(c),v.then(u,u),{cancel:p,result:a.promise}}};return Object.defineProperty(t,"length",{get:function(){return e.length}}),t};var i=n(r(43)),o=n(r(44)),s=n(r(115))},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return g.apply(this,arguments)};var i=n(r(43)),o=n(r(116)),s=n(r(44)),a=n(r(428)),c=n(r(430));function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t){for(var r=new Float32Array(e.length),n=0;n<e.length;n++)r[n]=e[n]/t;return r}function v(e,t){switch(e.bitsPerSample){case 8:return h(new Int8Array(t),128);case 16:return h(new Int16Array(t),32768);case 32:return h(new Int32Array(t),2147483648);default:throw new Error("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}function l(e){return new Promise((function(t,r){e.onabort=function(){return r(new Error("aborted"))}}))}function d(e,t){for(var r=t.channels,n=new Array(r),i=e.length/r,o=0;o<r;o++){var s=new Float32Array(i);n[o]=s;for(var a=0;a<i;a++)s[a]=e[a*r+o]}return n}function f(e,t){if(1===t)return e;for(var r,n=new Array(t).fill(e[0]),i=new Float32Array(e.length*t),o=0;o<e.length;o++)for(var s=e[o],a=o*t,c=0;c<t;c++)n.shift(),n.push(s),i[a+c]=(r=n).reduce((function(e,t){return e+t}),0)/r.length;return i}function g(){return(g=(0,s.default)(i.default.mark((function e(t,r){var n,o,s,p,h=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h.length>2&&void 0!==h[2]?h[2]:{},o=n.signal,s=void 0===o?{}:o,t){e.next=5;break}throw new Error("botframework-directlinespeech-sdk: audioContext must be specified.");case 5:if(r){e.next=9;break}throw new Error("botframework-directlinespeech-sdk: stream must be specified.");case 9:if(r.format){e.next=13;break}throw new Error("botframework-directlinespeech-sdk: stream is missing format.");case 13:if("function"==typeof r.read){e.next=15;break}throw new Error("botframework-directlinespeech-sdk: stream is missing read().");case 15:return p=[],e.prev=16,e.delegateYield(i.default.mark((function e(){var n,o,p,h,g,y,m,S,C,b,P,R,w;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.format,o=l(s),p=new Uint8Array(4096),h=(0,a.default)(r.read.bind(r)),g=function(){return Promise.race([o.catch((function(){})),h(p.buffer).then((function(e){return e===p.byteLength?p:e?p.slice(0,e):void 0}))])},!s.aborted){e.next=7;break}throw new Error("aborted");case 7:for(y=n.samplesPerSec,m=1;y<44100&&y<96e3;)m++,y=n.samplesPerSec*m;return S=(0,c.default)(t,u(u({},n),{},{samplesPerSec:y}),4096/(n.bitsPerSample/8)*m),e.next=13,g();case 13:C=e.sent,b=0;case 15:if(!(C&&b<1e3)||s.aborted){e.next=28;break}if(!s.aborted){e.next=18;break}return e.abrupt("break",28);case 18:P=v(n,C.buffer),R=d(P,n),w=R.map((function(e){return f(e,m)})),S.push(w);case 22:return e.next=24,g();case 24:C=e.sent,b++,e.next=15;break;case 28:if(o.catch((function(){return S.cancelAll()})),!s.aborted){e.next=31;break}throw new Error("aborted");case 31:return e.next=33,Promise.race([o,S.flush()]);case 33:case"end":return e.stop()}}),e)}))(),"t0",18);case 18:return e.prev=18,p.forEach((function(e){return e.stop()})),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[16,,18,21]])})))).apply(this,arguments)}},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){return(0,i.default)(e.apply(void 0,arguments))}};var i=n(r(429))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return new Promise((function(t,r){return e.on(t,r)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var n,i=t.channels,o=t.samplesPerSec,s=new Array(3).fill().map((function(){return e.createBuffer(i,r,o)})),a=[],c=[];return{cancelAll:function(){c.splice(0),a.forEach((function(e){return e.stop()}))},flush:function(){return new Promise((function(e){return c.push(e)}))},push:function(t){if(!t)throw new Error("multiChannelArray must not be falsy.");c.push(t),function t(){"number"!=typeof n&&(n=e.currentTime);var r=e.createBufferSource(),i=c.shift();if("function"==typeof i)i();else if(i){var o=s.shift();if(!o)return void c.unshift(i);!function(e){for(var t=e.numberOfChannels,r=0;r<t;r++){var n=e.getChannelData(r);[].fill.call(n,0)}}(o),function(e,t){for(var r=e.numberOfChannels,n=0;n<r;n++){var i=t[n];if(e.copyToChannel)e.copyToChannel(i,n);else for(var o=i.length,s=e.getChannelData(n),a=0;a<o;a++)s[a]=i[a]}}(o,i),r.buffer=o,r.connect(e.destination),r.start(n),a.push(r),n+=o.duration,r.addEventListener("ended",(function(){a=a.filter((function(e){return e!==r})),s.push(o),t()}))}}()}}}},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return h.apply(this,arguments)};var i=n(r(43)),o=n(r(44)),s=r(432),a=n(r(433)),c="SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU3LjU2LjEwMQAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAACAAABhgC7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7//////////////////////////////////////////////////////////////////8AAAAATGF2YzU3LjY0AAAAAAAAAAAAAAAAJAUHAAAAAAAAAYYoRBqpAAAAAAD/+xDEAAPAAAGkAAAAIAAANIAAAARMQU1FMy45OS41VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7EMQpg8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV";function p(e,t){return new Promise((function(r,n){var i=e.decodeAudioData(t,r,n);i&&"function"==typeof i.then&&r(i)}))}function u(e,t,r){return new Promise((function(n,i){var o,s,c,p=new a.default,u=new a.default,h=(s="statechange",c=function(e){return"closed"===e.target.state&&p.eventListener()},(o=e).addEventListener(s,c),function(){return o.removeEventListener(s,c)});try{r.buffer=t,r.onended=u.eventListener,r.connect(e.destination),r.start(0),Promise.race([p.upcoming(),u.upcoming()]).then(n)}catch(e){i(e)}finally{h()}}))}function h(){return(h=(0,o.default)(i.default.mark((function e(t){var r,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.createBufferSource(),e.next=3,p(t,(0,s.decode)(c));case 3:return n=e.sent,e.next=6,u(t,n,r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),n=0;n<e.length;n++)r[e.charCodeAt(n)]=n;t.encode=function(t){var r,n=new Uint8Array(t),i=n.length,o="";for(r=0;r<i;r+=3)o+=e[n[r]>>2],o+=e[(3&n[r])<<4|n[r+1]>>4],o+=e[(15&n[r+1])<<2|n[r+2]>>6],o+=e[63&n[r+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,n,i,o,s,a=.75*e.length,c=e.length,p=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u=new ArrayBuffer(a),h=new Uint8Array(u);for(t=0;t<c;t+=4)n=r[e.charCodeAt(t)],i=r[e.charCodeAt(t+1)],o=r[e.charCodeAt(t+2)],s=r[e.charCodeAt(t+3)],h[p++]=n<<2|i>>4,h[p++]=(15&i)<<4|o>>2,h[p++]=(3&o)<<6|63&s;return u}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(434))&&n.__esModule?n:{default:n};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.defers=[],this.upcomingDeferred=null,this.eventListener=this.eventListener.bind(this),this.options=r,this.one=this.one.bind(this),this.upcoming=this.upcoming.bind(this),this[Symbol.iterator]=function(){return{next:function(){return{done:!1,value:t.upcoming()}}}}}var t,r,n;return t=e,(r=[{key:"eventListener",value:function(e){var t=this.defers.shift(),r=this.options.array?[].slice.call(arguments):e;t&&t.resolve(r),this.upcomingDeferred&&(this.upcomingDeferred.resolve(r),this.upcomingDeferred=null)}},{key:"one",value:function(){var e=(0,i.default)();return this.defers.push(e),e.promise}},{key:"upcoming",value:function(){return this.upcomingDeferred||(this.upcomingDeferred=(0,i.default)()),this.upcomingDeferred.promise}}])&&s(t.prototype,r),n&&s(t,n),e}();t.default=a,e.exports=t.default,e.exports.default=t.default},function(e,t,r){"use strict";e.exports=function(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(116)),o=n(r(112)),s=n(r(189)),a=n(r(436)),c=n(r(466)),p=n(r(468)),u=n(r(203));function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l=function(){function e(t){var r,n=this,i=t.dialogServiceConnector;(0,o.default)(this,e),this.dialogServiceConnector=i,this.activity$=(0,p.default)(new a.default((function(e){n._activityObserver=e,r.next(0),r.next(1),r.next(2)}))),this.connectionStatus$=(0,p.default)(new a.default((function(e){r=e}))),i.activityReceived=function(e,t){var r=t.activity,i=t.audioStream;try{n._activityObserver&&n._activityObserver.next(v(v({},r),{},{channelData:v(v({},r.channelData),{},{speechSynthesisUtterance:new u.default(i)}),from:v(v({},r.from),{},{role:"bot"}),timestamp:(new Date).toISOString()}))}catch(e){console.error(e)}}}return(0,s.default)(e,[{key:"end",value:function(){try{this.dialogServiceConnector.close()}catch(e){if(!~e.message.indexOf("already disposed"))throw e}}},{key:"postActivity",value:function(e){e=v(v({},e),{},{from:{role:"user"}});try{var t=(0,c.default)().toString(36).substr(2);return!(!e.channelData||!e.channelData.speech)||this.dialogServiceConnector.sendActivityAsync(JSON.stringify(e)),this._activityObserver&&this._activityObserver.next(v(v({},e),{},{id:t,timestamp:(new Date).toISOString()})),a.default.of(t)}catch(e){return new a.default((function(t){return t.error(e)}))}}}]),e}();t.default=l},function(e,t,r){r(437),r(448),r(451),r(453),r(462);var n=r(72);e.exports=n.Observable},function(e,t,r){"use strict";var n=r(90),i=r(39),o=r(438),s=r(205),a=r(37),c=r(52),p=r(440),u=r(41).f,h=r(40),v=r(441),l=r(442),d=r(443),f=r(447),g=r(25),y=r(71),m=g("observable"),S=y.get,C=y.set,b=function(e){return null==e?void 0:s(e)},P=function(e){var t=e.cleanup;if(t){e.cleanup=void 0;try{t()}catch(e){f(e)}}},R=function(e){return void 0===e.observer},w=function(e,t){if(!i){e.closed=!0;var r=t.subscriptionObserver;r&&(r.closed=!0)}t.observer=void 0},I=function(e,t){var r,n=C(this,{cleanup:void 0,observer:a(e),subscriptionObserver:void 0});i||(this.closed=!1);try{(r=b(e.start))&&r.call(e,this)}catch(e){f(e)}if(!R(n)){var o=n.subscriptionObserver=new E(this);try{var c=t(o),p=c;null!=c&&(n.cleanup="function"==typeof c.unsubscribe?function(){p.unsubscribe()}:s(c))}catch(e){return void o.error(e)}R(n)&&P(n)}};I.prototype=v({},{unsubscribe:function(){var e=S(this);R(e)||(w(this,e),P(e))}}),i&&u(I.prototype,"closed",{configurable:!0,get:function(){return R(S(this))}});var E=function(e){C(this,{subscription:e}),i||(this.closed=!1)};E.prototype=v({},{next:function(e){var t=S(S(this).subscription);if(!R(t)){var r=t.observer;try{var n=b(r.next);n&&n.call(r,e)}catch(e){f(e)}}},error:function(e){var t=S(this).subscription,r=S(t);if(!R(r)){var n=r.observer;w(t,r);try{var i=b(n.error);i?i.call(n,e):f(e)}catch(e){f(e)}P(r)}},complete:function(){var e=S(this).subscription,t=S(e);if(!R(t)){var r=t.observer;w(e,t);try{var n=b(r.complete);n&&n.call(r)}catch(e){f(e)}P(t)}}}),i&&u(E.prototype,"closed",{configurable:!0,get:function(){return R(S(S(this).subscription))}});var O=function(e){p(this,O,"Observable"),C(this,{subscriber:s(e)})};v(O.prototype,{subscribe:function(e){var t=arguments.length;return new I("function"==typeof e?{next:e,error:t>1?arguments[1]:void 0,complete:t>2?arguments[2]:void 0}:c(e)?e:{},S(this).subscriber)}}),v(O,{from:function(e){var t="function"==typeof this?this:O,r=b(a(e)[m]);if(r){var n=a(r.call(e));return n.constructor===t?n:new t((function(e){return n.subscribe(e)}))}var i=l(e);return new t((function(e){d(i,(function(t){if(e.next(t),e.closed)return d.stop()}),void 0,!1,!0),e.complete()}))},of:function(){for(var e="function"==typeof this?this:O,t=arguments.length,r=new Array(t),n=0;n<t;)r[n]=arguments[n++];return new e((function(e){for(var n=0;n<t;n++)if(e.next(r[n]),e.closed)return;e.complete()}))}}),h(O.prototype,m,(function(){return this})),n({global:!0},{Observable:O}),o("Observable")},function(e,t,r){"use strict";var n=r(98),i=r(41),o=r(25),s=r(39),a=o("species");e.exports=function(e){var t=n(e),r=i.f;s&&t&&!t[a]&&r(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(204);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t){e.exports=function(e,t,r){if(!(e instanceof t))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return e}},function(e,t,r){var n=r(70);e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},function(e,t,r){var n=r(37),i=r(206);e.exports=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return n(t.call(e))}},function(e,t,r){var n=r(37),i=r(444),o=r(145),s=r(445),a=r(206),c=r(446),p=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,t,r,u,h){var v,l,d,f,g,y,m,S=s(t,r,u?2:1);if(h)v=e;else{if("function"!=typeof(l=a(e)))throw TypeError("Target is not iterable");if(i(l)){for(d=0,f=o(e.length);f>d;d++)if((g=u?S(n(m=e[d])[0],m[1]):S(e[d]))&&g instanceof p)return g;return new p(!1)}v=l.call(e)}for(y=v.next;!(m=y.call(v)).done;)if("object"==typeof(g=c(v,S,m.value,u))&&g&&g instanceof p)return g;return new p(!1)}).stop=function(e){return new p(!0,e)}},function(e,t,r){var n=r(25),i=r(66),o=n("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||s[o]===e)}},function(e,t,r){var n=r(205);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){var n=r(37);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&n(o.call(e)),t}}},function(e,t,r){var n=r(24);e.exports=function(e,t){var r=n.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))}},function(e,t,r){r(449)("observable")},function(e,t,r){var n=r(72),i=r(33),o=r(450),s=r(41).f;e.exports=function(e){var t=n.Symbol||(n.Symbol={});i(t,e)||s(t,e,{value:o.f(e)})}},function(e,t,r){var n=r(25);t.f=n},function(e,t,r){var n=r(117),i=r(70),o=r(452);n||i(Object.prototype,"toString",o,{unsafe:!0})},function(e,t,r){"use strict";var n=r(117),i=r(207);e.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}},function(e,t,r){"use strict";var n=r(454).charAt,i=r(71),o=r(208),s=i.set,a=i.getterFor("String Iterator");o(String,"String",(function(e){s(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=a(this),r=t.string,i=t.index;return i>=r.length?{value:void 0,done:!0}:(e=n(r,i),t.index+=e.length,{value:e,done:!1})}))},function(e,t,r){var n=r(99),i=r(93),o=function(e){return function(t,r){var o,s,a=String(i(t)),c=n(r),p=a.length;return c<0||c>=p?e?"":void 0:(o=a.charCodeAt(c))<55296||o>56319||c+1===p||(s=a.charCodeAt(c+1))<56320||s>57343?e?a.charAt(c):o:e?a.slice(c,c+2):s-56320+(o-55296<<10)+65536}};e.exports={codeAt:o(!1),charAt:o(!0)}},function(e,t,r){"use strict";var n=r(209).IteratorPrototype,i=r(211),o=r(92),s=r(212),a=r(66),c=function(){return this};e.exports=function(e,t,r){var p=t+" Iterator";return e.prototype=i(n,{next:o(1,r)}),s(e,p,!1,!0),a[p]=c,e}},function(e,t,r){var n=r(93);e.exports=function(e){return Object(n(e))}},function(e,t,r){var n=r(51);e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,r){var n=r(39),i=r(41),o=r(37),s=r(146);e.exports=n?Object.defineProperties:function(e,t){o(e);for(var r,n=s(t),a=n.length,c=0;a>c;)i.f(e,r=n[c++],t[r]);return e}},function(e,t,r){var n=r(98);e.exports=n("document","documentElement")},function(e,t,r){var n=r(37),i=r(461);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(e){}return function(r,o){return n(r),i(o),t?e.call(r,o):r.__proto__=o,r}}():void 0)},function(e,t,r){var n=r(52);e.exports=function(e){if(!n(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},function(e,t,r){var n=r(24),i=r(463),o=r(464),s=r(40),a=r(25),c=a("iterator"),p=a("toStringTag"),u=o.values;for(var h in i){var v=n[h],l=v&&v.prototype;if(l){if(l[c]!==u)try{s(l,c,u)}catch(e){l[c]=u}if(l[p]||s(l,p,h),i[h])for(var d in o)if(l[d]!==o[d])try{s(l,d,o[d])}catch(e){l[d]=o[d]}}}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,r){"use strict";var n=r(62),i=r(465),o=r(66),s=r(71),a=r(208),c=s.set,p=s.getterFor("Array Iterator");e.exports=a(Array,"Array",(function(e,t){c(this,{type:"Array Iterator",target:n(e),index:0,kind:t})}),(function(){var e=p(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t,r){var n=r(25),i=r(211),o=r(41),s=n("unscopables"),a=Array.prototype;null==a[s]&&o.f(a,s,{configurable:!0,value:i(null)}),e.exports=function(e){a[s][e]=!0}},function(e,t,r){e.exports=function(e){if(!e)return Math.random;var t=Math.pow(2,32),r=new Uint32Array(1);return function(){return e.getRandomValues(r)[0]/t}}(r(467))},function(e,t){var r="undefined"!=typeof window?window:self;e.exports=r.crypto||r.msCrypto},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r=[];return new Observable((function(n){return t||(t=e.subscribe({complete:function(){r.forEach((function(e){return e.complete()}))},error:function(e){r.forEach((function(t){return t.error(e)}))},next:function(e){r.forEach((function(t){return t.next(e)}))}})),r.push(n),function(){(r=r.filter((function(e){return e!==n}))).length||(t.unsubscribe(),t=null)}}))}},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;return e.listenOnceAsync=s(e.listenOnceAsync.bind(e),(function(e,r){t=(0,o.default)();for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];return[s(e,null,(function(e){return t.resolve(e),e})),s(r,null,(function(e){return t.reject(e),e}))].concat(i)})),e.startContinuousRecognitionAsync=function(t,r){e.listenOnceAsync((function(){}),(function(e){t=null,r&&r(e)})),setTimeout((function(){r=null,t&&t()}),0)},e};var i=n(r(470)),o=n(r(115));function s(e,t,r){return function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];o=t?t.apply(void 0,(0,i.default)(o)):o;var a=e.apply(void 0,(0,i.default)(o));return r?r(a):a}}},function(e,t,r){var n=r(471),i=r(472),o=r(201),s=r(473);e.exports=function(e){return n(e)||i(e)||o(e)||s()}},function(e,t,r){var n=r(202);e.exports=function(e){if(Array.isArray(e))return n(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return a.apply(this,arguments)};var i=n(r(43)),o=n(r(44)),s=n(r(475));function a(){return(a=(0,o.default)(i.default.mark((function e(t){var r,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.default)("https://directline.botframework.com/v3/directline/tokens/refresh",{headers:{authorization:"Bearer ".concat(t)},method:"POST"});case 2:return r=e.sent,n=r.token,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,r){"use strict";var n=r(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return u.apply(this,arguments)};var i=n(r(43)),o=n(r(116)),s=n(r(44)),a=n(r(476));function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(){return(u=(0,s.default)(i.default.mark((function e(t,r){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.default)(t,p(p({},r),{},{headers:p(p({},r.headers),{},{accept:"application/json"})}));case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Failed to fetch JSON from server due to ".concat(n.status));case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,r){"use strict";var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"function"==typeof e?e():e}},function(e,t,r){"use strict";r.r(t),r.d(t,"AudioConfig",(function(){return o.b})),r.d(t,"AudioStreamFormat",(function(){return o.e})),r.d(t,"AudioInputStream",(function(){return o.c})),r.d(t,"PullAudioInputStream",(function(){return o.Q})),r.d(t,"PushAudioInputStream",(function(){return o.T})),r.d(t,"AudioOutputStream",(function(){return o.d})),r.d(t,"PullAudioOutputStream",(function(){return o.S})),r.d(t,"PushAudioOutputStream",(function(){return o.U})),r.d(t,"CancellationReason",(function(){return o.m})),r.d(t,"PullAudioInputStreamCallback",(function(){return o.R})),r.d(t,"PushAudioOutputStreamCallback",(function(){return o.V})),r.d(t,"KeywordRecognitionModel",(function(){return o.F})),r.d(t,"SessionEventArgs",(function(){return o.cb})),r.d(t,"RecognitionEventArgs",(function(){return o.W})),r.d(t,"OutputFormat",(function(){return o.J})),r.d(t,"IntentRecognitionEventArgs",(function(){return o.C})),r.d(t,"RecognitionResult",(function(){return o.X})),r.d(t,"SpeechRecognitionResult",(function(){return o.pb})),r.d(t,"IntentRecognitionResult",(function(){return o.D})),r.d(t,"LanguageUnderstandingModel",(function(){return o.G})),r.d(t,"SpeechRecognitionEventArgs",(function(){return o.ob})),r.d(t,"SpeechRecognitionCanceledEventArgs",(function(){return o.nb})),r.d(t,"TranslationRecognitionEventArgs",(function(){return o.yb})),r.d(t,"TranslationSynthesisEventArgs",(function(){return o.Bb})),r.d(t,"TranslationRecognitionResult",(function(){return o.zb})),r.d(t,"TranslationSynthesisResult",(function(){return o.Cb})),r.d(t,"ResultReason",(function(){return o.Z})),r.d(t,"SpeechConfig",(function(){return o.lb})),r.d(t,"SpeechConfigImpl",(function(){return o.mb})),r.d(t,"SpeechTranslationConfig",(function(){return o.wb})),r.d(t,"PropertyCollection",(function(){return o.O})),r.d(t,"PropertyId",(function(){return o.P})),r.d(t,"Recognizer",(function(){return o.Y})),r.d(t,"SpeechRecognizer",(function(){return o.qb})),r.d(t,"IntentRecognizer",(function(){return o.E})),r.d(t,"VoiceProfileType",(function(){return o.Lb})),r.d(t,"TranslationRecognizer",(function(){return o.Ab})),r.d(t,"Translations",(function(){return o.Db})),r.d(t,"NoMatchReason",(function(){return o.I})),r.d(t,"NoMatchDetails",(function(){return o.H})),r.d(t,"TranslationRecognitionCanceledEventArgs",(function(){return o.xb})),r.d(t,"IntentRecognitionCanceledEventArgs",(function(){return o.B})),r.d(t,"CancellationDetailsBase",(function(){return o.k})),r.d(t,"CancellationDetails",(function(){return o.j})),r.d(t,"CancellationErrorCode",(function(){return o.l})),r.d(t,"ConnectionEventArgs",(function(){return o.o})),r.d(t,"ServiceEventArgs",(function(){return o.ab})),r.d(t,"Connection",(function(){return o.n})),r.d(t,"PhraseListGrammar",(function(){return o.M})),r.d(t,"DialogServiceConfig",(function(){return o.z})),r.d(t,"BotFrameworkConfig",(function(){return o.i})),r.d(t,"CustomCommandsConfig",(function(){return o.y})),r.d(t,"DialogServiceConnector",(function(){return o.A})),r.d(t,"ActivityReceivedEventArgs",(function(){return o.a})),r.d(t,"ServicePropertyChannel",(function(){return o.bb})),r.d(t,"ProfanityOption",(function(){return o.N})),r.d(t,"BaseAudioPlayer",(function(){return o.h})),r.d(t,"ConnectionMessageEventArgs",(function(){return o.q})),r.d(t,"ConnectionMessage",(function(){return o.p})),r.d(t,"VoiceProfile",(function(){return o.Fb})),r.d(t,"VoiceProfileEnrollmentResult",(function(){return o.Jb})),r.d(t,"VoiceProfileEnrollmentCancellationDetails",(function(){return o.Ib})),r.d(t,"VoiceProfileResult",(function(){return o.Kb})),r.d(t,"VoiceProfileCancellationDetails",(function(){return o.Gb})),r.d(t,"VoiceProfileClient",(function(){return o.Hb})),r.d(t,"SpeakerRecognizer",(function(){return o.jb})),r.d(t,"SpeakerIdentificationModel",(function(){return o.fb})),r.d(t,"SpeakerVerificationModel",(function(){return o.kb})),r.d(t,"AutoDetectSourceLanguageConfig",(function(){return o.f})),r.d(t,"AutoDetectSourceLanguageResult",(function(){return o.g})),r.d(t,"SourceLanguageConfig",(function(){return o.db})),r.d(t,"SpeakerRecognitionResult",(function(){return o.hb})),r.d(t,"SpeakerRecognitionResultType",(function(){return o.ib})),r.d(t,"SpeakerRecognitionCancellationDetails",(function(){return o.gb})),r.d(t,"Conversation",(function(){return o.r})),r.d(t,"ConversationExpirationEventArgs",(function(){return o.s})),r.d(t,"ConversationParticipantsChangedEventArgs",(function(){return o.t})),r.d(t,"ConversationTranslationCanceledEventArgs",(function(){return o.u})),r.d(t,"ConversationTranslationEventArgs",(function(){return o.v})),r.d(t,"ConversationTranslationResult",(function(){return o.w})),r.d(t,"ConversationTranslator",(function(){return o.x})),r.d(t,"Participant",(function(){return o.K})),r.d(t,"ParticipantChangedReason",(function(){return o.L})),r.d(t,"User",(function(){return o.Eb})),r.d(t,"SpeechSynthesisOutputFormat",(function(){return o.sb})),r.d(t,"SpeechSynthesizer",(function(){return o.vb})),r.d(t,"SpeechSynthesisResult",(function(){return o.tb})),r.d(t,"SpeechSynthesisEventArgs",(function(){return o.rb})),r.d(t,"SpeechSynthesisWordBoundaryEventArgs",(function(){return o.ub})),r.d(t,"SpeakerAudioDestination",(function(){return o.eb}));var n=r(9);var i=r(133),o=r(11);i.a.instance.attachListener(new class{constructor(e=n.a.Warning){this.onEvent=e=>{if(e.eventType>=this.privLogLevelFilter){const t=this.toString(e);switch(e.eventType){case n.a.Debug:console.debug(t);break;case n.a.Info:console.info(t);break;case n.a.Warning:console.warn(t);break;case n.a.Error:console.error(t);break;default:console.log(t)}}},this.toString=e=>{const t=[""+e.EventTime,""+e.Name];for(const r in e)if(r&&e.hasOwnProperty(r)&&"eventTime"!==r&&"eventType"!==r&&"eventId"!==r&&"name"!==r&&"constructor"!==r){const n=e[r];let i="<NULL>";null!=n&&(i="number"==typeof n||"string"==typeof n?n.toString():JSON.stringify(n)),t.push(`${r}: ${i}`)}return t.join(" | ")},this.privLogLevelFilter=e}})},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(223);class i extends n.a{constructor(e,t){super(t),this.privTargetChunkSize=e,this.privNextBufferReadyBytes=0}writeStreamChunk(e){if(e.isEnd||0===this.privNextBufferReadyBytes&&e.buffer.byteLength===this.privTargetChunkSize)return void super.writeStreamChunk(e);let t=0;for(;t<e.buffer.byteLength;){void 0===this.privNextBufferToWrite&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=e.timeReceived);const r=Math.min(e.buffer.byteLength-t,this.privTargetChunkSize-this.privNextBufferReadyBytes),n=new Uint8Array(this.privNextBufferToWrite),i=new Uint8Array(e.buffer.slice(t,r+t));n.set(i,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=r,t+=r,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){0===this.privNextBufferReadyBytes||this.isClosed||super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}}},function(e,t,r){"use strict";r.d(t,"h",(function(){return i})),r.d(t,"g",(function(){return s})),r.d(t,"d",(function(){return a})),r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return u})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return v}));var n=r(9);class i extends n.b{constructor(e,t,r=n.a.Info){super(e,r),this.privJsonResult=t}get jsonString(){return this.privJsonResult}}class o extends n.b{constructor(e,t,r=n.a.Info){super(e,r),this.privConnectionId=t}get connectionId(){return this.privConnectionId}}class s extends o{constructor(e,t,r){super("ConnectionStartEvent",e),this.privUri=t,this.privHeaders=r}get uri(){return this.privUri}get headers(){return this.privHeaders}}class a extends o{constructor(e,t){super("ConnectionEstablishedEvent",e)}}class c extends o{constructor(e,t,r){super("ConnectionClosedEvent",e,n.a.Debug),this.privRreason=r,this.privStatusCode=t}get reason(){return this.privRreason}get statusCode(){return this.privStatusCode}}class p extends o{constructor(e,t,r){super("ConnectionErrorEvent",e,n.a.Debug),this.privMessage=t,this.privType=r}get message(){return this.privMessage}get type(){return this.privType}}class u extends o{constructor(e,t,r){super("ConnectionEstablishErrorEvent",e,n.a.Error),this.privStatusCode=t,this.privReason=r}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class h extends o{constructor(e,t,r){super("ConnectionMessageReceivedEvent",e),this.privNetworkReceivedTime=t,this.privMessage=r}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}class v extends o{constructor(e,t,r){super("ConnectionMessageSentEvent",e),this.privNetworkSentTime=t,this.privMessage=r}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(7);class i{constructor(e,t){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.id=()=>this.privAudioNode.id(),this.privAudioNode=e,this.privBytesPerSecond=t}read(){if(this.privReplay&&0!==this.privBuffers.length){const e=this.privReplayOffset-this.privBufferStartOffset;let t=Math.round(e*this.privBytesPerSecond*1e-7);0!=t%2&&t++;let r=0;for(;r<this.privBuffers.length&&t>=this.privBuffers[r].chunk.buffer.byteLength;)t-=this.privBuffers[r++].chunk.buffer.byteLength;const i=this.privBuffers[r].chunk.buffer.slice(t);return this.privReplayOffset+=i.byteLength/this.privBytesPerSecond*1e7,r===this.privBuffers.length-1&&(this.privReplay=!1),n.c.fromResult({buffer:i,isEnd:!1,timeReceived:this.privBuffers[r].chunk.timeReceived})}return this.privAudioNode.read().onSuccessContinueWith(e=>(e&&e.buffer&&(this.privBuffers.push(new o(e,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=e.buffer.byteLength),e))}detach(){this.privAudioNode.detach(),this.privBuffers=void 0}replay(){this.privBuffers&&0!==this.privBuffers.length&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(e){if(void 0===this.privBuffers)return;this.privLastShrinkOffset=e;const t=e-this.privBufferStartOffset;let r=Math.round(t*this.privBytesPerSecond*1e-7),n=0;for(;n<this.privBuffers.length&&r>=this.privBuffers[n].chunk.buffer.byteLength;)r-=this.privBuffers[n++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-r/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(n)}findTimeAtOffset(e){if(e<this.privBufferStartOffset||void 0===this.privBuffers)return 0;for(const t of this.privBuffers){const r=t.byteOffset/this.privBytesPerSecond*1e7,n=r+t.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(e>=r&&e<=n)return t.chunk.timeReceived}return 0}}class o{constructor(e,t,r){this.chunk=e,this.serial=t,this.byteOffset=r}}}]);