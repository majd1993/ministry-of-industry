{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _pDefer = _interopRequireDefault(require(\"./external/p-defer\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nvar EventAsPromise = /*#__PURE__*/function () {\n  function EventAsPromise() {\n    var _this = this;\n\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, EventAsPromise);\n\n    this.defers = [];\n    this.upcomingDeferred = null;\n    this.eventListener = this.eventListener.bind(this);\n    this.options = options;\n    this.one = this.one.bind(this);\n    this.upcoming = this.upcoming.bind(this);\n\n    this[Symbol.iterator] = function () {\n      return {\n        next: function next() {\n          return {\n            done: false,\n            value: _this.upcoming()\n          };\n        }\n      };\n    };\n  }\n\n  _createClass(EventAsPromise, [{\n    key: \"eventListener\",\n    value: function eventListener(event) {\n      var deferred = this.defers.shift();\n      var args = this.options.array ? [].slice.call(arguments) : event;\n      deferred && deferred.resolve(args);\n\n      if (this.upcomingDeferred) {\n        this.upcomingDeferred.resolve(args);\n        this.upcomingDeferred = null;\n      }\n    }\n  }, {\n    key: \"one\",\n    value: function one() {\n      var deferred = (0, _pDefer.default)();\n      this.defers.push(deferred);\n      return deferred.promise;\n    }\n  }, {\n    key: \"upcoming\",\n    value: function upcoming() {\n      if (!this.upcomingDeferred) {\n        this.upcomingDeferred = (0, _pDefer.default)();\n      }\n\n      return this.upcomingDeferred.promise;\n    }\n  }]);\n\n  return EventAsPromise;\n}();\n\nexports.default = EventAsPromise;\nmodule.exports = exports.default;\nmodule.exports.default = exports.default;","map":{"version":3,"sources":["../src/index.js"],"names":["EventAsPromise","options","Symbol","next","done","value","event","deferred","args"],"mappings":";;;;;;;AAAA,IAAA,OAAA,GAAA,sBAAA,CAAA,OAAA,CAAA,oBAAA,CAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAEqBA,c;AACnB,WAAA,cAAA,GAA0B;AAAA,QAAA,KAAA,GAAA,IAAA;;AAAA,QAAdC,OAAc,GAAA,SAAA,CAAA,MAAA,GAAA,CAAA,IAAA,SAAA,CAAA,CAAA,CAAA,KAAA,SAAA,GAAA,SAAA,CAAA,CAAA,CAAA,GAAJ,EAAI;;AAAA,IAAA,eAAA,CAAA,IAAA,EAAA,cAAA,CAAA;;AACxB,SAAA,MAAA,GAAA,EAAA;AACA,SAAA,gBAAA,GAAA,IAAA;AACA,SAAA,aAAA,GAAqB,KAAA,aAAA,CAAA,IAAA,CAArB,IAAqB,CAArB;AACA,SAAA,OAAA,GAAA,OAAA;AAEA,SAAA,GAAA,GAAW,KAAA,GAAA,CAAA,IAAA,CAAX,IAAW,CAAX;AACA,SAAA,QAAA,GAAgB,KAAA,QAAA,CAAA,IAAA,CAAhB,IAAgB,CAAhB;;AAEA,SAAKC,MAAM,CAAX,QAAA,IAAwB,YAAA;AAAA,aAAO;AAC7BC,QAAAA,IAAI,EAAE,SAAA,IAAA,GAAA;AAAA,iBAAO;AACXC,YAAAA,IAAI,EADO,KAAA;AAEXC,YAAAA,KAAK,EAAE,KAAI,CAAJ,QAAA;AAFI,WAAP;AAAA;AADuB,OAAP;AAAxB,KAAA;AAMD;;;;kCAEaC,K,EAAO;AACnB,UAAMC,QAAQ,GAAG,KAAA,MAAA,CAAjB,KAAiB,EAAjB;AACA,UAAMC,IAAI,GAAG,KAAA,OAAA,CAAA,KAAA,GAAqB,GAAA,KAAA,CAAA,IAAA,CAArB,SAAqB,CAArB,GAAb,KAAA;AAEAD,MAAAA,QAAQ,IAAIA,QAAQ,CAARA,OAAAA,CAAZA,IAAYA,CAAZA;;AAEA,UAAI,KAAJ,gBAAA,EAA2B;AACzB,aAAA,gBAAA,CAAA,OAAA,CAAA,IAAA;AACA,aAAA,gBAAA,GAAA,IAAA;AACD;AACF;;;0BAEK;AACJ,UAAMA,QAAQ,GAAG,CAAA,GAAA,OAAA,CAAjB,OAAiB,GAAjB;AAEA,WAAA,MAAA,CAAA,IAAA,CAAA,QAAA;AAEA,aAAOA,QAAQ,CAAf,OAAA;AACD;;;+BAEU;AACT,UAAI,CAAC,KAAL,gBAAA,EAA4B;AAC1B,aAAA,gBAAA,GAAwB,CAAA,GAAA,OAAA,CAAxB,OAAwB,GAAxB;AACD;;AAED,aAAO,KAAA,gBAAA,CAAP,OAAA;AACD","sourcesContent":["import createDeferred from './external/p-defer';\n\nexport default class EventAsPromise {\n  constructor(options = {}) {\n    this.defers = [];\n    this.upcomingDeferred = null;\n    this.eventListener = this.eventListener.bind(this);\n    this.options = options;\n\n    this.one = this.one.bind(this);\n    this.upcoming = this.upcoming.bind(this);\n\n    this[Symbol.iterator] = () => ({\n      next: () => ({\n        done: false,\n        value: this.upcoming()\n      })\n    });\n  }\n\n  eventListener(event) {\n    const deferred = this.defers.shift();\n    const args = this.options.array ? [].slice.call(arguments) : event;\n\n    deferred && deferred.resolve(args);\n\n    if (this.upcomingDeferred) {\n      this.upcomingDeferred.resolve(args);\n      this.upcomingDeferred = null;\n    }\n  }\n\n  one() {\n    const deferred = createDeferred();\n\n    this.defers.push(deferred);\n\n    return deferred.promise;\n  }\n\n  upcoming() {\n    if (!this.upcomingDeferred) {\n      this.upcomingDeferred = createDeferred();\n    }\n\n    return this.upcomingDeferred.promise;\n  }\n}\n"]},"metadata":{},"sourceType":"script"}