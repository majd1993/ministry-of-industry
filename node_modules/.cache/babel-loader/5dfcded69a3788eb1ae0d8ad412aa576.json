{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _simpleUpdateIn = _interopRequireDefault(require(\"simple-update-in\"));\n\nvar _createCustomEvent = _interopRequireDefault(require(\"../utils/createCustomEvent\"));\n\nvar _ErrorBoundary = _interopRequireDefault(require(\"./utils/ErrorBoundary\"));\n\nvar _getAllLocalizedStrings = _interopRequireDefault(require(\"../localization/getAllLocalizedStrings\"));\n\nvar _isObject = _interopRequireDefault(require(\"../utils/isObject\"));\n\nvar _normalizeLanguage = _interopRequireDefault(require(\"../utils/normalizeLanguage\"));\n\nvar _PrecompiledGlobalize = _interopRequireDefault(require(\"../external/PrecompiledGlobalize\"));\n\nvar _botframeworkWebchatCore = require(\"botframework-webchat-core\");\n\nvar _createDefaultCardActionMiddleware = _interopRequireDefault(require(\"./middleware/createDefaultCardActionMiddleware\"));\n\nvar _createDefaultGroupActivitiesMiddleware = _interopRequireDefault(require(\"./middleware/createDefaultGroupActivitiesMiddleware\"));\n\nvar _defaultSelectVoice = _interopRequireDefault(require(\"./internal/defaultSelectVoice\"));\n\nvar _mapMap = _interopRequireDefault(require(\"../utils/mapMap\"));\n\nvar _observableToPromise = _interopRequireDefault(require(\"./utils/observableToPromise\"));\n\nvar _Tracker = _interopRequireDefault(require(\"./internal/Tracker\"));\n\nvar _WebChatReduxContext = _interopRequireWildcard(require(\"./internal/WebChatReduxContext\"));\n\nvar _WebChatAPIContext = _interopRequireDefault(require(\"./internal/WebChatAPIContext\"));\n\nvar _applyMiddleware = _interopRequireWildcard(require(\"./middleware/applyMiddleware\"));\n\nvar _patchStyleOptions = _interopRequireDefault(require(\"../patchStyleOptions\"));\n\nvar _singleToArray = _interopRequireDefault(require(\"./utils/singleToArray\"));\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n} // List of Redux actions factory we are hoisting as Web Chat functions\n\n\nvar DISPATCHERS = {\n  clearSuggestedActions: _botframeworkWebchatCore.clearSuggestedActions,\n  dismissNotification: _botframeworkWebchatCore.dismissNotification,\n  emitTypingIndicator: _botframeworkWebchatCore.emitTypingIndicator,\n  markActivity: _botframeworkWebchatCore.markActivity,\n  postActivity: _botframeworkWebchatCore.postActivity,\n  sendEvent: _botframeworkWebchatCore.sendEvent,\n  sendFiles: _botframeworkWebchatCore.sendFiles,\n  sendMessage: _botframeworkWebchatCore.sendMessage,\n  sendMessageBack: _botframeworkWebchatCore.sendMessageBack,\n  sendPostBack: _botframeworkWebchatCore.sendPostBack,\n  setDictateInterims: _botframeworkWebchatCore.setDictateInterims,\n  setDictateState: _botframeworkWebchatCore.setDictateState,\n  setNotification: _botframeworkWebchatCore.setNotification,\n  setSendBox: _botframeworkWebchatCore.setSendBox,\n  setSendTimeout: _botframeworkWebchatCore.setSendTimeout,\n  startDictate: _botframeworkWebchatCore.startDictate,\n  startSpeakingActivity: _botframeworkWebchatCore.startSpeakingActivity,\n  stopDictate: _botframeworkWebchatCore.stopDictate,\n  stopSpeakingActivity: _botframeworkWebchatCore.stopSpeakingActivity,\n  submitSendBox: _botframeworkWebchatCore.submitSendBox\n};\n\nfunction createCardActionContext(_ref) {\n  var cardActionMiddleware = _ref.cardActionMiddleware,\n      directLine = _ref.directLine,\n      dispatch = _ref.dispatch;\n\n  var runMiddleware = _applyMiddleware.default.apply(void 0, ['card action'].concat(_toConsumableArray((0, _singleToArray.default)(cardActionMiddleware)), [(0, _createDefaultCardActionMiddleware.default)()]))({\n    dispatch: dispatch\n  });\n\n  return {\n    onCardAction: function onCardAction(cardAction) {\n      var _ref2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          target = _ref2.target;\n\n      return runMiddleware({\n        cardAction: cardAction,\n        getSignInUrl: cardAction.type === 'signin' ? function () {\n          var value = cardAction.value;\n\n          if (directLine.getSessionId) {\n            // TODO: [P3] We should change this one to async/await.\n            //       This is the first place in this project to use async.\n            //       Thus, we need to add @babel/plugin-transform-runtime and @babel/runtime.\n            return (0, _observableToPromise.default)(directLine.getSessionId()).then(function (sessionId) {\n              return \"\".concat(value).concat(encodeURIComponent(\"&code_challenge=\".concat(sessionId)));\n            });\n          }\n\n          console.warn('botframework-webchat: OAuth is not supported on this Direct Line adapter.');\n          return value;\n        } : null,\n        target: target\n      });\n    }\n  };\n}\n\nfunction createGroupActivitiesContext(_ref3) {\n  var groupActivitiesMiddleware = _ref3.groupActivitiesMiddleware,\n      groupTimestamp = _ref3.groupTimestamp;\n\n  var runMiddleware = _applyMiddleware.default.apply(void 0, ['group activities'].concat(_toConsumableArray((0, _singleToArray.default)(groupActivitiesMiddleware)), [(0, _createDefaultGroupActivitiesMiddleware.default)({\n    groupTimestamp: groupTimestamp\n  })]));\n\n  return {\n    groupActivities: runMiddleware({})\n  };\n}\n\nfunction mergeStringsOverrides(localizedStrings, language, overrideLocalizedStrings) {\n  if (!overrideLocalizedStrings) {\n    return localizedStrings;\n  } else if (typeof overrideLocalizedStrings === 'function') {\n    var merged = overrideLocalizedStrings(localizedStrings, language);\n\n    if (!(0, _isObject.default)(merged)) {\n      throw new Error('botframework-webchat: overrideLocalizedStrings function must return an object.');\n    }\n\n    return merged;\n  }\n\n  if (!(0, _isObject.default)(overrideLocalizedStrings)) {\n    throw new Error('botframework-webchat: overrideLocalizedStrings must be either a function, an object, or falsy.');\n  }\n\n  return _objectSpread(_objectSpread({}, localizedStrings), overrideLocalizedStrings);\n}\n\nvar Composer = function Composer(_ref4) {\n  var activityMiddleware = _ref4.activityMiddleware,\n      activityRenderer = _ref4.activityRenderer,\n      activityStatusMiddleware = _ref4.activityStatusMiddleware,\n      activityStatusRenderer = _ref4.activityStatusRenderer,\n      attachmentMiddleware = _ref4.attachmentMiddleware,\n      attachmentForScreenReaderMiddleware = _ref4.attachmentForScreenReaderMiddleware,\n      attachmentRenderer = _ref4.attachmentRenderer,\n      avatarMiddleware = _ref4.avatarMiddleware,\n      avatarRenderer = _ref4.avatarRenderer,\n      cardActionMiddleware = _ref4.cardActionMiddleware,\n      children = _ref4.children,\n      dir = _ref4.dir,\n      directLine = _ref4.directLine,\n      disabled = _ref4.disabled,\n      downscaleImageToDataURL = _ref4.downscaleImageToDataURL,\n      grammars = _ref4.grammars,\n      groupActivitiesMiddleware = _ref4.groupActivitiesMiddleware,\n      groupTimestamp = _ref4.groupTimestamp,\n      internalErrorBoxClass = _ref4.internalErrorBoxClass,\n      locale = _ref4.locale,\n      onTelemetry = _ref4.onTelemetry,\n      overrideLocalizedStrings = _ref4.overrideLocalizedStrings,\n      renderMarkdown = _ref4.renderMarkdown,\n      selectVoice = _ref4.selectVoice,\n      sendTimeout = _ref4.sendTimeout,\n      sendTypingIndicator = _ref4.sendTypingIndicator,\n      styleOptions = _ref4.styleOptions,\n      toastMiddleware = _ref4.toastMiddleware,\n      toastRenderer = _ref4.toastRenderer,\n      typingIndicatorMiddleware = _ref4.typingIndicatorMiddleware,\n      typingIndicatorRenderer = _ref4.typingIndicatorRenderer,\n      userID = _ref4.userID,\n      username = _ref4.username;\n  var dispatch = (0, _WebChatReduxContext.useDispatch)();\n  var telemetryDimensionsRef = (0, _react.useRef)({});\n  var patchedDir = (0, _react.useMemo)(function () {\n    return dir === 'ltr' || dir === 'rtl' ? dir : 'auto';\n  }, [dir]);\n  var patchedGrammars = (0, _react.useMemo)(function () {\n    return grammars || [];\n  }, [grammars]);\n  var patchedStyleOptions = (0, _react.useMemo)(function () {\n    return (0, _patchStyleOptions.default)(styleOptions, {\n      groupTimestamp: groupTimestamp,\n      sendTimeout: sendTimeout\n    });\n  }, [groupTimestamp, sendTimeout, styleOptions]);\n  (0, _react.useEffect)(function () {\n    dispatch((0, _botframeworkWebchatCore.setLanguage)(locale));\n  }, [dispatch, locale]);\n  (0, _react.useEffect)(function () {\n    typeof sendTimeout === 'number' && dispatch((0, _botframeworkWebchatCore.setSendTimeout)(sendTimeout));\n  }, [dispatch, sendTimeout]);\n  (0, _react.useEffect)(function () {\n    dispatch((0, _botframeworkWebchatCore.setSendTypingIndicator)(!!sendTypingIndicator));\n  }, [dispatch, sendTypingIndicator]);\n  (0, _react.useEffect)(function () {\n    dispatch((0, _botframeworkWebchatCore.connect)({\n      directLine: directLine,\n      userID: userID,\n      username: username\n    }));\n    return function () {\n      // TODO: [P3] disconnect() is an async call (pending -> fulfilled), we need to wait, or change it to reconnect()\n      dispatch((0, _botframeworkWebchatCore.disconnect)());\n    };\n  }, [dispatch, directLine, userID, username]);\n  var cardActionContext = (0, _react.useMemo)(function () {\n    return createCardActionContext({\n      cardActionMiddleware: cardActionMiddleware,\n      directLine: directLine,\n      dispatch: dispatch\n    });\n  }, [cardActionMiddleware, directLine, dispatch]);\n  var patchedSelectVoice = (0, _react.useMemo)(function () {\n    return selectVoice || _defaultSelectVoice.default.bind(null, {\n      language: locale\n    });\n  }, [locale, selectVoice]);\n  var groupActivitiesContext = (0, _react.useMemo)(function () {\n    return createGroupActivitiesContext({\n      groupActivitiesMiddleware: groupActivitiesMiddleware,\n      groupTimestamp: patchedStyleOptions.groupTimestamp\n    });\n  }, [groupActivitiesMiddleware, patchedStyleOptions.groupTimestamp]);\n  var hoistedDispatchers = (0, _react.useMemo)(function () {\n    return (0, _mapMap.default)(DISPATCHERS, function (dispatcher) {\n      return function () {\n        return dispatch(dispatcher.apply(void 0, arguments));\n      };\n    });\n  }, [dispatch]);\n  var patchedLocalizedStrings = (0, _react.useMemo)(function () {\n    return mergeStringsOverrides((0, _getAllLocalizedStrings.default)()[(0, _normalizeLanguage.default)(locale)], locale, overrideLocalizedStrings);\n  }, [locale, overrideLocalizedStrings]);\n  var localizedGlobalize = (0, _react.useMemo)(function () {\n    var _ref5 = patchedLocalizedStrings || {},\n        GLOBALIZE = _ref5.GLOBALIZE,\n        GLOBALIZE_LANGUAGE = _ref5.GLOBALIZE_LANGUAGE;\n\n    return GLOBALIZE || GLOBALIZE_LANGUAGE && (0, _PrecompiledGlobalize.default)(GLOBALIZE_LANGUAGE) || (0, _PrecompiledGlobalize.default)('en');\n  }, [patchedLocalizedStrings]);\n  var trackDimension = (0, _react.useCallback)(function (name, data) {\n    if (!name || typeof name !== 'string') {\n      return console.warn('botframework-webchat: Telemetry dimension name must be a string.');\n    }\n\n    var type = _typeof(data);\n\n    if (type !== 'string' && type !== 'undefined') {\n      return console.warn('botframework-webchat: Telemetry dimension data must be a string or undefined.');\n    }\n\n    telemetryDimensionsRef.current = (0, _simpleUpdateIn.default)(telemetryDimensionsRef.current, [name], type === 'undefined' ? data : function () {\n      return data;\n    });\n  }, [telemetryDimensionsRef]);\n  var patchedActivityRenderer = (0, _react.useMemo)(function () {\n    activityRenderer && console.warn('Web Chat: \"activityRenderer\" is deprecated and will be removed on 2022-06-15, please use \"activityMiddleware\" instead.');\n    return activityRenderer || _applyMiddleware.forRenderer.apply(void 0, ['activity', {\n      strict: false\n    }].concat(_toConsumableArray((0, _singleToArray.default)(activityMiddleware)), [function () {\n      return function () {\n        return function (_ref6) {\n          var activity = _ref6.activity;\n\n          if (activity) {\n            throw new Error(\"No renderer for activity of type \\\"\".concat(activity.type, \"\\\"\"));\n          } else {\n            throw new Error('No activity to render');\n          }\n        };\n      };\n    }]))({});\n  }, [activityMiddleware, activityRenderer]);\n  var patchedActivityStatusRenderer = (0, _react.useMemo)(function () {\n    activityStatusRenderer && console.warn('Web Chat: \"activityStatusRenderer\" is deprecated and will be removed on 2022-06-15, please use \"activityStatusMiddleware\" instead.');\n    return activityStatusRenderer || _applyMiddleware.forRenderer.apply(void 0, ['activity status', {\n      strict: false\n    }].concat(_toConsumableArray((0, _singleToArray.default)(activityStatusMiddleware)), [function () {\n      return function () {\n        return function () {\n          return false;\n        };\n      };\n    }]))({});\n  }, [activityStatusMiddleware, activityStatusRenderer]);\n  var patchedAttachmentForScreenReaderRenderer = (0, _react.useMemo)(function () {\n    return _applyMiddleware.forRenderer.apply(void 0, ['attachment for screen reader', {\n      strict: true\n    }].concat(_toConsumableArray((0, _singleToArray.default)(attachmentForScreenReaderMiddleware)), [function () {\n      return function () {\n        return function (_ref7) {\n          var attachment = _ref7.attachment;\n          return function () {\n            if (attachment) {\n              throw new Error(\"No renderer for attachment for screen reader of type \\\"\".concat(attachment.contentType, \"\\\"\"));\n            } else {\n              throw new Error('No attachment to render');\n            }\n          };\n        };\n      };\n    }]))({});\n  }, [attachmentForScreenReaderMiddleware]);\n  var patchedAttachmentRenderer = (0, _react.useMemo)(function () {\n    if (attachmentRenderer) {\n      console.warn('Web Chat: \"attachmentRenderer\" is deprecated and will be removed on 2022-06-15, please use \"attachmentMiddleware\" instead.');\n      return attachmentRenderer;\n    } // Attachment renderer\n\n\n    return _applyMiddleware.default.apply(void 0, ['attachment'].concat(_toConsumableArray((0, _singleToArray.default)(attachmentMiddleware)), [function () {\n      return function () {\n        return function (_ref8) {\n          var attachment = _ref8.attachment;\n\n          if (attachment) {\n            throw new Error(\"No renderer for attachment of type \\\"\".concat(attachment.contentType, \"\\\"\"));\n          } else {\n            throw new Error('No attachment to render');\n          }\n        };\n      };\n    }]))({});\n  }, [attachmentMiddleware, attachmentRenderer]);\n  var patchedAvatarRenderer = (0, _react.useMemo)(function () {\n    avatarRenderer && console.warn('Web Chat: \"avatarRenderer\" is deprecated and will be removed on 2022-06-15, please use \"avatarMiddleware\" instead.');\n    return avatarRenderer || _applyMiddleware.forRenderer.apply(void 0, ['avatar', {\n      strict: false\n    }].concat(_toConsumableArray((0, _singleToArray.default)(avatarMiddleware)), [function () {\n      return function () {\n        return function () {\n          return false;\n        };\n      };\n    }]))({});\n  }, [avatarMiddleware, avatarRenderer]);\n  var patchedToastRenderer = (0, _react.useMemo)(function () {\n    toastRenderer && console.warn('Web Chat: \"toastRenderer\" is deprecated and will be removed on 2022-06-15, please use \"toastMiddleware\" instead.');\n    return toastRenderer || _applyMiddleware.forRenderer.apply(void 0, ['toast', {\n      strict: false\n    }].concat(_toConsumableArray((0, _singleToArray.default)(toastMiddleware)), [function () {\n      return function () {\n        return function (_ref9) {\n          var notification = _ref9.notification;\n\n          if (notification) {\n            throw new Error(\"No renderer for notification of type \\\"\".concat(notification.contentType, \"\\\"\"));\n          } else {\n            throw new Error('No notification to render');\n          }\n        };\n      };\n    }]))({});\n  }, [toastMiddleware, toastRenderer]);\n  var patchedTypingIndicatorRenderer = (0, _react.useMemo)(function () {\n    typingIndicatorRenderer && console.warn('Web Chat: \"typingIndicatorRenderer\" is deprecated and will be removed on 2022-06-15, please use \"typingIndicatorMiddleware\" instead.');\n    return typingIndicatorRenderer || _applyMiddleware.forRenderer.apply(void 0, ['typing indicator', {\n      strict: false\n    }].concat(_toConsumableArray((0, _singleToArray.default)(typingIndicatorMiddleware)), [function () {\n      return function () {\n        return function () {\n          return false;\n        };\n      };\n    }]))({});\n  }, [typingIndicatorMiddleware, typingIndicatorRenderer]); // This is a heavy function, and it is expected to be only called when there is a need to recreate business logic, e.g.\n  // - User ID changed, causing all send* functions to be updated\n  // - send\n  // TODO: [P3] We should think about if we allow the user to change onSendBoxValueChanged/sendBoxValue, e.g.\n  // 1. Turns text into UPPERCASE\n  // 2. Filter out profanity\n  // TODO: [P4] Revisit all members of context\n  //       This context should consist of members that are not in the Redux store\n  //       i.e. members that are not interested in other types of UIs\n\n  var context = (0, _react.useMemo)(function () {\n    return _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, cardActionContext), groupActivitiesContext), hoistedDispatchers), {}, {\n      activityRenderer: patchedActivityRenderer,\n      activityStatusRenderer: patchedActivityStatusRenderer,\n      attachmentForScreenReaderRenderer: patchedAttachmentForScreenReaderRenderer,\n      attachmentRenderer: patchedAttachmentRenderer,\n      avatarRenderer: patchedAvatarRenderer,\n      dir: patchedDir,\n      directLine: directLine,\n      disabled: disabled,\n      downscaleImageToDataURL: downscaleImageToDataURL,\n      grammars: patchedGrammars,\n      internalErrorBoxClass: internalErrorBoxClass,\n      language: locale,\n      localizedGlobalizeState: [localizedGlobalize],\n      localizedStrings: patchedLocalizedStrings,\n      onTelemetry: onTelemetry,\n      renderMarkdown: renderMarkdown,\n      selectVoice: patchedSelectVoice,\n      sendTypingIndicator: sendTypingIndicator,\n      styleOptions: patchedStyleOptions,\n      telemetryDimensionsRef: telemetryDimensionsRef,\n      toastRenderer: patchedToastRenderer,\n      trackDimension: trackDimension,\n      typingIndicatorRenderer: patchedTypingIndicatorRenderer,\n      userID: userID,\n      username: username\n    });\n  }, [cardActionContext, directLine, disabled, downscaleImageToDataURL, groupActivitiesContext, hoistedDispatchers, internalErrorBoxClass, locale, localizedGlobalize, onTelemetry, patchedActivityRenderer, patchedActivityStatusRenderer, patchedAttachmentForScreenReaderRenderer, patchedAttachmentRenderer, patchedAvatarRenderer, patchedDir, patchedGrammars, patchedLocalizedStrings, patchedSelectVoice, patchedStyleOptions, patchedToastRenderer, patchedTypingIndicatorRenderer, renderMarkdown, sendTypingIndicator, telemetryDimensionsRef, trackDimension, userID, username]);\n  return /*#__PURE__*/_react.default.createElement(_WebChatAPIContext.default.Provider, {\n    value: context\n  }, typeof children === 'function' ? children(context) : children, onTelemetry && /*#__PURE__*/_react.default.createElement(_Tracker.default, null));\n}; // We will create a Redux store if it was not passed in\n\n\nvar ComposeWithStore = function ComposeWithStore(_ref10) {\n  var internalRenderErrorBox = _ref10.internalRenderErrorBox,\n      onTelemetry = _ref10.onTelemetry,\n      store = _ref10.store,\n      props = _objectWithoutProperties(_ref10, [\"internalRenderErrorBox\", \"onTelemetry\", \"store\"]);\n\n  var _useState = (0, _react.useState)(),\n      _useState2 = _slicedToArray(_useState, 2),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  var handleError = (0, _react.useCallback)(function (error) {\n    console.error('botframework-webchat: Uncaught exception', {\n      error: error\n    });\n    onTelemetry && onTelemetry((0, _createCustomEvent.default)('exception', {\n      error: error,\n      fatal: true\n    }));\n    setError(error);\n  }, [onTelemetry, setError]);\n  var memoizedStore = (0, _react.useMemo)(function () {\n    return store || (0, _botframeworkWebchatCore.createStore)();\n  }, [store]);\n  return error ? !!internalRenderErrorBox && internalRenderErrorBox({\n    error: error,\n    type: 'uncaught exception'\n  }) : /*#__PURE__*/_react.default.createElement(_ErrorBoundary.default, {\n    onError: handleError\n  }, /*#__PURE__*/_react.default.createElement(_reactRedux.Provider, {\n    context: _WebChatReduxContext.default,\n    store: memoizedStore\n  }, /*#__PURE__*/_react.default.createElement(Composer, _extends({\n    internalRenderErrorBox: internalRenderErrorBox,\n    onTelemetry: onTelemetry\n  }, props))));\n};\n\nComposeWithStore.defaultProps = {\n  internalRenderErrorBox: undefined,\n  onTelemetry: undefined,\n  store: undefined\n};\nComposeWithStore.propTypes = {\n  internalRenderErrorBox: _propTypes.default.any,\n  onTelemetry: _propTypes.default.func,\n  store: _propTypes.default.any\n};\nvar _default = ComposeWithStore; // TODO: [P3] We should consider moving some data from Redux store to props\n//       Although we use `connectToWebChat` to hide the details of accessor of Redux store,\n//       we should clean up the responsibility between Context and Redux store\n//       We should decide which data is needed for React but not in other environment such as CLI/VSCode\n\nexports.default = _default;\nComposer.defaultProps = {\n  activityMiddleware: undefined,\n  activityRenderer: undefined,\n  activityStatusMiddleware: undefined,\n  activityStatusRenderer: undefined,\n  attachmentForScreenReaderMiddleware: undefined,\n  attachmentMiddleware: undefined,\n  attachmentRenderer: undefined,\n  avatarMiddleware: undefined,\n  avatarRenderer: undefined,\n  cardActionMiddleware: undefined,\n  children: undefined,\n  dir: 'auto',\n  disabled: false,\n  downscaleImageToDataURL: undefined,\n  grammars: [],\n  groupActivitiesMiddleware: undefined,\n  groupTimestamp: undefined,\n  internalErrorBoxClass: undefined,\n  locale: window.navigator.language || 'en-US',\n  onTelemetry: undefined,\n  overrideLocalizedStrings: undefined,\n  renderMarkdown: undefined,\n  selectVoice: undefined,\n  sendTimeout: undefined,\n  sendTypingIndicator: false,\n  styleOptions: {},\n  toastMiddleware: undefined,\n  toastRenderer: undefined,\n  typingIndicatorMiddleware: undefined,\n  typingIndicatorRenderer: undefined,\n  userID: '',\n  username: ''\n};\nComposer.propTypes = {\n  activityMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  activityRenderer: _propTypes.default.func,\n  activityStatusMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  activityStatusRenderer: _propTypes.default.func,\n  attachmentForScreenReaderMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  attachmentMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  attachmentRenderer: _propTypes.default.func,\n  avatarMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  avatarRenderer: _propTypes.default.func,\n  cardActionMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  children: _propTypes.default.any,\n  dir: _propTypes.default.oneOf(['auto', 'ltr', 'rtl']),\n  directLine: _propTypes.default.shape({\n    activity$: _propTypes.default.shape({\n      subscribe: _propTypes.default.func.isRequired\n    }).isRequired,\n    connectionStatus$: _propTypes.default.shape({\n      subscribe: _propTypes.default.func.isRequired\n    }).isRequired,\n    end: _propTypes.default.func,\n    getSessionId: _propTypes.default.func,\n    postActivity: _propTypes.default.func.isRequired,\n    referenceGrammarID: _propTypes.default.string,\n    token: _propTypes.default.string\n  }).isRequired,\n  disabled: _propTypes.default.bool,\n  downscaleImageToDataURL: _propTypes.default.func,\n  grammars: _propTypes.default.arrayOf(_propTypes.default.string),\n  groupActivitiesMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  groupTimestamp: _propTypes.default.oneOfType([_propTypes.default.bool, _propTypes.default.number]),\n  internalErrorBoxClass: _propTypes.default.func,\n  // This is for internal use only. We don't allow customization of error box.\n  locale: _propTypes.default.string,\n  onTelemetry: _propTypes.default.func,\n  overrideLocalizedStrings: _propTypes.default.oneOfType([_propTypes.default.any, _propTypes.default.func]),\n  renderMarkdown: _propTypes.default.func,\n  selectVoice: _propTypes.default.func,\n  sendTimeout: _propTypes.default.number,\n  sendTypingIndicator: _propTypes.default.bool,\n  styleOptions: _propTypes.default.any,\n  toastMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  toastRenderer: _propTypes.default.func,\n  typingIndicatorMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  typingIndicatorRenderer: _propTypes.default.func,\n  userID: _propTypes.default.string,\n  username: _propTypes.default.string\n};","map":{"version":3,"sources":["../../src/hooks/Composer.js"],"names":["DISPATCHERS","clearSuggestedActions","dismissNotification","emitTypingIndicator","markActivity","postActivity","sendEvent","sendFiles","sendMessage","sendMessageBack","sendPostBack","setDictateInterims","setDictateState","setNotification","setSendBox","setSendTimeout","startDictate","startSpeakingActivity","stopDictate","stopSpeakingActivity","submitSendBox","cardActionMiddleware","directLine","dispatch","runMiddleware","onCardAction","target","cardAction","getSignInUrl","value","encodeURIComponent","console","groupActivitiesMiddleware","groupTimestamp","groupActivities","merged","overrideLocalizedStrings","Composer","activityMiddleware","activityRenderer","activityStatusMiddleware","activityStatusRenderer","attachmentMiddleware","attachmentForScreenReaderMiddleware","attachmentRenderer","avatarMiddleware","avatarRenderer","children","dir","disabled","downscaleImageToDataURL","grammars","internalErrorBoxClass","locale","onTelemetry","renderMarkdown","selectVoice","sendTimeout","sendTypingIndicator","styleOptions","toastMiddleware","toastRenderer","typingIndicatorMiddleware","typingIndicatorRenderer","userID","username","telemetryDimensionsRef","patchedDir","patchedGrammars","patchedStyleOptions","cardActionContext","createCardActionContext","patchedSelectVoice","language","groupActivitiesContext","createGroupActivitiesContext","hoistedDispatchers","dispatcher","patchedLocalizedStrings","mergeStringsOverrides","localizedGlobalize","GLOBALIZE","GLOBALIZE_LANGUAGE","trackDimension","type","patchedActivityRenderer","strict","activity","patchedActivityStatusRenderer","patchedAttachmentForScreenReaderRenderer","attachment","patchedAttachmentRenderer","patchedAvatarRenderer","patchedToastRenderer","notification","patchedTypingIndicatorRenderer","context","attachmentForScreenReaderRenderer","localizedGlobalizeState","localizedStrings","ComposeWithStore","internalRenderErrorBox","store","props","error","setError","handleError","fatal","memoizedStore","WebChatReduxContext","undefined","PropTypes","any","window","activity$","subscribe","isRequired","connectionStatus$","end","getSessionId","referenceGrammarID","token","string"],"mappings":"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","sourcesContent":["import { Provider } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport updateIn from 'simple-update-in';\n\nimport createCustomEvent from '../utils/createCustomEvent';\nimport ErrorBoundary from './utils/ErrorBoundary';\nimport getAllLocalizedStrings from '../localization/getAllLocalizedStrings';\nimport isObject from '../utils/isObject';\nimport normalizeLanguage from '../utils/normalizeLanguage';\nimport PrecompiledGlobalize from '../external/PrecompiledGlobalize';\n\nimport {\n  clearSuggestedActions,\n  connect as createConnectAction,\n  createStore,\n  disconnect,\n  dismissNotification,\n  emitTypingIndicator,\n  markActivity,\n  postActivity,\n  sendEvent,\n  sendFiles,\n  sendMessage,\n  sendMessageBack,\n  sendPostBack,\n  setDictateInterims,\n  setDictateState,\n  setLanguage,\n  setNotification,\n  setSendBox,\n  setSendTimeout,\n  setSendTypingIndicator,\n  startDictate,\n  startSpeakingActivity,\n  stopDictate,\n  stopSpeakingActivity,\n  submitSendBox\n} from 'botframework-webchat-core';\n\nimport createDefaultCardActionMiddleware from './middleware/createDefaultCardActionMiddleware';\nimport createDefaultGroupActivitiesMiddleware from './middleware/createDefaultGroupActivitiesMiddleware';\nimport defaultSelectVoice from './internal/defaultSelectVoice';\nimport mapMap from '../utils/mapMap';\nimport observableToPromise from './utils/observableToPromise';\nimport Tracker from './internal/Tracker';\nimport WebChatReduxContext, { useDispatch } from './internal/WebChatReduxContext';\nimport WebChatAPIContext from './internal/WebChatAPIContext';\n\nimport applyMiddleware, { forRenderer as applyMiddlewareForRenderer } from './middleware/applyMiddleware';\nimport patchStyleOptions from '../patchStyleOptions';\nimport singleToArray from './utils/singleToArray';\n\n// List of Redux actions factory we are hoisting as Web Chat functions\nconst DISPATCHERS = {\n  clearSuggestedActions,\n  dismissNotification,\n  emitTypingIndicator,\n  markActivity,\n  postActivity,\n  sendEvent,\n  sendFiles,\n  sendMessage,\n  sendMessageBack,\n  sendPostBack,\n  setDictateInterims,\n  setDictateState,\n  setNotification,\n  setSendBox,\n  setSendTimeout,\n  startDictate,\n  startSpeakingActivity,\n  stopDictate,\n  stopSpeakingActivity,\n  submitSendBox\n};\n\nfunction createCardActionContext({ cardActionMiddleware, directLine, dispatch }) {\n  const runMiddleware = applyMiddleware(\n    'card action',\n    ...singleToArray(cardActionMiddleware),\n    createDefaultCardActionMiddleware()\n  )({ dispatch });\n\n  return {\n    onCardAction: (cardAction, { target } = {}) =>\n      runMiddleware({\n        cardAction,\n        getSignInUrl:\n          cardAction.type === 'signin'\n            ? () => {\n                const { value } = cardAction;\n\n                if (directLine.getSessionId) {\n                  // TODO: [P3] We should change this one to async/await.\n                  //       This is the first place in this project to use async.\n                  //       Thus, we need to add @babel/plugin-transform-runtime and @babel/runtime.\n\n                  return observableToPromise(directLine.getSessionId()).then(\n                    sessionId => `${value}${encodeURIComponent(`&code_challenge=${sessionId}`)}`\n                  );\n                }\n\n                console.warn('botframework-webchat: OAuth is not supported on this Direct Line adapter.');\n\n                return value;\n              }\n            : null,\n        target\n      })\n  };\n}\n\nfunction createGroupActivitiesContext({ groupActivitiesMiddleware, groupTimestamp }) {\n  const runMiddleware = applyMiddleware(\n    'group activities',\n    ...singleToArray(groupActivitiesMiddleware),\n    createDefaultGroupActivitiesMiddleware({ groupTimestamp })\n  );\n\n  return {\n    groupActivities: runMiddleware({})\n  };\n}\n\nfunction mergeStringsOverrides(localizedStrings, language, overrideLocalizedStrings) {\n  if (!overrideLocalizedStrings) {\n    return localizedStrings;\n  } else if (typeof overrideLocalizedStrings === 'function') {\n    const merged = overrideLocalizedStrings(localizedStrings, language);\n\n    if (!isObject(merged)) {\n      throw new Error('botframework-webchat: overrideLocalizedStrings function must return an object.');\n    }\n\n    return merged;\n  }\n\n  if (!isObject(overrideLocalizedStrings)) {\n    throw new Error('botframework-webchat: overrideLocalizedStrings must be either a function, an object, or falsy.');\n  }\n\n  return { ...localizedStrings, ...overrideLocalizedStrings };\n}\n\nconst Composer = ({\n  activityMiddleware,\n  activityRenderer,\n  activityStatusMiddleware,\n  activityStatusRenderer,\n  attachmentMiddleware,\n  attachmentForScreenReaderMiddleware,\n  attachmentRenderer,\n  avatarMiddleware,\n  avatarRenderer,\n  cardActionMiddleware,\n  children,\n  dir,\n  directLine,\n  disabled,\n  downscaleImageToDataURL,\n  grammars,\n  groupActivitiesMiddleware,\n  groupTimestamp,\n  internalErrorBoxClass,\n  locale,\n  onTelemetry,\n  overrideLocalizedStrings,\n  renderMarkdown,\n  selectVoice,\n  sendTimeout,\n  sendTypingIndicator,\n  styleOptions,\n  toastMiddleware,\n  toastRenderer,\n  typingIndicatorMiddleware,\n  typingIndicatorRenderer,\n  userID,\n  username\n}) => {\n  const dispatch = useDispatch();\n  const telemetryDimensionsRef = useRef({});\n\n  const patchedDir = useMemo(() => (dir === 'ltr' || dir === 'rtl' ? dir : 'auto'), [dir]);\n  const patchedGrammars = useMemo(() => grammars || [], [grammars]);\n  const patchedStyleOptions = useMemo(() => patchStyleOptions(styleOptions, { groupTimestamp, sendTimeout }), [\n    groupTimestamp,\n    sendTimeout,\n    styleOptions\n  ]);\n\n  useEffect(() => {\n    dispatch(setLanguage(locale));\n  }, [dispatch, locale]);\n\n  useEffect(() => {\n    typeof sendTimeout === 'number' && dispatch(setSendTimeout(sendTimeout));\n  }, [dispatch, sendTimeout]);\n\n  useEffect(() => {\n    dispatch(setSendTypingIndicator(!!sendTypingIndicator));\n  }, [dispatch, sendTypingIndicator]);\n\n  useEffect(() => {\n    dispatch(\n      createConnectAction({\n        directLine,\n        userID,\n        username\n      })\n    );\n\n    return () => {\n      // TODO: [P3] disconnect() is an async call (pending -> fulfilled), we need to wait, or change it to reconnect()\n      dispatch(disconnect());\n    };\n  }, [dispatch, directLine, userID, username]);\n\n  const cardActionContext = useMemo(() => createCardActionContext({ cardActionMiddleware, directLine, dispatch }), [\n    cardActionMiddleware,\n    directLine,\n    dispatch\n  ]);\n\n  const patchedSelectVoice = useMemo(() => selectVoice || defaultSelectVoice.bind(null, { language: locale }), [\n    locale,\n    selectVoice\n  ]);\n\n  const groupActivitiesContext = useMemo(\n    () =>\n      createGroupActivitiesContext({\n        groupActivitiesMiddleware,\n        groupTimestamp: patchedStyleOptions.groupTimestamp\n      }),\n    [groupActivitiesMiddleware, patchedStyleOptions.groupTimestamp]\n  );\n\n  const hoistedDispatchers = useMemo(\n    () => mapMap(DISPATCHERS, dispatcher => (...args) => dispatch(dispatcher(...args))),\n    [dispatch]\n  );\n\n  const patchedLocalizedStrings = useMemo(\n    () => mergeStringsOverrides(getAllLocalizedStrings()[normalizeLanguage(locale)], locale, overrideLocalizedStrings),\n    [locale, overrideLocalizedStrings]\n  );\n\n  const localizedGlobalize = useMemo(() => {\n    const { GLOBALIZE, GLOBALIZE_LANGUAGE } = patchedLocalizedStrings || {};\n\n    return GLOBALIZE || (GLOBALIZE_LANGUAGE && PrecompiledGlobalize(GLOBALIZE_LANGUAGE)) || PrecompiledGlobalize('en');\n  }, [patchedLocalizedStrings]);\n\n  const trackDimension = useCallback(\n    (name, data) => {\n      if (!name || typeof name !== 'string') {\n        return console.warn('botframework-webchat: Telemetry dimension name must be a string.');\n      }\n\n      const type = typeof data;\n\n      if (type !== 'string' && type !== 'undefined') {\n        return console.warn('botframework-webchat: Telemetry dimension data must be a string or undefined.');\n      }\n\n      telemetryDimensionsRef.current = updateIn(\n        telemetryDimensionsRef.current,\n        [name],\n        type === 'undefined' ? data : () => data\n      );\n    },\n    [telemetryDimensionsRef]\n  );\n\n  const patchedActivityRenderer = useMemo(() => {\n    activityRenderer &&\n      console.warn(\n        'Web Chat: \"activityRenderer\" is deprecated and will be removed on 2022-06-15, please use \"activityMiddleware\" instead.'\n      );\n\n    return (\n      activityRenderer ||\n      applyMiddlewareForRenderer(\n        'activity',\n        { strict: false },\n        ...singleToArray(activityMiddleware),\n        () => () => ({ activity }) => {\n          if (activity) {\n            throw new Error(`No renderer for activity of type \"${activity.type}\"`);\n          } else {\n            throw new Error('No activity to render');\n          }\n        }\n      )({})\n    );\n  }, [activityMiddleware, activityRenderer]);\n\n  const patchedActivityStatusRenderer = useMemo(() => {\n    activityStatusRenderer &&\n      console.warn(\n        'Web Chat: \"activityStatusRenderer\" is deprecated and will be removed on 2022-06-15, please use \"activityStatusMiddleware\" instead.'\n      );\n\n    return (\n      activityStatusRenderer ||\n      applyMiddlewareForRenderer(\n        'activity status',\n        { strict: false },\n        ...singleToArray(activityStatusMiddleware),\n        () => () => () => false\n      )({})\n    );\n  }, [activityStatusMiddleware, activityStatusRenderer]);\n\n  const patchedAttachmentForScreenReaderRenderer = useMemo(\n    () =>\n      applyMiddlewareForRenderer(\n        'attachment for screen reader',\n        { strict: true },\n        ...singleToArray(attachmentForScreenReaderMiddleware),\n        () => () => ({ attachment }) => () => {\n          if (attachment) {\n            throw new Error(`No renderer for attachment for screen reader of type \"${attachment.contentType}\"`);\n          } else {\n            throw new Error('No attachment to render');\n          }\n        }\n      )({}),\n    [attachmentForScreenReaderMiddleware]\n  );\n\n  const patchedAttachmentRenderer = useMemo(() => {\n    if (attachmentRenderer) {\n      console.warn(\n        'Web Chat: \"attachmentRenderer\" is deprecated and will be removed on 2022-06-15, please use \"attachmentMiddleware\" instead.'\n      );\n\n      return attachmentRenderer;\n    }\n\n    // Attachment renderer\n    return applyMiddleware('attachment', ...singleToArray(attachmentMiddleware), () => () => ({ attachment }) => {\n      if (attachment) {\n        throw new Error(`No renderer for attachment of type \"${attachment.contentType}\"`);\n      } else {\n        throw new Error('No attachment to render');\n      }\n    })({});\n  }, [attachmentMiddleware, attachmentRenderer]);\n\n  const patchedAvatarRenderer = useMemo(() => {\n    avatarRenderer &&\n      console.warn(\n        'Web Chat: \"avatarRenderer\" is deprecated and will be removed on 2022-06-15, please use \"avatarMiddleware\" instead.'\n      );\n\n    return (\n      avatarRenderer ||\n      applyMiddlewareForRenderer('avatar', { strict: false }, ...singleToArray(avatarMiddleware), () => () => () =>\n        false\n      )({})\n    );\n  }, [avatarMiddleware, avatarRenderer]);\n\n  const patchedToastRenderer = useMemo(() => {\n    toastRenderer &&\n      console.warn(\n        'Web Chat: \"toastRenderer\" is deprecated and will be removed on 2022-06-15, please use \"toastMiddleware\" instead.'\n      );\n\n    return (\n      toastRenderer ||\n      applyMiddlewareForRenderer(\n        'toast',\n        { strict: false },\n        ...singleToArray(toastMiddleware),\n        () => () => ({ notification }) => {\n          if (notification) {\n            throw new Error(`No renderer for notification of type \"${notification.contentType}\"`);\n          } else {\n            throw new Error('No notification to render');\n          }\n        }\n      )({})\n    );\n  }, [toastMiddleware, toastRenderer]);\n\n  const patchedTypingIndicatorRenderer = useMemo(() => {\n    typingIndicatorRenderer &&\n      console.warn(\n        'Web Chat: \"typingIndicatorRenderer\" is deprecated and will be removed on 2022-06-15, please use \"typingIndicatorMiddleware\" instead.'\n      );\n\n    return (\n      typingIndicatorRenderer ||\n      applyMiddlewareForRenderer(\n        'typing indicator',\n        { strict: false },\n        ...singleToArray(typingIndicatorMiddleware),\n        () => () => () => false\n      )({})\n    );\n  }, [typingIndicatorMiddleware, typingIndicatorRenderer]);\n\n  // This is a heavy function, and it is expected to be only called when there is a need to recreate business logic, e.g.\n  // - User ID changed, causing all send* functions to be updated\n  // - send\n\n  // TODO: [P3] We should think about if we allow the user to change onSendBoxValueChanged/sendBoxValue, e.g.\n  // 1. Turns text into UPPERCASE\n  // 2. Filter out profanity\n\n  // TODO: [P4] Revisit all members of context\n  //       This context should consist of members that are not in the Redux store\n  //       i.e. members that are not interested in other types of UIs\n  const context = useMemo(\n    () => ({\n      ...cardActionContext,\n      ...groupActivitiesContext,\n      ...hoistedDispatchers,\n      activityRenderer: patchedActivityRenderer,\n      activityStatusRenderer: patchedActivityStatusRenderer,\n      attachmentForScreenReaderRenderer: patchedAttachmentForScreenReaderRenderer,\n      attachmentRenderer: patchedAttachmentRenderer,\n      avatarRenderer: patchedAvatarRenderer,\n      dir: patchedDir,\n      directLine,\n      disabled,\n      downscaleImageToDataURL,\n      grammars: patchedGrammars,\n      internalErrorBoxClass,\n      language: locale,\n      localizedGlobalizeState: [localizedGlobalize],\n      localizedStrings: patchedLocalizedStrings,\n      onTelemetry,\n      renderMarkdown,\n      selectVoice: patchedSelectVoice,\n      sendTypingIndicator,\n      styleOptions: patchedStyleOptions,\n      telemetryDimensionsRef,\n      toastRenderer: patchedToastRenderer,\n      trackDimension,\n      typingIndicatorRenderer: patchedTypingIndicatorRenderer,\n      userID,\n      username\n    }),\n    [\n      cardActionContext,\n      directLine,\n      disabled,\n      downscaleImageToDataURL,\n      groupActivitiesContext,\n      hoistedDispatchers,\n      internalErrorBoxClass,\n      locale,\n      localizedGlobalize,\n      onTelemetry,\n      patchedActivityRenderer,\n      patchedActivityStatusRenderer,\n      patchedAttachmentForScreenReaderRenderer,\n      patchedAttachmentRenderer,\n      patchedAvatarRenderer,\n      patchedDir,\n      patchedGrammars,\n      patchedLocalizedStrings,\n      patchedSelectVoice,\n      patchedStyleOptions,\n      patchedToastRenderer,\n      patchedTypingIndicatorRenderer,\n      renderMarkdown,\n      sendTypingIndicator,\n      telemetryDimensionsRef,\n      trackDimension,\n      userID,\n      username\n    ]\n  );\n\n  return (\n    <WebChatAPIContext.Provider value={context}>\n      {typeof children === 'function' ? children(context) : children}\n      {onTelemetry && <Tracker />}\n    </WebChatAPIContext.Provider>\n  );\n};\n\n// We will create a Redux store if it was not passed in\nconst ComposeWithStore = ({ internalRenderErrorBox, onTelemetry, store, ...props }) => {\n  const [error, setError] = useState();\n\n  const handleError = useCallback(\n    error => {\n      console.error('botframework-webchat: Uncaught exception', { error });\n\n      onTelemetry && onTelemetry(createCustomEvent('exception', { error, fatal: true }));\n      setError(error);\n    },\n    [onTelemetry, setError]\n  );\n\n  const memoizedStore = useMemo(() => store || createStore(), [store]);\n\n  return error ? (\n    !!internalRenderErrorBox && internalRenderErrorBox({ error, type: 'uncaught exception' })\n  ) : (\n    <ErrorBoundary onError={handleError}>\n      <Provider context={WebChatReduxContext} store={memoizedStore}>\n        <Composer internalRenderErrorBox={internalRenderErrorBox} onTelemetry={onTelemetry} {...props} />\n      </Provider>\n    </ErrorBoundary>\n  );\n};\n\nComposeWithStore.defaultProps = {\n  internalRenderErrorBox: undefined,\n  onTelemetry: undefined,\n  store: undefined\n};\n\nComposeWithStore.propTypes = {\n  internalRenderErrorBox: PropTypes.any,\n  onTelemetry: PropTypes.func,\n  store: PropTypes.any\n};\n\nexport default ComposeWithStore;\n\n// TODO: [P3] We should consider moving some data from Redux store to props\n//       Although we use `connectToWebChat` to hide the details of accessor of Redux store,\n//       we should clean up the responsibility between Context and Redux store\n//       We should decide which data is needed for React but not in other environment such as CLI/VSCode\n\nComposer.defaultProps = {\n  activityMiddleware: undefined,\n  activityRenderer: undefined,\n  activityStatusMiddleware: undefined,\n  activityStatusRenderer: undefined,\n  attachmentForScreenReaderMiddleware: undefined,\n  attachmentMiddleware: undefined,\n  attachmentRenderer: undefined,\n  avatarMiddleware: undefined,\n  avatarRenderer: undefined,\n  cardActionMiddleware: undefined,\n  children: undefined,\n  dir: 'auto',\n  disabled: false,\n  downscaleImageToDataURL: undefined,\n  grammars: [],\n  groupActivitiesMiddleware: undefined,\n  groupTimestamp: undefined,\n  internalErrorBoxClass: undefined,\n  locale: window.navigator.language || 'en-US',\n  onTelemetry: undefined,\n  overrideLocalizedStrings: undefined,\n  renderMarkdown: undefined,\n  selectVoice: undefined,\n  sendTimeout: undefined,\n  sendTypingIndicator: false,\n  styleOptions: {},\n  toastMiddleware: undefined,\n  toastRenderer: undefined,\n  typingIndicatorMiddleware: undefined,\n  typingIndicatorRenderer: undefined,\n  userID: '',\n  username: ''\n};\n\nComposer.propTypes = {\n  activityMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  activityRenderer: PropTypes.func,\n  activityStatusMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  activityStatusRenderer: PropTypes.func,\n  attachmentForScreenReaderMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  attachmentMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  attachmentRenderer: PropTypes.func,\n  avatarMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  avatarRenderer: PropTypes.func,\n  cardActionMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  children: PropTypes.any,\n  dir: PropTypes.oneOf(['auto', 'ltr', 'rtl']),\n  directLine: PropTypes.shape({\n    activity$: PropTypes.shape({\n      subscribe: PropTypes.func.isRequired\n    }).isRequired,\n    connectionStatus$: PropTypes.shape({\n      subscribe: PropTypes.func.isRequired\n    }).isRequired,\n    end: PropTypes.func,\n    getSessionId: PropTypes.func,\n    postActivity: PropTypes.func.isRequired,\n    referenceGrammarID: PropTypes.string,\n    token: PropTypes.string\n  }).isRequired,\n  disabled: PropTypes.bool,\n  downscaleImageToDataURL: PropTypes.func,\n  grammars: PropTypes.arrayOf(PropTypes.string),\n  groupActivitiesMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  groupTimestamp: PropTypes.oneOfType([PropTypes.bool, PropTypes.number]),\n  internalErrorBoxClass: PropTypes.func, // This is for internal use only. We don't allow customization of error box.\n  locale: PropTypes.string,\n  onTelemetry: PropTypes.func,\n  overrideLocalizedStrings: PropTypes.oneOfType([PropTypes.any, PropTypes.func]),\n  renderMarkdown: PropTypes.func,\n  selectVoice: PropTypes.func,\n  sendTimeout: PropTypes.number,\n  sendTypingIndicator: PropTypes.bool,\n  styleOptions: PropTypes.any,\n  toastMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  toastRenderer: PropTypes.func,\n  typingIndicatorMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  typingIndicatorRenderer: PropTypes.func,\n  userID: PropTypes.string,\n  username: PropTypes.string\n};\n"],"sourceRoot":"component:///"},"metadata":{},"sourceType":"script"}