{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _Context = _interopRequireDefault(require(\"./Context\"));\n\nvar _getTabIndex = _interopRequireDefault(require(\"./getTabIndex\"));\n\nvar _inputtableKey = _interopRequireDefault(require(\"./inputtableKey\"));\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nvar DEFAULT_STYLE = {\n  outline: 0\n};\n\nvar BaseFocusBox = function BaseFocusBox(_ref, ref) {\n  var children = _ref.children,\n      disabled = _ref.disabled,\n      sendFocusRefProp = _ref.sendFocusRef,\n      otherProps = _objectWithoutProperties(_ref, [\"children\", \"disabled\", \"sendFocusRef\"]);\n\n  var sendFocusRefPersist = (0, _react.useRef)(null);\n  var patchedSendFocusRef = (0, _react.useMemo)(function () {\n    return sendFocusRefProp || sendFocusRefPersist;\n  }, [sendFocusRefPersist, sendFocusRefProp]);\n  var context = (0, _react.useMemo)(function () {\n    return {\n      sendFocusRef: patchedSendFocusRef\n    };\n  }, [patchedSendFocusRef]);\n  var focus = (0, _react.useCallback)(function () {\n    var current = patchedSendFocusRef.current;\n    current && current.focus();\n  }, [patchedSendFocusRef]);\n  var handleKeyDownCapture = (0, _react.useCallback)(function (event) {\n    var altKey = event.altKey,\n        ctrlKey = event.ctrlKey,\n        key = event.key,\n        metaKey = event.metaKey,\n        target = event.target;\n    var tabIndex = (0, _getTabIndex.default)(target);\n\n    if (altKey || ctrlKey && key !== 'v' || metaKey || !(0, _inputtableKey.default)(key) && key !== 'Backspace') {\n      // Ignore if one of the utility key (except SHIFT) is pressed\n      // E.g. CTRL-C on a link in one of the message should not jump to chat box\n      // E.g. \"A\" or \"Backspace\" should jump to chat box\n      return;\n    }\n\n    if (typeof tabIndex !== 'number' || tabIndex < 0 || target.getAttribute('aria-disabled') === 'true') {\n      event.stopPropagation();\n      focus();\n    }\n  }, [focus]);\n  return /*#__PURE__*/_react.default.createElement(_Context.default.Provider, {\n    value: context\n  }, /*#__PURE__*/_react.default.createElement(\"div\", _extends({}, otherProps, {\n    onKeyDownCapture: disabled ? undefined : handleKeyDownCapture,\n    ref: ref,\n    style: DEFAULT_STYLE,\n    tabIndex: -1\n  }), typeof children === 'function' ? children({\n    focus: focus\n  }) : children));\n};\n\nvar FocusBox = /*#__PURE__*/(0, _react.forwardRef)(BaseFocusBox);\nFocusBox.defaultProps = BaseFocusBox.defaultProps = {\n  children: undefined,\n  disabled: false\n};\nFocusBox.propTypes = BaseFocusBox.propTypes = {\n  children: _propTypes.default.any,\n  disabled: _propTypes.default.bool,\n  sendFocusRef: _propTypes.default.shape({\n    current: _propTypes.default.shape({\n      focus: _propTypes.default.func\n    })\n  }).isRequired\n};\nvar _default = FocusBox;\nexports.default = _default;","map":{"version":3,"sources":["../../../src/Utils/TypeFocusSink/FocusBox.js"],"names":["DEFAULT_STYLE","outline","BaseFocusBox","children","disabled","sendFocusRef","sendFocusRefProp","otherProps","sendFocusRefPersist","patchedSendFocusRef","context","focus","current","handleKeyDownCapture","altKey","ctrlKey","key","metaKey","target","event","tabIndex","FocusBox","PropTypes","func","isRequired"],"mappings":"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","sourcesContent":["// This is for defaultProps: { children: undefined }\n/* eslint no-undefined: \"off\" */\n\nimport PropTypes from 'prop-types';\nimport React, { forwardRef, useCallback, useMemo, useRef } from 'react';\n\nimport Context from './Context';\nimport getTabIndex from './getTabIndex';\nimport inputtableKey from './inputtableKey';\n\nconst DEFAULT_STYLE = { outline: 0 };\n\nconst BaseFocusBox = ({ children, disabled, sendFocusRef: sendFocusRefProp, ...otherProps }, ref) => {\n  const sendFocusRefPersist = useRef(null);\n  const patchedSendFocusRef = useMemo(() => sendFocusRefProp || sendFocusRefPersist, [\n    sendFocusRefPersist,\n    sendFocusRefProp\n  ]);\n\n  const context = useMemo(\n    () => ({\n      sendFocusRef: patchedSendFocusRef\n    }),\n    [patchedSendFocusRef]\n  );\n\n  const focus = useCallback(() => {\n    const { current } = patchedSendFocusRef;\n\n    current && current.focus();\n  }, [patchedSendFocusRef]);\n\n  const handleKeyDownCapture = useCallback(\n    event => {\n      const { altKey, ctrlKey, key, metaKey, target } = event;\n      const tabIndex = getTabIndex(target);\n\n      if (altKey || (ctrlKey && key !== 'v') || metaKey || (!inputtableKey(key) && key !== 'Backspace')) {\n        // Ignore if one of the utility key (except SHIFT) is pressed\n        // E.g. CTRL-C on a link in one of the message should not jump to chat box\n        // E.g. \"A\" or \"Backspace\" should jump to chat box\n        return;\n      }\n\n      if (typeof tabIndex !== 'number' || tabIndex < 0 || target.getAttribute('aria-disabled') === 'true') {\n        event.stopPropagation();\n\n        focus();\n      }\n    },\n    [focus]\n  );\n\n  return (\n    <Context.Provider value={context}>\n      <div\n        {...otherProps}\n        onKeyDownCapture={disabled ? undefined : handleKeyDownCapture}\n        ref={ref}\n        style={DEFAULT_STYLE}\n        tabIndex={-1}\n      >\n        {typeof children === 'function' ? children({ focus }) : children}\n      </div>\n    </Context.Provider>\n  );\n};\n\nconst FocusBox = forwardRef(BaseFocusBox);\n\nFocusBox.defaultProps = BaseFocusBox.defaultProps = {\n  children: undefined,\n  disabled: false\n};\n\nFocusBox.propTypes = BaseFocusBox.propTypes = {\n  children: PropTypes.any,\n  disabled: PropTypes.bool,\n  sendFocusRef: PropTypes.shape({\n    current: PropTypes.shape({\n      focus: PropTypes.func\n    })\n  }).isRequired\n};\n\nexport default FocusBox;\n"],"sourceRoot":"component:///"},"metadata":{},"sourceType":"script"}