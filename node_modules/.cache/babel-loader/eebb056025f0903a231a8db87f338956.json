{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _objectWithoutProperties2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _Composer = _interopRequireDefault(require(\"./Composer\"));\n\nvar _createCustomEvent = _interopRequireDefault(require(\"./createCustomEvent\"));\n\nvar _createErrorEvent = _interopRequireDefault(require(\"./createErrorEvent\"));\n\nvar _migrateDeprecatedProps = _interopRequireDefault(require(\"./migrateDeprecatedProps\"));\n\nvar _useSynthesize = _interopRequireDefault(require(\"./useSynthesize\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(source, true).forEach(function (key) {\n        (0, _defineProperty2[\"default\"])(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(source).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar SayUtterance = function SayUtterance(props) {\n  var _migrateDeprecatedPro = (0, _migrateDeprecatedProps[\"default\"])(props),\n      onEnd = _migrateDeprecatedPro.onEnd,\n      onError = _migrateDeprecatedPro.onError,\n      onStart = _migrateDeprecatedPro.onStart,\n      utterance = _migrateDeprecatedPro.utterance;\n\n  var started = (0, _react.useRef)(false);\n  var synthesize = (0, _useSynthesize[\"default\"])(); // This useEffect() is essentially converting Promise-based useSynthesize() into events.\n\n  (0, _react.useEffect)(function () {\n    // After synthesis started, if utterance has changed, the event will be fired by the wrong target.\n    // Thus, we do not allow utterance to change after synthesis started.\n    if (started.current) {\n      // Since we have already cancelled the previous utterance, we are not starting a new one.\n      // This is because if we start a new one, we could fire onStart event twice, which sound confusing to the developer.\n      return console.warn('react-say: Should not change utterance after synthesis started.');\n    }\n\n    var cancelled;\n\n    var _synthesize = synthesize(utterance, function () {\n      started.current = true;\n      !cancelled && onStart && onStart((0, _createCustomEvent[\"default\"])('start'));\n    }),\n        cancel = _synthesize.cancel,\n        promise = _synthesize.promise;\n\n    promise.then(function () {\n      return !cancelled && onEnd && onEnd((0, _createCustomEvent[\"default\"])('end'));\n    }, function (error) {\n      return !cancelled && onError && onError((0, _createErrorEvent[\"default\"])(error));\n    });\n    return function () {\n      cancelled = true;\n      cancel();\n    };\n  }, []);\n  return false;\n};\n\nSayUtterance.defaultProps = {\n  onEnd: undefined,\n  onError: undefined,\n  onStart: undefined\n};\nSayUtterance.propTypes = {\n  onEnd: _propTypes[\"default\"].func,\n  onError: _propTypes[\"default\"].func,\n  onStart: _propTypes[\"default\"].func\n};\n\nvar SayUtteranceWithContext = function SayUtteranceWithContext(_ref) {\n  var ponyfill = _ref.ponyfill,\n      props = (0, _objectWithoutProperties2[\"default\"])(_ref, [\"ponyfill\"]);\n  return _react[\"default\"].createElement(_Composer[\"default\"], {\n    ponyfill: ponyfill\n  }, _react[\"default\"].createElement(SayUtterance, props));\n};\n\nSayUtteranceWithContext.defaultProps = _objectSpread({}, SayUtterance.defaultProps, {\n  ponyfill: undefined\n});\nSayUtteranceWithContext.propTypes = _objectSpread({}, SayUtterance.propTypes, {\n  ponyfill: _propTypes[\"default\"].shape({\n    speechSynthesis: _propTypes[\"default\"].any.isRequired,\n    SpeechSynthesisUtterance: _propTypes[\"default\"].any.isRequired\n  })\n});\nvar _default = SayUtteranceWithContext;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["../src/SayUtterance.js"],"names":["SayUtterance","onEnd","onError","onStart","utterance","started","synthesize","console","cancel","promise","cancelled","undefined","PropTypes","func","SayUtteranceWithContext","ponyfill","props","speechSynthesis","SpeechSynthesisUtterance","isRequired"],"mappings":"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","sourcesContent":["import PropTypes from 'prop-types';\nimport React, { useEffect, useRef } from 'react';\n\nimport Composer from './Composer';\nimport createCustomEvent from './createCustomEvent';\nimport createErrorEvent from './createErrorEvent';\nimport migrateDeprecatedProps from './migrateDeprecatedProps';\nimport useSynthesize from './useSynthesize';\n\nconst SayUtterance = props => {\n  const {\n    onEnd,\n    onError,\n    onStart,\n    utterance\n  } = migrateDeprecatedProps(props);\n\n  const started = useRef(false);\n  const synthesize = useSynthesize();\n\n  // This useEffect() is essentially converting Promise-based useSynthesize() into events.\n  useEffect(() => {\n    // After synthesis started, if utterance has changed, the event will be fired by the wrong target.\n    // Thus, we do not allow utterance to change after synthesis started.\n    if (started.current) {\n      // Since we have already cancelled the previous utterance, we are not starting a new one.\n      // This is because if we start a new one, we could fire onStart event twice, which sound confusing to the developer.\n\n      return console.warn('react-say: Should not change utterance after synthesis started.');\n    }\n\n    let cancelled;\n    const { cancel, promise } = synthesize(utterance, () => {\n      started.current = true;\n      !cancelled && onStart && onStart(createCustomEvent('start'));\n    });\n\n    promise.then(\n      () => !cancelled && onEnd && onEnd(createCustomEvent('end')),\n      error => !cancelled && onError && onError(createErrorEvent(error))\n    );\n\n    return () => {\n      cancelled = true;\n      cancel();\n    };\n  }, []);\n\n  return false;\n};\n\nSayUtterance.defaultProps = {\n  onEnd: undefined,\n  onError: undefined,\n  onStart: undefined\n};\n\nSayUtterance.propTypes = {\n  onEnd: PropTypes.func,\n  onError: PropTypes.func,\n  onStart: PropTypes.func\n};\n\nconst SayUtteranceWithContext = ({ ponyfill, ...props }) => (\n  <Composer ponyfill={ ponyfill }>\n    <SayUtterance { ...props } />\n  </Composer>\n);\n\nSayUtteranceWithContext.defaultProps = {\n  ...SayUtterance.defaultProps,\n  ponyfill: undefined\n};\n\nSayUtteranceWithContext.propTypes = {\n  ...SayUtterance.propTypes,\n  ponyfill: PropTypes.shape({\n    speechSynthesis: PropTypes.any.isRequired,\n    SpeechSynthesisUtterance: PropTypes.any.isRequired\n  })\n};\n\nexport default SayUtteranceWithContext\n"]},"metadata":{},"sourceType":"script"}