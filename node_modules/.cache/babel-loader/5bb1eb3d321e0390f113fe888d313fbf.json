{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/home/Ubility/Desktop/ministry-of-industry-and-advanced-technology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.connectUploadButton = exports.default = void 0;\n\nvar _botframeworkWebchatApi = require(\"botframework-webchat-api\");\n\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _AttachmentIcon = _interopRequireDefault(require(\"./Assets/AttachmentIcon\"));\n\nvar _connectToWebChat = _interopRequireDefault(require(\"../connectToWebChat\"));\n\nvar _index = _interopRequireDefault(require(\"../Utils/downscaleImageToDataURL/index\"));\n\nvar _IconButton = _interopRequireDefault(require(\"./IconButton\"));\n\nvar _useSendFiles = _interopRequireDefault(require(\"../hooks/useSendFiles\"));\n\nvar _useStyleSet3 = _interopRequireDefault(require(\"../hooks/useStyleSet\"));\n\nvar _useStyleToEmotionObject = _interopRequireDefault(require(\"../hooks/internal/useStyleToEmotionObject\"));\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nvar useDisabled = _botframeworkWebchatApi.hooks.useDisabled,\n    useLocalizer = _botframeworkWebchatApi.hooks.useLocalizer;\nvar ROOT_STYLE = {\n  overflow: 'hidden',\n  position: 'relative',\n  '& > input': {\n    height: 0,\n    width: 0,\n    opacity: 0,\n    position: 'absolute',\n    left: 0,\n    top: 0\n  }\n};\n\nvar PREVENT_DEFAULT_HANDLER = function PREVENT_DEFAULT_HANDLER(event) {\n  return event.preventDefault();\n};\n\nfunction makeThumbnail(_x, _x2, _x3, _x4, _x5) {\n  return _makeThumbnail.apply(this, arguments);\n}\n\nfunction _makeThumbnail() {\n  _makeThumbnail = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(file, width, height, contentType, quality) {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (!/\\.(gif|jpe?g|png)$/i.test(file.name)) {\n              _context3.next = 10;\n              break;\n            }\n\n            _context3.prev = 1;\n            _context3.next = 4;\n            return (0, _index.default)(file, width, height, contentType, quality);\n\n          case 4:\n            return _context3.abrupt(\"return\", _context3.sent);\n\n          case 7:\n            _context3.prev = 7;\n            _context3.t0 = _context3[\"catch\"](1);\n            console.warn(\"Web Chat: Failed to downscale image due to \".concat(_context3.t0, \".\"));\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[1, 7]]);\n  }));\n  return _makeThumbnail.apply(this, arguments);\n}\n\nvar connectUploadButton = function connectUploadButton() {\n  for (var _len = arguments.length, selectors = new Array(_len), _key = 0; _key < _len; _key++) {\n    selectors[_key] = arguments[_key];\n  }\n\n  return _connectToWebChat.default.apply(void 0, [function (_ref) {\n    var disabled = _ref.disabled,\n        language = _ref.language,\n        _sendFiles = _ref.sendFiles,\n        _ref$styleSet$options = _ref.styleSet.options,\n        enableUploadThumbnail = _ref$styleSet$options.enableUploadThumbnail,\n        uploadThumbnailContentType = _ref$styleSet$options.uploadThumbnailContentType,\n        uploadThumbnailHeight = _ref$styleSet$options.uploadThumbnailHeight,\n        uploadThumbnailQuality = _ref$styleSet$options.uploadThumbnailQuality,\n        uploadThumbnailWidth = _ref$styleSet$options.uploadThumbnailWidth;\n    return {\n      disabled: disabled,\n      language: language,\n      sendFiles: function () {\n        var _sendFiles2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(files) {\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  if (!(files && files.length)) {\n                    _context2.next = 6;\n                    break;\n                  }\n\n                  _context2.t0 = _sendFiles;\n                  _context2.next = 4;\n                  return Promise.all([].map.call(files, /*#__PURE__*/function () {\n                    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(file) {\n                      return _regeneratorRuntime.wrap(function _callee$(_context) {\n                        while (1) {\n                          switch (_context.prev = _context.next) {\n                            case 0:\n                              _context.t0 = _objectSpread;\n                              _context.t1 = {\n                                name: file.name,\n                                size: file.size,\n                                url: window.URL.createObjectURL(file)\n                              };\n                              _context.t2 = enableUploadThumbnail;\n\n                              if (!_context.t2) {\n                                _context.next = 8;\n                                break;\n                              }\n\n                              _context.next = 6;\n                              return makeThumbnail(file, uploadThumbnailWidth, uploadThumbnailHeight, uploadThumbnailContentType, uploadThumbnailQuality);\n\n                            case 6:\n                              _context.t3 = _context.sent;\n                              _context.t2 = {\n                                thumbnail: _context.t3\n                              };\n\n                            case 8:\n                              _context.t4 = _context.t2;\n                              return _context.abrupt(\"return\", (0, _context.t0)(_context.t1, _context.t4));\n\n                            case 10:\n                            case \"end\":\n                              return _context.stop();\n                          }\n                        }\n                      }, _callee);\n                    }));\n\n                    return function (_x7) {\n                      return _ref2.apply(this, arguments);\n                    };\n                  }()));\n\n                case 4:\n                  _context2.t1 = _context2.sent;\n                  (0, _context2.t0)(_context2.t1);\n\n                case 6:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }));\n\n        function sendFiles(_x6) {\n          return _sendFiles2.apply(this, arguments);\n        }\n\n        return sendFiles;\n      }()\n    };\n  }].concat(selectors));\n};\n\nexports.connectUploadButton = connectUploadButton;\n\nvar UploadButton = function UploadButton() {\n  var _useStyleSet = (0, _useStyleSet3.default)(),\n      _useStyleSet2 = _slicedToArray(_useStyleSet, 1),\n      uploadButtonStyleSet = _useStyleSet2[0].uploadButton;\n\n  var _useDisabled = useDisabled(),\n      _useDisabled2 = _slicedToArray(_useDisabled, 1),\n      disabled = _useDisabled2[0];\n\n  var inputRef = (0, _react.useRef)();\n  var localize = useLocalizer();\n  var rootClassName = (0, _useStyleToEmotionObject.default)()(ROOT_STYLE) + '';\n  var sendFiles = (0, _useSendFiles.default)();\n  var current = inputRef.current;\n  var uploadFileString = localize('TEXT_INPUT_UPLOAD_BUTTON_ALT');\n  var handleClick = (0, _react.useCallback)(function () {\n    current && current.click();\n  }, [current]);\n  var handleFileChange = (0, _react.useCallback)(function (_ref3) {\n    var files = _ref3.target.files;\n    sendFiles(files);\n\n    if (current) {\n      current.value = null;\n    }\n  }, [current, sendFiles]);\n  return /*#__PURE__*/_react.default.createElement(\"div\", {\n    className: (0, _classnames.default)(rootClassName, uploadButtonStyleSet + '')\n  }, /*#__PURE__*/_react.default.createElement(\"input\", {\n    \"aria-disabled\": disabled,\n    \"aria-hidden\": \"true\",\n    multiple: true,\n    onChange: disabled ? undefined : handleFileChange,\n    onClick: disabled ? PREVENT_DEFAULT_HANDLER : undefined,\n    readOnly: disabled,\n    ref: inputRef,\n    role: \"button\",\n    tabIndex: -1,\n    type: \"file\"\n  }), /*#__PURE__*/_react.default.createElement(_IconButton.default, {\n    alt: uploadFileString,\n    \"aria-label\": uploadFileString,\n    disabled: disabled,\n    onClick: handleClick\n  }, /*#__PURE__*/_react.default.createElement(_AttachmentIcon.default, null)));\n};\n\nvar _default = UploadButton;\nexports.default = _default;","map":{"version":3,"sources":["../../src/SendBox/UploadButton.js"],"names":["useDisabled","useLocalizer","hooks","ROOT_STYLE","overflow","position","height","width","opacity","left","top","PREVENT_DEFAULT_HANDLER","event","makeThumbnail","file","console","connectUploadButton","selectors","disabled","language","sendFiles","enableUploadThumbnail","uploadThumbnailContentType","uploadThumbnailHeight","uploadThumbnailQuality","uploadThumbnailWidth","files","name","size","url","window","thumbnail","UploadButton","uploadButtonStyleSet","inputRef","localize","rootClassName","current","uploadFileString","handleClick","handleFileChange","target"],"mappings":"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","sourcesContent":["import { hooks } from 'botframework-webchat-api';\nimport classNames from 'classnames';\nimport React, { useCallback, useRef } from 'react';\n\nimport AttachmentIcon from './Assets/AttachmentIcon';\nimport connectToWebChat from '../connectToWebChat';\nimport downscaleImageToDataURL from '../Utils/downscaleImageToDataURL/index';\nimport IconButton from './IconButton';\nimport useSendFiles from '../hooks/useSendFiles';\nimport useStyleSet from '../hooks/useStyleSet';\nimport useStyleToEmotionObject from '../hooks/internal/useStyleToEmotionObject';\n\nconst { useDisabled, useLocalizer } = hooks;\n\nconst ROOT_STYLE = {\n  overflow: 'hidden',\n  position: 'relative',\n\n  '& > input': {\n    height: 0,\n    width: 0,\n    opacity: 0,\n    position: 'absolute',\n    left: 0,\n    top: 0\n  }\n};\n\nconst PREVENT_DEFAULT_HANDLER = event => event.preventDefault();\n\nasync function makeThumbnail(file, width, height, contentType, quality) {\n  if (/\\.(gif|jpe?g|png)$/iu.test(file.name)) {\n    try {\n      return await downscaleImageToDataURL(file, width, height, contentType, quality);\n    } catch (error) {\n      console.warn(`Web Chat: Failed to downscale image due to ${error}.`);\n    }\n  }\n}\n\nconst connectUploadButton = (...selectors) =>\n  connectToWebChat(\n    ({\n      disabled,\n      language,\n      sendFiles,\n      styleSet: {\n        options: {\n          enableUploadThumbnail,\n          uploadThumbnailContentType,\n          uploadThumbnailHeight,\n          uploadThumbnailQuality,\n          uploadThumbnailWidth\n        }\n      }\n    }) => ({\n      disabled,\n      language,\n      sendFiles: async files => {\n        if (files && files.length) {\n          // TODO: [P3] We need to find revokeObjectURL on the UI side\n          //       Redux store should not know about the browser environment\n          //       One fix is to use ArrayBuffer instead of object URL, but that would requires change to DirectLineJS\n          sendFiles(\n            await Promise.all(\n              [].map.call(files, async file => ({\n                name: file.name,\n                size: file.size,\n                url: window.URL.createObjectURL(file),\n                ...(enableUploadThumbnail && {\n                  thumbnail: await makeThumbnail(\n                    file,\n                    uploadThumbnailWidth,\n                    uploadThumbnailHeight,\n                    uploadThumbnailContentType,\n                    uploadThumbnailQuality\n                  )\n                })\n              }))\n            )\n          );\n        }\n      }\n    }),\n    ...selectors\n  );\n\nconst UploadButton = () => {\n  const [{ uploadButton: uploadButtonStyleSet }] = useStyleSet();\n  const [disabled] = useDisabled();\n  const inputRef = useRef();\n  const localize = useLocalizer();\n  const rootClassName = useStyleToEmotionObject()(ROOT_STYLE) + '';\n  const sendFiles = useSendFiles();\n\n  const { current } = inputRef;\n  const uploadFileString = localize('TEXT_INPUT_UPLOAD_BUTTON_ALT');\n\n  const handleClick = useCallback(() => {\n    current && current.click();\n  }, [current]);\n\n  const handleFileChange = useCallback(\n    ({ target: { files } }) => {\n      sendFiles(files);\n\n      if (current) {\n        current.value = null;\n      }\n    },\n    [current, sendFiles]\n  );\n\n  return (\n    <div className={classNames(rootClassName, uploadButtonStyleSet + '')}>\n      <input\n        aria-disabled={disabled}\n        aria-hidden=\"true\"\n        multiple={true}\n        onChange={disabled ? undefined : handleFileChange}\n        onClick={disabled ? PREVENT_DEFAULT_HANDLER : undefined}\n        readOnly={disabled}\n        ref={inputRef}\n        role=\"button\"\n        tabIndex={-1}\n        type=\"file\"\n      />\n      <IconButton alt={uploadFileString} aria-label={uploadFileString} disabled={disabled} onClick={handleClick}>\n        <AttachmentIcon />\n      </IconButton>\n    </div>\n  );\n};\n\nexport default UploadButton;\n\nexport { connectUploadButton };\n"],"sourceRoot":"component:///"},"metadata":{},"sourceType":"script"}