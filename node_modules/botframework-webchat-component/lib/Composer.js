"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _botframeworkWebchatApi = require("botframework-webchat-api");

var _reactSay = require("react-say");

var _reactScrollToBottom = require("react-scroll-to-bottom");

var _createEmotion = _interopRequireDefault(require("create-emotion"));

var _createStyleSet = _interopRequireDefault(require("./Styles/createStyleSet"));

var _markdownIt = _interopRequireDefault(require("markdown-it"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireWildcard(require("react"));

var _BypassSpeechSynthesisPonyfill = require("./hooks/internal/BypassSpeechSynthesisPonyfill");

var _addTargetBlankToHyperlinksMarkdown = _interopRequireDefault(require("./Utils/addTargetBlankToHyperlinksMarkdown"));

var _createCSSKey = _interopRequireDefault(require("./Utils/createCSSKey"));

var _createCoreMiddleware = _interopRequireDefault(require("./Middleware/Activity/createCoreMiddleware"));

var _createCoreMiddleware2 = _interopRequireDefault(require("./Middleware/ActivityStatus/createCoreMiddleware"));

var _createCoreMiddleware3 = _interopRequireDefault(require("./Middleware/AttachmentForScreenReader/createCoreMiddleware"));

var _createCoreMiddleware4 = _interopRequireDefault(require("./Middleware/Attachment/createCoreMiddleware"));

var _createCoreMiddleware5 = _interopRequireDefault(require("./Middleware/Avatar/createCoreMiddleware"));

var _createCoreMiddleware6 = _interopRequireDefault(require("./Middleware/CardAction/createCoreMiddleware"));

var _createCoreMiddleware7 = _interopRequireDefault(require("./Middleware/Toast/createCoreMiddleware"));

var _createCoreMiddleware8 = _interopRequireDefault(require("./Middleware/TypingIndicator/createCoreMiddleware"));

var _Dictation = _interopRequireDefault(require("./Dictation"));

var _downscaleImageToDataURL = _interopRequireDefault(require("./Utils/downscaleImageToDataURL"));

var _ErrorBox = _interopRequireDefault(require("./ErrorBox"));

var _mapMap = _interopRequireDefault(require("./Utils/mapMap"));

var _singleToArray = _interopRequireDefault(require("./Utils/singleToArray"));

var _UITracker = _interopRequireDefault(require("./hooks/internal/UITracker"));

var _WebChatUIContext = _interopRequireDefault(require("./hooks/internal/WebChatUIContext"));

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var useReferenceGrammarID = _botframeworkWebchatApi.hooks.useReferenceGrammarID,
    useStyleOptions = _botframeworkWebchatApi.hooks.useStyleOptions;
var node_env = undefined || "production";
var emotionPool = {};

function createFocusContext(_ref) {
  var sendBoxFocusRef = _ref.sendBoxFocusRef,
      transcriptFocusRef = _ref.transcriptFocusRef;
  return {
    focus: function focus(where) {
      var ref = where === 'sendBox' || where === 'sendBoxWithoutKeyboard' ? sendBoxFocusRef : transcriptFocusRef;

      var _ref2 = ref || {},
          current = _ref2.current;

      if (current) {
        if (where === 'sendBoxWithoutKeyboard') {
          // To not activate the virtual keyboard while changing focus to an input, we will temporarily set it as read-only and flip it back.
          // https://stackoverflow.com/questions/7610758/prevent-iphone-default-keyboard-when-focusing-an-input/7610923
          var readOnly = current.getAttribute('readonly');
          current.setAttribute('readonly', 'readonly');
          setTimeout(function () {
            current.focus();
            readOnly ? current.setAttribute('readonly', readOnly) : current.removeAttribute('readonly');
          }, 0);
        } else {
          current.focus();
        }
      }
    }
  };
}

function styleSetToEmotionObjects(styleToEmotionObject, styleSet) {
  return (0, _mapMap.default)(styleSet, function (style, key) {
    return key === 'options' ? style : styleToEmotionObject(style);
  });
}

var ComposerCore = function ComposerCore(_ref3) {
  var children = _ref3.children,
      extraStyleSet = _ref3.extraStyleSet,
      nonce = _ref3.nonce,
      renderMarkdown = _ref3.renderMarkdown,
      styleSet = _ref3.styleSet,
      suggestedActionsAccessKey = _ref3.suggestedActionsAccessKey,
      webSpeechPonyfillFactory = _ref3.webSpeechPonyfillFactory;

  var _useState = (0, _react.useState)(),
      _useState2 = _slicedToArray(_useState, 2),
      dictateAbortable = _useState2[0],
      setDictateAbortable = _useState2[1];

  var _useReferenceGrammarI = useReferenceGrammarID(),
      _useReferenceGrammarI2 = _slicedToArray(_useReferenceGrammarI, 1),
      referenceGrammarID = _useReferenceGrammarI2[0];

  var _useStyleOptions = useStyleOptions(),
      _useStyleOptions2 = _slicedToArray(_useStyleOptions, 1),
      styleOptions = _useStyleOptions2[0];

  var internalMarkdownIt = (0, _react.useMemo)(function () {
    return new _markdownIt.default();
  }, []);
  var sendBoxFocusRef = (0, _react.useRef)();
  var transcriptActivityElementsRef = (0, _react.useRef)([]);
  var transcriptFocusRef = (0, _react.useRef)();
  var transcriptRootElementRef = (0, _react.useRef)();
  var dictationOnError = (0, _react.useCallback)(function (err) {
    console.error(err);
  }, []);
  var focusContext = (0, _react.useMemo)(function () {
    return createFocusContext({
      sendBoxFocusRef: sendBoxFocusRef,
      transcriptFocusRef: transcriptFocusRef
    });
  }, [sendBoxFocusRef, transcriptFocusRef]);
  var internalRenderMarkdownInline = (0, _react.useMemo)(function () {
    return function (markdown) {
      var tree = internalMarkdownIt.parseInline(markdown); // We should add rel="noopener noreferrer" and target="_blank"

      var patchedTree = (0, _addTargetBlankToHyperlinksMarkdown.default)(tree);
      return internalMarkdownIt.renderer.render(patchedTree);
    };
  }, [internalMarkdownIt]);
  var styleToEmotionObject = (0, _react.useMemo)(function () {
    // Emotion doesn't hash with nonce. We need to provide the pooling mechanism.
    // 1. If 2 instances use different nonce, they should result in different hash;
    // 2. If 2 instances are being mounted, pooling will make sure we render only 1 set of <style> tags, instead of 2.
    var emotion = emotionPool[nonce] || (emotionPool[nonce] = (0, _createEmotion.default)({
      key: "webchat--css-".concat((0, _createCSSKey.default)()),
      nonce: nonce
    }));
    return function (style) {
      return emotion.css(style);
    };
  }, [nonce]);
  var patchedStyleSet = (0, _react.useMemo)(function () {
    return styleSetToEmotionObjects(styleToEmotionObject, _objectSpread(_objectSpread({}, styleSet || (0, _createStyleSet.default)(styleOptions)), extraStyleSet));
  }, [extraStyleSet, styleOptions, styleSet, styleToEmotionObject]);
  var webSpeechPonyfill = (0, _react.useMemo)(function () {
    var ponyfill = webSpeechPonyfillFactory && webSpeechPonyfillFactory({
      referenceGrammarID: referenceGrammarID
    });

    var _ref4 = ponyfill || {},
        speechSynthesis = _ref4.speechSynthesis,
        SpeechSynthesisUtterance = _ref4.SpeechSynthesisUtterance;

    return _objectSpread(_objectSpread({}, ponyfill), {}, {
      speechSynthesis: speechSynthesis || _BypassSpeechSynthesisPonyfill.speechSynthesis,
      SpeechSynthesisUtterance: SpeechSynthesisUtterance || _BypassSpeechSynthesisPonyfill.SpeechSynthesisUtterance
    });
  }, [referenceGrammarID, webSpeechPonyfillFactory]);
  var context = (0, _react.useMemo)(function () {
    return _objectSpread(_objectSpread({}, focusContext), {}, {
      dictateAbortable: dictateAbortable,
      internalMarkdownItState: [internalMarkdownIt],
      internalRenderMarkdownInline: internalRenderMarkdownInline,
      nonce: nonce,
      renderMarkdown: renderMarkdown,
      sendBoxFocusRef: sendBoxFocusRef,
      setDictateAbortable: setDictateAbortable,
      styleSet: patchedStyleSet,
      styleToEmotionObject: styleToEmotionObject,
      suggestedActionsAccessKey: suggestedActionsAccessKey,
      transcriptActivityElementsRef: transcriptActivityElementsRef,
      transcriptFocusRef: transcriptFocusRef,
      transcriptRootElementRef: transcriptRootElementRef,
      webSpeechPonyfill: webSpeechPonyfill
    });
  }, [dictateAbortable, focusContext, internalMarkdownIt, internalRenderMarkdownInline, nonce, patchedStyleSet, renderMarkdown, sendBoxFocusRef, setDictateAbortable, styleToEmotionObject, suggestedActionsAccessKey, transcriptActivityElementsRef, transcriptFocusRef, transcriptRootElementRef, webSpeechPonyfill]);
  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_reactSay.Composer, {
    ponyfill: webSpeechPonyfill
  }, /*#__PURE__*/_react.default.createElement(_WebChatUIContext.default.Provider, {
    value: context
  }, children, /*#__PURE__*/_react.default.createElement(_Dictation.default, {
    onError: dictationOnError
  }))));
};

ComposerCore.defaultProps = {
  extraStyleSet: undefined,
  nonce: undefined,
  renderMarkdown: undefined,
  styleSet: undefined,
  suggestedActionsAccessKey: 'A a Å å',
  webSpeechPonyfillFactory: undefined
};
ComposerCore.propTypes = {
  extraStyleSet: _propTypes.default.any,
  nonce: _propTypes.default.string,
  renderMarkdown: _propTypes.default.func,
  styleSet: _propTypes.default.any,
  suggestedActionsAccessKey: _propTypes.default.oneOfType([_propTypes.default.oneOf([false]), _propTypes.default.string]),
  webSpeechPonyfillFactory: _propTypes.default.func
};

var Composer = function Composer(_ref5) {
  var activityMiddleware = _ref5.activityMiddleware,
      activityStatusMiddleware = _ref5.activityStatusMiddleware,
      attachmentForScreenReaderMiddleware = _ref5.attachmentForScreenReaderMiddleware,
      attachmentMiddleware = _ref5.attachmentMiddleware,
      avatarMiddleware = _ref5.avatarMiddleware,
      cardActionMiddleware = _ref5.cardActionMiddleware,
      children = _ref5.children,
      extraStyleSet = _ref5.extraStyleSet,
      renderMarkdown = _ref5.renderMarkdown,
      styleSet = _ref5.styleSet,
      suggestedActionsAccessKey = _ref5.suggestedActionsAccessKey,
      toastMiddleware = _ref5.toastMiddleware,
      typingIndicatorMiddleware = _ref5.typingIndicatorMiddleware,
      webSpeechPonyfillFactory = _ref5.webSpeechPonyfillFactory,
      composerProps = _objectWithoutProperties(_ref5, ["activityMiddleware", "activityStatusMiddleware", "attachmentForScreenReaderMiddleware", "attachmentMiddleware", "avatarMiddleware", "cardActionMiddleware", "children", "extraStyleSet", "renderMarkdown", "styleSet", "suggestedActionsAccessKey", "toastMiddleware", "typingIndicatorMiddleware", "webSpeechPonyfillFactory"]);

  var nonce = composerProps.nonce,
      onTelemetry = composerProps.onTelemetry;
  var patchedActivityMiddleware = (0, _react.useMemo)(function () {
    return [].concat(_toConsumableArray((0, _singleToArray.default)(activityMiddleware)), _toConsumableArray((0, _createCoreMiddleware.default)()));
  }, [activityMiddleware]);
  var patchedActivityStatusMiddleware = (0, _react.useMemo)(function () {
    return [].concat(_toConsumableArray((0, _singleToArray.default)(activityStatusMiddleware)), _toConsumableArray((0, _createCoreMiddleware2.default)()));
  }, [activityStatusMiddleware]);
  var patchedAttachmentForScreenReaderMiddleware = (0, _react.useMemo)(function () {
    return [].concat(_toConsumableArray((0, _singleToArray.default)(attachmentForScreenReaderMiddleware)), _toConsumableArray((0, _createCoreMiddleware3.default)()));
  }, [attachmentForScreenReaderMiddleware]);
  var patchedAttachmentMiddleware = (0, _react.useMemo)(function () {
    return [].concat(_toConsumableArray((0, _singleToArray.default)(attachmentMiddleware)), _toConsumableArray((0, _createCoreMiddleware4.default)()));
  }, [attachmentMiddleware]);
  var patchedAvatarMiddleware = (0, _react.useMemo)(function () {
    return [].concat(_toConsumableArray((0, _singleToArray.default)(avatarMiddleware)), _toConsumableArray((0, _createCoreMiddleware5.default)()));
  }, [avatarMiddleware]);
  var patchedCardActionMiddleware = (0, _react.useMemo)(function () {
    return [].concat(_toConsumableArray((0, _singleToArray.default)(cardActionMiddleware)), _toConsumableArray((0, _createCoreMiddleware6.default)()));
  }, [cardActionMiddleware]);
  var patchedToastMiddleware = (0, _react.useMemo)(function () {
    return [].concat(_toConsumableArray((0, _singleToArray.default)(toastMiddleware)), _toConsumableArray((0, _createCoreMiddleware7.default)()));
  }, [toastMiddleware]);
  var patchedTypingIndicatorMiddleware = (0, _react.useMemo)(function () {
    return [].concat(_toConsumableArray((0, _singleToArray.default)(typingIndicatorMiddleware)), _toConsumableArray((0, _createCoreMiddleware8.default)()));
  }, [typingIndicatorMiddleware]);
  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_botframeworkWebchatApi.Composer, _extends({
    activityMiddleware: patchedActivityMiddleware,
    activityStatusMiddleware: patchedActivityStatusMiddleware,
    attachmentForScreenReaderMiddleware: patchedAttachmentForScreenReaderMiddleware,
    attachmentMiddleware: patchedAttachmentMiddleware,
    avatarMiddleware: patchedAvatarMiddleware,
    cardActionMiddleware: patchedCardActionMiddleware,
    downscaleImageToDataURL: _downscaleImageToDataURL.default // Under dev server of create-react-app, "NODE_ENV" will be set to "development".
    ,
    internalErrorBoxClass: node_env === 'development' ? _ErrorBox.default : undefined,
    nonce: nonce,
    toastMiddleware: patchedToastMiddleware,
    typingIndicatorMiddleware: patchedTypingIndicatorMiddleware
  }, composerProps), /*#__PURE__*/_react.default.createElement(_reactScrollToBottom.Composer, {
    nonce: nonce
  }, /*#__PURE__*/_react.default.createElement(ComposerCore, {
    extraStyleSet: extraStyleSet,
    nonce: nonce,
    renderMarkdown: renderMarkdown,
    styleSet: styleSet,
    suggestedActionsAccessKey: suggestedActionsAccessKey,
    webSpeechPonyfillFactory: webSpeechPonyfillFactory
  }, children, onTelemetry && /*#__PURE__*/_react.default.createElement(_UITracker.default, null)))));
};

Composer.defaultProps = _objectSpread(_objectSpread(_objectSpread({}, _botframeworkWebchatApi.Composer.defaultProps), ComposerCore.defaultProps), {}, {
  activityMiddleware: undefined,
  activityRenderer: undefined,
  activityStatusMiddleware: undefined,
  activityStatusRenderer: undefined,
  attachmentForScreenReaderMiddleware: undefined,
  attachmentMiddleware: undefined,
  attachmentRenderer: undefined,
  avatarMiddleware: undefined,
  avatarRenderer: undefined,
  cardActionMiddleware: undefined,
  children: undefined,
  nonce: undefined,
  renderMarkdown: undefined,
  toastMiddleware: undefined,
  toastRenderer: undefined,
  typingIndicatorMiddleware: undefined,
  typingIndicatorRenderer: undefined,
  webSpeechPonyfillFactory: undefined
});
Composer.propTypes = _objectSpread(_objectSpread(_objectSpread({}, _botframeworkWebchatApi.Composer.propTypes), ComposerCore.propTypes), {}, {
  activityMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),
  activityRenderer: _propTypes.default.func,
  activityStatusMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),
  activityStatusRenderer: _propTypes.default.func,
  attachmentForScreenReaderMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),
  attachmentMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),
  attachmentRenderer: _propTypes.default.func,
  avatarMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),
  avatarRenderer: _propTypes.default.func,
  cardActionMiddleware: _propTypes.default.func,
  children: _propTypes.default.any,
  nonce: _propTypes.default.string,
  renderMarkdown: _propTypes.default.func,
  toastMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),
  toastRenderer: _propTypes.default.func,
  typingIndicatorMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),
  typingIndicatorRenderer: _propTypes.default.func,
  webSpeechPonyfillFactory: _propTypes.default.func
});
var _default = Composer;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9Db21wb3Nlci5qcyJdLCJuYW1lcyI6WyJ1c2VSZWZlcmVuY2VHcmFtbWFySUQiLCJob29rcyIsInVzZVN0eWxlT3B0aW9ucyIsIm5vZGVfZW52IiwiZW1vdGlvblBvb2wiLCJjcmVhdGVGb2N1c0NvbnRleHQiLCJzZW5kQm94Rm9jdXNSZWYiLCJ0cmFuc2NyaXB0Rm9jdXNSZWYiLCJmb2N1cyIsIndoZXJlIiwicmVmIiwiY3VycmVudCIsInJlYWRPbmx5IiwiZ2V0QXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwic2V0VGltZW91dCIsInJlbW92ZUF0dHJpYnV0ZSIsInN0eWxlU2V0VG9FbW90aW9uT2JqZWN0cyIsInN0eWxlVG9FbW90aW9uT2JqZWN0Iiwic3R5bGVTZXQiLCJzdHlsZSIsImtleSIsIkNvbXBvc2VyQ29yZSIsImNoaWxkcmVuIiwiZXh0cmFTdHlsZVNldCIsIm5vbmNlIiwicmVuZGVyTWFya2Rvd24iLCJzdWdnZXN0ZWRBY3Rpb25zQWNjZXNzS2V5Iiwid2ViU3BlZWNoUG9ueWZpbGxGYWN0b3J5IiwiZGljdGF0ZUFib3J0YWJsZSIsInNldERpY3RhdGVBYm9ydGFibGUiLCJyZWZlcmVuY2VHcmFtbWFySUQiLCJzdHlsZU9wdGlvbnMiLCJpbnRlcm5hbE1hcmtkb3duSXQiLCJNYXJrZG93bkl0IiwidHJhbnNjcmlwdEFjdGl2aXR5RWxlbWVudHNSZWYiLCJ0cmFuc2NyaXB0Um9vdEVsZW1lbnRSZWYiLCJkaWN0YXRpb25PbkVycm9yIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiZm9jdXNDb250ZXh0IiwiaW50ZXJuYWxSZW5kZXJNYXJrZG93bklubGluZSIsIm1hcmtkb3duIiwidHJlZSIsInBhcnNlSW5saW5lIiwicGF0Y2hlZFRyZWUiLCJyZW5kZXJlciIsInJlbmRlciIsImVtb3Rpb24iLCJjc3MiLCJwYXRjaGVkU3R5bGVTZXQiLCJ3ZWJTcGVlY2hQb255ZmlsbCIsInBvbnlmaWxsIiwic3BlZWNoU3ludGhlc2lzIiwiU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlIiwiYnlwYXNzU3BlZWNoU3ludGhlc2lzIiwiQnlwYXNzU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlIiwiY29udGV4dCIsImludGVybmFsTWFya2Rvd25JdFN0YXRlIiwiZGVmYXVsdFByb3BzIiwidW5kZWZpbmVkIiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwiYW55Iiwic3RyaW5nIiwiZnVuYyIsIm9uZU9mVHlwZSIsIm9uZU9mIiwiQ29tcG9zZXIiLCJhY3Rpdml0eU1pZGRsZXdhcmUiLCJhY3Rpdml0eVN0YXR1c01pZGRsZXdhcmUiLCJhdHRhY2htZW50Rm9yU2NyZWVuUmVhZGVyTWlkZGxld2FyZSIsImF0dGFjaG1lbnRNaWRkbGV3YXJlIiwiYXZhdGFyTWlkZGxld2FyZSIsImNhcmRBY3Rpb25NaWRkbGV3YXJlIiwidG9hc3RNaWRkbGV3YXJlIiwidHlwaW5nSW5kaWNhdG9yTWlkZGxld2FyZSIsImNvbXBvc2VyUHJvcHMiLCJvblRlbGVtZXRyeSIsInBhdGNoZWRBY3Rpdml0eU1pZGRsZXdhcmUiLCJwYXRjaGVkQWN0aXZpdHlTdGF0dXNNaWRkbGV3YXJlIiwicGF0Y2hlZEF0dGFjaG1lbnRGb3JTY3JlZW5SZWFkZXJNaWRkbGV3YXJlIiwicGF0Y2hlZEF0dGFjaG1lbnRNaWRkbGV3YXJlIiwicGF0Y2hlZEF2YXRhck1pZGRsZXdhcmUiLCJwYXRjaGVkQ2FyZEFjdGlvbk1pZGRsZXdhcmUiLCJwYXRjaGVkVG9hc3RNaWRkbGV3YXJlIiwicGF0Y2hlZFR5cGluZ0luZGljYXRvck1pZGRsZXdhcmUiLCJkb3duc2NhbGVJbWFnZVRvRGF0YVVSTCIsIkVycm9yQm94IiwiQVBJQ29tcG9zZXIiLCJhY3Rpdml0eVJlbmRlcmVyIiwiYWN0aXZpdHlTdGF0dXNSZW5kZXJlciIsImF0dGFjaG1lbnRSZW5kZXJlciIsImF2YXRhclJlbmRlcmVyIiwidG9hc3RSZW5kZXJlciIsInR5cGluZ0luZGljYXRvclJlbmRlcmVyIiwiYXJyYXlPZiJdLCJtYXBwaW5ncyI6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QUFVRztBQXBCdEM7ZUF1QmVHLFEiLCJzb3VyY2VSb290IjoiY29tcG9uZW50Oi8vLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvc2VyIGFzIEFQSUNvbXBvc2VyLCBob29rcyB9IGZyb20gJ2JvdGZyYW1ld29yay13ZWJjaGF0LWFwaSc7XG5pbXBvcnQgeyBDb21wb3NlciBhcyBTYXlDb21wb3NlciB9IGZyb20gJ3JlYWN0LXNheSc7XG5pbXBvcnQgeyBDb21wb3NlciBhcyBTY3JvbGxUb0JvdHRvbUNvbXBvc2VyIH0gZnJvbSAncmVhY3Qtc2Nyb2xsLXRvLWJvdHRvbSc7XG5pbXBvcnQgY3JlYXRlRW1vdGlvbiBmcm9tICdjcmVhdGUtZW1vdGlvbic7XG5pbXBvcnQgY3JlYXRlU3R5bGVTZXQgZnJvbSAnLi9TdHlsZXMvY3JlYXRlU3R5bGVTZXQnO1xuaW1wb3J0IE1hcmtkb3duSXQgZnJvbSAnbWFya2Rvd24taXQnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBSZWFjdCwgeyB1c2VDYWxsYmFjaywgdXNlTWVtbywgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IHtcbiAgc3BlZWNoU3ludGhlc2lzIGFzIGJ5cGFzc1NwZWVjaFN5bnRoZXNpcyxcbiAgU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlIGFzIEJ5cGFzc1NwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZVxufSBmcm9tICcuL2hvb2tzL2ludGVybmFsL0J5cGFzc1NwZWVjaFN5bnRoZXNpc1BvbnlmaWxsJztcbmltcG9ydCBhZGRUYXJnZXRCbGFua1RvSHlwZXJsaW5rc01hcmtkb3duIGZyb20gJy4vVXRpbHMvYWRkVGFyZ2V0QmxhbmtUb0h5cGVybGlua3NNYXJrZG93bic7XG5pbXBvcnQgY3JlYXRlQ1NTS2V5IGZyb20gJy4vVXRpbHMvY3JlYXRlQ1NTS2V5JztcbmltcG9ydCBjcmVhdGVEZWZhdWx0QWN0aXZpdHlNaWRkbGV3YXJlIGZyb20gJy4vTWlkZGxld2FyZS9BY3Rpdml0eS9jcmVhdGVDb3JlTWlkZGxld2FyZSc7XG5pbXBvcnQgY3JlYXRlRGVmYXVsdEFjdGl2aXR5U3RhdHVzTWlkZGxld2FyZSBmcm9tICcuL01pZGRsZXdhcmUvQWN0aXZpdHlTdGF0dXMvY3JlYXRlQ29yZU1pZGRsZXdhcmUnO1xuaW1wb3J0IGNyZWF0ZURlZmF1bHRBdHRhY2htZW50Rm9yU2NyZWVuUmVhZGVyTWlkZGxld2FyZSBmcm9tICcuL01pZGRsZXdhcmUvQXR0YWNobWVudEZvclNjcmVlblJlYWRlci9jcmVhdGVDb3JlTWlkZGxld2FyZSc7XG5pbXBvcnQgY3JlYXRlRGVmYXVsdEF0dGFjaG1lbnRNaWRkbGV3YXJlIGZyb20gJy4vTWlkZGxld2FyZS9BdHRhY2htZW50L2NyZWF0ZUNvcmVNaWRkbGV3YXJlJztcbmltcG9ydCBjcmVhdGVEZWZhdWx0QXZhdGFyTWlkZGxld2FyZSBmcm9tICcuL01pZGRsZXdhcmUvQXZhdGFyL2NyZWF0ZUNvcmVNaWRkbGV3YXJlJztcbmltcG9ydCBjcmVhdGVEZWZhdWx0Q2FyZEFjdGlvbk1pZGRsZXdhcmUgZnJvbSAnLi9NaWRkbGV3YXJlL0NhcmRBY3Rpb24vY3JlYXRlQ29yZU1pZGRsZXdhcmUnO1xuaW1wb3J0IGNyZWF0ZURlZmF1bHRUb2FzdE1pZGRsZXdhcmUgZnJvbSAnLi9NaWRkbGV3YXJlL1RvYXN0L2NyZWF0ZUNvcmVNaWRkbGV3YXJlJztcbmltcG9ydCBjcmVhdGVEZWZhdWx0VHlwaW5nSW5kaWNhdG9yTWlkZGxld2FyZSBmcm9tICcuL01pZGRsZXdhcmUvVHlwaW5nSW5kaWNhdG9yL2NyZWF0ZUNvcmVNaWRkbGV3YXJlJztcbmltcG9ydCBEaWN0YXRpb24gZnJvbSAnLi9EaWN0YXRpb24nO1xuaW1wb3J0IGRvd25zY2FsZUltYWdlVG9EYXRhVVJMIGZyb20gJy4vVXRpbHMvZG93bnNjYWxlSW1hZ2VUb0RhdGFVUkwnO1xuaW1wb3J0IEVycm9yQm94IGZyb20gJy4vRXJyb3JCb3gnO1xuaW1wb3J0IG1hcE1hcCBmcm9tICcuL1V0aWxzL21hcE1hcCc7XG5pbXBvcnQgc2luZ2xlVG9BcnJheSBmcm9tICcuL1V0aWxzL3NpbmdsZVRvQXJyYXknO1xuaW1wb3J0IFVJVHJhY2tlciBmcm9tICcuL2hvb2tzL2ludGVybmFsL1VJVHJhY2tlcic7XG5pbXBvcnQgV2ViQ2hhdFVJQ29udGV4dCBmcm9tICcuL2hvb2tzL2ludGVybmFsL1dlYkNoYXRVSUNvbnRleHQnO1xuXG5jb25zdCB7IHVzZVJlZmVyZW5jZUdyYW1tYXJJRCwgdXNlU3R5bGVPcHRpb25zIH0gPSBob29rcztcblxuY29uc3Qgbm9kZV9lbnYgPSBwcm9jZXNzLmVudi5ub2RlX2VudiB8fCBwcm9jZXNzLmVudi5OT0RFX0VOVjtcblxuY29uc3QgZW1vdGlvblBvb2wgPSB7fTtcblxuZnVuY3Rpb24gY3JlYXRlRm9jdXNDb250ZXh0KHsgc2VuZEJveEZvY3VzUmVmLCB0cmFuc2NyaXB0Rm9jdXNSZWYgfSkge1xuICByZXR1cm4ge1xuICAgIGZvY3VzOiB3aGVyZSA9PiB7XG4gICAgICBjb25zdCByZWYgPSB3aGVyZSA9PT0gJ3NlbmRCb3gnIHx8IHdoZXJlID09PSAnc2VuZEJveFdpdGhvdXRLZXlib2FyZCcgPyBzZW5kQm94Rm9jdXNSZWYgOiB0cmFuc2NyaXB0Rm9jdXNSZWY7XG4gICAgICBjb25zdCB7IGN1cnJlbnQgfSA9IHJlZiB8fCB7fTtcblxuICAgICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgICAgaWYgKHdoZXJlID09PSAnc2VuZEJveFdpdGhvdXRLZXlib2FyZCcpIHtcbiAgICAgICAgICAvLyBUbyBub3QgYWN0aXZhdGUgdGhlIHZpcnR1YWwga2V5Ym9hcmQgd2hpbGUgY2hhbmdpbmcgZm9jdXMgdG8gYW4gaW5wdXQsIHdlIHdpbGwgdGVtcG9yYXJpbHkgc2V0IGl0IGFzIHJlYWQtb25seSBhbmQgZmxpcCBpdCBiYWNrLlxuICAgICAgICAgIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzc2MTA3NTgvcHJldmVudC1pcGhvbmUtZGVmYXVsdC1rZXlib2FyZC13aGVuLWZvY3VzaW5nLWFuLWlucHV0Lzc2MTA5MjNcbiAgICAgICAgICBjb25zdCByZWFkT25seSA9IGN1cnJlbnQuZ2V0QXR0cmlidXRlKCdyZWFkb25seScpO1xuXG4gICAgICAgICAgY3VycmVudC5zZXRBdHRyaWJ1dGUoJ3JlYWRvbmx5JywgJ3JlYWRvbmx5Jyk7XG5cbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGN1cnJlbnQuZm9jdXMoKTtcbiAgICAgICAgICAgIHJlYWRPbmx5ID8gY3VycmVudC5zZXRBdHRyaWJ1dGUoJ3JlYWRvbmx5JywgcmVhZE9ubHkpIDogY3VycmVudC5yZW1vdmVBdHRyaWJ1dGUoJ3JlYWRvbmx5Jyk7XG4gICAgICAgICAgfSwgMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY3VycmVudC5mb2N1cygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBzdHlsZVNldFRvRW1vdGlvbk9iamVjdHMoc3R5bGVUb0Vtb3Rpb25PYmplY3QsIHN0eWxlU2V0KSB7XG4gIHJldHVybiBtYXBNYXAoc3R5bGVTZXQsIChzdHlsZSwga2V5KSA9PiAoa2V5ID09PSAnb3B0aW9ucycgPyBzdHlsZSA6IHN0eWxlVG9FbW90aW9uT2JqZWN0KHN0eWxlKSkpO1xufVxuXG5jb25zdCBDb21wb3NlckNvcmUgPSAoe1xuICBjaGlsZHJlbixcbiAgZXh0cmFTdHlsZVNldCxcbiAgbm9uY2UsXG4gIHJlbmRlck1hcmtkb3duLFxuICBzdHlsZVNldCxcbiAgc3VnZ2VzdGVkQWN0aW9uc0FjY2Vzc0tleSxcbiAgd2ViU3BlZWNoUG9ueWZpbGxGYWN0b3J5XG59KSA9PiB7XG4gIGNvbnN0IFtkaWN0YXRlQWJvcnRhYmxlLCBzZXREaWN0YXRlQWJvcnRhYmxlXSA9IHVzZVN0YXRlKCk7XG4gIGNvbnN0IFtyZWZlcmVuY2VHcmFtbWFySURdID0gdXNlUmVmZXJlbmNlR3JhbW1hcklEKCk7XG4gIGNvbnN0IFtzdHlsZU9wdGlvbnNdID0gdXNlU3R5bGVPcHRpb25zKCk7XG4gIGNvbnN0IGludGVybmFsTWFya2Rvd25JdCA9IHVzZU1lbW8oKCkgPT4gbmV3IE1hcmtkb3duSXQoKSwgW10pO1xuICBjb25zdCBzZW5kQm94Rm9jdXNSZWYgPSB1c2VSZWYoKTtcbiAgY29uc3QgdHJhbnNjcmlwdEFjdGl2aXR5RWxlbWVudHNSZWYgPSB1c2VSZWYoW10pO1xuICBjb25zdCB0cmFuc2NyaXB0Rm9jdXNSZWYgPSB1c2VSZWYoKTtcbiAgY29uc3QgdHJhbnNjcmlwdFJvb3RFbGVtZW50UmVmID0gdXNlUmVmKCk7XG5cbiAgY29uc3QgZGljdGF0aW9uT25FcnJvciA9IHVzZUNhbGxiYWNrKGVyciA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgZm9jdXNDb250ZXh0ID0gdXNlTWVtbygoKSA9PiBjcmVhdGVGb2N1c0NvbnRleHQoeyBzZW5kQm94Rm9jdXNSZWYsIHRyYW5zY3JpcHRGb2N1c1JlZiB9KSwgW1xuICAgIHNlbmRCb3hGb2N1c1JlZixcbiAgICB0cmFuc2NyaXB0Rm9jdXNSZWZcbiAgXSk7XG5cbiAgY29uc3QgaW50ZXJuYWxSZW5kZXJNYXJrZG93bklubGluZSA9IHVzZU1lbW8oXG4gICAgKCkgPT4gbWFya2Rvd24gPT4ge1xuICAgICAgY29uc3QgdHJlZSA9IGludGVybmFsTWFya2Rvd25JdC5wYXJzZUlubGluZShtYXJrZG93bik7XG5cbiAgICAgIC8vIFdlIHNob3VsZCBhZGQgcmVsPVwibm9vcGVuZXIgbm9yZWZlcnJlclwiIGFuZCB0YXJnZXQ9XCJfYmxhbmtcIlxuICAgICAgY29uc3QgcGF0Y2hlZFRyZWUgPSBhZGRUYXJnZXRCbGFua1RvSHlwZXJsaW5rc01hcmtkb3duKHRyZWUpO1xuXG4gICAgICByZXR1cm4gaW50ZXJuYWxNYXJrZG93bkl0LnJlbmRlcmVyLnJlbmRlcihwYXRjaGVkVHJlZSk7XG4gICAgfSxcbiAgICBbaW50ZXJuYWxNYXJrZG93bkl0XVxuICApO1xuXG4gIGNvbnN0IHN0eWxlVG9FbW90aW9uT2JqZWN0ID0gdXNlTWVtbygoKSA9PiB7XG4gICAgLy8gRW1vdGlvbiBkb2Vzbid0IGhhc2ggd2l0aCBub25jZS4gV2UgbmVlZCB0byBwcm92aWRlIHRoZSBwb29saW5nIG1lY2hhbmlzbS5cbiAgICAvLyAxLiBJZiAyIGluc3RhbmNlcyB1c2UgZGlmZmVyZW50IG5vbmNlLCB0aGV5IHNob3VsZCByZXN1bHQgaW4gZGlmZmVyZW50IGhhc2g7XG4gICAgLy8gMi4gSWYgMiBpbnN0YW5jZXMgYXJlIGJlaW5nIG1vdW50ZWQsIHBvb2xpbmcgd2lsbCBtYWtlIHN1cmUgd2UgcmVuZGVyIG9ubHkgMSBzZXQgb2YgPHN0eWxlPiB0YWdzLCBpbnN0ZWFkIG9mIDIuXG4gICAgY29uc3QgZW1vdGlvbiA9XG4gICAgICBlbW90aW9uUG9vbFtub25jZV0gfHwgKGVtb3Rpb25Qb29sW25vbmNlXSA9IGNyZWF0ZUVtb3Rpb24oeyBrZXk6IGB3ZWJjaGF0LS1jc3MtJHtjcmVhdGVDU1NLZXkoKX1gLCBub25jZSB9KSk7XG5cbiAgICByZXR1cm4gc3R5bGUgPT4gZW1vdGlvbi5jc3Moc3R5bGUpO1xuICB9LCBbbm9uY2VdKTtcblxuICBjb25zdCBwYXRjaGVkU3R5bGVTZXQgPSB1c2VNZW1vKFxuICAgICgpID0+XG4gICAgICBzdHlsZVNldFRvRW1vdGlvbk9iamVjdHMoc3R5bGVUb0Vtb3Rpb25PYmplY3QsIHtcbiAgICAgICAgLi4uKHN0eWxlU2V0IHx8IGNyZWF0ZVN0eWxlU2V0KHN0eWxlT3B0aW9ucykpLFxuICAgICAgICAuLi5leHRyYVN0eWxlU2V0XG4gICAgICB9KSxcbiAgICBbZXh0cmFTdHlsZVNldCwgc3R5bGVPcHRpb25zLCBzdHlsZVNldCwgc3R5bGVUb0Vtb3Rpb25PYmplY3RdXG4gICk7XG5cbiAgY29uc3Qgd2ViU3BlZWNoUG9ueWZpbGwgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBjb25zdCBwb255ZmlsbCA9IHdlYlNwZWVjaFBvbnlmaWxsRmFjdG9yeSAmJiB3ZWJTcGVlY2hQb255ZmlsbEZhY3RvcnkoeyByZWZlcmVuY2VHcmFtbWFySUQgfSk7XG4gICAgY29uc3QgeyBzcGVlY2hTeW50aGVzaXMsIFNwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZSB9ID0gcG9ueWZpbGwgfHwge307XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4ucG9ueWZpbGwsXG4gICAgICBzcGVlY2hTeW50aGVzaXM6IHNwZWVjaFN5bnRoZXNpcyB8fCBieXBhc3NTcGVlY2hTeW50aGVzaXMsXG4gICAgICBTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2U6IFNwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZSB8fCBCeXBhc3NTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2VcbiAgICB9O1xuICB9LCBbcmVmZXJlbmNlR3JhbW1hcklELCB3ZWJTcGVlY2hQb255ZmlsbEZhY3RvcnldKTtcblxuICBjb25zdCBjb250ZXh0ID0gdXNlTWVtbyhcbiAgICAoKSA9PiAoe1xuICAgICAgLi4uZm9jdXNDb250ZXh0LFxuICAgICAgZGljdGF0ZUFib3J0YWJsZSxcbiAgICAgIGludGVybmFsTWFya2Rvd25JdFN0YXRlOiBbaW50ZXJuYWxNYXJrZG93bkl0XSxcbiAgICAgIGludGVybmFsUmVuZGVyTWFya2Rvd25JbmxpbmUsXG4gICAgICBub25jZSxcbiAgICAgIHJlbmRlck1hcmtkb3duLFxuICAgICAgc2VuZEJveEZvY3VzUmVmLFxuICAgICAgc2V0RGljdGF0ZUFib3J0YWJsZSxcbiAgICAgIHN0eWxlU2V0OiBwYXRjaGVkU3R5bGVTZXQsXG4gICAgICBzdHlsZVRvRW1vdGlvbk9iamVjdCxcbiAgICAgIHN1Z2dlc3RlZEFjdGlvbnNBY2Nlc3NLZXksXG4gICAgICB0cmFuc2NyaXB0QWN0aXZpdHlFbGVtZW50c1JlZixcbiAgICAgIHRyYW5zY3JpcHRGb2N1c1JlZixcbiAgICAgIHRyYW5zY3JpcHRSb290RWxlbWVudFJlZixcbiAgICAgIHdlYlNwZWVjaFBvbnlmaWxsXG4gICAgfSksXG4gICAgW1xuICAgICAgZGljdGF0ZUFib3J0YWJsZSxcbiAgICAgIGZvY3VzQ29udGV4dCxcbiAgICAgIGludGVybmFsTWFya2Rvd25JdCxcbiAgICAgIGludGVybmFsUmVuZGVyTWFya2Rvd25JbmxpbmUsXG4gICAgICBub25jZSxcbiAgICAgIHBhdGNoZWRTdHlsZVNldCxcbiAgICAgIHJlbmRlck1hcmtkb3duLFxuICAgICAgc2VuZEJveEZvY3VzUmVmLFxuICAgICAgc2V0RGljdGF0ZUFib3J0YWJsZSxcbiAgICAgIHN0eWxlVG9FbW90aW9uT2JqZWN0LFxuICAgICAgc3VnZ2VzdGVkQWN0aW9uc0FjY2Vzc0tleSxcbiAgICAgIHRyYW5zY3JpcHRBY3Rpdml0eUVsZW1lbnRzUmVmLFxuICAgICAgdHJhbnNjcmlwdEZvY3VzUmVmLFxuICAgICAgdHJhbnNjcmlwdFJvb3RFbGVtZW50UmVmLFxuICAgICAgd2ViU3BlZWNoUG9ueWZpbGxcbiAgICBdXG4gICk7XG5cbiAgcmV0dXJuIChcbiAgICA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICA8U2F5Q29tcG9zZXIgcG9ueWZpbGw9e3dlYlNwZWVjaFBvbnlmaWxsfT5cbiAgICAgICAgPFdlYkNoYXRVSUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2NvbnRleHR9PlxuICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgICA8RGljdGF0aW9uIG9uRXJyb3I9e2RpY3RhdGlvbk9uRXJyb3J9IC8+XG4gICAgICAgIDwvV2ViQ2hhdFVJQ29udGV4dC5Qcm92aWRlcj5cbiAgICAgIDwvU2F5Q29tcG9zZXI+XG4gICAgPC9SZWFjdC5GcmFnbWVudD5cbiAgKTtcbn07XG5cbkNvbXBvc2VyQ29yZS5kZWZhdWx0UHJvcHMgPSB7XG4gIGV4dHJhU3R5bGVTZXQ6IHVuZGVmaW5lZCxcbiAgbm9uY2U6IHVuZGVmaW5lZCxcbiAgcmVuZGVyTWFya2Rvd246IHVuZGVmaW5lZCxcbiAgc3R5bGVTZXQ6IHVuZGVmaW5lZCxcbiAgc3VnZ2VzdGVkQWN0aW9uc0FjY2Vzc0tleTogJ0EgYSDDhSDDpScsXG4gIHdlYlNwZWVjaFBvbnlmaWxsRmFjdG9yeTogdW5kZWZpbmVkXG59O1xuXG5Db21wb3NlckNvcmUucHJvcFR5cGVzID0ge1xuICBleHRyYVN0eWxlU2V0OiBQcm9wVHlwZXMuYW55LFxuICBub25jZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgcmVuZGVyTWFya2Rvd246IFByb3BUeXBlcy5mdW5jLFxuICBzdHlsZVNldDogUHJvcFR5cGVzLmFueSxcbiAgc3VnZ2VzdGVkQWN0aW9uc0FjY2Vzc0tleTogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLm9uZU9mKFtmYWxzZV0pLCBQcm9wVHlwZXMuc3RyaW5nXSksXG4gIHdlYlNwZWVjaFBvbnlmaWxsRmFjdG9yeTogUHJvcFR5cGVzLmZ1bmNcbn07XG5cbmNvbnN0IENvbXBvc2VyID0gKHtcbiAgYWN0aXZpdHlNaWRkbGV3YXJlLFxuICBhY3Rpdml0eVN0YXR1c01pZGRsZXdhcmUsXG4gIGF0dGFjaG1lbnRGb3JTY3JlZW5SZWFkZXJNaWRkbGV3YXJlLFxuICBhdHRhY2htZW50TWlkZGxld2FyZSxcbiAgYXZhdGFyTWlkZGxld2FyZSxcbiAgY2FyZEFjdGlvbk1pZGRsZXdhcmUsXG4gIGNoaWxkcmVuLFxuICBleHRyYVN0eWxlU2V0LFxuICByZW5kZXJNYXJrZG93bixcbiAgc3R5bGVTZXQsXG4gIHN1Z2dlc3RlZEFjdGlvbnNBY2Nlc3NLZXksXG4gIHRvYXN0TWlkZGxld2FyZSxcbiAgdHlwaW5nSW5kaWNhdG9yTWlkZGxld2FyZSxcbiAgd2ViU3BlZWNoUG9ueWZpbGxGYWN0b3J5LFxuICAuLi5jb21wb3NlclByb3BzXG59KSA9PiB7XG4gIGNvbnN0IHsgbm9uY2UsIG9uVGVsZW1ldHJ5IH0gPSBjb21wb3NlclByb3BzO1xuXG4gIGNvbnN0IHBhdGNoZWRBY3Rpdml0eU1pZGRsZXdhcmUgPSB1c2VNZW1vKFxuICAgICgpID0+IFsuLi5zaW5nbGVUb0FycmF5KGFjdGl2aXR5TWlkZGxld2FyZSksIC4uLmNyZWF0ZURlZmF1bHRBY3Rpdml0eU1pZGRsZXdhcmUoKV0sXG4gICAgW2FjdGl2aXR5TWlkZGxld2FyZV1cbiAgKTtcblxuICBjb25zdCBwYXRjaGVkQWN0aXZpdHlTdGF0dXNNaWRkbGV3YXJlID0gdXNlTWVtbyhcbiAgICAoKSA9PiBbLi4uc2luZ2xlVG9BcnJheShhY3Rpdml0eVN0YXR1c01pZGRsZXdhcmUpLCAuLi5jcmVhdGVEZWZhdWx0QWN0aXZpdHlTdGF0dXNNaWRkbGV3YXJlKCldLFxuICAgIFthY3Rpdml0eVN0YXR1c01pZGRsZXdhcmVdXG4gICk7XG5cbiAgY29uc3QgcGF0Y2hlZEF0dGFjaG1lbnRGb3JTY3JlZW5SZWFkZXJNaWRkbGV3YXJlID0gdXNlTWVtbyhcbiAgICAoKSA9PiBbXG4gICAgICAuLi5zaW5nbGVUb0FycmF5KGF0dGFjaG1lbnRGb3JTY3JlZW5SZWFkZXJNaWRkbGV3YXJlKSxcbiAgICAgIC4uLmNyZWF0ZURlZmF1bHRBdHRhY2htZW50Rm9yU2NyZWVuUmVhZGVyTWlkZGxld2FyZSgpXG4gICAgXSxcbiAgICBbYXR0YWNobWVudEZvclNjcmVlblJlYWRlck1pZGRsZXdhcmVdXG4gICk7XG5cbiAgY29uc3QgcGF0Y2hlZEF0dGFjaG1lbnRNaWRkbGV3YXJlID0gdXNlTWVtbyhcbiAgICAoKSA9PiBbLi4uc2luZ2xlVG9BcnJheShhdHRhY2htZW50TWlkZGxld2FyZSksIC4uLmNyZWF0ZURlZmF1bHRBdHRhY2htZW50TWlkZGxld2FyZSgpXSxcbiAgICBbYXR0YWNobWVudE1pZGRsZXdhcmVdXG4gICk7XG5cbiAgY29uc3QgcGF0Y2hlZEF2YXRhck1pZGRsZXdhcmUgPSB1c2VNZW1vKFxuICAgICgpID0+IFsuLi5zaW5nbGVUb0FycmF5KGF2YXRhck1pZGRsZXdhcmUpLCAuLi5jcmVhdGVEZWZhdWx0QXZhdGFyTWlkZGxld2FyZSgpXSxcbiAgICBbYXZhdGFyTWlkZGxld2FyZV1cbiAgKTtcblxuICBjb25zdCBwYXRjaGVkQ2FyZEFjdGlvbk1pZGRsZXdhcmUgPSB1c2VNZW1vKFxuICAgICgpID0+IFsuLi5zaW5nbGVUb0FycmF5KGNhcmRBY3Rpb25NaWRkbGV3YXJlKSwgLi4uY3JlYXRlRGVmYXVsdENhcmRBY3Rpb25NaWRkbGV3YXJlKCldLFxuICAgIFtjYXJkQWN0aW9uTWlkZGxld2FyZV1cbiAgKTtcblxuICBjb25zdCBwYXRjaGVkVG9hc3RNaWRkbGV3YXJlID0gdXNlTWVtbygoKSA9PiBbLi4uc2luZ2xlVG9BcnJheSh0b2FzdE1pZGRsZXdhcmUpLCAuLi5jcmVhdGVEZWZhdWx0VG9hc3RNaWRkbGV3YXJlKCldLCBbXG4gICAgdG9hc3RNaWRkbGV3YXJlXG4gIF0pO1xuXG4gIGNvbnN0IHBhdGNoZWRUeXBpbmdJbmRpY2F0b3JNaWRkbGV3YXJlID0gdXNlTWVtbyhcbiAgICAoKSA9PiBbLi4uc2luZ2xlVG9BcnJheSh0eXBpbmdJbmRpY2F0b3JNaWRkbGV3YXJlKSwgLi4uY3JlYXRlRGVmYXVsdFR5cGluZ0luZGljYXRvck1pZGRsZXdhcmUoKV0sXG4gICAgW3R5cGluZ0luZGljYXRvck1pZGRsZXdhcmVdXG4gICk7XG5cbiAgcmV0dXJuIChcbiAgICA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICA8QVBJQ29tcG9zZXJcbiAgICAgICAgYWN0aXZpdHlNaWRkbGV3YXJlPXtwYXRjaGVkQWN0aXZpdHlNaWRkbGV3YXJlfVxuICAgICAgICBhY3Rpdml0eVN0YXR1c01pZGRsZXdhcmU9e3BhdGNoZWRBY3Rpdml0eVN0YXR1c01pZGRsZXdhcmV9XG4gICAgICAgIGF0dGFjaG1lbnRGb3JTY3JlZW5SZWFkZXJNaWRkbGV3YXJlPXtwYXRjaGVkQXR0YWNobWVudEZvclNjcmVlblJlYWRlck1pZGRsZXdhcmV9XG4gICAgICAgIGF0dGFjaG1lbnRNaWRkbGV3YXJlPXtwYXRjaGVkQXR0YWNobWVudE1pZGRsZXdhcmV9XG4gICAgICAgIGF2YXRhck1pZGRsZXdhcmU9e3BhdGNoZWRBdmF0YXJNaWRkbGV3YXJlfVxuICAgICAgICBjYXJkQWN0aW9uTWlkZGxld2FyZT17cGF0Y2hlZENhcmRBY3Rpb25NaWRkbGV3YXJlfVxuICAgICAgICBkb3duc2NhbGVJbWFnZVRvRGF0YVVSTD17ZG93bnNjYWxlSW1hZ2VUb0RhdGFVUkx9XG4gICAgICAgIC8vIFVuZGVyIGRldiBzZXJ2ZXIgb2YgY3JlYXRlLXJlYWN0LWFwcCwgXCJOT0RFX0VOVlwiIHdpbGwgYmUgc2V0IHRvIFwiZGV2ZWxvcG1lbnRcIi5cbiAgICAgICAgaW50ZXJuYWxFcnJvckJveENsYXNzPXtub2RlX2VudiA9PT0gJ2RldmVsb3BtZW50JyA/IEVycm9yQm94IDogdW5kZWZpbmVkfVxuICAgICAgICBub25jZT17bm9uY2V9XG4gICAgICAgIHRvYXN0TWlkZGxld2FyZT17cGF0Y2hlZFRvYXN0TWlkZGxld2FyZX1cbiAgICAgICAgdHlwaW5nSW5kaWNhdG9yTWlkZGxld2FyZT17cGF0Y2hlZFR5cGluZ0luZGljYXRvck1pZGRsZXdhcmV9XG4gICAgICAgIHsuLi5jb21wb3NlclByb3BzfVxuICAgICAgPlxuICAgICAgICA8U2Nyb2xsVG9Cb3R0b21Db21wb3NlciBub25jZT17bm9uY2V9PlxuICAgICAgICAgIDxDb21wb3NlckNvcmVcbiAgICAgICAgICAgIGV4dHJhU3R5bGVTZXQ9e2V4dHJhU3R5bGVTZXR9XG4gICAgICAgICAgICBub25jZT17bm9uY2V9XG4gICAgICAgICAgICByZW5kZXJNYXJrZG93bj17cmVuZGVyTWFya2Rvd259XG4gICAgICAgICAgICBzdHlsZVNldD17c3R5bGVTZXR9XG4gICAgICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zQWNjZXNzS2V5PXtzdWdnZXN0ZWRBY3Rpb25zQWNjZXNzS2V5fVxuICAgICAgICAgICAgd2ViU3BlZWNoUG9ueWZpbGxGYWN0b3J5PXt3ZWJTcGVlY2hQb255ZmlsbEZhY3Rvcnl9XG4gICAgICAgICAgPlxuICAgICAgICAgICAge2NoaWxkcmVufVxuICAgICAgICAgICAge29uVGVsZW1ldHJ5ICYmIDxVSVRyYWNrZXIgLz59XG4gICAgICAgICAgPC9Db21wb3NlckNvcmU+XG4gICAgICAgIDwvU2Nyb2xsVG9Cb3R0b21Db21wb3Nlcj5cbiAgICAgIDwvQVBJQ29tcG9zZXI+XG4gICAgPC9SZWFjdC5GcmFnbWVudD5cbiAgKTtcbn07XG5cbkNvbXBvc2VyLmRlZmF1bHRQcm9wcyA9IHtcbiAgLi4uQVBJQ29tcG9zZXIuZGVmYXVsdFByb3BzLFxuICAuLi5Db21wb3NlckNvcmUuZGVmYXVsdFByb3BzLFxuICBhY3Rpdml0eU1pZGRsZXdhcmU6IHVuZGVmaW5lZCxcbiAgYWN0aXZpdHlSZW5kZXJlcjogdW5kZWZpbmVkLFxuICBhY3Rpdml0eVN0YXR1c01pZGRsZXdhcmU6IHVuZGVmaW5lZCxcbiAgYWN0aXZpdHlTdGF0dXNSZW5kZXJlcjogdW5kZWZpbmVkLFxuICBhdHRhY2htZW50Rm9yU2NyZWVuUmVhZGVyTWlkZGxld2FyZTogdW5kZWZpbmVkLFxuICBhdHRhY2htZW50TWlkZGxld2FyZTogdW5kZWZpbmVkLFxuICBhdHRhY2htZW50UmVuZGVyZXI6IHVuZGVmaW5lZCxcbiAgYXZhdGFyTWlkZGxld2FyZTogdW5kZWZpbmVkLFxuICBhdmF0YXJSZW5kZXJlcjogdW5kZWZpbmVkLFxuICBjYXJkQWN0aW9uTWlkZGxld2FyZTogdW5kZWZpbmVkLFxuICBjaGlsZHJlbjogdW5kZWZpbmVkLFxuICBub25jZTogdW5kZWZpbmVkLFxuICByZW5kZXJNYXJrZG93bjogdW5kZWZpbmVkLFxuICB0b2FzdE1pZGRsZXdhcmU6IHVuZGVmaW5lZCxcbiAgdG9hc3RSZW5kZXJlcjogdW5kZWZpbmVkLFxuICB0eXBpbmdJbmRpY2F0b3JNaWRkbGV3YXJlOiB1bmRlZmluZWQsXG4gIHR5cGluZ0luZGljYXRvclJlbmRlcmVyOiB1bmRlZmluZWQsXG4gIHdlYlNwZWVjaFBvbnlmaWxsRmFjdG9yeTogdW5kZWZpbmVkXG59O1xuXG5Db21wb3Nlci5wcm9wVHlwZXMgPSB7XG4gIC4uLkFQSUNvbXBvc2VyLnByb3BUeXBlcyxcbiAgLi4uQ29tcG9zZXJDb3JlLnByb3BUeXBlcyxcbiAgYWN0aXZpdHlNaWRkbGV3YXJlOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuZnVuYyksIFByb3BUeXBlcy5mdW5jXSksXG4gIGFjdGl2aXR5UmVuZGVyZXI6IFByb3BUeXBlcy5mdW5jLFxuICBhY3Rpdml0eVN0YXR1c01pZGRsZXdhcmU6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5mdW5jKSwgUHJvcFR5cGVzLmZ1bmNdKSxcbiAgYWN0aXZpdHlTdGF0dXNSZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMsXG4gIGF0dGFjaG1lbnRGb3JTY3JlZW5SZWFkZXJNaWRkbGV3YXJlOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuZnVuYyksIFByb3BUeXBlcy5mdW5jXSksXG4gIGF0dGFjaG1lbnRNaWRkbGV3YXJlOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuZnVuYyksIFByb3BUeXBlcy5mdW5jXSksXG4gIGF0dGFjaG1lbnRSZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMsXG4gIGF2YXRhck1pZGRsZXdhcmU6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5mdW5jKSwgUHJvcFR5cGVzLmZ1bmNdKSxcbiAgYXZhdGFyUmVuZGVyZXI6IFByb3BUeXBlcy5mdW5jLFxuICBjYXJkQWN0aW9uTWlkZGxld2FyZTogUHJvcFR5cGVzLmZ1bmMsXG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LFxuICBub25jZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgcmVuZGVyTWFya2Rvd246IFByb3BUeXBlcy5mdW5jLFxuICB0b2FzdE1pZGRsZXdhcmU6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5mdW5jKSwgUHJvcFR5cGVzLmZ1bmNdKSxcbiAgdG9hc3RSZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMsXG4gIHR5cGluZ0luZGljYXRvck1pZGRsZXdhcmU6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5mdW5jKSwgUHJvcFR5cGVzLmZ1bmNdKSxcbiAgdHlwaW5nSW5kaWNhdG9yUmVuZGVyZXI6IFByb3BUeXBlcy5mdW5jLFxuICB3ZWJTcGVlY2hQb255ZmlsbEZhY3Rvcnk6IFByb3BUeXBlcy5mdW5jXG59O1xuXG5leHBvcnQgZGVmYXVsdCBDb21wb3NlcjtcbiJdfQ==