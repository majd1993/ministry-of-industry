"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createStyleSet;

var _Activities = _interopRequireDefault(require("./StyleSet/Activities"));

var _Activity = _interopRequireDefault(require("./StyleSet/Activity"));

var _AudioAttachment = _interopRequireDefault(require("./StyleSet/AudioAttachment"));

var _AudioContent = _interopRequireDefault(require("./StyleSet/AudioContent"));

var _Avatar = _interopRequireDefault(require("./StyleSet/Avatar"));

var _Bubble = _interopRequireDefault(require("./StyleSet/Bubble"));

var _CarouselFilmStrip = _interopRequireDefault(require("./StyleSet/CarouselFilmStrip"));

var _CarouselFlipper = _interopRequireDefault(require("./StyleSet/CarouselFlipper"));

var _ConnectivityNotification = _interopRequireDefault(require("./StyleSet/ConnectivityNotification"));

var _DictationInterims = _interopRequireDefault(require("./StyleSet/DictationInterims"));

var _ErrorBox = _interopRequireDefault(require("./StyleSet/ErrorBox"));

var _ErrorNotification = _interopRequireDefault(require("./StyleSet/ErrorNotification"));

var _FileContent = _interopRequireDefault(require("./StyleSet/FileContent"));

var _ImageAvatar = _interopRequireDefault(require("./StyleSet/ImageAvatar"));

var _InitialsAvatar = _interopRequireDefault(require("./StyleSet/InitialsAvatar"));

var _MicrophoneButton = _interopRequireDefault(require("./StyleSet/MicrophoneButton"));

var _Root = _interopRequireDefault(require("./StyleSet/Root"));

var _ScrollToEndButton = _interopRequireDefault(require("./StyleSet/ScrollToEndButton"));

var _SendBoxButton = _interopRequireDefault(require("./StyleSet/SendBoxButton"));

var _SendBox = _interopRequireDefault(require("./StyleSet/SendBox"));

var _SendBoxTextArea = _interopRequireDefault(require("./StyleSet/SendBoxTextArea"));

var _SendBoxTextBox = _interopRequireDefault(require("./StyleSet/SendBoxTextBox"));

var _SendStatus = _interopRequireDefault(require("./StyleSet/SendStatus"));

var _SingleAttachmentActivity = _interopRequireDefault(require("./StyleSet/SingleAttachmentActivity"));

var _SpinnerAnimation = _interopRequireDefault(require("./StyleSet/SpinnerAnimation"));

var _StackedLayout = _interopRequireDefault(require("./StyleSet/StackedLayout"));

var _SuggestedActions = _interopRequireDefault(require("./StyleSet/SuggestedActions"));

var _SuggestedAction = _interopRequireDefault(require("./StyleSet/SuggestedAction"));

var _TextContent = _interopRequireDefault(require("./StyleSet/TextContent"));

var _Toaster = _interopRequireDefault(require("./StyleSet/Toaster"));

var _Toast = _interopRequireDefault(require("./StyleSet/Toast"));

var _TypingAnimation = _interopRequireDefault(require("./StyleSet/TypingAnimation"));

var _TypingIndicator = _interopRequireDefault(require("./StyleSet/TypingIndicator"));

var _UploadButton = _interopRequireDefault(require("./StyleSet/UploadButton"));

var _VideoAttachment = _interopRequireDefault(require("./StyleSet/VideoAttachment"));

var _VideoContent = _interopRequireDefault(require("./StyleSet/VideoContent"));

var _VimeoContent = _interopRequireDefault(require("./StyleSet/VimeoContent"));

var _WarningNotification = _interopRequireDefault(require("./StyleSet/WarningNotification"));

var _YouTubeContent = _interopRequireDefault(require("./StyleSet/YouTubeContent"));

var _defaultStyleOptions = _interopRequireDefault(require("./defaultStyleOptions"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

// TODO: [P4] We should add a notice for people who want to use "styleSet" instead of "styleOptions".
//       "styleSet" is actually CSS stylesheet and it is based on the DOM tree.
//       DOM tree may change from time to time, thus, maintaining "styleSet" becomes a constant effort.
function parseBorder(border) {
  var dummyElement = document.createElement('div');
  dummyElement.setAttribute('style', "border: ".concat(border));
  var _dummyElement$style = dummyElement.style,
      color = _dummyElement$style.borderColor,
      style = _dummyElement$style.borderStyle,
      width = _dummyElement$style.borderWidth;
  return {
    color: color,
    style: style,
    width: width
  };
}

var PIXEL_UNIT_PATTERN = /^[0-9]+px$/;

function createStyleSet(options) {
  options = _objectSpread(_objectSpread({}, _defaultStyleOptions.default), options); // Keep this list flat (no nested style) and serializable (no functions)
  // TODO: [P4] Deprecate this code after bump to v5

  var _options = options,
      bubbleBorder = _options.bubbleBorder,
      bubbleFromUserBorder = _options.bubbleFromUserBorder,
      bubbleFromUserNubOffset = _options.bubbleFromUserNubOffset,
      bubbleNubOffset = _options.bubbleNubOffset,
      suggestedActionBorder = _options.suggestedActionBorder,
      suggestedActionDisabledBorder = _options.suggestedActionDisabledBorder;

  if (bubbleBorder) {
    console.warn('botframework-webchat: "styleSet.bubbleBorder" is deprecated and will be removed on or after 2020-07-17. Please use "bubbleBorderColor", "bubbleBorderStyle", and, "bubbleBorderWidth.');

    var _parseBorder = parseBorder(bubbleBorder),
        color = _parseBorder.color,
        style = _parseBorder.style,
        width = _parseBorder.width;

    if (color && color !== 'initial') {
      options.bubbleBorderColor = color;
    }

    if (style && style !== 'initial') {
      options.bubbleBorderStyle = style;
    }

    if (PIXEL_UNIT_PATTERN.test(width)) {
      options.bubbleBorderWidth = parseInt(width, 10);
    }
  }

  if (bubbleFromUserBorder) {
    console.warn('botframework-webchat: "styleSet.bubbleFromUserBorder" is deprecated and will be removed on or after 2020-07-17. Please use "bubbleFromUserBorderColor", "bubbleFromUserBorderStyle", and, "bubbleFromUserBorderWidth".');

    var _parseBorder2 = parseBorder(bubbleFromUserBorder),
        _color = _parseBorder2.color,
        _style = _parseBorder2.style,
        _width = _parseBorder2.width;

    if (_color && _color !== 'initial') {
      options.bubbleFromUserBorderColor = _color;
    }

    if (_style && _style !== 'initial') {
      options.bubbleFromUserBorderStyle = _style;
    }

    if (PIXEL_UNIT_PATTERN.test(_width)) {
      options.bubbleFromUserBorderWidth = parseInt(_width, 10);
    }
  }

  if (suggestedActionBorder) {
    console.warn('botframework-webchat: "styleSet.suggestedActionBorder" is deprecated and will be removed on or after 2020-09-11. Please use "suggestedActionBorderColor", "suggestedActionBorderStyle", and, "suggestedActionBorderWidth".');

    var _parseBorder3 = parseBorder(suggestedActionBorder),
        _color2 = _parseBorder3.color,
        _style2 = _parseBorder3.style,
        _width2 = _parseBorder3.width;

    if (_color2 && _color2 !== 'initial') {
      options.suggestedActionBorderColor = _color2;
    }

    if (_style2 && _style2 !== 'initial') {
      options.suggestedActionBorderStyle = _style2;
    }

    if (PIXEL_UNIT_PATTERN.test(_width2)) {
      options.suggestedActionBorderWidth = parseInt(_width2, 10);
    }
  }

  if (suggestedActionDisabledBorder) {
    console.warn('botframework-webcaht: "styleSet.suggestedActionDisabledBorder" is deprecated and will be removed on or after 2020-09-11. Please use "suggestedActionDisabledBorderColor", "suggestedActionDisabledBorderStyle", and, "suggestedActionDisabledBorderWidth".');

    var _parseBorder4 = parseBorder(suggestedActionDisabledBorder),
        _color3 = _parseBorder4.color,
        _style3 = _parseBorder4.style,
        _width3 = _parseBorder4.width;

    if (_color3 && _color3 !== 'initial') {
      options.suggestedActionDisabledBorderColor = _color3;
    }

    if (_style3 && _style3 !== 'initial') {
      options.suggestedActionDisabledBorderStyle = _style3;
    }

    if (PIXEL_UNIT_PATTERN.test(_width3)) {
      options.suggestedActionDisabledBorderWidth = parseInt(_width3, 10);
    }
  }

  if (bubbleFromUserNubOffset === 'top') {
    options.bubbleFromUserNubOffset = 0;
  } else if (typeof bubbleFromUserNubOffset !== 'number') {
    options.bubbleFromUserNubOffset = -0;
  }

  if (bubbleNubOffset === 'top') {
    options.bubbleNubOffset = 0;
  } else if (typeof bubbleNubOffset !== 'number') {
    options.bubbleNubOffset = -0;
  }

  if (options.emojiSet === true) {
    options.emojiSet = {
      ':)': '😊',
      ':-)': '😊',
      '(:': '😊',
      '(-:': '😊',
      ':-|': '😐',
      ':|': '😐',
      ':-(': '☹️',
      ':(': '☹️',
      ':-D': '😀',
      ':D': '😀',
      ':-p': '😛',
      ':p': '😛',
      ':-P': '😛',
      ':P': '😛',
      ':-o': '😲',
      ':o': '😲',
      ':O': '😲',
      ':-O': '😲',
      ':-0': '😲',
      ':0': '😲',
      ';-)': '😉',
      ';)': '😉',
      '<3': '❤️',
      '</3': '💔',
      '<\\3': '💔'
    };
  } else if (Object.prototype.toString.call(options.emojiSet) !== '[object Object]') {
    console.warn('botframework-webchat: emojiSet must be a boolean or an object with emoticon: emojiValues');
    options.emojiSet = false;
  }

  return {
    activities: (0, _Activities.default)(options),
    activity: (0, _Activity.default)(options),
    audioAttachment: (0, _AudioAttachment.default)(options),
    audioContent: (0, _AudioContent.default)(options),
    avatar: (0, _Avatar.default)(options),
    bubble: (0, _Bubble.default)(options),
    carouselFilmStrip: (0, _CarouselFilmStrip.default)(options),
    carouselFlipper: (0, _CarouselFlipper.default)(options),
    connectivityNotification: (0, _ConnectivityNotification.default)(options),
    dictationInterims: (0, _DictationInterims.default)(options),
    errorBox: (0, _ErrorBox.default)(options),
    errorNotification: (0, _ErrorNotification.default)(options),
    fileContent: (0, _FileContent.default)(options),
    imageAvatar: (0, _ImageAvatar.default)(options),
    initialsAvatar: (0, _InitialsAvatar.default)(options),
    microphoneButton: (0, _MicrophoneButton.default)(options),
    options: _objectSpread({}, options),
    // Cloned to make sure no additional modifications will propagate up.
    root: (0, _Root.default)(options),
    scrollToEndButton: (0, _ScrollToEndButton.default)(options),
    sendBox: (0, _SendBox.default)(options),
    sendBoxButton: (0, _SendBoxButton.default)(options),
    sendBoxTextArea: (0, _SendBoxTextArea.default)(options),
    sendBoxTextBox: (0, _SendBoxTextBox.default)(options),
    sendStatus: (0, _SendStatus.default)(options),
    singleAttachmentActivity: (0, _SingleAttachmentActivity.default)(options),
    spinnerAnimation: (0, _SpinnerAnimation.default)(options),
    stackedLayout: (0, _StackedLayout.default)(options),
    suggestedAction: (0, _SuggestedAction.default)(options),
    suggestedActions: (0, _SuggestedActions.default)(options),
    textContent: (0, _TextContent.default)(options),
    toast: (0, _Toast.default)(options),
    toaster: (0, _Toaster.default)(options),
    typingAnimation: (0, _TypingAnimation.default)(options),
    typingIndicator: (0, _TypingIndicator.default)(options),
    uploadButton: (0, _UploadButton.default)(options),
    videoAttachment: (0, _VideoAttachment.default)(options),
    videoContent: (0, _VideoContent.default)(options),
    vimeoContent: (0, _VimeoContent.default)(options),
    warningNotification: (0, _WarningNotification.default)(options),
    youTubeContent: (0, _YouTubeContent.default)(options)
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9TdHlsZXMvY3JlYXRlU3R5bGVTZXQuanMiXSwibmFtZXMiOlsicGFyc2VCb3JkZXIiLCJib3JkZXIiLCJkdW1teUVsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJzdHlsZSIsImNvbG9yIiwiYm9yZGVyQ29sb3IiLCJib3JkZXJTdHlsZSIsIndpZHRoIiwiYm9yZGVyV2lkdGgiLCJQSVhFTF9VTklUX1BBVFRFUk4iLCJjcmVhdGVTdHlsZVNldCIsIm9wdGlvbnMiLCJkZWZhdWx0U3R5bGVPcHRpb25zIiwiYnViYmxlQm9yZGVyIiwiYnViYmxlRnJvbVVzZXJCb3JkZXIiLCJidWJibGVGcm9tVXNlck51Yk9mZnNldCIsImJ1YmJsZU51Yk9mZnNldCIsInN1Z2dlc3RlZEFjdGlvbkJvcmRlciIsInN1Z2dlc3RlZEFjdGlvbkRpc2FibGVkQm9yZGVyIiwiY29uc29sZSIsIndhcm4iLCJidWJibGVCb3JkZXJDb2xvciIsImJ1YmJsZUJvcmRlclN0eWxlIiwidGVzdCIsImJ1YmJsZUJvcmRlcldpZHRoIiwicGFyc2VJbnQiLCJidWJibGVGcm9tVXNlckJvcmRlckNvbG9yIiwiYnViYmxlRnJvbVVzZXJCb3JkZXJTdHlsZSIsImJ1YmJsZUZyb21Vc2VyQm9yZGVyV2lkdGgiLCJzdWdnZXN0ZWRBY3Rpb25Cb3JkZXJDb2xvciIsInN1Z2dlc3RlZEFjdGlvbkJvcmRlclN0eWxlIiwic3VnZ2VzdGVkQWN0aW9uQm9yZGVyV2lkdGgiLCJzdWdnZXN0ZWRBY3Rpb25EaXNhYmxlZEJvcmRlckNvbG9yIiwic3VnZ2VzdGVkQWN0aW9uRGlzYWJsZWRCb3JkZXJTdHlsZSIsInN1Z2dlc3RlZEFjdGlvbkRpc2FibGVkQm9yZGVyV2lkdGgiLCJlbW9qaVNldCIsIk9iamVjdCIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwiY2FsbCIsImFjdGl2aXRpZXMiLCJhY3Rpdml0eSIsImF1ZGlvQXR0YWNobWVudCIsImF1ZGlvQ29udGVudCIsImF2YXRhciIsImJ1YmJsZSIsImNhcm91c2VsRmlsbVN0cmlwIiwiY2Fyb3VzZWxGbGlwcGVyIiwiY29ubmVjdGl2aXR5Tm90aWZpY2F0aW9uIiwiZGljdGF0aW9uSW50ZXJpbXMiLCJlcnJvckJveCIsImVycm9yTm90aWZpY2F0aW9uIiwiZmlsZUNvbnRlbnQiLCJpbWFnZUF2YXRhciIsImluaXRpYWxzQXZhdGFyIiwibWljcm9waG9uZUJ1dHRvbiIsInJvb3QiLCJzY3JvbGxUb0VuZEJ1dHRvbiIsInNlbmRCb3giLCJzZW5kQm94QnV0dG9uIiwic2VuZEJveFRleHRBcmVhIiwic2VuZEJveFRleHRCb3giLCJzZW5kU3RhdHVzIiwic2luZ2xlQXR0YWNobWVudEFjdGl2aXR5Iiwic3Bpbm5lckFuaW1hdGlvbiIsInN0YWNrZWRMYXlvdXQiLCJzdWdnZXN0ZWRBY3Rpb24iLCJzdWdnZXN0ZWRBY3Rpb25zIiwidGV4dENvbnRlbnQiLCJ0b2FzdCIsInRvYXN0ZXIiLCJ0eXBpbmdBbmltYXRpb24iLCJ0eXBpbmdJbmRpY2F0b3IiLCJ1cGxvYWRCdXR0b24iLCJ2aWRlb0F0dGFjaG1lbnQiLCJ2aWRlb0NvbnRlbnQiLCJ2aW1lb0NvbnRlbnQiLCJ3YXJuaW5nTm90aWZpY2F0aW9uIiwieW91VHViZUNvbnRlbnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7Ozs7Ozs7OztBQUVBO0FBQ0E7QUFDQTtBQUVBLFNBQVNBLFdBQVQsQ0FBcUJDLE1BQXJCLEVBQTZCO0FBQzNC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QUFBLGVBQWUsRUFBRSw4QkFBMkIvRCxPQUEzQixDQXBDWjtBQXFDTGdFLElBQUFBLFlBQVksRUFBRSwyQkFBd0JoRSxPQUF4QixDQXJDVDtBQXNDTGlFLElBQUFBLFlBQVksRUFBRSwyQkFBd0JqRSxPQUF4QixDQXRDVDtBQXVDTGtFLElBQUFBLG1CQUFtQixFQUFFLGtDQUErQmxFLE9BQS9CLENBdkNoQjtBQXdDTG1FLElBQUFBLGNBQWMsRUFBRSw2QkFBMEJuRSxPQUExQjtBQXhDWCxHQUFQO0FBMENEIiwic291cmNlUm9vdCI6ImNvbXBvbmVudDovLy8iLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBjb21wbGV4aXR5ICovXG5pbXBvcnQgY3JlYXRlQWN0aXZpdGllc1N0eWxlIGZyb20gJy4vU3R5bGVTZXQvQWN0aXZpdGllcyc7XG5pbXBvcnQgY3JlYXRlQWN0aXZpdHlTdHlsZSBmcm9tICcuL1N0eWxlU2V0L0FjdGl2aXR5JztcbmltcG9ydCBjcmVhdGVBdWRpb0F0dGFjaG1lbnRTdHlsZSBmcm9tICcuL1N0eWxlU2V0L0F1ZGlvQXR0YWNobWVudCc7XG5pbXBvcnQgY3JlYXRlQXVkaW9Db250ZW50U3R5bGUgZnJvbSAnLi9TdHlsZVNldC9BdWRpb0NvbnRlbnQnO1xuaW1wb3J0IGNyZWF0ZUF2YXRhclN0eWxlIGZyb20gJy4vU3R5bGVTZXQvQXZhdGFyJztcbmltcG9ydCBjcmVhdGVCdWJibGVTdHlsZSBmcm9tICcuL1N0eWxlU2V0L0J1YmJsZSc7XG5pbXBvcnQgY3JlYXRlQ2Fyb3VzZWxGaWxtU3RyaXAgZnJvbSAnLi9TdHlsZVNldC9DYXJvdXNlbEZpbG1TdHJpcCc7XG5pbXBvcnQgY3JlYXRlQ2Fyb3VzZWxGbGlwcGVyIGZyb20gJy4vU3R5bGVTZXQvQ2Fyb3VzZWxGbGlwcGVyJztcbmltcG9ydCBjcmVhdGVDb25uZWN0aXZpdHlOb3RpZmljYXRpb24gZnJvbSAnLi9TdHlsZVNldC9Db25uZWN0aXZpdHlOb3RpZmljYXRpb24nO1xuaW1wb3J0IGNyZWF0ZURpY3RhdGlvbkludGVyaW1zU3R5bGUgZnJvbSAnLi9TdHlsZVNldC9EaWN0YXRpb25JbnRlcmltcyc7XG5pbXBvcnQgY3JlYXRlRXJyb3JCb3hTdHlsZSBmcm9tICcuL1N0eWxlU2V0L0Vycm9yQm94JztcbmltcG9ydCBjcmVhdGVFcnJvck5vdGlmaWNhdGlvblN0eWxlIGZyb20gJy4vU3R5bGVTZXQvRXJyb3JOb3RpZmljYXRpb24nO1xuaW1wb3J0IGNyZWF0ZUZpbGVDb250ZW50U3R5bGUgZnJvbSAnLi9TdHlsZVNldC9GaWxlQ29udGVudCc7XG5pbXBvcnQgY3JlYXRlSW1hZ2VBdmF0YXJTdHlsZSBmcm9tICcuL1N0eWxlU2V0L0ltYWdlQXZhdGFyJztcbmltcG9ydCBjcmVhdGVJbml0aWFsc0F2YXRhclN0eWxlIGZyb20gJy4vU3R5bGVTZXQvSW5pdGlhbHNBdmF0YXInO1xuaW1wb3J0IGNyZWF0ZU1pY3JvcGhvbmVCdXR0b25TdHlsZSBmcm9tICcuL1N0eWxlU2V0L01pY3JvcGhvbmVCdXR0b24nO1xuaW1wb3J0IGNyZWF0ZVJvb3RTdHlsZSBmcm9tICcuL1N0eWxlU2V0L1Jvb3QnO1xuaW1wb3J0IGNyZWF0ZVNjcm9sbFRvRW5kQnV0dG9uU3R5bGUgZnJvbSAnLi9TdHlsZVNldC9TY3JvbGxUb0VuZEJ1dHRvbic7XG5pbXBvcnQgY3JlYXRlU2VuZEJveEJ1dHRvblN0eWxlIGZyb20gJy4vU3R5bGVTZXQvU2VuZEJveEJ1dHRvbic7XG5pbXBvcnQgY3JlYXRlU2VuZEJveFN0eWxlIGZyb20gJy4vU3R5bGVTZXQvU2VuZEJveCc7XG5pbXBvcnQgY3JlYXRlU2VuZEJveFRleHRBcmVhU3R5bGUgZnJvbSAnLi9TdHlsZVNldC9TZW5kQm94VGV4dEFyZWEnO1xuaW1wb3J0IGNyZWF0ZVNlbmRCb3hUZXh0Qm94U3R5bGUgZnJvbSAnLi9TdHlsZVNldC9TZW5kQm94VGV4dEJveCc7XG5pbXBvcnQgY3JlYXRlU2VuZFN0YXR1c1N0eWxlIGZyb20gJy4vU3R5bGVTZXQvU2VuZFN0YXR1cyc7XG5pbXBvcnQgY3JlYXRlU2luZ2xlQXR0YWNobWVudEFjdGl2aXR5U3R5bGUgZnJvbSAnLi9TdHlsZVNldC9TaW5nbGVBdHRhY2htZW50QWN0aXZpdHknO1xuaW1wb3J0IGNyZWF0ZVNwaW5uZXJBbmltYXRpb25TdHlsZSBmcm9tICcuL1N0eWxlU2V0L1NwaW5uZXJBbmltYXRpb24nO1xuaW1wb3J0IGNyZWF0ZVN0YWNrZWRMYXlvdXRTdHlsZSBmcm9tICcuL1N0eWxlU2V0L1N0YWNrZWRMYXlvdXQnO1xuaW1wb3J0IGNyZWF0ZVN1Z2dlc3RlZEFjdGlvbnNTdHlsZSBmcm9tICcuL1N0eWxlU2V0L1N1Z2dlc3RlZEFjdGlvbnMnO1xuaW1wb3J0IGNyZWF0ZVN1Z2dlc3RlZEFjdGlvblN0eWxlIGZyb20gJy4vU3R5bGVTZXQvU3VnZ2VzdGVkQWN0aW9uJztcbmltcG9ydCBjcmVhdGVUZXh0Q29udGVudFN0eWxlIGZyb20gJy4vU3R5bGVTZXQvVGV4dENvbnRlbnQnO1xuaW1wb3J0IGNyZWF0ZVRvYXN0ZXJTdHlsZSBmcm9tICcuL1N0eWxlU2V0L1RvYXN0ZXInO1xuaW1wb3J0IGNyZWF0ZVRvYXN0U3R5bGUgZnJvbSAnLi9TdHlsZVNldC9Ub2FzdCc7XG5pbXBvcnQgY3JlYXRlVHlwaW5nQW5pbWF0aW9uU3R5bGUgZnJvbSAnLi9TdHlsZVNldC9UeXBpbmdBbmltYXRpb24nO1xuaW1wb3J0IGNyZWF0ZVR5cGluZ0luZGljYXRvclN0eWxlIGZyb20gJy4vU3R5bGVTZXQvVHlwaW5nSW5kaWNhdG9yJztcbmltcG9ydCBjcmVhdGVVcGxvYWRCdXR0b25TdHlsZSBmcm9tICcuL1N0eWxlU2V0L1VwbG9hZEJ1dHRvbic7XG5pbXBvcnQgY3JlYXRlVmlkZW9BdHRhY2htZW50U3R5bGUgZnJvbSAnLi9TdHlsZVNldC9WaWRlb0F0dGFjaG1lbnQnO1xuaW1wb3J0IGNyZWF0ZVZpZGVvQ29udGVudFN0eWxlIGZyb20gJy4vU3R5bGVTZXQvVmlkZW9Db250ZW50JztcbmltcG9ydCBjcmVhdGVWaW1lb0NvbnRlbnRTdHlsZSBmcm9tICcuL1N0eWxlU2V0L1ZpbWVvQ29udGVudCc7XG5pbXBvcnQgY3JlYXRlV2FybmluZ05vdGlmaWNhdGlvblN0eWxlIGZyb20gJy4vU3R5bGVTZXQvV2FybmluZ05vdGlmaWNhdGlvbic7XG5pbXBvcnQgY3JlYXRlWW91VHViZUNvbnRlbnRTdHlsZSBmcm9tICcuL1N0eWxlU2V0L1lvdVR1YmVDb250ZW50JztcblxuaW1wb3J0IGRlZmF1bHRTdHlsZU9wdGlvbnMgZnJvbSAnLi9kZWZhdWx0U3R5bGVPcHRpb25zJztcblxuLy8gVE9ETzogW1A0XSBXZSBzaG91bGQgYWRkIGEgbm90aWNlIGZvciBwZW9wbGUgd2hvIHdhbnQgdG8gdXNlIFwic3R5bGVTZXRcIiBpbnN0ZWFkIG9mIFwic3R5bGVPcHRpb25zXCIuXG4vLyAgICAgICBcInN0eWxlU2V0XCIgaXMgYWN0dWFsbHkgQ1NTIHN0eWxlc2hlZXQgYW5kIGl0IGlzIGJhc2VkIG9uIHRoZSBET00gdHJlZS5cbi8vICAgICAgIERPTSB0cmVlIG1heSBjaGFuZ2UgZnJvbSB0aW1lIHRvIHRpbWUsIHRodXMsIG1haW50YWluaW5nIFwic3R5bGVTZXRcIiBiZWNvbWVzIGEgY29uc3RhbnQgZWZmb3J0LlxuXG5mdW5jdGlvbiBwYXJzZUJvcmRlcihib3JkZXIpIHtcbiAgY29uc3QgZHVtbXlFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cbiAgZHVtbXlFbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBgYm9yZGVyOiAke2JvcmRlcn1gKTtcblxuICBjb25zdCB7XG4gICAgc3R5bGU6IHsgYm9yZGVyQ29sb3I6IGNvbG9yLCBib3JkZXJTdHlsZTogc3R5bGUsIGJvcmRlcldpZHRoOiB3aWR0aCB9XG4gIH0gPSBkdW1teUVsZW1lbnQ7XG5cbiAgcmV0dXJuIHtcbiAgICBjb2xvcixcbiAgICBzdHlsZSxcbiAgICB3aWR0aFxuICB9O1xufVxuXG5jb25zdCBQSVhFTF9VTklUX1BBVFRFUk4gPSAvXlxcZCtweCQvdTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY3JlYXRlU3R5bGVTZXQob3B0aW9ucykge1xuICBvcHRpb25zID0geyAuLi5kZWZhdWx0U3R5bGVPcHRpb25zLCAuLi5vcHRpb25zIH07XG5cbiAgLy8gS2VlcCB0aGlzIGxpc3QgZmxhdCAobm8gbmVzdGVkIHN0eWxlKSBhbmQgc2VyaWFsaXphYmxlIChubyBmdW5jdGlvbnMpXG5cbiAgLy8gVE9ETzogW1A0XSBEZXByZWNhdGUgdGhpcyBjb2RlIGFmdGVyIGJ1bXAgdG8gdjVcbiAgY29uc3Qge1xuICAgIGJ1YmJsZUJvcmRlcixcbiAgICBidWJibGVGcm9tVXNlckJvcmRlcixcbiAgICBidWJibGVGcm9tVXNlck51Yk9mZnNldCxcbiAgICBidWJibGVOdWJPZmZzZXQsXG4gICAgc3VnZ2VzdGVkQWN0aW9uQm9yZGVyLFxuICAgIHN1Z2dlc3RlZEFjdGlvbkRpc2FibGVkQm9yZGVyXG4gIH0gPSBvcHRpb25zO1xuXG4gIGlmIChidWJibGVCb3JkZXIpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICAnYm90ZnJhbWV3b3JrLXdlYmNoYXQ6IFwic3R5bGVTZXQuYnViYmxlQm9yZGVyXCIgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIG9uIG9yIGFmdGVyIDIwMjAtMDctMTcuIFBsZWFzZSB1c2UgXCJidWJibGVCb3JkZXJDb2xvclwiLCBcImJ1YmJsZUJvcmRlclN0eWxlXCIsIGFuZCwgXCJidWJibGVCb3JkZXJXaWR0aC4nXG4gICAgKTtcblxuICAgIGNvbnN0IHsgY29sb3IsIHN0eWxlLCB3aWR0aCB9ID0gcGFyc2VCb3JkZXIoYnViYmxlQm9yZGVyKTtcblxuICAgIGlmIChjb2xvciAmJiBjb2xvciAhPT0gJ2luaXRpYWwnKSB7XG4gICAgICBvcHRpb25zLmJ1YmJsZUJvcmRlckNvbG9yID0gY29sb3I7XG4gICAgfVxuXG4gICAgaWYgKHN0eWxlICYmIHN0eWxlICE9PSAnaW5pdGlhbCcpIHtcbiAgICAgIG9wdGlvbnMuYnViYmxlQm9yZGVyU3R5bGUgPSBzdHlsZTtcbiAgICB9XG5cbiAgICBpZiAoUElYRUxfVU5JVF9QQVRURVJOLnRlc3Qod2lkdGgpKSB7XG4gICAgICBvcHRpb25zLmJ1YmJsZUJvcmRlcldpZHRoID0gcGFyc2VJbnQod2lkdGgsIDEwKTtcbiAgICB9XG4gIH1cblxuICBpZiAoYnViYmxlRnJvbVVzZXJCb3JkZXIpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICAnYm90ZnJhbWV3b3JrLXdlYmNoYXQ6IFwic3R5bGVTZXQuYnViYmxlRnJvbVVzZXJCb3JkZXJcIiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgb24gb3IgYWZ0ZXIgMjAyMC0wNy0xNy4gUGxlYXNlIHVzZSBcImJ1YmJsZUZyb21Vc2VyQm9yZGVyQ29sb3JcIiwgXCJidWJibGVGcm9tVXNlckJvcmRlclN0eWxlXCIsIGFuZCwgXCJidWJibGVGcm9tVXNlckJvcmRlcldpZHRoXCIuJ1xuICAgICk7XG5cbiAgICBjb25zdCB7IGNvbG9yLCBzdHlsZSwgd2lkdGggfSA9IHBhcnNlQm9yZGVyKGJ1YmJsZUZyb21Vc2VyQm9yZGVyKTtcblxuICAgIGlmIChjb2xvciAmJiBjb2xvciAhPT0gJ2luaXRpYWwnKSB7XG4gICAgICBvcHRpb25zLmJ1YmJsZUZyb21Vc2VyQm9yZGVyQ29sb3IgPSBjb2xvcjtcbiAgICB9XG5cbiAgICBpZiAoc3R5bGUgJiYgc3R5bGUgIT09ICdpbml0aWFsJykge1xuICAgICAgb3B0aW9ucy5idWJibGVGcm9tVXNlckJvcmRlclN0eWxlID0gc3R5bGU7XG4gICAgfVxuXG4gICAgaWYgKFBJWEVMX1VOSVRfUEFUVEVSTi50ZXN0KHdpZHRoKSkge1xuICAgICAgb3B0aW9ucy5idWJibGVGcm9tVXNlckJvcmRlcldpZHRoID0gcGFyc2VJbnQod2lkdGgsIDEwKTtcbiAgICB9XG4gIH1cblxuICBpZiAoc3VnZ2VzdGVkQWN0aW9uQm9yZGVyKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgJ2JvdGZyYW1ld29yay13ZWJjaGF0OiBcInN0eWxlU2V0LnN1Z2dlc3RlZEFjdGlvbkJvcmRlclwiIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBvbiBvciBhZnRlciAyMDIwLTA5LTExLiBQbGVhc2UgdXNlIFwic3VnZ2VzdGVkQWN0aW9uQm9yZGVyQ29sb3JcIiwgXCJzdWdnZXN0ZWRBY3Rpb25Cb3JkZXJTdHlsZVwiLCBhbmQsIFwic3VnZ2VzdGVkQWN0aW9uQm9yZGVyV2lkdGhcIi4nXG4gICAgKTtcblxuICAgIGNvbnN0IHsgY29sb3IsIHN0eWxlLCB3aWR0aCB9ID0gcGFyc2VCb3JkZXIoc3VnZ2VzdGVkQWN0aW9uQm9yZGVyKTtcblxuICAgIGlmIChjb2xvciAmJiBjb2xvciAhPT0gJ2luaXRpYWwnKSB7XG4gICAgICBvcHRpb25zLnN1Z2dlc3RlZEFjdGlvbkJvcmRlckNvbG9yID0gY29sb3I7XG4gICAgfVxuXG4gICAgaWYgKHN0eWxlICYmIHN0eWxlICE9PSAnaW5pdGlhbCcpIHtcbiAgICAgIG9wdGlvbnMuc3VnZ2VzdGVkQWN0aW9uQm9yZGVyU3R5bGUgPSBzdHlsZTtcbiAgICB9XG5cbiAgICBpZiAoUElYRUxfVU5JVF9QQVRURVJOLnRlc3Qod2lkdGgpKSB7XG4gICAgICBvcHRpb25zLnN1Z2dlc3RlZEFjdGlvbkJvcmRlcldpZHRoID0gcGFyc2VJbnQod2lkdGgsIDEwKTtcbiAgICB9XG4gIH1cblxuICBpZiAoc3VnZ2VzdGVkQWN0aW9uRGlzYWJsZWRCb3JkZXIpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICAnYm90ZnJhbWV3b3JrLXdlYmNhaHQ6IFwic3R5bGVTZXQuc3VnZ2VzdGVkQWN0aW9uRGlzYWJsZWRCb3JkZXJcIiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgb24gb3IgYWZ0ZXIgMjAyMC0wOS0xMS4gUGxlYXNlIHVzZSBcInN1Z2dlc3RlZEFjdGlvbkRpc2FibGVkQm9yZGVyQ29sb3JcIiwgXCJzdWdnZXN0ZWRBY3Rpb25EaXNhYmxlZEJvcmRlclN0eWxlXCIsIGFuZCwgXCJzdWdnZXN0ZWRBY3Rpb25EaXNhYmxlZEJvcmRlcldpZHRoXCIuJ1xuICAgICk7XG5cbiAgICBjb25zdCB7IGNvbG9yLCBzdHlsZSwgd2lkdGggfSA9IHBhcnNlQm9yZGVyKHN1Z2dlc3RlZEFjdGlvbkRpc2FibGVkQm9yZGVyKTtcblxuICAgIGlmIChjb2xvciAmJiBjb2xvciAhPT0gJ2luaXRpYWwnKSB7XG4gICAgICBvcHRpb25zLnN1Z2dlc3RlZEFjdGlvbkRpc2FibGVkQm9yZGVyQ29sb3IgPSBjb2xvcjtcbiAgICB9XG5cbiAgICBpZiAoc3R5bGUgJiYgc3R5bGUgIT09ICdpbml0aWFsJykge1xuICAgICAgb3B0aW9ucy5zdWdnZXN0ZWRBY3Rpb25EaXNhYmxlZEJvcmRlclN0eWxlID0gc3R5bGU7XG4gICAgfVxuXG4gICAgaWYgKFBJWEVMX1VOSVRfUEFUVEVSTi50ZXN0KHdpZHRoKSkge1xuICAgICAgb3B0aW9ucy5zdWdnZXN0ZWRBY3Rpb25EaXNhYmxlZEJvcmRlcldpZHRoID0gcGFyc2VJbnQod2lkdGgsIDEwKTtcbiAgICB9XG4gIH1cblxuICBpZiAoYnViYmxlRnJvbVVzZXJOdWJPZmZzZXQgPT09ICd0b3AnKSB7XG4gICAgb3B0aW9ucy5idWJibGVGcm9tVXNlck51Yk9mZnNldCA9IDA7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGJ1YmJsZUZyb21Vc2VyTnViT2Zmc2V0ICE9PSAnbnVtYmVyJykge1xuICAgIG9wdGlvbnMuYnViYmxlRnJvbVVzZXJOdWJPZmZzZXQgPSAtMDtcbiAgfVxuXG4gIGlmIChidWJibGVOdWJPZmZzZXQgPT09ICd0b3AnKSB7XG4gICAgb3B0aW9ucy5idWJibGVOdWJPZmZzZXQgPSAwO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBidWJibGVOdWJPZmZzZXQgIT09ICdudW1iZXInKSB7XG4gICAgb3B0aW9ucy5idWJibGVOdWJPZmZzZXQgPSAtMDtcbiAgfVxuXG4gIGlmIChvcHRpb25zLmVtb2ppU2V0ID09PSB0cnVlKSB7XG4gICAgb3B0aW9ucy5lbW9qaVNldCA9IHtcbiAgICAgICc6KSc6ICfwn5iKJyxcbiAgICAgICc6LSknOiAn8J+YiicsXG4gICAgICAnKDonOiAn8J+YiicsXG4gICAgICAnKC06JzogJ/CfmIonLFxuICAgICAgJzotfCc6ICfwn5iQJyxcbiAgICAgICc6fCc6ICfwn5iQJyxcbiAgICAgICc6LSgnOiAn4pi577iPJyxcbiAgICAgICc6KCc6ICfimLnvuI8nLFxuICAgICAgJzotRCc6ICfwn5iAJyxcbiAgICAgICc6RCc6ICfwn5iAJyxcbiAgICAgICc6LXAnOiAn8J+YmycsXG4gICAgICAnOnAnOiAn8J+YmycsXG4gICAgICAnOi1QJzogJ/CfmJsnLFxuICAgICAgJzpQJzogJ/CfmJsnLFxuICAgICAgJzotbyc6ICfwn5iyJyxcbiAgICAgICc6byc6ICfwn5iyJyxcbiAgICAgICc6Tyc6ICfwn5iyJyxcbiAgICAgICc6LU8nOiAn8J+YsicsXG4gICAgICAnOi0wJzogJ/CfmLInLFxuICAgICAgJzowJzogJ/CfmLInLFxuICAgICAgJzstKSc6ICfwn5iJJyxcbiAgICAgICc7KSc6ICfwn5iJJyxcbiAgICAgICc8Myc6ICfinaTvuI8nLFxuICAgICAgJzwvMyc6ICfwn5KUJyxcbiAgICAgICc8XFxcXDMnOiAn8J+SlCdcbiAgICB9O1xuICB9IGVsc2UgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvcHRpb25zLmVtb2ppU2V0KSAhPT0gJ1tvYmplY3QgT2JqZWN0XScpIHtcbiAgICBjb25zb2xlLndhcm4oJ2JvdGZyYW1ld29yay13ZWJjaGF0OiBlbW9qaVNldCBtdXN0IGJlIGEgYm9vbGVhbiBvciBhbiBvYmplY3Qgd2l0aCBlbW90aWNvbjogZW1vamlWYWx1ZXMnKTtcbiAgICBvcHRpb25zLmVtb2ppU2V0ID0gZmFsc2U7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGFjdGl2aXRpZXM6IGNyZWF0ZUFjdGl2aXRpZXNTdHlsZShvcHRpb25zKSxcbiAgICBhY3Rpdml0eTogY3JlYXRlQWN0aXZpdHlTdHlsZShvcHRpb25zKSxcbiAgICBhdWRpb0F0dGFjaG1lbnQ6IGNyZWF0ZUF1ZGlvQXR0YWNobWVudFN0eWxlKG9wdGlvbnMpLFxuICAgIGF1ZGlvQ29udGVudDogY3JlYXRlQXVkaW9Db250ZW50U3R5bGUob3B0aW9ucyksXG4gICAgYXZhdGFyOiBjcmVhdGVBdmF0YXJTdHlsZShvcHRpb25zKSxcbiAgICBidWJibGU6IGNyZWF0ZUJ1YmJsZVN0eWxlKG9wdGlvbnMpLFxuICAgIGNhcm91c2VsRmlsbVN0cmlwOiBjcmVhdGVDYXJvdXNlbEZpbG1TdHJpcChvcHRpb25zKSxcbiAgICBjYXJvdXNlbEZsaXBwZXI6IGNyZWF0ZUNhcm91c2VsRmxpcHBlcihvcHRpb25zKSxcbiAgICBjb25uZWN0aXZpdHlOb3RpZmljYXRpb246IGNyZWF0ZUNvbm5lY3Rpdml0eU5vdGlmaWNhdGlvbihvcHRpb25zKSxcbiAgICBkaWN0YXRpb25JbnRlcmltczogY3JlYXRlRGljdGF0aW9uSW50ZXJpbXNTdHlsZShvcHRpb25zKSxcbiAgICBlcnJvckJveDogY3JlYXRlRXJyb3JCb3hTdHlsZShvcHRpb25zKSxcbiAgICBlcnJvck5vdGlmaWNhdGlvbjogY3JlYXRlRXJyb3JOb3RpZmljYXRpb25TdHlsZShvcHRpb25zKSxcbiAgICBmaWxlQ29udGVudDogY3JlYXRlRmlsZUNvbnRlbnRTdHlsZShvcHRpb25zKSxcbiAgICBpbWFnZUF2YXRhcjogY3JlYXRlSW1hZ2VBdmF0YXJTdHlsZShvcHRpb25zKSxcbiAgICBpbml0aWFsc0F2YXRhcjogY3JlYXRlSW5pdGlhbHNBdmF0YXJTdHlsZShvcHRpb25zKSxcbiAgICBtaWNyb3Bob25lQnV0dG9uOiBjcmVhdGVNaWNyb3Bob25lQnV0dG9uU3R5bGUob3B0aW9ucyksXG4gICAgb3B0aW9uczogeyAuLi5vcHRpb25zIH0sIC8vIENsb25lZCB0byBtYWtlIHN1cmUgbm8gYWRkaXRpb25hbCBtb2RpZmljYXRpb25zIHdpbGwgcHJvcGFnYXRlIHVwLlxuICAgIHJvb3Q6IGNyZWF0ZVJvb3RTdHlsZShvcHRpb25zKSxcbiAgICBzY3JvbGxUb0VuZEJ1dHRvbjogY3JlYXRlU2Nyb2xsVG9FbmRCdXR0b25TdHlsZShvcHRpb25zKSxcbiAgICBzZW5kQm94OiBjcmVhdGVTZW5kQm94U3R5bGUob3B0aW9ucyksXG4gICAgc2VuZEJveEJ1dHRvbjogY3JlYXRlU2VuZEJveEJ1dHRvblN0eWxlKG9wdGlvbnMpLFxuICAgIHNlbmRCb3hUZXh0QXJlYTogY3JlYXRlU2VuZEJveFRleHRBcmVhU3R5bGUob3B0aW9ucyksXG4gICAgc2VuZEJveFRleHRCb3g6IGNyZWF0ZVNlbmRCb3hUZXh0Qm94U3R5bGUob3B0aW9ucyksXG4gICAgc2VuZFN0YXR1czogY3JlYXRlU2VuZFN0YXR1c1N0eWxlKG9wdGlvbnMpLFxuICAgIHNpbmdsZUF0dGFjaG1lbnRBY3Rpdml0eTogY3JlYXRlU2luZ2xlQXR0YWNobWVudEFjdGl2aXR5U3R5bGUob3B0aW9ucyksXG4gICAgc3Bpbm5lckFuaW1hdGlvbjogY3JlYXRlU3Bpbm5lckFuaW1hdGlvblN0eWxlKG9wdGlvbnMpLFxuICAgIHN0YWNrZWRMYXlvdXQ6IGNyZWF0ZVN0YWNrZWRMYXlvdXRTdHlsZShvcHRpb25zKSxcbiAgICBzdWdnZXN0ZWRBY3Rpb246IGNyZWF0ZVN1Z2dlc3RlZEFjdGlvblN0eWxlKG9wdGlvbnMpLFxuICAgIHN1Z2dlc3RlZEFjdGlvbnM6IGNyZWF0ZVN1Z2dlc3RlZEFjdGlvbnNTdHlsZShvcHRpb25zKSxcbiAgICB0ZXh0Q29udGVudDogY3JlYXRlVGV4dENvbnRlbnRTdHlsZShvcHRpb25zKSxcbiAgICB0b2FzdDogY3JlYXRlVG9hc3RTdHlsZShvcHRpb25zKSxcbiAgICB0b2FzdGVyOiBjcmVhdGVUb2FzdGVyU3R5bGUob3B0aW9ucyksXG4gICAgdHlwaW5nQW5pbWF0aW9uOiBjcmVhdGVUeXBpbmdBbmltYXRpb25TdHlsZShvcHRpb25zKSxcbiAgICB0eXBpbmdJbmRpY2F0b3I6IGNyZWF0ZVR5cGluZ0luZGljYXRvclN0eWxlKG9wdGlvbnMpLFxuICAgIHVwbG9hZEJ1dHRvbjogY3JlYXRlVXBsb2FkQnV0dG9uU3R5bGUob3B0aW9ucyksXG4gICAgdmlkZW9BdHRhY2htZW50OiBjcmVhdGVWaWRlb0F0dGFjaG1lbnRTdHlsZShvcHRpb25zKSxcbiAgICB2aWRlb0NvbnRlbnQ6IGNyZWF0ZVZpZGVvQ29udGVudFN0eWxlKG9wdGlvbnMpLFxuICAgIHZpbWVvQ29udGVudDogY3JlYXRlVmltZW9Db250ZW50U3R5bGUob3B0aW9ucyksXG4gICAgd2FybmluZ05vdGlmaWNhdGlvbjogY3JlYXRlV2FybmluZ05vdGlmaWNhdGlvblN0eWxlKG9wdGlvbnMpLFxuICAgIHlvdVR1YmVDb250ZW50OiBjcmVhdGVZb3VUdWJlQ29udGVudFN0eWxlKG9wdGlvbnMpXG4gIH07XG59XG4iXX0=